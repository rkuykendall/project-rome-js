{"version":3,"sources":["webpack:///webpack/bootstrap d3a8829f6f7258123e87","webpack:///./lib/melonJS.js","webpack:///./lib/plugins/debugPanel.js","webpack:///./js/game.js","webpack:///./js/resources.js","webpack:///./js/screens/play.js","webpack:///./js/entities/text.js","webpack:///./js/entities/ship.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;;;;;;;;iICtCA;AACA;AACA;AACA,cAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,cAAa;AACb;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,6BAA4B,uBAAuB;AACnD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB;AACnB,iCAAgC;AAChC,kCAAiC;AACjC;AACA;AACA;AACA;AACA;;AAEA,EAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,iBAAgB;AAChB,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAW,OAAO;AAClB,aAAY;AACZ;AACA,aAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAS;AACT;;AAEA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,iBAAgB;AAChB,cAAa;AACb;AACA;AACA;AACA,4BAA2B;AAC3B;AACA;AACA,yBAAwB;AACxB;AACA;AACA,4BAA2B;AAC3B;AACA;AACA,oBAAmB,IAAI,EAAE;AACzB;AACA;AACA,kBAAiB;AACjB,wBAAuB;AACvB;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,SAAS;AACxB,iBAAgB,OAAO;AACvB,cAAa;AACb;AACA;AACA,kBAAiB;AACjB,kBAAiB;AACjB,kBAAiB;AACjB;AACA;AACA;AACA,YAAW;AACX;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B,sBAAsB;AACjD;AACA;AACA;AACA;AACA;AACA,gEAA+D,iBAAiB;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW,SAAS;AACpB;AACA;AACA,aAAY;AACZ;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,2BAA0B;AAC1B;AACA;AACA,2BAA0B;AAC1B,gCAA+B;AAC/B;AACA;AACA,2BAA0B;AAC1B,gCAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,oCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA,wBAAuB,sBAAsB;AAC7C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;;AAEL;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,iBAAgB,OAAO;AACvB;AACA;AACA,gBAAe;AACf;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAS;AACT;;AAEA;AACA;AACA;AACA;AACA,YAAW,OAAO;AAClB,YAAW,OAAO;AAClB,aAAY,OAAO;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAW,OAAO;AAClB,YAAW,OAAO;AAClB,aAAY,OAAO;AACnB;AACA,6BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAW,OAAO;AAClB,YAAW,OAAO;AAClB,aAAY,OAAO;AACnB;AACA,6BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAW,OAAO;AAClB,YAAW,OAAO;AAClB,aAAY,OAAO;AACnB;AACA,6BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAW,OAAO;AAClB,YAAW,OAAO;AAClB,aAAY,OAAO;AACnB;AACA;AACA,yCAAwC;AACxC;AACA;AACA,iBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAY,OAAO;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAW,OAAO;AAClB,aAAY,OAAO;AACnB;AACA;AACA,mCAAkC;AAClC;AACA;AACA,mBAAkB;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAW,OAAO;AAClB,aAAY,OAAO;AACnB;AACA;AACA,mDAAkD;AAClD;AACA;AACA,8BAA6B;AAC7B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,QAAQ;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,iBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAS;AACT;;AAEA;AACA;AACA;AACA;AACA,YAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAwC,KAAK;AAC7C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAW,MAAM;AACjB,aAAY,IAAI;AAChB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAW,MAAM;AACjB,aAAY,IAAI;AAChB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,oBAAmB,mBAAmB;AACtC;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAS;AACT;AACA;;AAEA;AACA;AACA;AACA,UAAS;AACT;AACA;;AAEA;AACA;AACA;AACA,UAAS;AACT;AACA;;AAEA;AACA;AACA;AACA,UAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,sBAAqB;AACrB;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;;AAGA;AACA;AACA,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAO;AACP;;AAEA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA,yCAAwC;AACxC;AACA;AACA,0CAAyC;AACzC;AACA,6BAA4B,qBAAqB;AACjD;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAqC,sBAAsB,EAAE;AAC7D;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,uDAAsD,0BAA0B;AAChF;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;;AAEA,EAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,mBAAkB;AAClB;AACA;AACA;AACA;;AAEA;AACA,2CAA0C;AAC1C;AACA;AACA,mBAAkB;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,mBAAkB;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAkB;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,mBAAkB;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,mBAAkB;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAkB;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAkB;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,mBAAkB;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAkB;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,OAAO,2BAA2B,eAAe;AACrE;AACA,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,4BAA2B,SAAS;AACpC;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA,cAAa;AACb;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,EAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,mBAAkB;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAkB;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAkB;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAkB;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAkB;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,uBAAsB,QAAQ;AAC9B,uBAAsB,QAAQ;AAC9B,uBAAsB,QAAQ;AAC9B,uBAAsB,QAAQ;AAC9B;AACA,mBAAkB;AAClB;AACA;AACA;AACA;AACA,+CAA8C;AAC9C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,cAAc;AACjC,qBAAoB;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,OAAO;AACvB,iBAAgB,OAAO;AACvB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,MAAM;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,MAAM;AACzB,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;;AAEA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,cAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;;AAGb;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA,cAAa;AACb;AACA;AACA,cAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAkB;AAClB;AACA;AACA;AACA,aAAY;AACZ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,gBAAgB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iDAAgD;AAChD;AACA,kDAAiD;;AAEjD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iDAAgD,SAAS;AACzD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iDAAgD,SAAS;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,yDAAwD,iBAAiB;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oBAAmB,SAAS;AAC5B,oBAAmB,OAAO;AAC1B,oBAAmB,QAAQ;AAC3B,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;AACA,oBAAmB,SAAS;AAC5B,oBAAmB,OAAO;AAC1B,oBAAmB,QAAQ;AAC3B,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,6BAA4B;AAC5B;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO,uBAAuB;AACjD,qBAAoB;AACpB,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B,sBAAsB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,0DAAyD,mBAAmB;AAC5E;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,YAAY;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B,qBAAoB;AACpB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,YAAY;AAChC;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B,qBAAoB;AACpB;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,YAAY;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,wBAAwB;AAC3C,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,wBAAwB;AAC3C,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,wBAAwB;AAC3C,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,YAAY;AAChC;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,wBAAwB;AAC3C,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,wBAAwB;AAC3C,qBAAoB,YAAY;AAChC;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,wBAAwB;AAC3C,qBAAoB,YAAY;AAChC;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,wBAAwB;AAC3C,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,wBAAwB;AAC3C,qBAAoB;AACpB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,YAAY;AAChC;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,wBAAwB;AAC3C,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,wBAAwB;AAC3C,qBAAoB;AACpB;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,wBAAwB;AAC3C,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,wBAAwB;AAC3C,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,wBAAwB;AAC3C,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,SAAS;AACxB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,SAAS;AAC5B,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,sBAAsB;AAC1C;AACA;AACA,iGAAgG,wBAAwB;AACxH,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,sBAAsB;AAC1C;AACA;AACA,yFAAwF,wBAAwB;AAChH,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,sBAAsB;AAC1C;AACA;AACA,uFAAsF,wBAAwB;AAC9G,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,sBAAsB;AAC1C;AACA;AACA,mEAAkE,wBAAwB;AAC1F,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC,qBAAoB;AACpB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC,qBAAoB;AACpB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,iEAAgE,wBAAwB;AACxF,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,SAAS;AACxB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,SAAS;AAC5B,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,oEAAoE;AACvF,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,oEAAoE;AACvF,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,oEAAoE;AACvF,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,oEAAoE;AACvF,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,oEAAoE;AACvF,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,oEAAoE;AACvF,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,oEAAoE;AACvF,qBAAoB;AACpB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,oEAAoE;AACvF,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,oEAAoE;AACvF,qBAAoB;AACpB;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,YAAY;AAC3B,gBAAe,SAAS,sCAAsC;AAC9D;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,YAAY;AAChC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B,qBAAoB,YAAY;AAChC;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B,qBAAoB,YAAY;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,YAAY;AAChC;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,YAAY;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,YAAY;AAChC;AACA;AACA;;AAEA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B,qBAAoB,YAAY;AAChC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,WAAW;AAC/B;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,WAAW;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B,qBAAoB,WAAW;AAC/B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,WAAW;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,OAAO;AAC3B,qBAAoB,OAAO;AAC3B,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,WAAW;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,cAAc;AAC7B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,cAAc;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,WAAW;AAC/B;AACA;AACA;AACA;AACA;AACA,gCAA+B,SAAS;AACxC;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,WAAW;AAC/B;AACA;AACA;;AAEA;AACA;AACA,4BAA2B,SAAS;AACpC;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B,qBAAoB,WAAW;AAC/B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,wBAAuB,SAAS;AAChC;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,WAAW;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B,qBAAoB,WAAW;AAC/B;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,OAAO;AAC3B,qBAAoB,OAAO;AAC3B,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,yCAAwC,SAAS;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;AACb;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,WAAW;AAC/B;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,QAAQ;AAC5B;AACA;;AAEA,sCAAqC;AACrC,sCAAqC;AACrC,sCAAqC;AACrC,sCAAqC;;AAErC;;AAEA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,QAAQ;AAC3B,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,QAAQ;AAC3B,qBAAoB,QAAQ;AAC5B;AACA,gCAA+B,QAAQ;AACvC;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,QAAQ;AAC5B,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,QAAQ;AAC5B,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,OAAO;AAC3B,qBAAoB,OAAO;AAC3B,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,WAAW;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;;AAEA;AACA;AACA;AACA,eAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA,MAAK;;AAEL;AACA;AACA;AACA,eAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA,MAAK;;AAEL;AACA;AACA;AACA,eAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA,MAAK;;AAEL;AACA;AACA;AACA,eAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA,MAAK;;AAEL;AACA;AACA;AACA,eAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA,UAAS;AACT;AACA,MAAK;;AAEL;AACA;AACA;AACA,eAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA,UAAS;AACT;AACA,MAAK;;AAEL,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,cAAc;AAC7B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,OAAO;AAC3B,qBAAoB,OAAO;AAC3B,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA,6BAA4B;AAC5B,6BAA4B;AAC5B,wCAAuC;AACvC,sCAAqC;;AAErC;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,UAAU;AACzB,gBAAe,8CAA8C;AAC7D;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,4BAA2B,mBAAmB;AAC9C;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,sCAAsC;AACzD,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,gCAA+B,iBAAiB;AAChD;AACA,oCAAmC,0BAA0B;AAC7D;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;;AAEA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,8BAA8B;AAClD;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,8BAA8B;AACjD,qBAAoB,OAAO;AAC3B;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,4BAA4B;AAC/C;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,iCAAgC,wBAAwB;AACxD;AACA;AACA;;AAEA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,QAAQ;AACvB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA,UAAS;AACT;;;AAGA;AACA;AACA,gBAAe,QAAQ;AACvB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,gBAAe,aAAa;AAC5B;AACA;;AAEA,uDAAsD,sCAAsC;AAC5F;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,iBAAgB,SAAS;AACzB;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,cAAa;AACb;AACA,gCAA+B,uBAAuB;AACtD;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,wBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA,eAAc;AACd;AACA;AACA,oBAAmB,QAAQ,OAAO,mCAAmC;;AAErE;AACA;AACA,eAAc;AACd;AACA;AACA,oBAAmB,OAAO,OAAO,mBAAmB;;;AAGpD;AACA;AACA;AACA;AACA,gBAAe,eAAe;AAC9B,gBAAe,OAAO;AACtB,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB,SAAS;AAChC;AACA;AACA,6BAA4B,WAAW;AACvC,6BAA4B,WAAW;AACvC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,eAAe;AAC9B,gBAAe,eAAe;AAC9B,gBAAe,OAAO;AACtB;AACA,gBAAe,UAAU;AACzB;AACA,iBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,kBAAiB,OAAO;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,mBAAkB;AAClB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,mBAAkB;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,mBAAkB;AAClB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,mBAAkB;AAClB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA4C;AAC5C;AACA;AACA;AACA,mBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;;AAEA;AACA;AACA,uBAAsB,UAAU;AAChC,uBAAsB,UAAU;AAChC,uBAAsB,OAAO;AAC7B,uBAAsB,YAAY;AAClC,uBAAsB,YAAY;AAClC,uBAAsB,QAAQ;AAC9B,uBAAsB,QAAQ;AAC9B,uBAAsB,OAAO;AAC7B,uBAAsB,OAAO;AAC7B;AACA;AACA;AACA,mBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAkB;AAClB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,UAAU;AAC7B,oBAAmB,UAAU;AAC7B,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,UAAU;AAC7B,oBAAmB,4BAA4B;AAC/C,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY;AACZ;AACA;AACA;AACA;;AAEA;AACA;;AAEA,kDAAiD,6BAA6B;;AAE9E;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB;AACzB;AACA,sBAAqB;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oBAAmB,UAAU;AAC7B,oBAAmB,WAAW;AAC9B,oBAAmB,UAAU;AAC7B,oBAAmB,WAAW;AAC9B,oBAAmB,UAAU;AAC7B,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wBAAuB,UAAU;AACjC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wBAAuB,SAAS;AAChC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oBAAmB,UAAU;AAC7B,oBAAmB,WAAW;AAC9B,oBAAmB,UAAU;AAC7B,oBAAmB,WAAW;AAC9B,oBAAmB,UAAU;AAC7B;AACA,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oBAAmB,UAAU;AAC7B,oBAAmB,WAAW;AAC9B,oBAAmB,UAAU;AAC7B,oBAAmB,WAAW;AAC9B,oBAAmB,UAAU;AAC7B,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,4BAA2B,SAAS;AACpC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,UAAU;AAC7B,oBAAmB,WAAW;AAC9B,oBAAmB,UAAU;AAC7B,oBAAmB,WAAW;AAC9B,oBAAmB,UAAU;AAC7B;AACA,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa;AACb,gEAA+D,4CAA4C;AAC3G;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,mCAAmC;AACtD;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,eAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,UAAS;AACT;AACA,MAAK;;AAEL;AACA;AACA;AACA,eAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,UAAS;AACT;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,uCAAuC;AACtD,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,QAAQ;AACvB,gBAAe,QAAQ;AACvB,gBAAe,YAAY;AAC3B;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,SAAS;AAC5B;AACA;AACA;AACA;AACA;AACA,aAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,mCAAmC;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,aAAa;AAC5B,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,YAAY;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,2BAA2B;AAC9C;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAuC,sBAAsB,GAAG,sBAAsB;AACtF;AACA,wCAAuC,8BAA8B,GAAG,8BAA8B;AACtG;AACA,uCAAsC,sBAAsB,GAAG,sBAAsB,GAAG,2BAA2B;AACnH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;;AAEA;AACA;AACA;AACA,gDAA+C,SAAS;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA,kBAAiB,OAAO;AACxB;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA,+BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,gBAAgB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B;AAC3B,aAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe;AACf;AACA,4BAA2B;AAC3B,aAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,OAAO,mCAAmC,OAAO;AACrE;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA,8DAA6D;AAC7D;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAS;;;AAGT;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,YAAY;AAChC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC;AACA,oBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,iBAAiB;AACpC;AACA,oBAAmB,SAAS;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,gBAAgB;AACnC,oBAAmB,OAAO;AAC1B,oBAAmB,SAAS;AAC5B;AACA;AACA;AACA;AACA,uDAAsD;AACtD;AACA,sBAAqB,aAAa;AAClC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,gBAAgB;AACnC,oBAAmB,OAAO;AAC1B,oBAAmB,SAAS;AAC5B;AACA;AACA;AACA;AACA,sDAAqD;AACrD;AACA,sBAAqB,aAAa;AAClC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,QAAQ;AAC3B,qBAAoB;AACpB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA,qBAAoB;AACpB;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA,qBAAoB;AACpB;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO,eAAe;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,MAAM;AACzB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,MAAM;AACzB;AACA,2CAA0C;;AAE1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,MAAM;AACzB;AACA,0CAAyC;;AAEzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,MAAM;AACzB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAA+B;;AAE/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,qBAAoB;AACpB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAS;;;AAGT;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,cAAc;AACjC,oBAAmB,OAAO;AAC1B,qBAAoB,cAAc;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,cAAc;AACjC,oBAAmB,OAAO;AAC1B,qBAAoB,cAAc;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,cAAc;AACjC,oBAAmB,cAAc;AACjC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,cAAc;AACjC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,cAAc;AACjC,qBAAoB;AACpB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,6BAA6B;AAChD,qBAAoB,gBAAgB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,mDAAkD,QAAQ;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,gBAAgB;AACpC;AACA;AACA;;AAEA,mDAAkD,QAAQ;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,6BAA6B;AAChD,qBAAoB,gBAAgB;AACpC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,6BAA6B;AAChD,qBAAoB,cAAc;AAClC;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA,sDAAqD,iCAAiC;AACtF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,sDAAqD,iCAAiC;AACtF;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA,kDAAiD,+BAA+B;AAChF;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,cAAc;AACjC,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA,UAAS;;;AAGT;AACA;AACA;AACA,wDAAuD,cAAc;AACrE;AACA;AACA;AACA,oBAAmB,cAAc;AACjC,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,QAAQ;AAC3B;AACA;AACA,+CAA8C,QAAQ;AACtD;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,cAAc;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,cAAc;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,cAAc;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,cAAc;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA,4DAA2D,+BAA+B;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,UAAS;;AAET;AACA,oDAAmD,+BAA+B;AAClF;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,oDAAmD,+BAA+B;AAClF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,oDAAmD,+BAA+B;AAClF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,oDAAmD,+BAA+B;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,aAAa;AAC5B,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,iBAAgB,+CAA+C;AAC/D;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,UAAU;AAC7B,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,UAAU;AAC7B,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,mCAAmC;AACtD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,4BAA4B;AAC/C,oBAAmB,UAAU;AAC7B,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA4B;;AAE5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;;;AAGL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,gBAAgB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAiD,oBAAoB;AACrE;AACA;AACA;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,aAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,gBAAgB;AACnC,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAgB,4CAA4C;AAC5D,iBAAgB,4CAA4C;AAC5D,iBAAgB,4CAA4C;AAC5D,iBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAmC,0BAA0B;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,SAAS;AAC5B;AACA;AACA;AACA,eAAc,wEAAwE;AACtF;AACA,eAAc;AACd;AACA,eAAc,gEAAgE;AAC9E;AACA,eAAc,qDAAqD;AACnE,eAAc,oDAAoD;AAClE,eAAc,kDAAkD,kEAAkE;AAClI,eAAc,iDAAiD,2BAA2B;AAC1F;AACA,eAAc,oDAAoD;AAClE,eAAc,oDAAoD;AAClE;AACA,eAAc,2DAA2D;AACzE;AACA,eAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B,gBAAgB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,SAAS;AAC5B,oBAAmB,SAAS;AAC5B;AACA;AACA,4BAA2B,uDAAuD;AAClF;AACA;AACA;AACA;AACA;AACA;AACA,aAAY;AACZ;AACA,aAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,QAAQ;AAC5B,uCAAsC,uDAAuD;AAC7F;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAgC;AAChC;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,cAAc;AAC7B,gBAAe,gBAAgB;AAC/B,gBAAe,OAAO;AACtB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,cAAc;AACjC,oBAAmB,gBAAgB;AACnC,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA,wE;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,mCAAmC;AACtD,oBAAmB,OAAO;AAC1B,qBAAoB,OAAO;AAC3B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,4BAA2B,oBAAoB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,mCAAmC;AACtD,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,mCAAmC;AACtD,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,4BAA2B,oBAAoB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,cAAc,gDAAgD;AAC7E,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,mCAAmC;AACtD,oBAAmB,OAAO;AAC1B,qBAAoB,OAAO;AAC3B;AACA;AACA;;AAEA;;AAEA,4BAA2B,oBAAoB;AAC/C;AACA;AACA;AACA,qBAAoB;AACpB,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,mCAAmC;AACtD,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,4CAA2C;AAC3C,4BAA2B,oBAAoB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,qDAAoD,SAAS;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB;AACnB;AACA,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B,8BAA8B;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,QAAQ;AAC3B,oBAAmB,SAAS;AAC5B,oBAAmB,OAAO;AAC1B,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB,OAAO;AAC5B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,mBAAkB;AAClB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,mBAAkB;AAClB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,mBAAkB;AAClB;AACA;;AAEA;AACA;AACA;AACA,0CAAyC;AACzC,sFAAqF;AACrF,sEAAqE;AACrE,oEAAmE;AACnE,2DAA0D;AAC1D;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,QAAQ;AAC3B,oBAAmB,cAAc;AACjC,oBAAmB,OAAO;AAC1B,oBAAmB,QAAQ;AAC3B,oBAAmB,QAAQ;AAC3B,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY;AACZ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,6DAA4D;;AAE5D;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA,8CAA6C;AAC7C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,QAAQ;AAC3B,qBAAoB;AACpB;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,MAAK;;AAEL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,QAAQ;AACvB,gBAAe,QAAQ;AACvB,gBAAe,QAAQ;AACvB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,gDAA+C,OAAO;AACtD;AACA,4CAA2C;AAC3C,gDAA+C;AAC/C,gDAA+C;AAC/C;AACA;;AAEA;AACA;AACA;AACA,gDAA+C,OAAO;;AAEtD,8CAA6C;AAC7C,kDAAiD;AACjD,kDAAiD;AACjD;AACA;;AAEA;AACA;AACA;AACA,gDAA+C,OAAO;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA,wCAAuC;;AAEvC;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,QAAQ;AAC3B,qBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,UAAU;AAC7B,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA,4CAA2C;;AAE3C,MAAK;;AAEL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAsC;AACtC,0BAAyB;AACzB;AACA;AACA,wCAAuC;AACvC,0BAAyB;AACzB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,QAAQ;AACvB,gBAAe,QAAQ;AACvB,gBAAe,QAAQ;AACvB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,UAAU;AAC7B,oBAAmB,gBAAgB;AACnC,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,MAAM;AACzB,oBAAmB,OAAO;AAC1B,qBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,MAAM;AACzB,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,cAAc;AACjC,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,gBAAgB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,WAAW;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B,wBAAwB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,sCAAsC;AACzD;AACA;AACA;AACA;AACA,cAAa;AACb;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;;AAEA,MAAK;;AAEL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sGAAqG,wBAAwB;AAC7H;AACA;AACA,0BAAyB,+CAA+C;AACxE,oBAAmB,oCAAoC;AACvD,+BAA8B,kFAAkF;AAChH,8DAA6D,uDAAuD;AACpH;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO,+BAA+B;AACrD,gBAAe,MAAM;AACrB,gBAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,6EAA6E;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,uEAAsE,gBAAgB;AACtF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB;AACpB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO,+CAA+C,gBAAgB;AACzF,qBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB,gBAAgB;AACjC;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,kBAAkB;AACrC;AACA,oBAAmB,OAAO,+CAA+C,wBAAwB;AACjG,qBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B,kBAAkB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa,gBAAgB;AAC7B;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,aAAa;AAChC,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA,yCAAwC;AACxC,yCAAwC;AACxC;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA,8BAA6B;AAC7B;AACA,gCAA+B;AAC/B;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA,cAAa;AACb;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,aAAa;AAChC,oBAAmB,OAAO;AAC1B,oBAAmB,mDAAmD;AACtE,oBAAmB,OAAO,kDAAkD,2BAA2B;AACvG,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,aAAa;AACjC;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,MAAK;;AAEL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,QAAQ;AACvB,gBAAe,QAAQ;AACvB,gBAAe,QAAQ;AACvB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,4BAA4B;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B;AAC9B,kBAAiB;AACjB;AACA;AACA,gCAA+B;AAC/B,kBAAiB;AACjB,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,MAAM;AACzB,oBAAmB,OAAO;AAC1B,qBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B,wCAAwC;AACtE;AACA,kBAAiB;AACjB;AACA;AACA,gCAA+B;AAC/B,kBAAiB;AACjB,cAAa;;AAEb;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,aAAa;AAChC,oBAAmB,gBAAgB;AACnC,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,MAAM;AACzB,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,0BAA0B;AAC7C,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,QAAQ;AAC3B,qBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,gBAAgB;AACnC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,WAAW;AAC9B;AACA;AACA;AACA;AACA;;AAEA;AACA,8CAA6C,SAAS;AACtD;AACA;;AAEA;AACA,wBAAuB,SAAS;AAChC;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,sCAAsC;AACzD;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA,MAAK;;AAEL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sGAAqG,wBAAwB;AAC7H;AACA;AACA,0BAAyB,+CAA+C;AACxE,oBAAmB,oCAAoC;AACvD,+BAA8B,kFAAkF;AAChH,8DAA6D,8BAA8B;AAC3F;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO,+BAA+B;AACrD,gBAAe,MAAM;AACrB,gBAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,oCAAoC;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,aAAa;AAC5B,gBAAe,YAAY;AAC3B,gBAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,0CAAyC,+BAA+B,uBAAuB,qBAAqB,gBAAgB,oDAAoD,EAAE,YAAY;AACtM,0CAAyC,6CAA6C,oBAAoB,gBAAgB,qBAAqB,EAAE,YAAY;AAC7J;AACA,kBAAiB;AACjB;AACA;AACA;AACA,0CAAyC,+BAA+B,uBAAuB,sBAAsB,yBAAyB,uBAAuB,qBAAqB,oBAAoB,uBAAuB,qBAAqB,gBAAgB,mDAAmD,0CAA0C,kBAAkB,iBAAiB,EAAE,YAAY;AACxZ,0CAAyC,6CAA6C,kDAAkD,oBAAoB,uBAAuB,qBAAqB,gBAAgB,0BAA0B,eAAe,oDAAoD,EAAE,YAAY,oBAAoB,KAAK,gCAAgC,0DAA0D,GAAG,WAAW,2EAA2E,EAAE,YAAY;AAC7hB;AACA;AACA,kBAAiB;AACjB;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,4BAA2B,sBAAsB;AACjD;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,4BAA2B,iBAAiB;AAC5C;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,aAAa;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,0BAA0B;AAC7C,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,cAAc;AACjC,oBAAmB,QAAQ;AAC3B;AACA;AACA;;AAEA;AACA;AACA,4BAA2B,mBAAmB;AAC9C;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,eAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,iBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,iBAAgB,QAAQ;AACxB;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,aAAa;AAC5B,gBAAe,QAAQ;AACvB;AACA;AACA;AACA;;AAEA;AACA;AACA,4BAA2B;AAC3B;AACA;AACA,0BAAyB;AACzB;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,aAAa;AAC5B,gBAAe,OAAO;AACtB,gBAAe,QAAQ;AACvB,gBAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,aAAa;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAc;AACd;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAc;AACd;;AAEA;AACA;AACA;AACA;AACA,eAAc;AACd;;AAEA;AACA;AACA;AACA;AACA,eAAc;AACd;;AAEA;AACA;AACA;AACA;AACA,eAAc;AACd;;AAEA;AACA;AACA;AACA;AACA,eAAc;AACd;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAc;AACd;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,eAAc;AACd;AACA;AACA,oBAAmB,QAAQ,OAAO,mCAAmC;;AAErE;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,wBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mDAAkD;AAClD;AACA;AACA,wCAAuC;AACvC;AACA;AACA,mBAAkB;AAClB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA6D,0CAA0C;AACvG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,mD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA,uDAAsD,kCAAkC;;AAExF;AACA,+D;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sB;AACA,kB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA4D,OAAO;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,mBAAkB;AAClB;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAc;AACd;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,iBAAgB,YAAY;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,aAAa;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,sCAAsC;AACrD,gBAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,+BAA8B;AAC9B;AACA,cAAa;AACb;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA,gBAAe,OAAO,oEAAoE;AAC1F,gBAAe,sCAAsC;AACrD,gBAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,uCAAsC,IAAI,YAAY,IAAI;;AAE1D;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA,UAAS;AACT;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT,MAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,yBAAyB;AACxC,gBAAe,aAAa;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,4BAA2B;AAC3B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,yBAAyB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,SAAS;AACxB,gBAAe,SAAS;AACxB,gBAAe,SAAS;AACxB,gBAAe,sBAAsB;AACrC;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;;AAEA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB;AACrB;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,SAAS;AAC7B;AACA;AACA;;AAEA;AACA;;AAEA,kDAAiD,SAAS;AAC1D;AACA,oCAAmC,QAAQ;AAC3C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,SAAS;AAC7B,qBAAoB,OAAO;AAC3B,qBAAoB,SAAS;AAC7B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,OAAO;AAC3B,qBAAoB,SAAS;AAC7B;AACA;AACA;;AAEA;AACA,4BAA2B,oBAAoB;AAC/C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,OAAO;AAC3B,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,OAAO;AAC3B,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,aAAa;AAChC,qBAAoB,UAAU;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,aAAa;AAChC,qBAAoB,MAAM;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAgC,EAAE,aAAa,EAAE,aAAa,EAAE;;AAEhE;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,oBAAoB;AACnC,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,SAAS;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,SAAS;AAC7B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,gBAAgB;AACnC,qBAAoB,SAAS;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,SAAS;AAC5B,qBAAoB,SAAS;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,SAAS;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,SAAS;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,SAAS;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,SAAS;AAC5B,qBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,SAAS;AAC7B;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,SAAS;AAC7B;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,SAAS;AAC7B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B,kCAAkC,EAAE;AAC/D,iCAAgC,wDAAwD,EAAE;AAC1F;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B,kCAAkC,EAAE;AAC/D,iCAAgC,wDAAwD,EAAE;AAC1F;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B,kCAAkC,EAAE;AAC/D,iCAAgC,wDAAwD,EAAE;AAC1F;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B,wBAAwB,EAAE;AACrD,iCAAgC,8EAA8E,EAAE;AAChH;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,uBAAuB;AAC3C;AACA;AACA,uCAAsC;AACtC,0CAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,mBAAmB,EAAE;AACzC,iCAAgC,qCAAqC,QAAQ,GAAG;AAChF;AACA;AACA;AACA;AACA,4CAA2C;AAC3C,sDAAqD;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA,wBAAuB,OAAO;AAC9B;AACA;AACA,6BAA4B,uBAAuB;AACnD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB;AACzB,sBAAqB;;AAErB;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA,wBAAuB,OAAO;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,gCAA+B,2BAA2B;AAC1D;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,uCAAsC,mBAAmB;AACzD;AACA;AACA;AACA;AACA,0BAAyB;AACzB;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,gCAA+B,2BAA2B;AAC1D;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB;AACzB;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,oCAAoC;AACxD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,4BAA2B,cAAc;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,4BAA2B,mBAAmB;AAC9C;AACA;AACA;;AAEA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,cAAc;;AAE7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO,iBAAiB;AAC3C,qBAAoB,cAAc;AAClC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB,kBAAiB;AACjB;AACA;AACA;;AAEA,cAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAS;AACT,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB;AACpB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB;AACpB;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,qBAAoB,cAAc;AAClC;AACA;AACA;;AAEA;AACA;;AAEA;AACA,wDAAuD,SAAS;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAS,eAAe;AACxB,UAAS,eAAe;AACxB,UAAS,eAAe;AACxB,UAAS,eAAe;AACxB;AACA;AACA,UAAS,eAAe;AACxB,UAAS,eAAe;AACxB,UAAS,eAAe;AACxB,UAAS,eAAe;AACxB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;;AAGL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,kCAAiC,WAAW;AAC5C,sCAAqC,WAAW;AAChD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;;;AAGL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,qCAAoC,iCAAiC;AACrE;AACA,yCAAwC,eAAe;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;;;AAGL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,4CAA2C;AAC3C;AACA;AACA,mBAAkB;AAClB;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,4BAA2B,OAAO;AAClC;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,kCAAiC,WAAW;AAC5C,sCAAqC,WAAW;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,gBAAgB;AAC/B,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,aAAa,sCAAsC;AAClE,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,mBAAmB;AAClC,gBAAe,mBAAmB,+CAA+C;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,2CAA0C,WAAW;AACrD;AACA;AACA,gDAA+C,gBAAgB;AAC/D;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB,WAAW;AACpC,0BAAyB,WAAW;AACpC,0BAAyB,WAAW;AACpC;AACA;AACA,oDAAmD,gBAAgB;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,oCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;;AAEA,kCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,mBAAmB;AAClC,gBAAe,OAAO;AACtB;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,4BAA2B,0BAA0B;AACrD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;;AAEA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA,gCAA+B,oBAAoB;AACnD;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,UAAS;;;AAGT;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B,OAAO;AAClC;AACA,gCAA+B,OAAO;AACtC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAA+B,kCAAkC;AACjE;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB,gBAAgB;AACxC,4BAA2B,gBAAgB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,UAAS;;AAET;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa;AACb;AACA,UAAS;;;AAGT;AACA;AACA;AACA;AACA;AACA,oBAAmB,aAAa;AAChC,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,QAAQ;AAC3B;AACA,qBAAoB,gBAAgB;AACpC;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,4BAA2B,8BAA8B;AACzD;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,gCAA+B,0BAA0B;AACzD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,cAAc;AAClC;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,aAAa;AAChC,oBAAmB,QAAQ;AAC3B,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,aAAa;AAChC,oBAAmB,SAAS;AAC5B,oBAAmB,QAAQ;AAC3B,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA,iBAAgB,oEAAoE;AACpF,iBAAgB,oEAAoE;AACpF,iBAAgB,oEAAoE;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa,eAAe;;AAE5B;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,aAAa;AAChC,oBAAmB,SAAS;AAC5B,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,aAAa;AAChC,oBAAmB,SAAS;AAC5B,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,aAAa;AAChC,oBAAmB,SAAS;AAC5B,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB;AACA;AACA,+CAA8C,OAAO;AACrD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA,qDAAoD;AACpD;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,QAAQ;AAC3B;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,gBAAgB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,uBAAuB;AAC1C;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,SAAS;AAC5B;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,SAAS;AAC5B;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,SAAS;AAC5B;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,SAAS;AAC5B;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA,kBAAiB;;AAEjB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA,kBAAiB;AACjB;AACA;;AAEA;;AAEA;;AAEA;;AAEA,+EAA8E,sBAAsB;;AAEpG;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA,UAAS;;AAET;AACA;AACA;;AAEA;;AAEA,cAAa;AACb;AACA;;AAEA;;AAEA,cAAa;AACb;AACA;;AAEA;AACA;;AAEA;;AAEA,UAAS;;AAET;AACA;AACA;;AAEA;;AAEA,cAAa;AACb;AACA;;AAEA;;AAEA,cAAa;AACb;AACA;;AAEA;AACA;;AAEA;;AAEA,UAAS;;AAET;AACA;AACA;;AAEA;;AAEA,cAAa;AACb;AACA;;AAEA;;AAEA,cAAa;AACb;AACA;;AAEA;AACA;;AAEA;;AAEA,UAAS;;AAET;AACA;AACA;;AAEA;;AAEA,cAAa;AACb;AACA;;AAEA;;AAEA,cAAa;AACb;AACA;;AAEA;AACA;;AAEA;;AAEA,UAAS;;AAET;AACA;AACA;;AAEA;;AAEA,cAAa;AACb;AACA;;AAEA;;AAEA,cAAa;AACb;AACA;;AAEA;;AAEA;;AAEA,UAAS;;AAET;AACA;AACA;;AAEA;;AAEA,cAAa;AACb;AACA;;AAEA;;AAEA,cAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,UAAS;;AAET;AACA;AACA;;AAEA;;AAEA,cAAa;AACb;AACA;;AAEA;;AAEA,cAAa;AACb;AACA;;AAEA;AACA;;AAEA;;AAEA,UAAS;;AAET;AACA;AACA;;AAEA;AACA;AACA;AACA,qCAAoC,OAAO,WAAW;AACtD;AACA;;AAEA,cAAa;AACb;AACA;;AAEA;AACA;AACA;AACA,qCAAoC,OAAO,WAAW;AACtD;AACA;;AAEA,cAAa;AACb;AACA;;AAEA;AACA;AACA;AACA,qCAAoC,OAAO,WAAW;AACtD;AACA;AACA;;AAEA;;AAEA,UAAS;;AAET;AACA;AACA;;AAEA;AACA;;AAEA,cAAa;AACb;AACA;;AAEA;AACA;;AAEA,cAAa;AACb;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,UAAS;;AAET;AACA;AACA;;AAEA;;AAEA,cAAa;AACb;AACA;;AAEA;;AAEA;;AAEA,kBAAiB;;AAEjB;;AAEA,kBAAiB;;AAEjB;;AAEA,kBAAiB;;AAEjB;;AAEA;;AAEA,cAAa;AACb;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA,UAAS;AACT;AACA;;AAEA;;AAEA,yBAAwB,QAAQ;AAChC;AACA;;AAEA;;AAEA,UAAS;AACT;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,cAAa;;AAEb;AACA;;AAEA;;AAEA;;AAEA,UAAS;;AAET;AACA;AACA;;AAEA;;AAEA,cAAa;AACb;AACA;;AAEA;AACA;;AAEA,cAAa;AACb;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA,iCAAgC,OAAO;AACvC;;AAEA;;AAEA,cAAa;AACb;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA0B,OAAO;AACjC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA0B,OAAO;AACjC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA0B,OAAO;AACjC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA0B,OAAO,YAAY,SAAS;AACtD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA0B,OAAO,uBAAuB,OAAO;AAC/D,aAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA0D;AAC1D,sDAAqD;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY;AACZ;AACA;;AAEA;AACA;AACA,2BAA0B,OAAO,uBAAuB,OAAO;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY;AACZ;AACA;;AAEA;AACA;AACA,2BAA0B,OAAO;AACjC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA0B,OAAO;AACjC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA0B,OAAO;AACjC,2BAA0B,OAAO;AACjC,2BAA0B,OAAO;AACjC,2BAA0B,OAAO;AACjC,2BAA0B,QAAQ;AAClC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA0B,OAAO;AACjC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAY,OAAO;AACnB,aAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAY,OAAO;AACnB,aAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA0B,MAAM;AAChC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,2BAA0B,OAAO;AACjC,2BAA0B,OAAO;AACjC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA0B,MAAM;AAChC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA0B,MAAM;AAChC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA0B,YAAY;AACtC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,MAAM;AACzB;AACA;AACA;AACA,6CAA4C;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,qDAAoD;AACpD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,SAAS;AAC5B;AACA;AACA,qBAAoB,OAAO;AAC3B;AACA;AACA,mEAAkE,eAAe,EAAE;AACnF;;AAEA;AACA;AACA;AACA;AACA;AACA,0CAAyC;AACzC;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,aAAa;AAChC;AACA,oBAAmB,SAAS;AAC5B;AACA,0EAAyE;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA,iBAAgB,MAAM;AACtB,iBAAgB,aAAa;AAC7B;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,sBAAqB,sBAAsB;AAC3C;AACA;AACA;;AAEA;AACA,0BAAyB,cAAc;AACvC;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA,iBAAgB,QAAQ;AACxB;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,oBAAmB,sBAAsB;AACzC;AACA;AACA;;AAEA;AACA,wBAAuB,cAAc;AACrC;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA,iBAAgB;AAChB;AACA;AACA;;AAEA,uCAAsC,MAAM;AAC5C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA,iBAAgB,OAAO;AACvB,iBAAgB;AAChB;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA,iBAAgB;AAChB;AACA;AACA;AACA;AACA,wDAAuD;AACvD;;AAEA;AACA,2EAA0E;AAC1E;AACA,kDAAiD;AACjD,iDAAgD;AAChD,iDAAgD;AAChD,iDAAgD;AAChD,oDAAmD,uCAAuC,uCAAuC;AACjI,oDAAmD,uCAAuC,uCAAuC;AACjI,mDAAkD;AAClD,mDAAkD;AAClD;;AAEA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAS;AACT;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,oBAAmB,sBAAsB;AACzC;AACA,wBAAuB,iCAAiC;AACxD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAS;AACT,QAAO;;AAEP;AACA,MAAK;;AAEL;AACA;AACA,iBAAgB;AAChB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,UAAS;AACT,QAAO;AACP;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,cAAa,OAAO;AACpB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAgB,OAAO;AACvB,iBAAgB;AAChB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,iCAAgC,YAAY;AAC5C,qCAAoC,cAAc;AAClD,mCAAkC,aAAa;AAC/C,6CAA4C,kBAAkB;AAC9D,qCAAoC,cAAc;AAClD,mCAAkC,aAAa;AAC/C,mCAAkC,aAAa;;AAE/C;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA,iBAAgB;AAChB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,oBAAmB,oBAAoB;AACvC;;AAEA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,mCAAkC,KAAK;AACvC;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA,iBAAgB,cAAc;AAC9B,iBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;AACA,sBAAqB,uBAAuB;AAC5C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAS;AACT;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAW;AACX;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa;AACb;AACA;;AAEA;AACA;AACA,UAAS;AACT;AACA;;AAEA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;;AAEA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA,iBAAgB,OAAO;AACvB,iBAAgB;AAChB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;;AAEA;AACA;;AAEA,oBAAmB,cAAc;AACjC;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,gBAAe;AACf;AACA;;AAEA;AACA;AACA,cAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA,iBAAgB,OAAO;AACvB,iBAAgB;AAChB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;;AAEA;AACA;;AAEA;AACA;;AAEA,oBAAmB,cAAc;AACjC;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,gBAAe;AACf;AACA;;AAEA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA,iBAAgB,QAAQ;AACxB,iBAAgB,OAAO;AACvB,iBAAgB;AAChB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;;AAEA;AACA;;AAEA,oBAAmB,cAAc;AACjC;AACA;;AAEA;AACA;;AAEA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,YAAY;AAC5B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,QAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;;AAEX;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,aAAa;AAClC;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA,iBAAgB,OAAO;AACvB,iBAAgB,OAAO;AACvB,iBAAgB,OAAO;AACvB,iBAAgB,OAAO;AACvB,iBAAgB;AAChB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;;AAEA;AACA;;AAEA;AACA;AACA,oBAAmB,cAAc;AACjC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe;AACf,cAAa;AACb,YAAW;AACX;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe;AACf,cAAa;AACb;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA;AACA,iBAAgB,OAAO;AACvB,iBAAgB;AAChB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,aAAa;AAC7B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;;AAEA;AACA;AACA,oBAAmB,cAAc;AACjC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,YAAY;AAC5B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,QAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;;AAEX;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,aAAa;AAClC;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,cAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,YAAY;AAC5B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA,iBAAgB,OAAO;AACvB,iBAAgB,QAAQ;AACxB;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA,iBAAgB,OAAO;AACvB;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,oBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA,iBAAgB,OAAO;AACvB,iBAAgB,SAAS;AACzB,iBAAgB,OAAO;AACvB,iBAAgB,OAAO;AACvB,iBAAgB;AAChB;AACA;AACA;AACA;;AAEA;AACA,6BAA4B,2BAA2B,IAAI,eAAe;AAC1E;;AAEA;AACA,MAAK;;AAEL;AACA;AACA,iBAAgB,OAAO;AACvB,iBAAgB,SAAS;AACzB,iBAAgB,OAAO;AACvB,iBAAgB;AAChB;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,iBAAiB;AACtC;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,QAAO;AACP;AACA;AACA,sBAAqB,eAAe;AACpC;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA,iBAAgB,OAAO;AACvB,iBAAgB,SAAS;AACzB,iBAAgB,OAAO;AACvB,iBAAgB;AAChB;AACA;AACA;;AAEA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA,iBAAgB,OAAO;AACvB,iBAAgB,OAAO;AACvB,iBAAgB,OAAO;AACvB,iBAAgB;AAChB;AACA;AACA;AACA;;AAEA;AACA,oBAAmB,iBAAiB;AACpC;AACA;AACA;AACA,YAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA,iBAAgB,MAAM;AACtB,iBAAgB;AAChB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA,iBAAgB,OAAO;AACvB,iBAAgB;AAChB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA,iBAAgB,OAAO;AACvB,iBAAgB,OAAO;AACvB;AACA;AACA;;AAEA;AACA,oBAAmB,uBAAuB;AAC1C;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA,iBAAgB,MAAM;AACtB;AACA;AACA;;AAEA;;AAEA;AACA,oBAAmB,uBAAuB;AAC1C;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,gBAAe,uBAAuB;AACtC;AACA;AACA;AACA;;AAEA;AACA,sCAAqC,MAAM;AAC3C;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA,iBAAgB,OAAO;AACvB,iBAAgB,MAAM;AACtB;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,uBAAuB;AAC5C;AACA;;AAEA;AACA,QAAO;AACP;AACA;AACA,MAAK;;AAEL;AACA;AACA,iBAAgB,MAAM;AACtB,iBAAgB;AAChB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,cAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA,iBAAgB;AAChB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA,iBAAgB;AAChB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,2BAA0B;AAC1B;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,iBAAgB,KAAK;AACrB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,qBAAoB,GAAG;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB,eAAe;AACpC;AACA;;AAEA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,iBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;;AAEA;AACA;AACA,iBAAgB,YAAY;AAC5B,iBAAgB,KAAK;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,QAAO;AACP;;AAEA;AACA;AACA,iBAAgB,KAAK;AACrB,iBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,yBAAwB;AACxB;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,QAAO;AACP;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,QAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,SAAS;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB,kBAAiB;AACjB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,eAAe;AAClC,oBAAmB,OAAO;AAC1B,qBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW,OAAO;AAClB,YAAW,OAAO;AAClB,YAAW,OAAO,kCAAkC,gBAAgB;AACpE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA,gEAA+D;AAC/D;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW,OAAO;AAClB,YAAW,OAAO;AAClB,YAAW,OAAO,kCAAkC,gBAAgB;AACpE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,SAAS;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA,6BAA4B;;AAE5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAW,OAAO;AAClB,YAAW,OAAO;AAClB,YAAW,OAAO,eAAe;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAW,OAAO;AAClB,YAAW,OAAO;AAClB,YAAW,OAAO,eAAe;AACjC,YAAW,OAAO;AAClB,YAAW,gBAAgB;AAC3B,YAAW,OAAO;AAClB,YAAW,oBAAoB,6CAA6C;AAC5E,YAAW,SAAS,iDAAiD;AACrE,YAAW,QAAQ,wEAAwE;AAC3F,YAAW,QAAQ,2EAA2E;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB,gBAAe,OAAO;AACtB,gBAAe,OAAO,2EAA2E;AACjG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,qCAAoC,6BAA6B,EAAE;AACnE,0CAAyC,8BAA8B,EAAE;AACzE;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAmC,gCAAgC,EAAE;AACrE,yCAAwC,iCAAiC,EAAE;AAC3E;AACA;AACA,cAAa;;AAEb;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA,UAAS;;AAET;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA,oBAAmB,OAAO,wDAAwD;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA,4BAA2B,aAAa;AACxC;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA,sBAAqB,QAAQ;AAC7B;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,mBAAmB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,mDAAkD,QAAQ;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,mBAAmB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA,8DAA6D;AAC7D;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;;;AAGL;AACA;AACA;AACA,EAAC;;;;;;;;ACxr1BD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;;AAET;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA,cAAa;;AAEb;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;;AAEA;AACA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iEAAgE,oCAAoC;AACpG;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;AACb,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;;AAGT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAA+B,uBAAuB;AACtD;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,EAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC/eD,OAAM,CAAC,IAAI,GAAG;;;;;;;AAMV,WAAM,oBAAG;;;AAGL,aAAI,CAAC,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,EAAE,EAAC,OAAO,EAAG,QAAQ,EAAE,KAAK,EAAG,MAAM,EAAE,WAAW,EAAG,MAAM,EAAC,CAAC,EAAE;AACtF,kBAAK,CAAC,6CAA6C,CAAC,CAAC;AACrD,oBAAO;UACV;;;AAGD,WAAE,CAAC,KAAK,CAAC,YAAY,GAAG,IAAI;;;AAG5B,aAAI,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,KAAK,IAAI,EAAE;AAC7B,mBAAM,CAAC,OAAO,CAAC,YAAY;AACvB,mBAAE,CAAC,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,EAAE,EAAE,CAAC,KAAK,CAAC,KAAK,EAAE,OAAO,EAAE,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;cAC3E,CAAC,CAAC;UACN;;;AAGD,WAAE,CAAC,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC;;;AAGzC,WAAE,CAAC,MAAM,CAAC,OAAO,qBAAW;;;AAG5B,WAAE,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;MACrC;;;;;AAKD,WAAM,oBAAG;;;AAGL,aAAI,CAAC,UAAU,GAAG,oBAAgB,CAAC;AACnC,WAAE,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,CAAC,UAAU,CAAC;;;AAG5C,WAAE,CAAC,KAAK,CAAC,UAAU,CAAC,MAAM,EAAE,SAAS,EAAE,GAAG,CAAC;;;AAG3C,aAAI,IAAI,GAAG,mBAAe,CAAC,EAAE,CAAC,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC;AACzC,aAAI,CAAC,YAAY,GAAG,IAAI,CAAC;AACzB,WAAE,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;;AAE7B,aAAI,IAAI,GAAG,mBAAe,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC;AAC/C,aAAI,CAAC,YAAY,GAAG,IAAI,CAAC;AACzB,WAAE,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC;;;AAG5B,WAAE,CAAC,KAAK,CAAC,oBAAoB,CAAC,aAAa,EAAE,EAAE,CAAC,IAAI,CAAC,QAAQ,EAAE,UAAU,KAAK,EAAE;AAC5E,eAAE,CAAC,KAAK,CAAC,OAAO,CAAC,aAAa,EAAE,CAAE,KAAK,CAAE,CAAC,CAAC;UAC9C,EAAE,KAAK,CAAC;;;AAGT,WAAE,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;MAClC;EACJ,C;;;;;;;;;;;mBCvEc;;;;;;AAMX,GAAE,IAAI,EAAE,yCAAyC,EAAG,IAAI,EAAC,OAAO,EAAE,GAAG,EAAE,sDAAsD,EAAE;;;;;;;AAO/H,GAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,kBAAkB,EAAE,CAiBxD,C;;;;;;;;;;;mBC9Bc,EAAE,CAAC,YAAY,CAAC,MAAM,CAAC;;;;;AAIlC,eAAY,0BAAG;;AAEX,OAAE,CAAC,aAAa,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;IACrC;;;;;AAKD,iBAAc,4BAAG,EAChB;EACJ,CAAC,C;;;;;;;;;;;;;;;;mBCTa,EAAE,CAAC,UAAU,CAAC,MAAM,CAAC;AAChC,SAAI,gBAAC,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,MAAM,EAAE;AACtB,aAAM,IAAI,GAAG,IAAI,CAAC;AAClB,aAAI,CAAC,IAAI,GAAG,KAAK,CAAC;AAClB,aAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;AACnB,aAAI,CAAC,IAAI,GAAG,IAAI,EAAE,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,QAAQ,EAAE,OAAO,CAAC;;;AAG1D,aAAI,CAAC,MAAM,CAAC,EAAE,CAAC,UAAU,EAAE,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,MAAM,CAAC,CAAC,CAAC;AAC1D,aAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;;AAErB,aAAI,CAAC,WAAW,GAAG,EAAE,CAAC,KAAK,CAAC,SAAS,CAAC,aAAa,EAAE,UAAU,KAAK,EAAE;AAClE,iBAAI,CAAC,IAAI,GAAG,KAAK;;AAEjB,iBAAI,EAAE,CAAC,aAAa,CAAC,iBAAiB,EAAE,EAAE;AACtC,qBAAM,KAAK,GAAG,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;AACxD,qBAAM,IAAI,GAAG,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,UAAU,EAAE,KAAK,CAAC,UAAU,CAAC,CAAC;AAC/D,qBAAI,IAAI,EAAE;AACN,yBAAI,CAAC,IAAI,GAAG,IAAI,CAAC,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC;kBACzC;cACJ;UACJ,CAAC,CAAC;MACN;AAED,SAAI,gBAAC,QAAQ,EAAE;AACX,iBAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;AAC3B,iBAAQ,CAAC,QAAQ,CACb,IAAI,CAAC,IAAI,EAAG,IAAI,CAAC,GAAG,EACpB,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,MAAM,CAC1B,CAAC;AACF,aAAI,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;MAC/D;AAED,WAAM,oBAAG;AACL,gBAAO,IAAI,CAAC;MACf;EACJ,CAAC,C;;;;;;;;;;;mBCzCa,EAAE,CAAC,UAAU,CAAC,MAAM,CAAC;AAChC,SAAI,gBAAC,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,MAAM,EAAE;AACtB,aAAM,IAAI,GAAG,IAAI,CAAC;AAClB,aAAI,CAAC,IAAI,GAAG,MAAM,CAAC;AACnB,aAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;AACnB,aAAI,CAAC,IAAI,GAAG,IAAI,EAAE,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;AAC3D,aAAI,CAAC,GAAG,GAAG,CAAC,CAAC;AACb,aAAI,CAAC,GAAG,GAAG,CAAC;;;AAGZ,aAAI,CAAC,MAAM,CAAC,EAAE,CAAC,UAAU,EAAE,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,MAAM,CAAC,CAAC,CAAC;AAC1D,aAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;;AAErB,aAAI,CAAC,WAAW,GAAG,EAAE,CAAC,KAAK,CAAC,SAAS,CAAC,aAAa,EAAE,UAAU,KAAK,EAAE;;AAElE,iBAAI,EAAE,CAAC,aAAa,CAAC,iBAAiB,EAAE,EAAE;AACtC,qBAAM,KAAK,GAAG,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;AACxD,qBAAM,IAAI,GAAG,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,UAAU,EAAE,KAAK,CAAC,UAAU,CAAC,CAAC;AAC/D,qBAAI,IAAI,EAAE;AACN,yBAAI,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC;kBACpC;cACJ;UACJ,CAAC,CAAC;MACN;AAED,YAAO,mBAAC,GAAG,EAAE,GAAG,EAAE;AACd,aAAI,CAAC,GAAG,GAAG,GAAG,CAAC;AACf,aAAI,CAAC,GAAG,GAAG,GAAG,CAAC;;AAEf,aAAM,GAAG,GAAG,IAAI,CAAC,GAAG,GAAG,CAAC,IAAI,CAAC,CAAC;AAC9B,aAAI,CAAC,GAAG,CAAC,CAAC,GAAI,IAAI,CAAC,GAAG,GAAG,EAAE,GAAI,GAAG,GAAI,IAAI,CAAC,GAAG,GAAG,CAAC,GAAG,EAAG,CAAC;AACzD,aAAI,CAAC,GAAG,CAAC,CAAC,GAAI,IAAI,CAAC,GAAG,GAAG,EAAG,CAAC;MAChC;AAED,SAAI,gBAAC,QAAQ,EAAE;AACX,iBAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;AAC3B,iBAAQ,CAAC,QAAQ,CACb,IAAI,CAAC,IAAI,EAAG,IAAI,CAAC,GAAG,EACpB,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,MAAM,CAC1B,CAAC;AACF,aAAI,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;MAC/D;AAED,WAAM,oBAAG;AACL,gBAAO,IAAI,CAAC;MACf;EACJ,CAAC,C","file":"build/bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap d3a8829f6f7258123e87\n **/","/**\n * melonJS Game Engine v3.0.0\n * http://www.melonjs.org\n * @license {@link http://www.opensource.org/licenses/mit-license.php|MIT}\n * @copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n */\n\n/**\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n */\n\n(function () {\n\n    /**\n     * The built in window Object\n     * @external window\n     * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/Window.window|window}\n     */\n\n    /**\n     * (<b>m</b>)elonJS (<b>e</b>)ngine : All melonJS functions are defined inside\n     * of this namespace.\n     * <p>You generally should not add new properties to this namespace as it may be\n     * overwritten in future versions.</p>\n     * @name me\n     * @namespace\n     */\n    window.me = window.me || {};\n\n    /*\n     * DOM loading stuff\n     */\n    var readyBound = false, isReady = false, readyList = [];\n\n    // Handle when the DOM is ready\n    function domReady() {\n        // Make sure that the DOM is not already loaded\n        if (!isReady) {\n            // be sure document.body is there\n            if (!document.body) {\n                return setTimeout(domReady, 13);\n            }\n\n            // clean up loading event\n            if (document.removeEventListener) {\n                document.removeEventListener(\n                    \"DOMContentLoaded\",\n                    domReady,\n                    false\n                );\n            }\n            else {\n                window.removeEventListener(\"load\", domReady, false);\n            }\n\n            // Remember that the DOM is ready\n            isReady = true;\n\n            // execute the defined callback\n            for (var fn = 0; fn < readyList.length; fn++) {\n                readyList[fn].call(window, []);\n            }\n            readyList.length = 0;\n\n            /*\n             * Add support for AMD (Asynchronous Module Definition) libraries\n             * such as require.js.\n             */\n            if (typeof define === \"function\" && define.amd) {\n                define(\"me\", [], function () {\n                    return me;\n                });\n            }\n        }\n    }\n\n    // bind ready\n    function bindReady() {\n        if (readyBound) {\n            return;\n        }\n        readyBound = true;\n\n        // directly call domReady if document is already \"ready\"\n        if (document.readyState === \"complete\") {\n            return domReady();\n        }\n        else {\n            if (document.addEventListener) {\n                // Use the handy event callback\n                document.addEventListener(\"DOMContentLoaded\", domReady, false);\n            }\n            // A fallback to window.onload, that will always work\n            window.addEventListener(\"load\", domReady, false);\n        }\n    }\n\n    /**\n     * Specify a function to execute when the DOM is fully loaded\n     * @memberOf external:window#\n     * @alias onReady\n     * @param {Function} handler A function to execute after the DOM is ready.\n     * @example\n     * // small main skeleton\n     * var game = {\n     *    // Initialize the game\n     *    // called by the window.onReady function\n     *    onload : function () {\n     *       // init video\n     *       if (!me.video.init('screen', 640, 480, true)) {\n     *          alert(\"Sorry but your browser does not support html 5 canvas.\");\n     *          return;\n     *       }\n     *\n     *       // initialize the \"audio\"\n     *       me.audio.init(\"mp3,ogg\");\n     *\n     *       // set callback for ressources loaded event\n     *       me.loader.onload = this.loaded.bind(this);\n     *\n     *       // set all ressources to be loaded\n     *       me.loader.preload(game.resources);\n     *\n     *       // load everything & display a loading screen\n     *       me.state.change(me.state.LOADING);\n     *    },\n     *\n     *    // callback when everything is loaded\n     *    loaded : function () {\n     *       // define stuff\n     *       // ....\n     *\n     *       // change to the menu screen\n     *       me.state.change(me.state.MENU);\n     *    }\n     * }; // game\n     *\n     * // \"bootstrap\"\n     * window.onReady(function () {\n     *    game.onload();\n     * });\n     */\n    window.onReady = function (fn) {\n        // Attach the listeners\n        bindReady();\n\n        // If the DOM is already ready\n        if (isReady) {\n            // Execute the function immediately\n            fn.call(window, []);\n        }\n        else {\n            // Add the function to the wait list\n            readyList.push(function () {\n                return fn.call(window, []);\n            });\n        }\n        return this;\n    };\n\n    // call the library init function when ready\n    // (this should not be here?)\n    if (me.skipAutoInit !== true) {\n        window.onReady(function () {\n            me.boot();\n        });\n    }\n    else {\n        me.init = function () {\n            me.boot();\n            domReady();\n        };\n    }\n\n    if (!window.throttle) {\n        /**\n         * a simple throttle function\n         * use same fct signature as the one in prototype\n         * in case it's already defined before\n         * @ignore\n         */\n        window.throttle = function (delay, no_trailing, callback) {\n            var last = window.performance.now(), deferTimer;\n            // `no_trailing` defaults to false.\n            if (typeof no_trailing !== \"boolean\") {\n                no_trailing = false;\n            }\n            return function () {\n                var now = window.performance.now();\n                var elasped = now - last;\n                var args = arguments;\n                if (elasped < delay) {\n                    if (no_trailing === false) {\n                        // hold on to it\n                        clearTimeout(deferTimer);\n                        deferTimer = setTimeout(function () {\n                            last = now;\n                            return callback.apply(null, args);\n                        }, elasped);\n                    }\n                }\n                else {\n                    last = now;\n                    return callback.apply(null, args);\n                }\n            };\n        };\n    }\n\n    if (typeof console === \"undefined\") {\n        /**\n         * Dummy console.log to avoid crash\n         * in case the browser does not support it\n         * @ignore\n         */\n        console = { // jshint ignore:line\n            log : function () {},\n            info : function () {},\n            error : function () {\n                alert(Array.prototype.slice.call(arguments).join(\", \"));\n            }\n        };\n    }\n\n})();\n\n/**\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n */\n\n/**\n * The built in Function Object\n * @external Function\n * @see {@link https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function|Function}\n */\nif (!Function.prototype.bind) {\n    /** @ignore */\n    var Empty = function () {};\n\n    /**\n     * Binds this function to the given context by wrapping it in another function and returning the wrapper.<p>\n     * Whenever the resulting \"bound\" function is called, it will call the original ensuring that this is set to context. <p>\n     * Also optionally curries arguments for the function.\n     * @memberof! external:Function#\n     * @alias bind\n     * @param {Object} context the object to bind to.\n     * @param {} [arguments...] Optional additional arguments to curry for the function.\n     * @see {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind|Function.bind}\n     * @example\n     * // Ensure that our callback is triggered with the right object context (this):\n     * myObject.onComplete(this.callback.bind(this));\n     */\n    Function.prototype.bind = function bind(that) {\n        // ECMAScript 5 compliant implementation\n        // http://es5.github.com/#x15.3.4.5\n        // from https://github.com/kriskowal/es5-shim\n        var target = this;\n        if (typeof target !== \"function\") {\n            throw new TypeError(\"Function.prototype.bind called on incompatible \" + target);\n        }\n        var args = Array.prototype.slice.call(arguments, 1);\n        var bound = function () {\n            if (this instanceof bound) {\n                var result = target.apply(this, args.concat(Array.prototype.slice.call(arguments)));\n                if (Object(result) === result) {\n                    return result;\n                }\n                return this;\n            }\n            else {\n                return target.apply(that, args.concat(Array.prototype.slice.call(arguments)));\n            }\n        };\n        if (target.prototype) {\n            Empty.prototype = target.prototype;\n            bound.prototype = new Empty();\n            Empty.prototype = null;\n        }\n        return bound;\n    };\n}\n\n/**\n * Executes a function as soon as the interpreter is idle (stack empty).\n * @memberof! external:Function#\n * @alias defer\n * @param {Object} context The execution context of the deferred function.\n * @param {} [arguments...] Optional additional arguments to carry for the\n * function.\n * @return {Number} id that can be used to clear the deferred function using\n * clearTimeout\n * @example\n * // execute myFunc() when the stack is empty,\n * // with the current context and 'myArgument' as parameter\n * myFunc.defer(this, 'myArgument');\n */\nFunction.prototype.defer = function () {\n    return setTimeout(this.bind.apply(this, arguments), 0.01);\n};\n\n/**\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n */\n\n/**\n * The built in Object object.\n * @external Object\n * @see {@link https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object|Object}\n */\n\nif (!Object.defineProperty) {\n    /**\n     * simple defineProperty function definition (if not supported by the browser)<br>\n     * if defineProperty is redefined, internally use __defineGetter__/__defineSetter__ as fallback\n     * @param {Object} obj The object on which to define the property.\n     * @param {string} prop The name of the property to be defined or modified.\n     * @param {Object} desc The descriptor for the property being defined or modified.\n     * @see {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty|Object.defineProperty}\n     */\n    Object.defineProperty = function (obj, prop, desc) {\n        // check if Object support __defineGetter function\n        if (obj.__defineGetter__) {\n            if (desc.get) {\n                obj.__defineGetter__(prop, desc.get);\n            }\n            if (desc.set) {\n                obj.__defineSetter__(prop, desc.set);\n            }\n        } else {\n            // we should never reach this point....\n            throw new TypeError(\"Object.defineProperty not supported\");\n        }\n    };\n}\n\nif (!Object.create) {\n    /**\n     * Prototypal Inheritance Create Helper\n     * @name create\n     * @memberOf external:Object#\n     * @function\n     * @param {Object} Object\n     * @see {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/create|Object.create}\n     * @example\n     * // declare oldObject\n     * oldObject = new Object();\n     * // make some crazy stuff with oldObject (adding functions, etc...)\n     * // ...\n     *\n     * // make newObject inherits from oldObject\n     * newObject = Object.create(oldObject);\n     */\n    Object.create = function (o) {\n        var Fn = function () {};\n        Fn.prototype = o;\n        return new Fn();\n    };\n}\n\nif (!Object.is) {\n    /**\n     * The Object.is() method determines whether two values are the same value.\n     * @name is\n     * @memberOf external:Object#\n     * @function\n     * @param {Object} a The first value to compare\n     * @param {Object} b The second value to compare\n     * @return {Boolean}\n     * @see {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is|Object.is}\n     * @example\n     * // Strings are equal\n     * var s = \"foo\";\n     * Object.is(s, \"foo\"); //> true\n     *\n     * // 0 and -0 are not equal\n     * Object.is(0, -0); //>false\n     *\n     * // NaN and NaN are equal\n     * Object.is(NaN, NaN); //> true\n     *\n     * // Two object references are not equal\n     * Object.is({}, {}); //> false\n     *\n     * // Two vars referencing one object are equal\n     * var a = {}, b = a;\n     * Object.is(a, b); //> true\n     */\n    Object.is = function(x, y) {\n        // SameValue algorithm\n        if (x === y) { // Steps 1-5, 7-10\n            // Steps 6.b-6.e: +0 != -0\n            return x !== 0 || 1 / x === 1 / y;\n        } else {\n            // Step 6.a: NaN == NaN\n            return x !== x && y !== y;\n        }\n  };\n}\n\nif (!Object.assign) {\n    /**\n     * The Object.assign() method is used to copy the values of all enumerable own properties from one or more source objects to a target object.\n     * The Object.assign method only copies enumerable and own properties from a source object to a target object.\n     * It uses [[Get]] on the source and [[Put]] on the target, so it will invoke getters and setters.\n     * Therefore it assigns properties versus just copying or defining new properties.\n     * This may make it unsuitable for merging new properties into a prototype if the merge sources contain getters.\n     * For copying propertiy definitions, including their enumerability, into prototypes Object.getOwnPropertyDescriptor and Object.defineProperty should be used instead.\n     * @name assign\n     * @memberOf external:Object#\n     * @function\n     * @param {Object} target The target object.\n     * @param {Object[]} sources The source object(s).\n     * @return {Object} The target object gets returned.\n     * @see {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign|Object.assign}\n     * @example\n     * // Merging objects\n     * var o1 = { a: 1 };\n     * var o2 = { b: 2 };\n     * var o3 = { c: 3 };\n     *\n     * var obj = Object.assign(o1, o2, o3);\n     * console.log(obj);\n     * // { a: 1, b: 2, c: 3 }\n     */\n\n    Object.defineProperty(Object, \"assign\", {\n        enumerable: false,\n        configurable: true,\n        writable: true,\n        value: function (target) {\n            \"use strict\";\n            if (target === undefined || target === null) {\n                throw new TypeError(\"Cannot convert first argument to object\");\n            }\n            var to = Object(target);\n            for (var i = 1; i < arguments.length; i++) {\n                var nextSource = arguments[i];\n                if (nextSource === undefined || nextSource === null) {\n                    continue;\n                }\n                var keysArray = Object.keys(Object(nextSource));\n                for (var nextIndex = 0, len = keysArray.length; nextIndex < len; nextIndex++) {\n                    var nextKey = keysArray[nextIndex];\n                    var desc = Object.getOwnPropertyDescriptor(nextSource, nextKey);\n                    if (desc !== undefined && desc.enumerable) {\n                        to[nextKey] = nextSource[nextKey];\n                    }\n                }\n            }\n            return to;\n        }\n    });\n}\n\n/**\n * Extend a class prototype with the provided mixin descriptors.\n * Designed as a faster replacement for John Resig's Simple Inheritance.\n * @name extend\n * @memberOf me#Object\n * @function\n * @param {Object[]} mixins... Each mixin is a dictionary of functions, or a\n * previously extended class whose methods will be applied to the target class\n * prototype.\n * @return {Object}\n * @example\n * var Person = me.Object.extend({\n *     \"init\" : function (isDancing) {\n *         this.dancing = isDancing;\n *     },\n *     \"dance\" : function () {\n *         return this.dancing;\n *     }\n * });\n *\n * var Ninja = Person.extend({\n *     \"init\" : function () {\n *         // Call the super constructor, passing a single argument\n *         Person.prototype.init.apply(this, [false]);\n *     },\n *     \"dance\" : function () {\n *         // Call the overridden dance() method\n *         return Person.prototype.dance.apply(this);\n *     },\n *     \"swingSword\" : function () {\n *         return true;\n *     }\n * });\n *\n * var Pirate = Person.extend(Ninja, {\n *     \"init\" : function () {\n *         // Call the super constructor, passing a single argument\n *         Person.prototype.init.apply(this, [true]);\n *     }\n * });\n *\n * var p = new Person(true);\n * console.log(p.dance()); // => true\n *\n * var n = new Ninja();\n * console.log(n.dance()); // => false\n * console.log(n.swingSword()); // => true\n *\n * var r = new Pirate();\n * console.log(r.dance()); // => true\n * console.log(r.swingSword()); // => true\n *\n * console.log(\n *     p instanceof Person &&\n *     n instanceof Ninja &&\n *     n instanceof Person &&\n *     r instanceof Pirate &&\n *     r instanceof Person\n * ); // => true\n *\n * console.log(r instanceof Ninja); // => false\n */\n(function () {\n    function extend() {\n        var methods = {};\n        var mixins = new Array(arguments.length);\n        for (var i = 0; i < arguments.length; i++) {\n            mixins.push(arguments[i]);\n        }\n\n        /**\n         * The class constructor which calls the user `init` constructor.\n         * @ignore\n         */\n        function Class() {\n            // Call the user constructor\n            this.init.apply(this, arguments);\n            return this;\n        }\n\n        // Apply superClass\n        Class.prototype = Object.create(this.prototype);\n\n        // Apply all mixin methods to the class prototype\n        mixins.forEach(function (mixin) {\n            apply_methods(Class, methods, mixin.__methods__ || mixin);\n        });\n\n        // Verify constructor exists\n        if (!(\"init\" in Class.prototype)) {\n            throw new TypeError(\n                \"extend: Class is missing a constructor named `init`\"\n            );\n        }\n\n        // Apply syntactic sugar for accessing methods on super classes\n        Object.defineProperty(Class.prototype, \"_super\", {\n            \"value\" : _super\n        });\n\n        // Create a hidden property on the class itself\n        // List of methods, used for applying classes as mixins\n        Object.defineProperty(Class, \"__methods__\", {\n            \"value\" : methods\n        });\n\n        // Make this class extendable\n        Class.extend = extend;\n\n        return Class;\n    }\n\n    /**\n     * Apply methods to the class prototype.\n     * @ignore\n     */\n    function apply_methods(Class, methods, descriptor) {\n        Object.keys(descriptor).forEach(function (method) {\n            methods[method] = descriptor[method];\n\n            if (typeof(descriptor[method]) !== \"function\") {\n                throw new TypeError(\n                    \"extend: Method `\" + method + \"` is not a function\"\n                );\n            }\n\n            Object.defineProperty(Class.prototype, method, {\n                \"configurable\" : true,\n                \"value\" : descriptor[method]\n            });\n        });\n    }\n\n    /**\n     * Special method that acts as a proxy to the super class.\n     * @name _super\n     * @ignore\n     */\n    function _super(superClass, method, args) {\n        return superClass.prototype[method].apply(this, args);\n    }\n\n    /**\n     * The base class from which all jay-extend classes inherit.\n     * @ignore\n     */\n    var Jay = function () {\n        Object.apply(this, arguments);\n    };\n    Jay.prototype = Object.create(Object.prototype);\n    Jay.prototype.constructor = Jay;\n\n    Object.defineProperty(Jay, \"extend\", {\n        \"value\" : extend\n    });\n\n    /**\n     * The base class from which all melonJS objects inherit.\n     * See: {@link https://github.com/parasyte/jay-extend}\n     * @name Object\n     * @memberOf me\n     */\n    me.Object = Jay;\n})();\n\n/**\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n */\n\n/**\n * The built in Error object.\n * @external Error\n * @see {@link https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Error|Error}\n */\n\n/**\n * melonJS base class for exception handling.\n * @name Error\n * @memberOf me\n * @constructor\n * @param {String} msg Error message.\n */\nme.Error = me.Object.extend.bind(Error)({\n    init : function (msg) {\n        this.name = \"me.Error\";\n        this.message = msg;\n    }\n});\n\n/**\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n */\n\n /**\n * The built in Math Object\n * @external Math\n * @see {@link https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Math|Math}\n */\n\nif (!Math.sign) {\n    /**\n     * The Math.sign() function returns the sign of a number, indicating whether the number is positive, negative or zero.\n     * @memberof! external:Math#\n     * @alias sign\n     * @param {number} x a number.\n     * @return {number} sign of the number\n     */\n    Math.sign = function(x) {\n        x = +x; // convert to a number\n        if (x === 0 || isNaN(x)) {\n            return x;\n        }\n        return x > 0 ? 1 : -1;\n    };\n}\n\n/**\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n */\n\n /**\n * The built in Number Object\n * @external Number\n * @see {@link https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Number|Number}\n */\n\n/**\n * add a clamp fn to the Number object\n * @memberof! external:Number#\n * @alias clamp\n * @param {number} low lower limit\n * @param {number} high higher limit\n * @return {number} clamped value\n */\nNumber.prototype.clamp = function (low, high) {\n    return this < low ? low : this > high ? high : +this;\n};\n\n/**\n * return a random integer between min, max (exclusive)\n * @memberof! external:Number#\n * @alias random\n * @param {number} [min=this] minimum value.\n * @param {number} max maximum value.\n * @return {number} random value\n * @example\n * // Print a random number; one of 5, 6, 7, 8, 9\n * console.log( (5).random(10) );\n * // Select a random array element\n * var ar = [ \"foo\", \"bar\", \"baz\" ];\n * console.log(ar[ (0).random(ar.length) ]);\n */\nNumber.prototype.random = function (min, max) {\n    if (!max) {\n        max = min;\n        min = this;\n    }\n    return (~~(Math.random() * (max - min)) + min);\n};\n\n/**\n * return a random float between min, max (exclusive)\n * @memberof! external:Number#\n * @alias randomFloat\n * @param {number} [min=this] minimum value.\n * @param {number} max maximum value.\n * @return {number} random value\n * @example\n * // Print a random number; one of 5, 6, 7, 8, 9\n * console.log( (5).random(10) );\n * // Select a random array element\n * var ar = [ \"foo\", \"bar\", \"baz\" ];\n * console.log(ar[ (0).random(ar.length) ]);\n */\nNumber.prototype.randomFloat = function (min, max) {\n    if (!max) {\n        max = min;\n        min = this;\n    }\n    return (Math.random() * (max - min)) + min;\n};\n\n/**\n * return a weighted random between min, max (exclusive)\n * favoring the lower numbers\n * @memberof! external:Number#\n * @alias weightedRandom\n * @param {number} [min=this] minimum value.\n * @param {number} max maximum value.\n * @return {number} random value\n * @example\n * // Print a random number; one of 5, 6, 7, 8, 9\n * console.log( (5).random(10) );\n * // Select a random array element\n * var ar = [ \"foo\", \"bar\", \"baz\" ];\n * console.log(ar[ (0).random(ar.length) ]);\n */\nNumber.prototype.weightedRandom = function (min, max) {\n    if (!max) {\n        max = min;\n        min = this;\n    }\n    return (~~(Math.pow(Math.random(), 2) * (max - min)) + min);\n};\n\n/**\n * round a value to the specified number of digit\n * @memberof! external:Number#\n * @alias round\n * @param {number} [num=this] value to be rounded.\n * @param {number} dec number of decimal digit to be rounded to.\n * @return {number} rounded value\n * @example\n * // round a specific value to 2 digits\n * Number.prototype.round (10.33333, 2); // return 10.33\n * // round a float value to 4 digits\n * num = 10.3333333\n * num.round(4); // return 10.3333\n */\nNumber.prototype.round = function (num, dec) {\n    // if only one argument use the object value\n    num = (arguments.length < 2) ? this : num;\n    var powres = Math.pow(10, dec || num || 0);\n    return (~~(0.5 + num * powres) / powres);\n};\n\n/**\n * a quick toHex function<br>\n * given number <b>must</b> be an int, with a value between 0 and 255\n * @memberof! external:Number#\n * @alias toHex\n * @return {string} converted hexadecimal value\n */\nNumber.prototype.toHex = function () {\n    return \"0123456789ABCDEF\".charAt((this - (this % 16)) >> 4) + \"0123456789ABCDEF\".charAt(this % 16);\n};\n\n/**\n * Converts an angle in degrees to an angle in radians\n * @memberof! external:Number#\n * @alias degToRad\n * @param {number} [angle=\"angle\"] angle in degrees\n * @return {number} corresponding angle in radians\n * @example\n * // convert a specific angle\n * Number.prototype.degToRad (60); // return 1.0471...\n * // convert object value\n * var num = 60\n * num.degToRad(); // return 1.0471...\n */\nNumber.prototype.degToRad = function (angle) {\n    return (angle || this) / 180.0 * Math.PI;\n};\n\n/**\n * Converts an angle in radians to an angle in degrees.\n * @memberof! external:Number#\n * @alias radToDeg\n * @param {number} [angle=\"angle\"] angle in radians\n * @return {number} corresponding angle in degrees\n * @example\n * // convert a specific angle\n * Number.prototype.radToDeg (1.0471975511965976); // return 59.9999...\n * // convert object value\n * num = 1.0471975511965976\n * Math.ceil(num.radToDeg()); // return 60\n */\nNumber.prototype.radToDeg = function (angle) {\n    return (angle || this) * (180.0 / Math.PI);\n};\n\n/**\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n */\n\n/**\n * The built in String Object\n * @external String\n * @see {@link https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String|String}\n */\n\nif (!String.prototype.trim) {\n    /**\n     * removes whitespace from both ends of a string. Whitespace in this context is all the whitespace characters (space, tab, no-break space, etc.) and all the line terminator characters (LF, CR, etc.).\n     * @memberof! external:String#\n     * @alias trim\n     * @return {string} the string stripped of whitespace from both ends. \n     */\n    if (!String.prototype.trim) {\n      (function() {\n        // Make sure we trim BOM and NBSP\n        var rtrim = /^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g;\n        String.prototype.trim = function() {\n          return this.replace(rtrim, \"\");\n        };\n      })();\n    }\n}\n\nif (!String.prototype.trimLeft) {\n    /**\n     * returns the string stripped of whitespace from the left.\n     * @memberof! external:String#\n     * @alias trimLeft\n     * @return {string} trimmed string\n     */\n    String.prototype.trimLeft = function () {\n        return this.replace(/^\\s+/, \"\");\n    };\n}\n\nif (!String.prototype.trimRight) {\n    /**\n     * returns the string stripped of whitespace from the right.\n     * @memberof! external:String#\n     * @alias trimRight\n     * @return {string} trimmed string\n     */\n    String.prototype.trimRight = function () {\n        return this.replace(/\\s+$/, \"\");\n    };\n}\n\n/**\n * add isNumeric fn to the string object\n * @memberof! external:String#\n * @alias isNumeric\n * @return {boolean} true if string contains only digits\n */\nString.prototype.isNumeric = function () {\n    return (!isNaN(this) && this.trim() !== \"\");\n};\n\n/**\n * add a isBoolean fn to the string object\n * @memberof! external:String#\n * @alias isBoolean\n * @return {boolean} true if the string is either true or false\n */\nString.prototype.isBoolean = function () {\n    var trimmed = this.trim();\n    return (\"true\" === trimmed) || (\"false\" === trimmed);\n};\n\nif (!String.prototype.includes) {\n    /**\n     * determines whether one string may be found within another string.\n     * @memberof! external:String#\n     * @alias includes\n     * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/includes\n     * @param {string} searchString A string to be searched for within this string.\n     * @param {number} [position=0] The position in this string at which to begin searching for the given string.\n     * @return {boolean} true if contains the specified string\n     */\n  String.prototype.includes = function() {\n    return String.prototype.indexOf.apply(this, arguments) !== -1;\n  };\n}\n\n/**\n * convert the string to hex value\n * @memberof! external:String#\n * @alias toHex\n * @return {string}\n */\nString.prototype.toHex = function () {\n    var res = \"\", c = 0;\n    while (c < this.length) {\n        res += this.charCodeAt(c++).toString(16);\n    }\n    return res;\n};\n\n/**\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n */\n\n/**\n * The built in Array Object\n * @external Array\n * @see {@link https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array|Array}\n */\n\n/**\n * Remove the specified object from the Array<br>\n * @memberof! external:Array#\n * @alias remove\n * @param {Object} object to be removed\n */\nArray.prototype.remove = function (obj) {\n    var i = Array.prototype.indexOf.call(this, obj);\n    if (i !== -1) {\n        Array.prototype.splice.call(this, i, 1);\n    }\n    return this;\n};\n\nif (!Array.prototype.forEach) {\n    /**\n     * provide a replacement for browsers that don't\n     * support Array.prototype.forEach (JS 1.6)\n     * @ignore\n     */\n    Array.prototype.forEach = function (callback, scope) {\n        for (var i = 0, j = this.length; j--; i++) {\n            callback.call(scope || this, this[i], i, this);\n        }\n    };\n}\n\nif (!Array.isArray) {\n    /**\n     * provide a replacement for browsers that don't\n     * natively support Array.isArray\n     * @ignore\n     */\n    Array.isArray = function (vArg) {\n        var isArray;\n        isArray = vArg instanceof Array;\n        return isArray;\n    };\n}\n\n/**\n * return a random array element\n * @memberof! external:Array#\n * @alias random\n * @param {array} entry array to pick a element\n * @return {any} random member of array\n */\nArray.prototype.random = function (entry) {\n    return entry[(0).random(entry.length)];\n};\n\n/**\n * return a weighted random array element, favoring the earlier entries\n * @memberof! external:Array#\n * @alias weightedRandom\n * @param {array} entry array to pick a element\n * @return {any} random member of array\n */\nArray.prototype.weightedRandom = function (entry) {\n    return entry[(0).weightedRandom(entry.length)];\n};\n\n/**\n * A fake TypedArray object to be used for the TypedArray polyfills\n * @ignore\n */\nme.TypedArray = function (a) {\n    var i = 0;\n    if (Array.isArray(a)) {\n        this.concat(a.slice());\n    }\n    else if ((arguments.length === 1) && (typeof(a) === \"number\")) {\n        for (i = 0; i < a; i++) {\n            this.push(0);\n        }\n    }\n    else {\n        throw new me.Error(\n            \"TypedArray polyfill: Unsupported constructor arguments\",\n            arguments\n        );\n    }\n};\nme.TypedArray.prototype = Array.prototype;\n\n/**\n * The set() method stores multiple values in the typed array, reading input values from a specified array.\n * @ignore\n * @see {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray/set|TypedArray.prototype.set}\n */\nme.TypedArray.prototype.set = function (source, offset) {\n    offset = offset || 0;\n\n    if (source.length + offset > this.length) {\n        throw new me.Error(\n            \"TypedArray pollyfill: Buffer overflow in set\"\n        );\n    }\n\n    for (var i = 0; i < source.length; i++, offset++) {\n        this[offset] = source[i];\n    }\n};\n\n/**\n * The built in Float32Array object.\n * @external Float32Array\n * @see {@link https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Float32Array|Float32Array}\n */\nwindow.Float32Array = window.Float32Array || me.TypedArray;\n\n/**\n * The built in Uint8Array object.\n * @external Uint8Array\n * @see {@link https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Uint8Array|Uint8Array}\n */\nwindow.Uint8Array = window.Uint8Array || me.TypedArray;\n\n/**\n * The built in Uint16Array object.\n * @external Uint16Array\n * @see {@link https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Uint16Array|Uint16Array}\n */\nwindow.Uint16Array = window.Uint16Array || me.TypedArray;\n\n/**\n * The built in Uint32Array object.\n * @external Uint32Array\n * @see {@link https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Uint32Array|Uint32Array}\n */\nwindow.Uint32Array = window.Uint32Array || me.TypedArray;\n\n/**\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n */\n\n// define window.performance if undefined\nif (typeof window.performance === \"undefined\") {\n    window.performance = {};\n}\n\nif (typeof Date.now === \"undefined\") {\n    /**\n     * provide a replacement for browser not\n     * supporting Date.now (JS 1.5)\n     * @ignore\n     */\n    Date.now = function () {\n        return new Date().getTime();\n    };\n}\n\nif (!window.performance.now) {\n    var timeOffset = Date.now();\n\n    if (window.performance.timing &&\n        window.performance.timing.navigationStart) {\n        timeOffset = window.performance.timing.navigationStart;\n    }\n    /**\n     * provide a polyfill for window.performance now\n     * to provide consistent time information across browser\n     * (always return the elapsed time since the browser started)\n     * @ignore\n     */\n    window.performance.now = function () {\n        return Date.now() - timeOffset;\n    };\n}\n\n/*\n\nCopyright (C) 2011 by Andrea Giammarchi, @WebReflection\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n*/\n\n/* jshint -W003 */\n/* jshint -W013 */\n/* jshint -W015 */\n/* jshint -W030 */\n/* jshint -W035 */\n/* jshint -W040 */\n/* jshint -W058 */\n/* jshint -W108 */\n/* jshint -W116 */\n\n(function (exports) {'use strict';\n  //shared pointer\n  var i;\n  //shortcuts\n  var defineProperty = Object.defineProperty, is = Object.is;\n\n\n  //Polyfill global objects\n  if (typeof WeakMap == 'undefined') {\n    exports.WeakMap = createCollection({\n      // WeakMap#delete(key:void*):boolean\n      'delete': sharedDelete,\n      // WeakMap#clear():\n      clear: sharedClear,\n      // WeakMap#get(key:void*):void*\n      get: sharedGet,\n      // WeakMap#has(key:void*):boolean\n      has: mapHas,\n      // WeakMap#set(key:void*, value:void*):void\n      set: sharedSet\n    }, true);\n  }\n\n  if (typeof Map == 'undefined' || typeof ((new Map).values) !== 'function' || !(new Map).values().next) {\n    exports.Map = createCollection({\n      // WeakMap#delete(key:void*):boolean\n      'delete': sharedDelete,\n      //:was Map#get(key:void*[, d3fault:void*]):void*\n      // Map#has(key:void*):boolean\n      has: mapHas,\n      // Map#get(key:void*):boolean\n      get: sharedGet,\n      // Map#set(key:void*, value:void*):void\n      set: sharedSet,\n      // Map#keys(void):Iterator\n      keys: sharedKeys,\n      // Map#values(void):Iterator\n      values: sharedValues,\n      // Map#entries(void):Iterator\n      entries: mapEntries,\n      // Map#forEach(callback:Function, context:void*):void ==> callback.call(context, key, value, mapObject) === not in specs`\n      forEach: sharedForEach,\n      // Map#clear():\n      clear: sharedClear\n    });\n  }\n\n  if (typeof Set == 'undefined' || typeof ((new Set).values) !== 'function' || !(new Set).values().next) {\n    exports.Set = createCollection({\n      // Set#has(value:void*):boolean\n      has: setHas,\n      // Set#add(value:void*):boolean\n      add: sharedAdd,\n      // Set#delete(key:void*):boolean\n      'delete': sharedDelete,\n      // Set#clear():\n      clear: sharedClear,\n      // Set#keys(void):Iterator\n      keys: sharedValues, // specs actually say \"the same function object as the initial value of the values property\"\n      // Set#values(void):Iterator\n      values: sharedValues,\n      // Set#entries(void):Iterator\n      entries: setEntries,\n      // Set#forEach(callback:Function, context:void*):void ==> callback.call(context, value, index) === not in specs\n      forEach: sharedForEach\n    });\n  }\n\n  if (typeof WeakSet == 'undefined') {\n    exports.WeakSet = createCollection({\n      // WeakSet#delete(key:void*):boolean\n      'delete': sharedDelete,\n      // WeakSet#add(value:void*):boolean\n      add: sharedAdd,\n      // WeakSet#clear():\n      clear: sharedClear,\n      // WeakSet#has(value:void*):boolean\n      has: setHas\n    }, true);\n  }\n\n\n  /**\n   * ES6 collection constructor\n   * @return {Function} a collection class\n   */\n  function createCollection(proto, objectOnly){\n    function Collection(a){\n      if (!this || this.constructor !== Collection) return new Collection(a);\n      this._keys = [];\n      this._values = [];\n      this._itp = []; // iteration pointers\n      this.objectOnly = objectOnly;\n\n      //parse initial iterable argument passed\n      if (a) init.call(this, a);\n    }\n\n    //define size for non object-only collections\n    if (!objectOnly) {\n      defineProperty(proto, 'size', {\n        get: sharedSize\n      });\n    }\n\n    //set prototype\n    proto.constructor = Collection;\n    Collection.prototype = proto;\n\n    return Collection;\n  }\n\n\n  /** parse initial iterable argument passed */\n  function init(a){\n    //init Set argument, like `[1,2,3,{}]`\n    if (this.add)\n      a.forEach(this.add, this);\n    //init Map argument like `[[1,2], [{}, 4]]`\n    else\n      a.forEach(function(a){this.set(a[0],a[1]);}, this);\n  }\n\n\n  /** delete */\n  function sharedDelete(key) {\n    if (this.has(key)) {\n      this._keys.splice(i, 1);\n      this._values.splice(i, 1);\n      // update iteration pointers\n      this._itp.forEach(function(p) { if (i < p[0]) p[0]--; });\n    }\n    // Aurora here does it while Canary doesn't\n    return -1 < i;\n  }\n\n  function sharedGet(key) {\n    return this.has(key) ? this._values[i] : undefined;\n  }\n\n  function has(list, key) {\n    if (this.objectOnly && key !== Object(key))\n      throw new TypeError(\"Invalid value used as weak collection key\");\n    //NaN or 0 passed\n    if (key != key || key === 0) for (i = list.length; i-- && !is(list[i], key);){}\n    else i = list.indexOf(key);\n    return -1 < i;\n  }\n\n  function setHas(value) {\n    return has.call(this, this._values, value);\n  }\n\n  function mapHas(value) {\n    return has.call(this, this._keys, value);\n  }\n\n  /** @chainable */\n  function sharedSet(key, value) {\n    this.has(key) ?\n      this._values[i] = value\n      :\n      this._values[this._keys.push(key) - 1] = value\n      ;\n    return this;\n  }\n\n  /** @chainable */\n  function sharedAdd(value) {\n    if (!this.has(value)) this._values.push(value);\n    return this;\n  }\n\n  function sharedClear() {\n    (this._keys || 0).length =\n    this._values.length = 0;\n  }\n\n  /** keys, values, and iterate related methods */\n  function sharedKeys() {\n    return sharedIterator(this._itp, this._keys);\n  }\n\n  function sharedValues() {\n    return sharedIterator(this._itp, this._values);\n  }\n\n  function mapEntries() {\n    return sharedIterator(this._itp, this._keys, this._values);\n  }\n\n  function setEntries() {\n    return sharedIterator(this._itp, this._values, this._values);\n  }\n\n  function sharedIterator(itp, array, array2) {\n    var p = [0], done = false;\n    itp.push(p);\n    return {\n      next: function() {\n        var v, k = p[0];\n        if (!done && k < array.length) {\n          v = array2 ? [array[k], array2[k]]: array[k];\n          p[0]++;\n        } else {\n          done = true;\n          itp.splice(itp.indexOf(p), 1);\n        }\n        return { done: done, value: v };\n      }\n    };\n  }\n\n  function sharedSize() {\n    return this._values.length;\n  }\n\n  function sharedForEach(callback, context) {\n    var it = this.entries();\n    for (;;) {\n      var r = it.next();\n      if (r.done) break;\n      callback.call(context, r.value[1], r.value[0], this);\n    }\n  }\n\n})(typeof exports != 'undefined' && typeof global != 'undefined' ? global : window );\n\n/**\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n */\n\n(function () {\n\n    /**\n     * me global references\n     * @ignore\n     */\n    me.mod = \"melonJS\";\n    me.version = \"3.0.0\";\n    /**\n     * global system settings and browser capabilities\n     * @namespace\n     */\n    me.sys = {\n\n        /*\n         * Global settings\n         */\n\n        /**\n         * Set game FPS limiting\n         * @see me.timer.tick\n         * @type {Number}\n         * @default 60\n         * @memberOf me.sys\n         */\n        fps : 60,\n \n        /**\n         * Rate at which the game updates;<br>\n         * must be equal to or lower than the fps\n         * @see me.timer.tick\n         * @type {Number}\n         * @default 60\n         * @memberOf me.sys\n         */\n        updatesPerSecond : 60,\n\n        /**\n         * Enable/disable frame interpolation\n         * @see me.timer.tick\n         * @type {Boolean}\n         * @default false\n         * @memberOf me.sys\n         */\n        interpolation : false,\n\n        /**\n         * Global scaling factor\n         * @type {me.Vector2d}\n         * @default <0,0>\n         * @memberOf me.sys\n         */\n        scale : null, //initialized by me.video.init\n\n        /**\n         * Global gravity settings <br>\n         * will override entities init value if defined<br>\n         * @type {Number|undefined}\n         * @default undefined\n         * @memberOf me.sys\n         */\n        gravity : undefined,\n\n        /**\n         * Specify either to stop on audio loading error or not<br>\n         * if true, melonJS will throw an exception and stop loading<br>\n         * if false, melonJS will disable sounds and output a warning message\n         * in the console<br>\n         * @type {Boolean}\n         * @default true\n         * @memberOf me.sys\n         */\n        stopOnAudioError : true,\n\n        /**\n         * Specify whether to pause the game when losing focus.<br>\n         * @type {Boolean}\n         * @default true\n         * @memberOf me.sys\n         */\n        pauseOnBlur : true,\n\n        /**\n         * Specify whether to unpause the game when gaining focus.<br>\n         * @type {Boolean}\n         * @default true\n         * @memberOf me.sys\n         */\n        resumeOnFocus : true,\n\n        /**\n         * Specify whether to stop the game when losing focus or not<br>\n         * The engine restarts on focus if this is enabled.\n         * @type {boolean}\n         * @default false\n         * @memberOf me.sys\n         */\n        stopOnBlur : false,\n\n        /**\n         * Specify the rendering method for layers <br>\n         * if false, visible part of the layers are rendered dynamically<br>\n         * if true, the entire layers are first rendered into an offscreen\n         * canvas<br>\n         * the \"best\" rendering method depends of your game<br>\n         * (amount of layer, layer size, amount of tiles per layer, etc.)<br>\n         * note : rendering method is also configurable per layer by adding this\n         * property to your layer (in Tiled)<br>\n         * @type {Boolean}\n         * @default false\n         * @memberOf me.sys\n         */\n        preRender : false,\n\n        /*\n         * System methods\n         */\n\n        /**\n         * Compare two version strings\n         * @public\n         * @function\n         * @param {String} first First version string to compare\n         * @param {String} [second=\"3.0.0\"] Second version string to compare\n         * @return {Number} comparison result <br>&lt; 0 : first &lt; second<br>\n         * 0 : first == second<br>\n         * &gt; 0 : first &gt; second\n         * @example\n         * if (me.sys.checkVersion(\"3.0.0\") > 0) {\n         *     console.error(\n         *         \"melonJS is too old. Expected: 3.0.0, Got: \" + me.version\n         *     );\n         * }\n         */\n        checkVersion : function (first, second) {\n            second = second || me.version;\n\n            var a = first.split(\".\");\n            var b = second.split(\".\");\n            var len = Math.min(a.length, b.length);\n            var result = 0;\n\n            for (var i = 0; i < len; i++) {\n                if ((result = +a[i] - +b[i])) {\n                    break;\n                }\n            }\n\n            return result ? result : a.length - b.length;\n        }\n    };\n\n    function parseHash() {\n        var hash = {};\n\n        if (document.location.hash) {\n            document.location.hash.substr(1).split(\"&\").filter(function (value) {\n                return (value !== \"\");\n            }).forEach(function (value) {\n                var kv = value.split(\"=\");\n                var k = kv.shift();\n                var v = kv.join(\"=\");\n                hash[k] = v || true;\n            });\n        }\n\n        return hash;\n    }\n\n    // a flag to know if melonJS\n    // is initialized\n    var me_initialized = false;\n\n    Object.defineProperty(me, \"initialized\", {\n        get : function get() {\n            return me_initialized;\n        }\n    });\n\n    /*\n     * initial boot function\n     */\n\n    me.boot = function () {\n        // don't do anything if already initialized (should not happen anyway)\n        if (me_initialized) {\n            return;\n        }\n\n        // check the device capabilites\n        me.device._check();\n\n        // initialize me.save\n        me.save._init();\n\n        // parse optional url parameters/tags\n        me.game.HASH = parseHash();\n\n        // enable/disable the cache\n        me.loader.setNocache(\n            me.game.HASH.nocache || false\n        );\n\n        // init the FPS counter if needed\n        me.timer.init();\n\n        // init the App Manager\n        me.state.init();\n\n        // init the Entity Pool\n        me.pool.init();\n\n        // automatically enable keyboard events if on desktop\n        if (me.device.isMobile === false) {\n            me.input._enableKeyboardEvent();\n        }\n\n        // init the level Director\n        me.levelDirector.reset();\n\n        me_initialized = true;\n    };\n\n})();\n\n/**\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n */\n\n(function () {\n\n    /**\n     * me.game represents your current game, it contains all the objects,\n     * tilemap layers, current viewport, collision map, etc...<br>\n     * me.game is also responsible for updating (each frame) the object status\n     * and draw them<br>\n     * @namespace me.game\n     * @memberOf me\n     */\n    me.game = (function () {\n        // hold public stuff in our singleton\n        var api = {};\n\n        /*\n         * PRIVATE STUFF\n         */\n\n        // flag to redraw the sprites\n        var initialized = false;\n\n        // to know when we have to refresh the display\n        var isDirty = true;\n\n        // always refresh the display when updatesPerSecond are lower than fps\n        var isAlwaysDirty = false;\n\n        // frame counter for frameSkipping\n        // reset the frame counter\n        var frameCounter = 0;\n        var frameRate = 1;\n\n        // time accumulation for multiple update calls\n        var accumulator = 0.0;\n        var accumulatorMax = 0.0;\n        var accumulatorUpdateDelta = 0;\n\n        // min update step size\n        var stepSize = 1000 / 60;\n        var updateDelta = 0;\n        var lastUpdateStart = null;\n        var updateAverageDelta = 0;\n\n        // reference to the renderer object\n        var renderer = null;\n\n        /*\n         * PUBLIC STUFF\n         */\n\n        /**\n         * a reference to the game viewport.\n         * @public\n         * @type {me.Viewport}\n         * @name viewport\n         * @memberOf me.game\n         */\n        api.viewport = null;\n\n        /**\n         * a reference to the game world <br>\n         * a world is a virtual environment containing all the game objects\n         * @public\n         * @type {me.Container}\n         * @name world\n         * @memberOf me.game\n         */\n        api.world = null;\n\n        /**\n         * when true, all objects will be added under the root world container<br>\n         * when false, a `me.Container` object will be created for each\n         * corresponding `TMXObjectGroup`\n         * default value : true\n         * @public\n         * @type {boolean}\n         * @name mergeGroup\n         * @memberOf me.game\n         */\n        api.mergeGroup = true;\n\n        /**\n         * The property of should be used when sorting entities <br>\n         * value : \"x\", \"y\", \"z\" (default: \"z\")\n         * @public\n         * @type {string}\n         * @name sortOn\n         * @memberOf me.game\n         */\n        api.sortOn = \"z\";\n\n        /**\n         * default layer tmxRenderer\n         * @private\n         * @ignore\n         * @type {me.TMXRenderer}\n         * @name tmxRenderer\n         * @memberOf me.game\n         */\n        api.tmxRenderer = null;\n\n        /**\n         * Fired when a level is fully loaded and <br>\n         * and all entities instantiated. <br>\n         * Additionnaly the level id will also be passed\n         * to the called function.\n         * @public\n         * @callback\n         * @name onLevelLoaded\n         * @memberOf me.game\n         * @example\n         * // call myFunction () everytime a level is loaded\n         * me.game.onLevelLoaded = this.myFunction.bind(this);\n         */\n        api.onLevelLoaded = function () {};\n\n        /**\n         * Provide an object hash with all tag parameters specified in the url.\n         * @property {Boolean} [hitbox=false] draw the hitbox in the debug panel (if enabled)\n         * @property {Boolean} [velocity=false] draw the entities velocity in the debug panel (if enabled)\n         * @property {Boolean} [quadtree=false] draw the quadtree in the debug panel (if enabled)\n         * @property {Boolean} [webgl=false] force the renderer to WebGL\n         * @public\n         * @type {Object}\n         * @name HASH\n         * @memberOf me.game\n         * @example\n         * // http://www.example.com/index.html#debug&hitbox=true&mytag=value\n         * console.log(me.game.HASH[\"mytag\"]); //> \"value\"\n         */\n        api.HASH = null;\n\n        /**\n         * Initialize the game manager\n         * @name init\n         * @memberOf me.game\n         * @private\n         * @ignore\n         * @function\n         * @param {Number} [width] width of the canvas\n         * @param {Number} [height] width of the canvas\n         * init function.\n         */\n        api.init = function (width, height) {\n            if (!initialized) {\n                // if no parameter specified use the system size\n                width  = width  || me.video.renderer.getWidth();\n                height = height || me.video.renderer.getHeight();\n\n                // create a defaut viewport of the same size\n                api.viewport = new me.Viewport(0, 0, width, height);\n\n                // the root object of our world is an entity container\n                api.world = new me.Container(0, 0, width, height);\n                api.world.name = \"rootContainer\";\n                api.world._root = true;\n\n                // initialize the collision system (the quadTree mostly)\n                me.collision.init();\n\n                renderer = me.video.renderer;\n\n                // publish init notification\n                me.event.publish(me.event.GAME_INIT);\n\n                // translate global pointer events\n                me.input._translatePointerEvents();\n\n                // make display dirty by default\n                isDirty = true;\n\n                // set as initialized\n                initialized = true;\n            }\n        };\n\n        /**\n         * reset the game Object manager<p>\n         * destroy all current objects\n         * @name reset\n         * @memberOf me.game\n         * @public\n         * @function\n         */\n        api.reset = function () {\n\n            // clear the quadtree\n            me.collision.quadTree.clear();\n\n            // remove all objects\n            api.world.destroy();\n\n            // reset the viewport to zero ?\n            if (api.viewport) {\n                api.viewport.reset();\n            }\n\n            // reset the renderer\n            renderer.reset();\n\n            // reset the frame counter\n            frameCounter = 0;\n            frameRate = ~~(0.5 + 60 / me.sys.fps);\n\n            // set step size based on the updatesPerSecond\n            stepSize = (1000 / me.sys.updatesPerSecond);\n            accumulator = 0.0;\n            accumulatorMax = stepSize * 10;\n\n            // display should always re-draw when update speed doesn't match fps\n            // this means the user intends to write position prediction drawing logic\n            isAlwaysDirty = (me.sys.fps > me.sys.updatesPerSecond);\n        };\n\n        /**\n         * Returns the parent container of the specified Child in the game world\n         * @name getParentContainer\n         * @memberOf me.game\n         * @function\n         * @param {me.Renderable} child\n         * @return {me.Container}\n         */\n        api.getParentContainer = function (child) {\n            return child.ancestor;\n        };\n\n        /**\n         * force the redraw (not update) of all objects\n         * @name repaint\n         * @memberOf me.game\n         * @public\n         * @function\n         */\n\n        api.repaint = function () {\n            isDirty = true;\n        };\n\n\n        /**\n         * update all objects of the game manager\n         * @name update\n         * @memberOf me.game\n         * @private\n         * @ignore\n         * @function\n         * @param {Number} time current timestamp as provided by the RAF callback\n         */\n        api.update = function (time) {\n            // handle frame skipping if required\n            if ((++frameCounter % frameRate) === 0) {\n                // reset the frame counter\n                frameCounter = 0;\n\n                // update the timer\n                me.timer.update(time);\n\n                // update the gamepads\n                me.input._updateGamepads();\n\n                accumulator += me.timer.getDelta();\n                accumulator = Math.min(accumulator, accumulatorMax);\n\n                updateDelta = (me.sys.interpolation) ? me.timer.getDelta() : stepSize;\n                accumulatorUpdateDelta = (me.sys.interpolation) ? updateDelta : Math.max(updateDelta, updateAverageDelta);\n\n                while (accumulator >= accumulatorUpdateDelta || me.sys.interpolation) {\n                    lastUpdateStart = window.performance.now();\n\n                    // clear the quadtree\n                    me.collision.quadTree.clear();\n\n                    // insert the world container (children) into the quadtree\n                    me.collision.quadTree.insertContainer(api.world);\n\n                    // update all objects (and pass the elapsed time since last frame)\n                    isDirty = api.world.update(updateDelta) || isDirty;\n\n                    // update the camera/viewport\n                    isDirty = api.viewport.update(updateDelta) || isDirty;\n\n                    me.timer.lastUpdate = window.performance.now();\n                    updateAverageDelta = me.timer.lastUpdate - lastUpdateStart;\n\n                    accumulator -= accumulatorUpdateDelta;\n                    if (me.sys.interpolation) {\n                        accumulator = 0;\n                        break;\n                    }\n                }\n            }\n        };\n\n        /**\n         * draw all existing objects\n         * @name draw\n         * @memberOf me.game\n         * @private\n         * @ignore\n         * @function\n         */\n        api.draw = function () {\n            if (isDirty || isAlwaysDirty) {\n                // cache the viewport rendering position, so that other object\n                // can access it later (e,g. entityContainer when drawing floating objects)\n                var translateX = api.viewport.pos.x + ~~api.viewport.offset.x;\n                var translateY = api.viewport.pos.y + ~~api.viewport.offset.y;\n\n                // translate the world coordinates by default to screen coordinates\n                api.world.transform.translate(-translateX, -translateY);\n\n                // prepare renderer to draw a new frame\n                me.video.renderer.prepareSurface();\n\n                // update all objects,\n                // specifying the viewport as the rectangle area to redraw\n                api.world.draw(renderer, api.viewport);\n\n                // translate back\n                api.world.transform.translate(translateX, translateY);\n\n                // draw our camera/viewport\n                api.viewport.draw(renderer);\n            }\n\n            isDirty = false;\n\n            // blit our frame\n            me.video.renderer.blitSurface();\n        };\n\n        // return our object\n        return api;\n    })();\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org/\n *\n */\n(function () {\n    /**\n     * Convert first character of a string to uppercase, if it's a letter.\n     * @ignore\n     * @function\n     * @name capitalize\n     * @param  {String} str Input string.\n     * @return {String} String with first letter made uppercase.\n     */\n    var capitalize = function (str) {\n        return str.substring(0, 1).toUpperCase() + str.substring(1, str.length);\n    };\n\n    /**\n     * A collection of utilities to ease porting between different user agents.\n     * @namespace me.agent\n     * @memberOf me\n     */\n    me.agent = (function () {\n        var api = {};\n\n        /**\n         * Known agent vendors\n         * @ignore\n         */\n        var vendors = [ \"ms\", \"MS\", \"moz\", \"webkit\", \"o\" ];\n\n        /**\n         * Get a vendor-prefixed property\n         * @public\n         * @name prefixed\n         * @function\n         * @param {String} name Property name\n         * @param {Object} [obj=window] Object or element reference to access\n         * @return {Mixed} Value of property\n         * @memberOf me.agent\n         */\n        api.prefixed = function (name, obj) {\n            obj = obj || window;\n            if (name in obj) {\n                return obj[name];\n            }\n\n            var uc_name = capitalize(name);\n\n            var result;\n            vendors.some(function (vendor) {\n                var name = vendor + uc_name;\n                return (result = (name in obj) ? obj[name] : undefined);\n            });\n            return result;\n        };\n\n        /**\n         * Set a vendor-prefixed property\n         * @public\n         * @name setPrefixed\n         * @function\n         * @param {String} name Property name\n         * @param {Mixed} value Property value\n         * @param {Object} [obj=window] Object or element reference to access\n         * @memberOf me.agent\n         */\n        api.setPrefixed = function (name, value, obj) {\n            obj = obj || window;\n            if (name in obj) {\n                obj[name] = value;\n                return;\n            }\n\n            var uc_name = capitalize(name);\n\n            vendors.some(function (vendor) {\n                var name = vendor + uc_name;\n                if (name in obj) {\n                    obj[name] = value;\n                    return true;\n                }\n                return false;\n            });\n        };\n\n        return api;\n    })();\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n    /**\n     * A singleton object representing the device capabilities and specific events\n     * @namespace me.device\n     * @memberOf me\n     */\n    me.device = (function () {\n        // defines object for holding public information/functionality.\n        var api = {};\n        // private properties\n        var accelInitialized = false;\n        var deviceOrientationInitialized = false;\n        var devicePixelRatio = null;\n\n        /**\n         * check the device capapbilities\n         * @ignore\n         */\n        api._check = function () {\n\n            // detect device type/platform\n            me.device._detectDevice();\n\n            // future proofing (MS) feature detection\n            me.device.pointerEnabled = me.agent.prefixed(\"pointerEnabled\", navigator);\n            me.device.maxTouchPoints = me.agent.prefixed(\"maxTouchPoints\", navigator) || 0;\n            window.gesture = me.agent.prefixed(\"gesture\");\n\n            // detect touch capabilities\n            me.device.touch = (\"createTouch\" in document) || (\"ontouchstart\" in window) ||\n                              (navigator.isCocoonJS) || (me.device.pointerEnabled && (me.device.maxTouchPoints > 0));\n\n            // accelerometer detection\n            me.device.hasAccelerometer = (\n                (typeof (window.DeviceMotionEvent) !== \"undefined\") || (\n                    (typeof (window.Windows) !== \"undefined\") &&\n                    (typeof (Windows.Devices.Sensors.Accelerometer) === \"function\")\n                )\n            );\n\n            // pointerlock detection\n            this.hasPointerLockSupport = me.agent.prefixed(\"pointerLockElement\", document);\n\n            if (this.hasPointerLockSupport) {\n                document.exitPointerLock = me.agent.prefixed(\"exitPointerLock\", document);\n            }\n\n            // device motion detection\n            if (window.DeviceOrientationEvent) {\n                me.device.hasDeviceOrientation = true;\n            }\n\n            // fullscreen api detection & polyfill when possible\n            this.hasFullscreenSupport = me.agent.prefixed(\"fullscreenEnabled\", document) ||\n                                        document.mozFullScreenEnabled;\n\n            document.exitFullscreen = me.agent.prefixed(\"cancelFullScreen\", document) ||\n                                      me.agent.prefixed(\"exitFullscreen\", document);\n\n            // vibration API poyfill\n            navigator.vibrate = me.agent.prefixed(\"vibrate\", navigator);\n\n            try {\n                api.localStorage = !!window.localStorage;\n            } catch (e) {\n                // the above generates an exception when cookies are blocked\n                api.localStorage = false;\n            }\n\n            // set pause/stop action on losing focus\n            window.addEventListener(\"blur\", function () {\n                if (me.sys.stopOnBlur) {\n                    me.state.stop(true);\n                }\n                if (me.sys.pauseOnBlur) {\n                    me.state.pause(true);\n                }\n            }, false);\n            // set restart/resume action on gaining focus\n            window.addEventListener(\"focus\", function () {\n                if (me.sys.stopOnBlur) {\n                    me.state.restart(true);\n                }\n                if (me.sys.resumeOnFocus) {\n                    me.state.resume(true);\n                }\n            }, false);\n\n\n            // Set the name of the hidden property and the change event for visibility\n            var hidden, visibilityChange;\n            if (typeof document.hidden !== \"undefined\") {\n                // Opera 12.10 and Firefox 18 and later support\n                hidden = \"hidden\";\n                visibilityChange = \"visibilitychange\";\n            } else if (typeof document.mozHidden !== \"undefined\") {\n                hidden = \"mozHidden\";\n                visibilityChange = \"mozvisibilitychange\";\n            } else if (typeof document.msHidden !== \"undefined\") {\n                hidden = \"msHidden\";\n                visibilityChange = \"msvisibilitychange\";\n            } else if (typeof document.webkitHidden !== \"undefined\") {\n                hidden = \"webkitHidden\";\n                visibilityChange = \"webkitvisibilitychange\";\n            }\n\n            // register on the event if supported\n            if (typeof (visibilityChange) === \"string\") {\n                // add the corresponding event listener\n                document.addEventListener(visibilityChange,\n                    function () {\n                        if (document[hidden]) {\n                            if (me.sys.stopOnBlur) {\n                                me.state.stop(true);\n                            }\n                            if (me.sys.pauseOnBlur) {\n                                me.state.pause(true);\n                            }\n                        } else {\n                            if (me.sys.stopOnBlur) {\n                                me.state.restart(true);\n                            }\n                            if (me.sys.resumeOnFocus) {\n                                me.state.resume(true);\n                            }\n                        }\n                    }, false\n                );\n            }\n        };\n\n        /**\n         * detect the device type\n         * @ignore\n         */\n        api._detectDevice = function () {\n            // iOS Device ?\n            me.device.iOS = me.device.ua.match(/iPhone|iPad|iPod/i) || false;\n            // Android Device ?\n            me.device.android = me.device.ua.match(/Android/i) || false;\n            me.device.android2 = me.device.ua.match(/Android 2/i) || false;\n            // Windows Device ?\n            me.device.wp = me.device.ua.match(/Windows Phone/i) || false;\n            // Kindle device ?\n            me.device.BlackBerry = me.device.ua.match(/BlackBerry/i) || false;\n            // Kindle device ?\n            me.device.Kindle = me.device.ua.match(/Kindle|Silk.*Mobile Safari/i) || false;\n\n             // Mobile platform\n            me.device.isMobile = me.device.ua.match(/Mobi/i) ||\n                                 me.device.iOS ||\n                                 me.device.android ||\n                                 me.device.wp ||\n                                 me.device.BlackBerry ||\n                                 me.device.Kindle ||\n                                 me.device.iOS || false;\n        };\n\n        /*\n         * PUBLIC Properties & Functions\n         */\n\n        // Browser capabilities\n\n        /**\n         * Browser User Agent\n         * @type Boolean\n         * @readonly\n         * @name ua\n         * @memberOf me.device\n         */\n        api.ua = navigator.userAgent;\n\n        /**\n         * Browser Local Storage capabilities <br>\n         * (this flag will be set to false if cookies are blocked)\n         * @type Boolean\n         * @readonly\n         * @name localStorage\n         * @memberOf me.device\n         */\n        api.localStorage = false;\n\n        /**\n         * Browser accelerometer capabilities\n         * @type Boolean\n         * @readonly\n         * @name hasAccelerometer\n         * @memberOf me.device\n         */\n        api.hasAccelerometer = false;\n\n        /**\n         * Browser device orientation\n         * @type Boolean\n         * @readonly\n         * @name hasDeviceOrientation\n         * @memberOf me.device\n         */\n        api.hasDeviceOrientation = false;\n\n        /**\n         * Browser full screen support\n         * @type Boolean\n         * @readonly\n         * @name hasFullscreenSupport\n         * @memberOf me.device\n         */\n        api.hasFullscreenSupport = false;\n\n         /**\n         * Browser pointerlock api support\n         * @type Boolean\n         * @readonly\n         * @name hasPointerLockSupport\n         * @memberOf me.device\n         */\n        api.hasPointerLockSupport = false;\n\n        /**\n         * Browser Base64 decoding capability\n         * @type Boolean\n         * @readonly\n         * @name nativeBase64\n         * @memberOf me.device\n         */\n        api.nativeBase64 = (typeof(window.atob) === \"function\");\n\n         /**\n         * Return the maximum number of touch contacts of current device.\n         * @type Number\n         * @readonly\n         * @name maxTouchPoints\n         * @memberOf me.device\n         */\n        api.maxTouchPoints = 0;\n\n        /**\n         * Touch capabilities\n         * @type Boolean\n         * @readonly\n         * @name touch\n         * @memberOf me.device\n         */\n        api.touch = false;\n\n        /**\n         * equals to true if a mobile device <br>\n         * (Android | iPhone | iPad | iPod | BlackBerry | Windows Phone | Kindle)\n         * @type Boolean\n         * @readonly\n         * @name isMobile\n         * @memberOf me.device\n         */\n        api.isMobile = false;\n\n        /**\n         * equals to true if the device is an iOS platform <br>\n         * @type Boolean\n         * @readonly\n         * @name iOS\n         * @memberOf me.device\n         */\n        api.iOS = false;\n\n        /**\n         * equals to true if the device is an Android platform <br>\n         * @type Boolean\n         * @readonly\n         * @name android\n         * @memberOf me.device\n         */\n        api.android = false;\n\n        /**\n         * equals to true if the device is an Android 2.x platform <br>\n         * @type Boolean\n         * @readonly\n         * @name android2\n         * @memberOf me.device\n         */\n        api.android2 = false;\n\n         /**\n         * equals to true if the device is a Windows Phone platform <br>\n         * @type Boolean\n         * @readonly\n         * @name wp\n         * @memberOf me.device\n         */\n        api.wp = false;\n\n        /**\n         * equals to true if the device is a BlackBerry platform <br>\n         * @type Boolean\n         * @readonly\n         * @name BlackBerry\n         * @memberOf me.device\n         */\n        api.BlackBerry = false;\n\n        /**\n         * equals to true if the device is a Kindle platform <br>\n         * @type Boolean\n         * @readonly\n         * @name Kindle\n         * @memberOf me.device\n         */\n        api.Kindle = false;\n\n        /**\n         * The device current orientation status. <br>\n         *   0 : default orientation<br>\n         *  90 : 90 degrees clockwise from default<br>\n         * -90 : 90 degrees anti-clockwise from default<br>\n         * 180 : 180 degrees from default\n         * @type Number\n         * @readonly\n         * @name orientation\n         * @memberOf me.device\n         */\n        api.orientation = 0;\n\n        /**\n         * contains the g-force acceleration along the x-axis.\n         * @public\n         * @type Number\n         * @readonly\n         * @name accelerationX\n         * @memberOf me.device\n         */\n        api.accelerationX = 0;\n\n        /**\n         * contains the g-force acceleration along the y-axis.\n         * @public\n         * @type Number\n         * @readonly\n         * @name accelerationY\n         * @memberOf me.device\n         */\n        api.accelerationY = 0;\n\n        /**\n         * contains the g-force acceleration along the z-axis.\n         * @public\n         * @type Number\n         * @readonly\n         * @name accelerationZ\n         * @memberOf me.device\n         */\n        api.accelerationZ = 0;\n\n        /**\n         * Device orientation Gamma property. Gives angle on tilting a portrait held phone left or right\n         * @public\n         * @type Number\n         * @readonly\n         * @name gamma\n         * @memberOf me.device\n         */\n        api.gamma = 0;\n\n        /**\n         * Device orientation Beta property. Gives angle on tilting a portrait held phone forward or backward\n         * @public\n         * @type Number\n         * @readonly\n         * @name beta\n         * @memberOf me.device\n         */\n        api.beta = 0;\n\n        /**\n         * Device orientation Alpha property. Gives angle based on the rotation of the phone around its z axis.\n         * The z-axis is perpendicular to the phone, facing out from the center of the screen.\n         * @public\n         * @type Number\n         * @readonly\n         * @name alpha\n         * @memberOf me.device\n         */\n        api.alpha = 0;\n\n        /**\n         * a string representing the preferred language of the user, usually the language of the browser UI.\n         * (will default to \"en\" if the information is not available)\n         * @public\n         * @type String\n         * @readonly\n         * @see http://www.w3schools.com/tags/ref_language_codes.asp\n         * @name language\n         * @memberOf me.device\n         */\n        api.language = navigator.language || navigator.browserLanguage || navigator.userLanguage || \"en\";\n\n        /**\n         * Triggers a fullscreen request. Requires fullscreen support from the browser/device.\n         * @name requestFullscreen\n         * @memberOf me.device\n         * @function\n         * @param {Object} [element=default canvas object] the element to be set in full-screen mode.\n         * @example\n         * // add a keyboard shortcut to toggle Fullscreen mode on/off\n         * me.input.bindKey(me.input.KEY.F, \"toggleFullscreen\");\n         * me.event.subscribe(me.event.KEYDOWN, function (action, keyCode, edge) {\n         *    // toggle fullscreen on/off\n         *    if (action === \"toggleFullscreen\") {\n         *       if (!me.device.isFullscreen) {\n         *          me.device.requestFullscreen();\n         *       } else {\n         *          me.device.exitFullscreen();\n         *       }\n         *    }\n         * });\n         */\n        api.requestFullscreen = function (element) {\n            if (this.hasFullscreenSupport) {\n                element = element || me.video.getWrapper();\n                element.requestFullscreen = me.agent.prefixed(\"requestFullscreen\", element) ||\n                                            element.mozRequestFullScreen;\n\n                element.requestFullscreen();\n            }\n        };\n\n        /**\n         * Exit fullscreen mode. Requires fullscreen support from the browser/device.\n         * @name exitFullscreen\n         * @memberOf me.device\n         * @function\n         */\n        api.exitFullscreen = function () {\n            if (this.hasFullscreenSupport) {\n                document.exitFullscreen();\n            }\n        };\n\n        /**\n         * return the device pixel ratio\n         * @name getPixelRatio\n         * @memberOf me.device\n         * @function\n         */\n        api.getPixelRatio = function () {\n\n            if (devicePixelRatio === null) {\n                var _context;\n                if (typeof me.video.renderer !== \"undefined\") {\n                    _context = me.video.renderer.getScreenContext();\n                } else {\n                    _context = me.Renderer.prototype.getContext2d(document.createElement(\"canvas\"));\n                }\n                var _devicePixelRatio = window.devicePixelRatio || 1,\n                    _backingStoreRatio = me.agent.prefixed(\"backingStorePixelRatio\", _context) || 1;\n                devicePixelRatio = _devicePixelRatio / _backingStoreRatio;\n            }\n            return devicePixelRatio;\n        };\n\n        /**\n         * return the device storage\n         * @name getStorage\n         * @memberOf me.device\n         * @function\n         * @param {String} [type=\"local\"]\n         * @return me.save object\n         */\n        api.getStorage = function (type) {\n\n            type = type || \"local\";\n\n            switch (type) {\n                case \"local\" :\n                    return me.save;\n\n                default :\n                    throw new me.Error(\"storage type \" + type + \" not supported\");\n            }\n        };\n\n        /**\n         * event management (Accelerometer)\n         * http://www.mobilexweb.com/samples/ball.html\n         * http://www.mobilexweb.com/blog/safari-ios-accelerometer-websockets-html5\n         * @ignore\n         */\n        function onDeviceMotion(e) {\n            if (e.reading) {\n                // For Windows 8 devices\n                api.accelerationX = e.reading.accelerationX;\n                api.accelerationY = e.reading.accelerationY;\n                api.accelerationZ = e.reading.accelerationZ;\n            }\n            else {\n                // Accelerometer information\n                api.accelerationX = e.accelerationIncludingGravity.x;\n                api.accelerationY = e.accelerationIncludingGravity.y;\n                api.accelerationZ = e.accelerationIncludingGravity.z;\n            }\n        }\n\n        function onDeviceRotate(e) {\n            api.gamma = e.gamma;\n            api.beta = e.beta;\n            api.alpha = e.alpha;\n        }\n\n        /**\n         * Enters pointer lock, requesting it from the user first. Works on supported devices & browsers\n         * Must be called in a click event or an event that requires user interaction.\n         * If you need to run handle events for errors or change of the pointer lock, see below.\n         * @name turnOnPointerLock\n         * @memberOf me.device\n         * @function\n         * @example\n         * document.addEventListener(\"pointerlockchange\", pointerlockchange, false);\n         * document.addEventListener(\"mozpointerlockchange\", pointerlockchange, false);\n         * document.addEventListener(\"webkitpointerlockchange\", pointerlockchange, false);\n         *\n         * document.addEventListener(\"pointerlockerror\", pointerlockerror, false);\n         * document.addEventListener(\"mozpointerlockerror\", pointerlockerror, false);\n         * document.addEventListener(\"webkitpointerlockerror\", pointerlockerror, false);\n         */\n        api.turnOnPointerLock = function () {\n            if (this.hasPointerLockSupport) {\n                var element = me.video.getWrapper();\n                if (me.device.ua.match(/Firefox/i)) {\n                    var fullscreenchange = function () {\n                        if ((me.agent.prefixed(\"fullscreenElement\", document) ||\n                            document.mozFullScreenElement) === element) {\n\n                            document.removeEventListener(\"fullscreenchange\", fullscreenchange);\n                            document.removeEventListener(\"mozfullscreenchange\", fullscreenchange);\n                            element.requestPointerLock = me.agent.prefixed(\"requestPointerLock\", element);\n                            element.requestPointerLock();\n                        }\n                    };\n\n                    document.addEventListener(\"fullscreenchange\", fullscreenchange, false);\n                    document.addEventListener(\"mozfullscreenchange\", fullscreenchange, false);\n\n                    me.device.requestFullscreen();\n\n                }\n                else {\n                    element.requestPointerLock();\n                }\n            }\n        };\n\n        /**\n         * Exits pointer lock. Works on supported devices & browsers\n         * @name turnOffPointerLock\n         * @memberOf me.device\n         * @function\n         */\n        api.turnOffPointerLock = function () {\n            if (this.hasPointerLockSupport) {\n                document.exitPointerLock();\n            }\n        };\n\n        /**\n         * watch Accelerator event\n         * @name watchAccelerometer\n         * @memberOf me.device\n         * @public\n         * @function\n         * @return {Boolean} false if not supported by the device\n         */\n        api.watchAccelerometer = function () {\n            if (me.device.hasAccelerometer) {\n                if (!accelInitialized) {\n                    if (typeof Windows === \"undefined\") {\n                        // add a listener for the devicemotion event\n                        window.addEventListener(\"devicemotion\", onDeviceMotion, false);\n                    }\n                    else {\n                        // On Windows 8 Device\n                        var accelerometer = Windows.Devices.Sensors.Accelerometer.getDefault();\n                        if (accelerometer) {\n                            // Capture event at regular intervals\n                            var minInterval = accelerometer.minimumReportInterval;\n                            var Interval = minInterval >= 16 ? minInterval : 25;\n                            accelerometer.reportInterval = Interval;\n\n                            accelerometer.addEventListener(\"readingchanged\", onDeviceMotion, false);\n                        }\n                    }\n                    accelInitialized = true;\n                }\n                return true;\n            }\n            return false;\n        };\n\n        /**\n         * unwatch Accelerometor event\n         * @name unwatchAccelerometer\n         * @memberOf me.device\n         * @public\n         * @function\n         */\n        api.unwatchAccelerometer = function () {\n            if (accelInitialized) {\n                if (typeof Windows === \"undefined\") {\n                    // add a listener for the mouse\n                    window.removeEventListener(\"devicemotion\", onDeviceMotion, false);\n                } else {\n                    // On Windows 8 Devices\n                    var accelerometer = Windows.Device.Sensors.Accelerometer.getDefault();\n\n                    accelerometer.removeEventListener(\"readingchanged\", onDeviceMotion, false);\n                }\n                accelInitialized = false;\n            }\n        };\n\n        /**\n         * watch the device orientation event\n         * @name watchDeviceOrientation\n         * @memberOf me.device\n         * @public\n         * @function\n         * @return {Boolean} false if not supported by the device\n         */\n        api.watchDeviceOrientation = function () {\n            if (me.device.hasDeviceOrientation && !deviceOrientationInitialized) {\n                window.addEventListener(\"deviceorientation\", onDeviceRotate, false);\n                deviceOrientationInitialized = true;\n            }\n            return false;\n        };\n\n        /**\n         * unwatch Device orientation event\n         * @name unwatchDeviceOrientation\n         * @memberOf me.device\n         * @public\n         * @function\n         */\n        api.unwatchDeviceOrientation = function () {\n            if (deviceOrientationInitialized) {\n                window.removeEventListener(\"deviceorientation\", onDeviceRotate, false);\n                deviceOrientationInitialized = false;\n            }\n        };\n\n        /**\n         * the vibrate method pulses the vibration hardware on the device, <br>\n         * If the device doesn't support vibration, this method has no effect. <br>\n         * If a vibration pattern is already in progress when this method is called,\n         * the previous pattern is halted and the new one begins instead.\n         * @name vibrate\n         * @memberOf me.device\n         * @public\n         * @function\n         * @param {Number|Number[]} pattern pattern of vibration and pause intervals\n         * @example\n         * // vibrate for 1000 ms\n         * navigator.vibrate(1000);\n         * // or alternatively\n         * navigator.vibrate([1000]);\n         * // vibrate for 50 ms, be still for 100 ms, and then vibrate for 150 ms:\n         * navigator.vibrate([50, 100, 150]);\n         * // cancel any existing vibrations\n         * navigator.vibrate(0);\n         */\n        api.vibrate = function (pattern) {\n            if (navigator.vibrate) {\n                navigator.vibrate(pattern);\n            }\n        };\n\n\n        return api;\n    })();\n\n    /**\n     * Returns true if the browser/device is in full screen mode.\n     * @name isFullscreen\n     * @memberOf me.device\n     * @public\n     * @type Boolean\n     * @readonly\n     * @return {boolean}\n     */\n    Object.defineProperty(me.device, \"isFullscreen\", {\n        get: function () {\n            if (me.device.hasFullscreenSupport) {\n                var el = me.agent.prefixed(\"fullscreenElement\", document) ||\n                         document.mozFullScreenElement;\n                return (el === me.video.getWrapper());\n            } else {\n                return false;\n            }\n        }\n    });\n\n    /**\n     * Returns true if the browser/device has audio capabilities.\n     * @name sound\n     * @memberOf me.device\n     * @public\n     * @type Boolean\n     * @readonly\n     * @return {boolean}\n     */\n    Object.defineProperty(me.device, \"sound\", {\n        get: function () {\n                return !Howler.noAudio;\n            }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n    /**\n     * a Timer object to manage time function (FPS, Game Tick, Time...)<p>\n     * There is no constructor function for me.timer\n     * @namespace me.timer\n     * @memberOf me\n     */\n    me.timer = (function () {\n        // hold public stuff in our api\n        var api = {};\n\n        /*\n         * PRIVATE STUFF\n         */\n\n        //hold element to display fps\n        var framecount = 0;\n        var framedelta = 0;\n\n        /* fps count stuff */\n        var last = 0;\n        var now = 0;\n        var delta = 0;\n        var step = Math.ceil(1000 / me.sys.fps); // ROUND IT ?\n        // define some step with some margin\n        var minstep = (1000 / me.sys.fps) * 1.25; // IS IT NECESSARY?\\\n\n        // list of defined timer function\n        var timers = [];\n        var timerId = 0;\n\n        /**\n         * @ignore\n         */\n        var clearTimer = function (timerId) {\n            for (var i = 0, len = timers.length; i < len; i++) {\n                if (timers[i].timerId === timerId) {\n                    timers.splice(i, 1);\n                    break;\n                }\n            }\n        };\n\n        /**\n         * update timers\n         * @ignore\n         */\n        var updateTimers = function (dt) {\n            for (var i = 0, len = timers.length; i < len; i++) {\n                var _timer = timers[i];\n                if (!(_timer.pauseable && me.state.isPaused())) {\n                    _timer.elapsed += dt;\n                }\n                if (_timer.elapsed >= _timer.delay) {\n                    _timer.fn.apply(this);\n                    if (_timer.repeat === true) {\n                        _timer.elapsed -= _timer.delay;\n                    } else {\n                        me.timer.clearTimeout(_timer.timerId);\n                    }\n                }\n            }\n        };\n\n        /*\n         * PUBLIC STUFF\n         */\n\n        /**\n         * Last game tick value.<br/>\n         * Use this value to scale velocities during frame drops due to slow\n         * hardware or when setting an FPS limit. (See {@link me.sys.fps})\n         * This feature is disabled by default. Enable me.sys.interpolation to\n         * use it.\n         * @public\n         * @see me.sys.interpolation\n         * @type Number\n         * @name tick\n         * @memberOf me.timer\n         */\n        api.tick = 1.0;\n\n        /**\n         * Last measured fps rate.<br/>\n         * This feature is disabled by default. Load and enable the DebugPanel\n         * plugin to use it.\n         * @public\n         * @type Number\n         * @name fps\n         * @memberOf me.timer\n         */\n        api.fps = 0;\n        \n        /**\n         * Last update time.<br/>\n         * Use this value to implement frame prediction in drawing events,\n         * for creating smooth motion while running game update logic at\n         * a lower fps.\n         * @public\n         * @type Date\n         * @name lastUpdate\n         * @memberOf me.timer\n         */\n        api.lastUpdate = window.performance.now();\n\n        /**\n         * init the timer\n         * @ignore\n         */\n        api.init = function () {\n            // reset variables to initial state\n            api.reset();\n            now = last = 0;\n        };\n\n        /**\n         * reset time (e.g. usefull in case of pause)\n         * @name reset\n         * @memberOf me.timer\n         * @ignore\n         * @function\n         */\n        api.reset = function () {\n            // set to \"now\"\n            last = now = window.performance.now();\n            delta = 0;\n            // reset delta counting variables\n            framedelta = 0;\n            framecount = 0;\n        };\n\n        /**\n         * Calls a function once after a specified delay.\n         * @name setTimeout\n         * @memberOf me.timer\n         * @param {Function} fn the function you want to execute after delay milliseconds.\n         * @param {Number} delay the number of milliseconds (thousandths of a second) that the function call should be delayed by.\n         * @param {Boolean} [pauseable=true] respects the pause state of the engine.\n         * @return {Number} The numerical ID of the timeout, which can be used later with me.timer.clearTimeout().\n         * @function\n         */\n        api.setTimeout = function (fn, delay, pauseable) {\n            timers.push({\n                fn : fn,\n                delay : delay,\n                elapsed : 0,\n                repeat : false,\n                timerId : ++timerId,\n                pauseable : pauseable === true || true\n            });\n            return timerId;\n        };\n\n        /**\n         * Calls a function at specified interval.\n         * @name setInterval\n         * @memberOf me.timer\n         * @param {Function} fn the function to execute\n         * @param {Number} delay the number of milliseconds (thousandths of a second) on how often to execute the function\n         * @param {Boolean} [pauseable=true] respects the pause state of the engine.\n         * @return {Number} The numerical ID of the timeout, which can be used later with me.timer.clearInterval().\n         * @function\n         */\n        api.setInterval = function (fn, delay, pauseable) {\n            timers.push({\n                fn : fn,\n                delay : delay,\n                elapsed : 0,\n                repeat : true,\n                timerId : ++timerId,\n                pauseable : pauseable === true || true\n            });\n            return timerId;\n        };\n\n        /**\n         * Clears the delay set by me.timer.setTimeout().\n         * @name clearTimeout\n         * @memberOf me.timer\n         * @function\n         * @param {Number} timeoutID ID of the timeout to be cleared\n         */\n        api.clearTimeout = function (timeoutID) {\n            clearTimer.defer(this, timeoutID);\n        };\n\n        /**\n         * Clears the Interval set by me.timer.setInterval().\n         * @name clearInterval\n         * @memberOf me.timer\n         * @function\n         * @param {Number} intervalID ID of the interval to be cleared\n         */\n        api.clearInterval = function (intervalID) {\n            clearTimer.defer(this, intervalID);\n        };\n\n        /**\n         * Return the current timestamp in milliseconds <br>\n         * since the game has started or since linux epoch (based on browser support for High Resolution Timer)\n         * @name getTime\n         * @memberOf me.timer\n         * @return {Number}\n         * @function\n         */\n        api.getTime = function () {\n            return now;\n        };\n\n        /**\n         * Return elapsed time in milliseconds since the last update<br>\n         * @name getDelta\n         * @memberOf me.timer\n         * @return {Number}\n         * @function\n         */\n        api.getDelta = function () {\n            return delta;\n        };\n\n        /**\n         * compute the actual frame time and fps rate\n         * @name computeFPS\n         * @ignore\n         * @memberOf me.timer\n         * @function\n         */\n        api.countFPS = function () {\n            framecount++;\n            framedelta += delta;\n            if (framecount % 10 === 0) {\n                this.fps = (~~((1000 * framecount) / framedelta)).clamp(0, me.sys.fps);\n                framedelta = 0;\n                framecount = 0;\n            }\n        };\n\n        /**\n         * update game tick\n         * should be called once a frame\n         * @param {Number} time current timestamp as provided by the RAF callback\n         * @return {Number} time elapsed since the last update\n         * @ignore\n         */\n        api.update = function (time) {\n            last = now;\n            now = time;\n            delta = (now - last);\n\n            // get the game tick\n            api.tick = (delta > minstep && me.sys.interpolation) ? delta / step : 1;\n\n            // update defined timers\n            updateTimers(delta);\n\n            return delta;\n        };\n\n        // return our apiect\n        return api;\n    })();\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n    /**\n     * A pool of Object entity <br>\n     * This object is used for object pooling - a technique that might speed up your game\n     * if used properly. <br>\n     * If some of your classes will be instantiated and removed a lot at a time, it is a\n     * good idea to add the class to this entity pool. A separate pool for that class\n     * will be created, which will reuse objects of the class. That way they won't be instantiated\n     * each time you need a new one (slowing your game), but stored into that pool and taking one\n     * already instantiated when you need it.<br><br>\n     * This object is also used by the engine to instantiate objects defined in the map,\n     * which means, that on level loading the engine will try to instantiate every object\n     * found in the map, based on the user defined name in each Object Properties<br>\n     * <img src=\"images/object_properties.png\"/><br>\n     * @namespace me.pool\n     * @memberOf me\n     */\n    me.pool = (function () {\n        // hold public stuff in our singleton\n        var api = {};\n\n        var entityClass = {};\n\n        /*\n         * PUBLIC STUFF\n         */\n\n        /**\n         * Constructor\n         * @ignore\n         */\n        api.init = function () {\n            // add default entity object\n            api.register(\"me.Entity\", me.Entity);\n            api.register(\"me.CollectableEntity\", me.CollectableEntity);\n            api.register(\"me.LevelEntity\", me.LevelEntity);\n            api.register(\"me.Tween\", me.Tween, true);\n            api.register(\"me.Color\", me.Color, true);\n            api.register(\"me.Particle\", me.Particle, true);\n            api.register(\"me.Sprite\", me.Sprite);\n            api.register(\"me.Vector2d\", me.Vector2d, true);\n        };\n\n        /**\n         * register an object to the pool. <br>\n         * Pooling must be set to true if more than one such objects will be created. <br>\n         * (note) If pooling is enabled, you shouldn't instantiate objects with `new`.\n         * See examples in {@link me.pool#pull}\n         * @name register\n         * @memberOf me.pool\n         * @public\n         * @function\n         * @param {String} className as defined in the Name field of the Object Properties (in Tiled)\n         * @param {Object} class corresponding Class to be instantiated\n         * @param {Boolean} [objectPooling=false] enables object pooling for the specified class\n         * - speeds up the game by reusing existing objects\n         * @example\n         * // add our users defined entities in the entity pool\n         * me.pool.register(\"playerspawnpoint\", PlayerEntity);\n         * me.pool.register(\"cherryentity\", CherryEntity, true);\n         * me.pool.register(\"heartentity\", HeartEntity, true);\n         * me.pool.register(\"starentity\", StarEntity, true);\n         */\n        api.register = function (className, entityObj, pooling) {\n            entityClass[className] = {\n                \"class\" : entityObj,\n                \"pool\" : (pooling ? [] : undefined)\n            };\n        };\n\n        /**\n         * Pull a new instance of the requested object (if added into the object pool)\n         * @name pull\n         * @memberOf me.pool\n         * @public\n         * @function\n         * @param {String} className as used in {@link me.pool.register}\n         * @param {} [arguments...] arguments to be passed when instantiating/reinitializing the object\n         * @return {Object} the instance of the requested object\n         * @example\n         * me.pool.register(\"player\", PlayerEntity);\n         * var player = me.pool.pull(\"player\");\n         * @example\n         * me.pool.register(\"bullet\", BulletEntity, true);\n         * me.pool.register(\"enemy\", EnemyEntity, true);\n         * // ...\n         * // when we need to manually create a new bullet:\n         * var bullet = me.pool.pull(\"bullet\", x, y, direction);\n         * // ...\n         * // params aren't a fixed number\n         * // when we need new enemy we can add more params, that the object construct requires:\n         * var enemy = me.pool.pull(\"enemy\", x, y, direction, speed, power, life);\n         * // ...\n         * // when we want to destroy existing object, the remove\n         * // function will ensure the object can then be reallocated later\n         * me.game.world.removeChild(enemy);\n         * me.game.world.removeChild(bullet);\n         */\n        api.pull = function (name) {\n            var args = new Array(arguments.length);\n            for (var i = 0; i < arguments.length; i++) {\n                args[i] = arguments[i];\n            }\n            var entity = entityClass[name];\n            if (entity) {\n                var proto = entity[\"class\"],\n                    pool = entity.pool,\n                    obj;\n\n                if (pool && ((obj = pool.pop()))) {\n                    args.shift();\n                    // call the object onResetEvent function if defined\n                    if (typeof(obj.onResetEvent) === \"function\") {\n                        obj.onResetEvent.apply(obj, args);\n                    }\n                    else {\n                        obj.init.apply(obj, args);\n                    }\n                }\n                else {\n                    args[0] = proto;\n                    obj = new (proto.bind.apply(proto, args))();\n                    if (pool) {\n                        obj.className = name;\n                    }\n                }\n                return obj;\n            }\n\n            throw new me.Error(\"Cannot instantiate entity of type '\" + name + \"'\");\n        };\n\n        /**\n         * purge the entity pool from any inactive object <br>\n         * Object pooling must be enabled for this function to work<br>\n         * note: this will trigger the garbage collector\n         * @name purge\n         * @memberOf me.pool\n         * @public\n         * @function\n         */\n        api.purge = function () {\n            for (var className in entityClass) {\n                if (entityClass[className]) {\n                    entityClass[className].pool = [];\n                }\n            }\n        };\n\n        /**\n         * Push back an object instance into the entity pool <br>\n         * Object pooling for the object class must be enabled,\n         * and object must have been instantiated using {@link me.pool#pull},\n         * otherwise this function won't work\n         * @name push\n         * @memberOf me.pool\n         * @public\n         * @function\n         * @param {Object} instance to be recycled\n         */\n        api.push = function (obj) {\n            var name = obj.className;\n            if (typeof(name) === \"undefined\" || !entityClass[name]) {\n                // object is not registered, don't do anything\n                return;\n            }\n            // store back the object instance for later recycling\n            entityClass[name].pool.push(obj);\n        };\n\n        /**\n         * Check if an object with the provided name is registered\n         * @name exists\n         * @memberOf me.pool\n         * @public\n         * @function\n         * @param {String} name of the registered object\n         * @return {Boolean} true if the classname is registered\n         */\n        api.exists = function (name) {\n            return name in entityClass;\n        };\n\n        // return our object\n        return api;\n    })();\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n    /**\n     * a generic 2D Vector Object\n     * @class\n     * @extends Object\n     * @memberOf me\n     * @constructor\n     * @param {Number} [x=0] x value of the vector\n     * @param {Number} [y=0] y value of the vector\n     */\n    me.Vector2d = me.Object.extend(\n    /** @scope me.Vector2d.prototype */\n    {\n        /** @ignore */\n        init : function (x, y) {\n            return this.set(x || 0, y || 0);\n        },\n        \n        /** \n         * @ignore */\n        _set : function (x, y) {\n            this.x = x;\n            this.y = y;\n            return this;\n        },\n\n        /**\n         * set the Vector x and y properties to the given values<br>\n         * @name set\n         * @memberOf me.Vector2d\n         * @function\n         * @param {Number} x\n         * @param {Number} y\n         * @return {me.Vector2d} Reference to this object for method chaining\n         */\n        set : function (x, y) {\n            if (x !== +x || y !== +y) {\n                throw new me.Vector2d.Error(\n                    \"invalid x,y parameters (not a number)\"\n                );\n            }\n\n            /**\n             * x value of the vector\n             * @public\n             * @type Number\n             * @name x\n             * @memberOf me.Vector2d\n             */\n            //this.x = x;\n\n            /**\n             * y value of the vector\n             * @public\n             * @type Number\n             * @name y\n             * @memberOf me.Vector2d\n             */\n            //this.y = y;\n\n            return this._set(x, y);\n        },\n\n        /**\n         * set the Vector x and y properties to 0\n         * @name setZero\n         * @memberOf me.Vector2d\n         * @function\n         * @return {me.Vector2d} Reference to this object for method chaining\n         */\n        setZero : function () {\n            return this.set(0, 0);\n        },\n\n        /**\n         * set the Vector x and y properties using the passed vector\n         * @name setV\n         * @memberOf me.Vector2d\n         * @function\n         * @param {me.Vector2d} v\n         * @return {me.Vector2d} Reference to this object for method chaining\n         */\n        setV : function (v) {\n            return this._set(v.x, v.y);\n        },\n\n        /**\n         * Add the passed vector to this vector\n         * @name add\n         * @memberOf me.Vector2d\n         * @function\n         * @param {me.Vector2d} v\n         * @return {me.Vector2d} Reference to this object for method chaining\n         */\n        add : function (v) {\n            return this._set(this.x + v.x, this.y + v.y);\n        },\n\n        /**\n         * Substract the passed vector to this vector\n         * @name sub\n         * @memberOf me.Vector2d\n         * @function\n         * @param {me.Vector2d} v\n         * @return {me.Vector2d} Reference to this object for method chaining\n         */\n        sub : function (v) {\n            return this._set(this.x - v.x, this.y - v.y);\n        },\n\n        /**\n         * Multiply this vector values by the given scalar\n         * @name scale\n         * @memberOf me.Vector2d\n         * @function\n         * @param {Number} x\n         * @param {Number} [y=x]\n         * @return {me.Vector2d} Reference to this object for method chaining\n         */\n        scale : function (x, y) {\n            return this._set(this.x * x, this.y * (typeof (y) !== \"undefined\" ? y : x));\n        },\n\n        /**\n         * Multiply this vector values by the passed vector\n         * @name scaleV\n         * @memberOf me.Vector2d\n         * @function\n         * @param {me.Vector2d} v\n         * @return {me.Vector2d} Reference to this object for method chaining\n         */\n        scaleV : function (v) {\n            return this._set(this.x * v.x, this.y * v.y);\n        },\n\n        /**\n         * Divide this vector values by the passed value\n         * @name div\n         * @memberOf me.Vector2d\n         * @function\n         * @param {Number} value\n         * @return {me.Vector2d} Reference to this object for method chaining\n         */\n        div : function (n) {\n            return this._set(this.x / n, this.y / n);\n        },\n\n        /**\n         * Update this vector values to absolute values\n         * @name abs\n         * @memberOf me.Vector2d\n         * @function\n         * @return {me.Vector2d} Reference to this object for method chaining\n         */\n        abs : function () {\n            return this._set((this.x < 0) ? -this.x : this.x, (this.y < 0) ? -this.y : this.y);\n        },\n\n        /**\n         * Clamp the vector value within the specified value range\n         * @name clamp\n         * @memberOf me.Vector2d\n         * @function\n         * @param {Number} low\n         * @param {Number} high\n         * @return {me.Vector2d} new me.Vector2d\n         */\n        clamp : function (low, high) {\n            return new me.Vector2d(this.x.clamp(low, high), this.y.clamp(low, high));\n        },\n\n        /**\n         * Clamp this vector value within the specified value range\n         * @name clampSelf\n         * @memberOf me.Vector2d\n         * @function\n         * @param {Number} low\n         * @param {Number} high\n         * @return {me.Vector2d} Reference to this object for method chaining\n         */\n        clampSelf : function (low, high) {\n            return this._set(this.x.clamp(low, high), this.y.clamp(low, high));\n        },\n\n        /**\n         * Update this vector with the minimum value between this and the passed vector\n         * @name minV\n         * @memberOf me.Vector2d\n         * @function\n         * @param {me.Vector2d} v\n         * @return {me.Vector2d} Reference to this object for method chaining\n         */\n        minV : function (v) {\n            return this._set((this.x < v.x) ? this.x : v.x, (this.y < v.y) ? this.y : v.y);\n        },\n\n        /**\n         * Update this vector with the maximum value between this and the passed vector\n         * @name maxV\n         * @memberOf me.Vector2d\n         * @function\n         * @param {me.Vector2d} v\n         * @return {me.Vector2d} Reference to this object for method chaining\n         */\n        maxV : function (v) {\n            return this._set((this.x > v.x) ? this.x : v.x, (this.y > v.y) ? this.y : v.y);\n        },\n\n        /**\n         * Floor the vector values\n         * @name floor\n         * @memberOf me.Vector2d\n         * @function\n         * @return {me.Vector2d} new me.Vector2d\n         */\n        floor : function () {\n            return new me.Vector2d(Math.floor(this.x), Math.floor(this.y));\n        },\n\n        /**\n         * Floor this vector values\n         * @name floorSelf\n         * @memberOf me.Vector2d\n         * @function\n         * @return {me.Vector2d} Reference to this object for method chaining\n         */\n        floorSelf : function () {\n            return this._set(Math.floor(this.x), Math.floor(this.y));\n        },\n\n        /**\n         * Ceil the vector values\n         * @name ceil\n         * @memberOf me.Vector2d\n         * @function\n         * @return {me.Vector2d} new me.Vector2d\n         */\n        ceil : function () {\n            return new me.Vector2d(Math.ceil(this.x), Math.ceil(this.y));\n        },\n\n        /**\n         * Ceil this vector values\n         * @name ceilSelf\n         * @memberOf me.Vector2d\n         * @function\n         * @return {me.Vector2d} Reference to this object for method chaining\n         */\n        ceilSelf : function () {\n            return this._set(Math.ceil(this.x), Math.ceil(this.y));\n        },\n\n        /**\n         * Negate the vector values\n         * @name negate\n         * @memberOf me.Vector2d\n         * @function\n         * @return {me.Vector2d} new me.Vector2d\n         */\n        negate : function () {\n            return new me.Vector2d(-this.x, -this.y);\n        },\n\n        /**\n         * Negate this vector values\n         * @name negateSelf\n         * @memberOf me.Vector2d\n         * @function\n         * @return {me.Vector2d} Reference to this object for method chaining\n         */\n        negateSelf : function () {\n            return this._set(-this.x, -this.y);\n        },\n\n        /**\n         * Copy the x,y values of the passed vector to this one\n         * @name copy\n         * @memberOf me.Vector2d\n         * @function\n         * @param {me.Vector2d} v\n         * @return {me.Vector2d} Reference to this object for method chaining\n         */\n        copy : function (v) {\n            return this._set(v.x, v.y);\n        },\n\n        /**\n         * return true if the two vectors are the same\n         * @name equals\n         * @memberOf me.Vector2d\n         * @function\n         * @param {me.Vector2d} v\n         * @return {Boolean}\n         */\n        equals : function (v) {\n            return ((this.x === v.x) && (this.y === v.y));\n        },\n\n        /**\n         * normalize this vector (scale the vector so that its magnitude is 1)\n         * @name normalize\n         * @memberOf me.Vector2d\n         * @function\n         * @return {me.Vector2d} Reference to this object for method chaining\n         */\n        normalize : function () {\n            var d = this.length();\n            if (d > 0) {\n                return this._set(this.x / d, this.y / d);\n            }\n            return this;\n        },\n\n        /**\n         * change this vector to be perpendicular to what it was before.<br>\n         * (Effectively rotates it 90 degrees in a clockwise direction)\n         * @name perp\n         * @memberOf me.Vector2d\n         * @function\n         * @return {me.Vector2d} Reference to this object for method chaining\n         */\n        perp : function () {\n            return this._set(this.y, -this.x);\n        },\n\n        /**\n         * Rotate this vector (counter-clockwise) by the specified angle (in radians).\n         * @name rotate\n         * @memberOf me.Vector2d\n         * @function\n         * @param {number} angle The angle to rotate (in radians)\n         * @return {me.Vector2d} Reference to this object for method chaining\n         */\n        rotate : function (angle) {\n            var x = this.x;\n            var y = this.y;\n            return this._set(x * Math.cos(angle) - y * Math.sin(angle), x * Math.sin(angle) + y * Math.cos(angle));\n        },\n\n        /**\n         * return the dot product of this vector and the passed one\n         * @name dotProduct\n         * @memberOf me.Vector2d\n         * @function\n         * @param {me.Vector2d} v\n         * @return {Number} The dot product.\n         */\n        dotProduct : function (v) {\n            return this.x * v.x + this.y * v.y;\n        },\n\n       /**\n         * return the square length of this vector\n         * @name length2\n         * @memberOf me.Vector2d\n         * @function\n         * @return {Number} The length^2 of this vector.\n         */\n        length2 : function () {\n            return this.dotProduct(this);\n        },\n\n        /**\n         * return the length (magnitude) of this vector\n         * @name length\n         * @memberOf me.Vector2d\n         * @function\n         * @return {Number} the length of this vector\n         */\n        length : function () {\n            return Math.sqrt(this.length2());\n        },\n\n        /**\n         * return the distance between this vector and the passed one\n         * @name distance\n         * @memberOf me.Vector2d\n         * @function\n         * @param {me.Vector2d} v\n         * @return {Number}\n         */\n        distance : function (v) {\n            var dx = this.x - v.x, dy = this.y - v.y;\n            return Math.sqrt(dx * dx + dy * dy);\n        },\n\n        /**\n         * return the angle between this vector and the passed one\n         * @name angle\n         * @memberOf me.Vector2d\n         * @function\n         * @param {me.Vector2d} v\n         * @return {Number} angle in radians\n         */\n        angle : function (v) {\n            return Math.acos((this.dotProduct(v) / (this.length() * v.length())).clamp(-1, 1));\n        },\n\n        /**\n         * project this vector on to another vector.\n         * @name project\n         * @memberOf me.Vector2d\n         * @function\n         * @param {me.Vector2d} v The vector to project onto.\n         * @return {me.Vector2d} Reference to this object for method chaining\n         */\n        project : function (v) {\n            return this.scale(this.dotProduct(v) / v.length2());\n        },\n\n        /**\n         * Project this vector onto a vector of unit length.<br>\n         * This is slightly more efficient than `project` when dealing with unit vectors.\n         * @name projectN\n         * @memberOf me.Vector2d\n         * @function\n         * @param {me.Vector2d} v The unit vector to project onto.\n         * @return {me.Vector2d} Reference to this object for method chaining\n         */\n        projectN : function (v) {\n            return this.scale(this.dotProduct(v));\n        },\n\n        /**\n         * return a clone copy of this vector\n         * @name clone\n         * @memberOf me.Vector2d\n         * @function\n         * @return {me.Vector2d} new me.Vector2d\n         */\n        clone : function () {\n            return new me.Vector2d(this.x, this.y);\n        },\n\n        /**\n         * convert the object to a string representation\n         * @name toString\n         * @memberOf me.Vector2d\n         * @function\n         * @return {String}\n         */\n        toString : function () {\n            return \"x:\" + this.x + \",y:\" + this.y;\n        }\n    });\n\n    /**\n     * Base class for Vector2d exception handling.\n     * @name Error\n     * @class\n     * @memberOf me.Vector2d\n     * @constructor\n     * @param {String} msg Error message.\n     */\n    me.Vector2d.Error = me.Error.extend({\n        init : function (msg) {\n            me.Error.prototype.init.apply(this, [ msg ]);\n            this.name = \"me.Vector2d.Error\";\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n    /**\n     * a generic 3D Vector Object\n     * @class\n     * @extends Object\n     * @memberOf me\n     * @constructor\n     * @param {Number} [x=0] x value of the vector\n     * @param {Number} [y=0] y value of the vector\n     * @param {Number} [z=0] z value of the vector\n     */\n    me.Vector3d = me.Object.extend(\n    /** @scope me.Vector3d.prototype */\n    {\n        /** @ignore */\n        init : function (x, y, z) {\n            return this.set(x || 0, y || 0, z || 0);\n        },\n        \n        /** \n         * @ignore */\n        _set : function (x, y, z) {\n            this.x = x;\n            this.y = y;\n            this.z = z;\n            return this;\n        },\n\n        /**\n         * set the Vector x and y properties to the given values<br>\n         * @name set\n         * @memberOf me.Vector3d\n         * @function\n         * @param {Number} x\n         * @param {Number} y\n         * @param {Number} z\n         * @return {me.Vector3d} Reference to this object for method chaining\n         */\n        set : function (x, y, z) {\n            if (x !== +x || y !== +y || z !== +z) {\n                throw new me.Vector3d.Error(\n                    \"invalid x, y, z parameters (not a number)\"\n                );\n            }\n\n            /**\n             * x value of the vector\n             * @public\n             * @type Number\n             * @name x\n             * @memberOf me.Vector3d\n             */\n            //this.x = x;\n\n            /**\n             * y value of the vector\n             * @public\n             * @type Number\n             * @name y\n             * @memberOf me.Vector3d\n             */\n            //this.y = y;\n\n            /**\n             * z value of the vector\n             * @public\n             * @type Number\n             * @name z\n             * @memberOf me.Vector3d\n             */\n            //this.z = z;\n            \n            return this._set(x, y, z);\n        },\n\n        /**\n         * set the Vector x and y properties to 0\n         * @name setZero\n         * @memberOf me.Vector3d\n         * @function\n         * @return {me.Vector3d} Reference to this object for method chaining\n         */\n        setZero : function () {\n            return this.set(0, 0, 0);\n        },\n\n        /**\n         * set the Vector x and y properties using the passed vector\n         * @name setV\n         * @memberOf me.Vector3d\n         * @function\n         * @param {me.Vector2d|me.Vector3d} v\n         * @return {me.Vector3d} Reference to this object for method chaining\n         */\n        setV : function (v) {\n            return this._set(v.x, v.y, typeof (v.z) !== \"undefined\" ? v.z : this.z);\n        },\n\n        /**\n         * Add the passed vector to this vector\n         * @name add\n         * @memberOf me.Vector3d\n         * @function\n         * @param {me.Vector2d|me.Vector3d} v\n         * @return {me.Vector3d} Reference to this object for method chaining\n         */\n        add : function (v) {\n            return this._set(this.x + v.x, this.y + v.y, this.z + (v.z || 0));\n        },\n\n        /**\n         * Substract the passed vector to this vector\n         * @name sub\n         * @memberOf me.Vector3d\n         * @function\n         * @param {me.Vector2d|me.Vector3d} v\n         * @return {me.Vector3d} Reference to this object for method chaining\n         */\n        sub : function (v) {\n            return this._set(this.x - v.x, this.y - v.y, this.z - (v.z || 0));\n        },\n\n        /**\n         * Multiply this vector values by the given scalar\n         * @name scale\n         * @memberOf me.Vector3d\n         * @function\n         * @param {Number} x\n         * @param {Number} [y=x]\n         * @param {Number} [z=x]\n         * @return {me.Vector3d} Reference to this object for method chaining\n         */\n        scale : function (x, y, z) {\n            y = (typeof (y) !== \"undefined\" ? y : x);\n            z = (typeof (z) !== \"undefined\" ? z : x);\n            return this._set(this.x * x, this.y * y, this.z * z);\n        },\n\n        /**\n         * Multiply this vector values by the passed vector\n         * @name scaleV\n         * @memberOf me.Vector3d\n         * @function\n         * @param {me.Vector2d|me.Vector3d} v\n         * @return {me.Vector3d} Reference to this object for method chaining\n         */\n        scaleV : function (v) {\n            return this._set(this.x * v.x, this.y * v.y, this.z * (v.z || 1));\n        },\n\n        /**\n         * Divide this vector values by the passed value\n         * @name div\n         * @memberOf me.Vector3d\n         * @function\n         * @param {Number} value\n         * @return {me.Vector3d} Reference to this object for method chaining\n         */\n        div : function (n) {\n            return this._set(this.x / n, this.y / n, this.z / n);\n        },\n\n        /**\n         * Update this vector values to absolute values\n         * @name abs\n         * @memberOf me.Vector3d\n         * @function\n         * @return {me.Vector3d} Reference to this object for method chaining\n         */\n        abs : function () {\n            return this._set((this.x < 0) ? -this.x : this.x, (this.y < 0) ? -this.y : this.y, (this.z < 0) ? -this.Z : this.z);\n        },\n\n        /**\n         * Clamp the vector value within the specified value range\n         * @name clamp\n         * @memberOf me.Vector3d\n         * @function\n         * @param {Number} low\n         * @param {Number} high\n         * @return {me.Vector3d} new me.Vector3d\n         */\n        clamp : function (low, high) {\n            return new me.Vector3d(this.x.clamp(low, high), this.y.clamp(low, high), this.z.clamp(low, high));\n        },\n\n        /**\n         * Clamp this vector value within the specified value range\n         * @name clampSelf\n         * @memberOf me.Vector3d\n         * @function\n         * @param {Number} low\n         * @param {Number} high\n         * @return {me.Vector3d} Reference to this object for method chaining\n         */\n        clampSelf : function (low, high) {\n            return this._set(this.x.clamp(low, high), this.y.clamp(low, high), this.z.clamp(low, high));\n        },\n\n        /**\n         * Update this vector with the minimum value between this and the passed vector\n         * @name minV\n         * @memberOf me.Vector3d\n         * @function\n         * @param {me.Vector2d|me.Vector3d} v\n         * @return {me.Vector3d} Reference to this object for method chaining\n         */\n        minV : function (v) {\n            var _vz = v.z || 0;\n            return this._set((this.x < v.x) ? this.x : v.x, (this.y < v.y) ? this.y : v.y, (this.z < _vz) ? this.z : _vz);\n        },\n\n        /**\n         * Update this vector with the maximum value between this and the passed vector\n         * @name maxV\n         * @memberOf me.Vector3d\n         * @function\n         * @param {me.Vector2d|me.Vector3d} v\n         * @return {me.Vector3d} Reference to this object for method chaining\n         */\n        maxV : function (v) {\n            var _vz = v.z || 0;\n            return this._set((this.x > v.x) ? this.x : v.x, (this.y > v.y) ? this.y : v.y, (this.z > _vz) ? this.z : _vz);\n        },\n\n        /**\n         * Floor the vector values\n         * @name floor\n         * @memberOf me.Vector3d\n         * @function\n         * @return {me.Vector3d} new me.Vector3d\n         */\n        floor : function () {\n            return new me.Vector3d(Math.floor(this.x), Math.floor(this.y), Math.floor(this.z));\n        },\n\n        /**\n         * Floor this vector values\n         * @name floorSelf\n         * @memberOf me.Vector3d\n         * @function\n         * @return {me.Vector3d} Reference to this object for method chaining\n         */\n        floorSelf : function () {\n            return this._set(Math.floor(this.x), Math.floor(this.y), Math.floor(this.z));\n        },\n\n        /**\n         * Ceil the vector values\n         * @name ceil\n         * @memberOf me.Vector3d\n         * @function\n         * @return {me.Vector3d} new me.Vector3d\n         */\n        ceil : function () {\n            return new me.Vector3d(Math.ceil(this.x), Math.ceil(this.y), Math.ceil(this.z));\n        },\n\n        /**\n         * Ceil this vector values\n         * @name ceilSelf\n         * @memberOf me.Vector3d\n         * @function\n         * @return {me.Vector3d} Reference to this object for method chaining\n         */\n        ceilSelf : function () {\n            return this._set(Math.ceil(this.x), Math.ceil(this.y), Math.ceil(this.z));\n        },\n\n        /**\n         * Negate the vector values\n         * @name negate\n         * @memberOf me.Vector3d\n         * @function\n         * @return {me.Vector3d} new me.Vector3d\n         */\n        negate : function () {\n            return new me.Vector3d(-this.x, -this.y, -this.z);\n        },\n\n        /**\n         * Negate this vector values\n         * @name negateSelf\n         * @memberOf me.Vector3d\n         * @function\n         * @return {me.Vector3d} Reference to this object for method chaining\n         */\n        negateSelf : function () {\n            return this._set(-this.x, -this.y, -this.z);\n        },\n\n        /**\n         * Copy the x,y values of the passed vector to this one\n         * @name copy\n         * @memberOf me.Vector3d\n         * @function\n         * @param {me.Vector2d|me.Vector3d} v\n         * @return {me.Vector3d} Reference to this object for method chaining\n         */\n        copy : function (v) {\n            return this._set(v.x, v.y, typeof (v.z) !== \"undefined\" ? v.z : this.z);\n        },\n\n        /**\n         * return true if the two vectors are the same\n         * @name equals\n         * @memberOf me.Vector3d\n         * @function\n         * @param {me.Vector2d|me.Vector3d} v\n         * @return {Boolean}\n         */\n        equals : function (v) {\n            return ((this.x === v.x) && (this.y === v.y) && (this.z === (v.z || this.z)));\n        },\n\n        /**\n         * normalize this vector (scale the vector so that its magnitude is 1)\n         * @name normalize\n         * @memberOf me.Vector3d\n         * @function\n         * @return {me.Vector3d} Reference to this object for method chaining\n         */\n        normalize : function () {\n            var d = this.length();\n            if (d > 0) {\n                return this._set(this.x / d, this.y / d, this.z / d);\n            }\n            return this;\n        },\n\n        /**\n         * change this vector to be perpendicular to what it was before.<br>\n         * (Effectively rotates it 90 degrees in a clockwise direction around the z axis)\n         * @name perp\n         * @memberOf me.Vector3d\n         * @function\n         * @return {me.Vector3d} Reference to this object for method chaining\n         */\n        perp : function () {\n            return this._set(this.y, -this.x, this.z);\n        },\n\n        /**\n         * Rotate this vector (counter-clockwise) by the specified angle (in radians) around the z axis\n         * @name rotate\n         * @memberOf me.Vector3d\n         * @function\n         * @param {number} angle The angle to rotate (in radians)\n         * @return {me.Vector3d} Reference to this object for method chaining\n         */\n        rotate : function (angle) {\n            var x = this.x;\n            var y = this.y;\n            return this._set(x * Math.cos(angle) - y * Math.sin(angle), x * Math.sin(angle) + y * Math.cos(angle), this.z);\n        },\n\n        /**\n         * return the dot product of this vector and the passed one\n         * @name dotProduct\n         * @memberOf me.Vector3d\n         * @function\n         * @param {me.Vector2d|me.Vector3d} v\n         * @return {Number} The dot product.\n         */\n        dotProduct : function (v) {\n            return this.x * v.x + this.y * v.y + this.z * (v.z || 1);\n        },\n\n       /**\n         * return the square length of this vector\n         * @name length2\n         * @memberOf me.Vector3d\n         * @function\n         * @return {Number} The length^2 of this vector.\n         */\n        length2 : function () {\n            return this.dotProduct(this);\n        },\n\n        /**\n         * return the length (magnitude) of this vector\n         * @name length\n         * @memberOf me.Vector3d\n         * @function\n         * @return {Number} the length of this vector\n         */\n        length : function () {\n            return Math.sqrt(this.length2());\n        },\n\n        /**\n         * return the distance between this vector and the passed one\n         * @name distance\n         * @memberOf me.Vector3d\n         * @function\n         * @param {me.Vector2d|me.Vector3d} v\n         * @return {Number}\n         */\n        distance : function (v) {\n            var dx = this.x - v.x, dy = this.y - v.y, dz = this.z - (v.z || 0);\n            return Math.sqrt(dx * dx + dy * dy + dz * dz);\n        },\n\n        /**\n         * return the angle between this vector and the passed one\n         * @name angle\n         * @memberOf me.Vector3d\n         * @function\n         * @param {me.Vector2d|me.Vector3d} v\n         * @return {Number} angle in radians\n         */\n        angle : function (v) {\n            return Math.acos((this.dotProduct(v) / (this.length() * v.length())).clamp(-1, 1));\n        },\n\n        /**\n         * project this vector on to another vector.\n         * @name project\n         * @memberOf me.Vector3d\n         * @function\n         * @param {me.Vector2d|me.Vector3d} v The vector to project onto.\n         * @return {me.Vector3d} Reference to this object for method chaining\n         */\n        project : function (v) {\n            return this.scale(this.dotProduct(v) / v.length2());\n        },\n\n        /**\n         * Project this vector onto a vector of unit length.<br>\n         * This is slightly more efficient than `project` when dealing with unit vectors.\n         * @name projectN\n         * @memberOf me.Vector3d\n         * @function\n         * @param {me.Vector2d|me.Vector3d} v The unit vector to project onto.\n         * @return {me.Vector3d} Reference to this object for method chaining\n         */\n        projectN : function (v) {\n            return this.scale(this.dotProduct(v));\n        },\n\n        /**\n         * return a clone copy of this vector\n         * @name clone\n         * @memberOf me.Vector3d\n         * @function\n         * @return {me.Vector3d} new me.Vector3d\n         */\n        clone : function () {\n            return new me.Vector3d(this.x, this.y, this.z);\n        },\n\n        /**\n         * convert the object to a string representation\n         * @name toString\n         * @memberOf me.Vector3d\n         * @function\n         * @return {String}\n         */\n        toString : function () {\n            return \"x:\" + this.x + \",y:\" + this.y + \",z:\" + this.z;\n        }\n    });\n\n    /**\n     * Base class for Vector3d exception handling.\n     * @name Error\n     * @class\n     * @memberOf me.Vector3d\n     * @constructor\n     * @param {String} msg Error message.\n     */\n    me.Vector3d.Error = me.Error.extend({\n        init : function (msg) {\n            me.Error.prototype.init.apply(this, [ msg ]);\n            this.name = \"me.Vector3d.Error\";\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n    /**\n     * A Vector2d object that provide notification by executing the given callback when the vector is changed.\n     * @class\n     * @extends me.Vector2d\n     * @constructor\n     * @param {Number} [x=0] x value of the vector\n     * @param {Number} [y=0] y value of the vector\n     * @param {Object} settings additional required parameters\n     * @param {Function} settings.onUpdate the callback to be executed when the vector is changed\n     */\n    me.ObservableVector2d = me.Vector2d.extend({\n    /** @scope me.ObservableVector2d.prototype */\n\n        /** @ignore */\n        init : function (x, y, settings) {\n            /**\n             * x value of the vector\n             * @public\n             * @type Number\n             * @name x\n             * @memberOf me.ObservableVector2d\n             */\n            Object.defineProperty(this, \"x\", {\n                get : function () {\n                    return this._x;\n                },\n\n                set : function (value) {\n                    this.onUpdate(value, this._y, this._x, this._y);\n                    this._x = value;\n                }\n            });\n\n            /**\n             * y value of the vector\n             * @public\n             * @type Number\n             * @name y\n             * @memberOf me.ObservableVector2d\n             */\n            Object.defineProperty(this, \"y\", {\n                get : function () {\n                    return this._y;\n                },\n\n                set : function (value) {\n                    this.onUpdate(this._x, value, this._x, this._y);\n                    this._y = value;\n                }\n            });\n\n            if (typeof(settings) === \"undefined\") {\n                throw new me.ObservableVector2d.Error(\n                    \"undefined `onUpdate` callback\"\n                );\n            }\n            this.setCallback(settings.onUpdate);\n            this._x = x || 0;\n            this._y = y || 0;\n        },\n\n        /** @ignore */\n        _set : function (x, y) {\n            this.onUpdate(x, y, this._x, this._y);\n            this._x = x;\n            this._y = y;\n            return this;\n        },\n\n        /**\n         * set the vector value without triggering the callback\n         * @name setMuted\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @param {Number} x x value of the vector\n         * @param {Number} y y value of the vector\n         * @return {me.ObservableVector2d} Reference to this object for method chaining\n         */\n        setMuted : function (x, y) {\n            this._x = x;\n            this._y = y;\n            return this;\n        },\n        \n        /**\n         * set the callback to be executed when the vector is changed\n         * @name setCallback\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @param {function} onUpdate callback\n         * @return {me.ObservableVector2d} Reference to this object for method chaining\n         */\n        setCallback : function (fn) {\n            if (typeof(fn) !== \"function\") {\n                throw new me.ObservableVector2d.Error(\n                    \"invalid `onUpdate` callback\"\n                );\n            }\n            this.onUpdate = fn;\n            return this;\n        },\n        \n        /**\n         * Add the passed vector to this vector\n         * @name add\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @param {me.ObservableVector2d} v\n         * @return {me.ObservableVector2d} Reference to this object for method chaining\n         */\n        add : function (v) {\n            return this._set(this._x + v.x, this._y + v.y);\n        },\n\n        /**\n         * Substract the passed vector to this vector\n         * @name sub\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @param {me.ObservableVector2d} v\n         * @return {me.ObservableVector2d} Reference to this object for method chaining\n         */\n        sub : function (v) {\n            return this._set(this._x - v.x, this._y - v.y);\n        },\n\n        /**\n         * Multiply this vector values by the given scalar\n         * @name scale\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @param {Number} x\n         * @param {Number} [y=x]\n         * @return {me.ObservableVector2d} Reference to this object for method chaining\n         */\n        scale : function (x, y) {\n            return this._set(this._x * x, this._y * (typeof (y) !== \"undefined\" ? y : x));\n        },\n\n        /**\n         * Multiply this vector values by the passed vector\n         * @name scaleV\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @param {me.ObservableVector2d} v\n         * @return {me.ObservableVector2d} Reference to this object for method chaining\n         */\n        scaleV : function (v) {\n            return this._set(this._x * v.x, this._y * v.y);\n        },\n\n        /**\n         * Divide this vector values by the passed value\n         * @name div\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @param {Number} value\n         * @return {me.ObservableVector2d} Reference to this object for method chaining\n         */\n        div : function (n) {\n            return this._set(this._x / n, this._y / n);\n        },\n\n        /**\n         * Update this vector values to absolute values\n         * @name abs\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @return {me.ObservableVector2d} Reference to this object for method chaining\n         */\n        abs : function () {\n            return this._set((this._x < 0) ? -this._x : this._x, (this._y < 0) ? -this._y : this._y);\n        },\n\n        /**\n         * Clamp the vector value within the specified value range\n         * @name clamp\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @param {Number} low\n         * @param {Number} high\n         * @return {me.ObservableVector2d} new me.ObservableVector2d\n         */\n        clamp : function (low, high) {\n            return new me.ObservableVector2d(this.x.clamp(low, high), this.y.clamp(low, high), {onUpdate: this.onUpdate});\n        },\n\n        /**\n         * Clamp this vector value within the specified value range\n         * @name clampSelf\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @param {Number} low\n         * @param {Number} high\n         * @return {me.ObservableVector2d} Reference to this object for method chaining\n         */\n        clampSelf : function (low, high) {\n            return this._set(this._x.clamp(low, high), this._y.clamp(low, high));\n        },\n\n        /**\n         * Update this vector with the minimum value between this and the passed vector\n         * @name minV\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @param {me.ObservableVector2d} v\n         * @return {me.ObservableVector2d} Reference to this object for method chaining\n         */\n        minV : function (v) {\n            return this._set((this._x < v.x) ? this._x : v.x, (this._y < v.y) ? this._y : v.y);\n        },\n\n        /**\n         * Update this vector with the maximum value between this and the passed vector\n         * @name maxV\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @param {me.ObservableVector2d} v\n         * @return {me.ObservableVector2d} Reference to this object for method chaining\n         */\n        maxV : function (v) {\n            return this._set((this._x > v.x) ? this._x : v.x, (this._y > v.y) ? this._y : v.y);\n        },\n\n        /**\n         * Floor the vector values\n         * @name floor\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @return {me.ObservableVector2d} new me.ObservableVector2d\n         */\n        floor : function () {\n            return new me.ObservableVector2d(Math.floor(this._x), Math.floor(this._y), {onUpdate: this.onUpdate});\n        },\n\n        /**\n         * Floor this vector values\n         * @name floorSelf\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @return {me.ObservableVector2d} Reference to this object for method chaining\n         */\n        floorSelf : function () {\n            return this._set(Math.floor(this._x), Math.floor(this._y));\n        },\n\n        /**\n         * Ceil the vector values\n         * @name ceil\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @return {me.ObservableVector2d} new me.ObservableVector2d\n         */\n        ceil : function () {\n            return new me.ObservableVector2d(Math.ceil(this._x), Math.ceil(this._y), {onUpdate: this.onUpdate});\n        },\n\n        /**\n         * Ceil this vector values\n         * @name ceilSelf\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @return {me.ObservableVector2d} Reference to this object for method chaining\n         */\n        ceilSelf : function () {\n            return this._set(Math.ceil(this._x), Math.ceil(this._y));\n        },\n\n        /**\n         * Negate the vector values\n         * @name negate\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @return {me.ObservableVector2d} new me.ObservableVector2d\n         */\n        negate : function () {\n            return new me.ObservableVector2d(-this._x, -this._y, {onUpdate: this.onUpdate});\n        },\n\n        /**\n         * Negate this vector values\n         * @name negateSelf\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @return {me.ObservableVector2d} Reference to this object for method chaining\n         */\n        negateSelf : function () {\n            return this._set(-this._x, -this._y);\n        },\n\n        /**\n         * Copy the x,y values of the passed vector to this one\n         * @name copy\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @param {me.ObservableVector2d} v\n         * @return {me.ObservableVector2d} Reference to this object for method chaining\n         */\n        copy : function (v) {\n            return this._set(v.x, v.y);\n        },\n\n        /**\n         * return true if the two vectors are the same\n         * @name equals\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @param {me.ObservableVector2d} v\n         * @return {Boolean}\n         */\n        equals : function (v) {\n            return ((this._x === v.x) && (this._y === v.y));\n        },\n\n        /**\n         * normalize this vector (scale the vector so that its magnitude is 1)\n         * @name normalize\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @return {me.ObservableVector2d} Reference to this object for method chaining\n         */\n        normalize : function () {\n            var d = this.length();\n            if (d > 0) {\n                return this._set(this._x / d, this._y / d);\n            }\n            return this;\n        },\n\n        /**\n         * change this vector to be perpendicular to what it was before.<br>\n         * (Effectively rotates it 90 degrees in a clockwise direction)\n         * @name perp\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @return {me.ObservableVector2d} Reference to this object for method chaining\n         */\n        perp : function () {\n            return this._set(this._y, -this._x);\n        },\n\n        /**\n         * Rotate this vector (counter-clockwise) by the specified angle (in radians).\n         * @name rotate\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @param {number} angle The angle to rotate (in radians)\n         * @return {me.ObservableVector2d} Reference to this object for method chaining\n         */\n        rotate : function (angle) {\n            var x = this._x;\n            var y = this._y;\n            return this._set(x * Math.cos(angle) - y * Math.sin(angle), x * Math.sin(angle) + y * Math.cos(angle));\n        },\n\n        /**\n         * return the dot product of this vector and the passed one\n         * @name dotProduct\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @param {me.ObservableVector2d} v\n         * @return {Number} The dot product.\n         */\n        dotProduct : function (v) {\n            return this._x * v.x + this._y * v.y;\n        },\n\n        /**\n         * return the distance between this vector and the passed one\n         * @name distance\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @param {me.ObservableVector2d} v\n         * @return {Number}\n         */\n        distance : function (v) {\n            return Math.sqrt((this._x - v.x) * (this._x - v.x) + (this._y - v.y) * (this._y - v.y));\n        },\n\n        /**\n         * return a clone copy of this vector\n         * @name clone\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @return {me.ObservableVector2d} new me.ObservableVector2d\n         */\n        clone : function () {\n            // shall we return a cloned me.ObservableVector2d here ?\n            return new me.ObservableVector2d(this._x, this._y, {onUpdate: this.onUpdate});\n        },\n\n        /**\n         * return a `me.Vector2d` copy of this `me.ObservableVector2d` object\n         * @name toVector2d\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @return {me.Vector2d} new me.Vector2d\n         */\n        toVector2d : function () {\n            return new me.Vector2d(this._x, this._y);\n        },\n\n        /**\n         * convert the object to a string representation\n         * @name toString\n         * @memberOf me.ObservableVector2d\n         * @function\n         * @return {String}\n         */\n        toString : function () {\n            return \"x:\" + this._x + \",y:\" + this._y;\n        }\n    });\n\n    /**\n     * Base class for Vector2d exception handling.\n     * @name Error\n     * @class\n     * @memberOf me.ObservableVector2d\n     * @constructor\n     * @param {String} msg Error message.\n     */\n    me.ObservableVector2d.Error = me.Error.extend({\n        init : function (msg) {\n            me.Error.prototype.init.apply(this, [ msg ]);\n            this.name = \"me.ObservableVector2d.Error\";\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n    /**\n     * A Vector3d object that provide notification by executing the given callback when the vector is changed.\n     * @class\n     * @extends me.Vector3d\n     * @constructor\n     * @param {Number} [x=0] x value of the vector\n     * @param {Number} [y=0] y value of the vector\n     * @param {Number} [z=0] z value of the vector\n     * @param {Object} settings additional required parameters\n     * @param {Function} settings.onUpdate the callback to be executed when the vector is changed\n     */\n    me.ObservableVector3d = me.Vector3d.extend({\n    /** @scope me.ObservableVector3d.prototype */\n\n        /** @ignore */\n        init : function (x, y, z, settings) {\n            /**\n             * x value of the vector\n             * @public\n             * @type Number\n             * @name x\n             * @memberOf me.ObservableVector3d\n             */\n            Object.defineProperty(this, \"x\", {\n                get : function () {\n                    return this._x;\n                },\n\n                set : function (value) {\n                    this.onUpdate(value, this._y, this._z, this._x, this._y, this._z);\n                    this._x = value;\n                }\n            });\n\n            /**\n             * y value of the vector\n             * @public\n             * @type Number\n             * @name y\n             * @memberOf me.ObservableVector3d\n             */\n            Object.defineProperty(this, \"y\", {\n                get : function () {\n                    return this._y;\n                },\n\n                set : function (value) {\n                    this.onUpdate(this._x, value, this._z, this._x, this._y, this._z);\n                    this._y = value;\n                }\n            });\n\n            /**\n             * z value of the vector\n             * @public\n             * @type Number\n             * @name z\n             * @memberOf me.ObservableVector3d\n             */\n            Object.defineProperty(this, \"z\", {\n                get : function () {\n                    return this._z;\n                },\n\n                set : function (value) {\n                    this.onUpdate(this._x, this._y, value, this._x, this._y, this._z);\n                    this._z = value;\n                }\n            });\n\n            if (typeof(settings) === \"undefined\") {\n                throw new me.ObservableVector3d.Error(\n                    \"undefined `onUpdate` callback\"\n                );\n            }\n            this.setCallback(settings.onUpdate);\n            this._x = x || 0;\n            this._y = y || 0;\n            this._z = z || 0;\n        },\n\n        /**\n         * @ignore */\n        _set : function (x, y, z) {\n            this.onUpdate(x, y, z, this._x, this._y, this._z);\n            this._x = x;\n            this._y = y;\n            this._z = z;\n            return this;\n        },\n        \n        /**\n         * set the vector value without triggering the callback\n         * @name setMuted\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @param {Number} x x value of the vector\n         * @param {Number} y y value of the vector\n         * @param {Number} z z value of the vector\n         * @return {me.ObservableVector2d} Reference to this object for method chaining\n         */\n        setMuted : function (x, y, z) {\n            this._x = x;\n            this._y = y;\n            this._z = z;\n            return this;\n        },\n        \n        /**\n         * set the callback to be executed when the vector is changed\n         * @name setCallback\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @param {function} onUpdate callback\n         * @return {me.ObservableVector2d} Reference to this object for method chaining\n         */\n        setCallback : function (fn) {\n            if (typeof(fn) !== \"function\") {\n                throw new me.ObservableVector2d.Error(\n                    \"invalid `onUpdate` callback\"\n                );\n            }\n            this.onUpdate = fn;\n            return this;\n        },\n        \n        /**\n         * Add the passed vector to this vector\n         * @name add\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @param {me.Vector2d|me.Vector3d|me.ObservableVector2d|me.ObservableVector3d} v\n         * @return {me.ObservableVector3d} Reference to this object for method chaining\n         */\n        add : function (v) {\n            return this._set(this._x + v.x, this._y + v.y, this._z + (v.z || 0));\n        },\n\n        /**\n         * Substract the passed vector to this vector\n         * @name sub\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @param {me.Vector2d|me.Vector3d|me.ObservableVector2d|me.ObservableVector3d} v\n         * @return {me.ObservableVector3d} Reference to this object for method chaining\n         */\n        sub : function (v) {\n            return this._set(this._x - v.x, this._y - v.y, this._z - (v.z || 0));\n        },\n\n        /**\n         * Multiply this vector values by the given scalar\n         * @name scale\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @param {Number} x\n         * @param {Number} [y=x]\n         * @param {Number} [z=x]\n         * @return {me.ObservableVector3d} Reference to this object for method chaining\n         */\n        scale : function (x, y, z) {\n            y = (typeof (y) !== \"undefined\" ? y : x);\n            z = (typeof (z) !== \"undefined\" ? z : x);\n            return this._set(this._x * x, this._y * y, this._z * z);\n        },\n\n        /**\n         * Multiply this vector values by the passed vector\n         * @name scaleV\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @param {me.Vector2d|me.Vector3d|me.ObservableVector2d|me.ObservableVector3d} v\n         * @return {me.ObservableVector3d} Reference to this object for method chaining\n         */\n        scaleV : function (v) {\n            return this._set(this._x * v.x, this._y * v.y, this._z * (v.z || 1));\n        },\n\n        /**\n         * Divide this vector values by the passed value\n         * @name div\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @param {Number} value\n         * @return {me.ObservableVector3d} Reference to this object for method chaining\n         */\n        div : function (n) {\n            return this._set(this._x / n, this._y / n, this._z / n);\n        },\n\n        /**\n         * Update this vector values to absolute values\n         * @name abs\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @return {me.ObservableVector3d} Reference to this object for method chaining\n         */\n        abs : function () {\n            return this._set(\n                (this._x < 0) ? -this._x : this._x,\n                (this._y < 0) ? -this._y : this._y,\n                (this._Z < 0) ? -this._z : this._z\n            );\n        },\n\n        /**\n         * Clamp the vector value within the specified value range\n         * @name clamp\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @param {Number} low\n         * @param {Number} high\n         * @return {me.ObservableVector3d} new me.ObservableVector3d\n         */\n        clamp : function (low, high) {\n            return new me.ObservableVector3d(\n                this._x.clamp(low, high),\n                this._y.clamp(low, high),\n                this._z.clamp(low, high),\n                {onUpdate: this.onUpdate}\n            );\n        },\n\n        /**\n         * Clamp this vector value within the specified value range\n         * @name clampSelf\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @param {Number} low\n         * @param {Number} high\n         * @return {me.ObservableVector3d} Reference to this object for method chaining\n         */\n        clampSelf : function (low, high) {\n            return this._set(\n                this._x.clamp(low, high),\n                this._y.clamp(low, high),\n                this._z.clamp(low, high)\n            );\n        },\n\n        /**\n         * Update this vector with the minimum value between this and the passed vector\n         * @name minV\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @param {me.Vector2d|me.Vector3d|me.ObservableVector2d|me.ObservableVector3d} v\n         * @return {me.ObservableVector3d} Reference to this object for method chaining\n         */\n        minV : function (v) {\n            var _vz = v.z || 0;\n            return this._set(\n                (this._x < v.x) ? this._x : v.x,\n                (this._y < v.y) ? this._y : v.y,\n                (this._z < _vz) ? this._z : _vz\n            );\n        },\n\n        /**\n         * Update this vector with the maximum value between this and the passed vector\n         * @name maxV\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @param {me.Vector2d|me.Vector3d|me.ObservableVector2d|me.ObservableVector3d} v\n         * @return {me.ObservableVector3d} Reference to this object for method chaining\n         */\n        maxV : function (v) {\n            var _vz = v.z || 0;\n            return this._set(\n                (this._x > v.x) ? this._x : v.x,\n                (this._y > v.y) ? this._y : v.y,\n                (this._z > _vz) ? this._z : _vz\n            );\n        },\n\n        /**\n         * Floor the vector values\n         * @name floor\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @return {me.ObservableVector3d} new me.ObservableVector3d\n         */\n        floor : function () {\n            return new me.ObservableVector3d(\n                Math.floor(this._x),\n                Math.floor(this._y),\n                Math.floor(this._z),\n                {onUpdate: this.onUpdate}\n            );\n        },\n\n        /**\n         * Floor this vector values\n         * @name floorSelf\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @return {me.ObservableVector3d} Reference to this object for method chaining\n         */\n        floorSelf : function () {\n            return this._set(Math.floor(this._x), Math.floor(this._y), Math.floor(this._z));\n        },\n\n        /**\n         * Ceil the vector values\n         * @name ceil\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @return {me.ObservableVector3d} new me.ObservableVector3d\n         */\n        ceil : function () {\n            return new me.ObservableVector3d(\n                Math.ceil(this._x),\n                Math.ceil(this._y),\n                Math.ceil(this._z),\n                {onUpdate: this.onUpdate}\n            );\n        },\n\n        /**\n         * Ceil this vector values\n         * @name ceilSelf\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @return {me.ObservableVector3d} Reference to this object for method chaining\n         */\n        ceilSelf : function () {\n            return this._set(Math.ceil(this._x), Math.ceil(this._y), Math.ceil(this._z));\n        },\n\n        /**\n         * Negate the vector values\n         * @name negate\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @return {me.ObservableVector3d} new me.ObservableVector3d\n         */\n        negate : function () {\n            return new me.ObservableVector3d(\n                -this._x,\n                -this._y,\n                -this._z,\n                {onUpdate: this.onUpdate}\n            );\n        },\n\n        /**\n         * Negate this vector values\n         * @name negateSelf\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @return {me.ObservableVector3d} Reference to this object for method chaining\n         */\n        negateSelf : function () {\n            return this._set(-this._x, -this._y, -this._z);\n        },\n\n        /**\n         * Copy the x,y,z values of the passed vector to this one\n         * @name copy\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @param {me.Vector2d|me.Vector3d|me.ObservableVector2d|me.ObservableVector3d} v\n         * @return {me.ObservableVector3d} Reference to this object for method chaining\n         */\n        copy : function (v) {\n            return this._set(v.x, v.y,typeof (v.z) !== \"undefined\" ? v.z : this._z);\n        },\n\n        /**\n         * return true if the two vectors are the same\n         * @name equals\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @param {me.Vector2d|me.Vector3d|me.ObservableVector2d|me.ObservableVector3d} v\n         * @return {Boolean}\n         */\n        equals : function (v) {\n            return ((this._x === v.x) && (this._y === v.y) && (this._z === (v.z || this._z)));\n        },\n\n        /**\n         * normalize this vector (scale the vector so that its magnitude is 1)\n         * @name normalize\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @return {me.ObservableVector3d} Reference to this object for method chaining\n         */\n        normalize : function () {\n            var d = this.length();\n            if (d > 0) {\n                return this._set(this._x / d, this._y / d, this._z / d);\n            }\n            return this;\n        },\n\n        /**\n         * change this vector to be perpendicular to what it was before.<br>\n         * (Effectively rotates it 90 degrees in a clockwise direction)\n         * @name perp\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @return {me.ObservableVector3d} Reference to this object for method chaining\n         */\n        perp : function () {\n            return this._set(this._y, -this._x, this._z);\n        },\n\n        /**\n         * Rotate this vector (counter-clockwise) by the specified angle (in radians).\n         * @name rotate\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @param {number} angle The angle to rotate (in radians)\n         * @return {me.ObservableVector3d} Reference to this object for method chaining\n         */\n        rotate : function (angle) {\n            var x = this._x;\n            var y = this._y;\n            return this._set(\n                x * Math.cos(angle) - y * Math.sin(angle),\n                x * Math.sin(angle) + y * Math.cos(angle),\n                this._z\n            );\n        },\n\n        /**\n         * return the dot product of this vector and the passed one\n         * @name dotProduct\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @param {me.Vector2d|me.Vector3d|me.ObservableVector2d|me.ObservableVector3d} v\n         * @return {Number} The dot product.\n         */\n        dotProduct : function (v) {\n            return this._x * v.x + this._y * v.y + this._z * (v.z || 1);\n        },\n\n        /**\n         * return the distance between this vector and the passed one\n         * @name distance\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @param {me.Vector2d|me.Vector3d|me.ObservableVector2d|me.ObservableVector3d} v\n         * @return {Number}\n         */\n        distance : function (v) {\n            var dx = this._x - v.x, dy = this._y - v.y, dz = this._z - (v.z || 0);\n            return Math.sqrt(dx * dx + dy * dy + dz * dz);\n        },\n\n        /**\n         * return a clone copy of this vector\n         * @name clone\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @return {me.ObservableVector3d} new me.ObservableVector3d\n         */\n        clone : function () {\n            // shall we return a cloned me.ObservableVector3d here ?\n            return new me.ObservableVector3d(\n                this._x,\n                this._y,\n                this._z,\n                {onUpdate: this.onUpdate}\n            );\n        },\n\n        /**\n         * return a `me.Vector3d` copy of this `me.ObservableVector3d` object\n         * @name toVector3d\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @return {me.Vector3d} new me.Vector3d\n         */\n        toVector3d : function () {\n            return new me.Vector3d(this._x, this._y, this._z);\n        },\n\n        /**\n         * convert the object to a string representation\n         * @name toString\n         * @memberOf me.ObservableVector3d\n         * @function\n         * @return {String}\n         */\n        toString : function () {\n            return \"x:\" + this._x + \",y:\" + this._y + \",z:\" + this._z;\n        }\n    });\n\n    /**\n     * Base class for Vector3d exception handling.\n     * @name Error\n     * @class\n     * @memberOf me.ObservableVector3d\n     * @constructor\n     * @param {String} msg Error message.\n     */\n    me.ObservableVector3d.Error = me.Error.extend({\n        init : function (msg) {\n            me.Error.prototype.init.apply(this, [ msg ]);\n            this.name = \"me.ObservableVector3d.Error\";\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n    /**\n     * a Matrix2d Object.<br>\n     * the identity matrix and parameters position : <br>\n     * <img src=\"images/identity-matrix_2x.png\"/>\n     * @class\n     * @extends Object\n     * @memberOf me\n     * @constructor\n     * @param {me.Matrix2d} [mat2d] An instance of me.Matrix2d to copy from\n     * @param {Number[]} [arguments...] Matrix elements. See {@link me.Matrix2d.set}\n     */\n    me.Matrix2d = me.Object.extend(\n    /** @scope me.Matrix2d.prototype */    {\n\n        /** @ignore */\n        init : function (a, b, c, d, e, f, g, h, i) {\n            this.val = new Float32Array(9);\n            if (a instanceof me.Matrix2d) {\n                this.copy(a);\n            }\n            else if (arguments.length === 9) {\n                this.set(a, b, c, d, e, f, g, h, i);\n            }\n            else {\n                this.identity();\n            }\n        },\n\n        /**\n         * reset the transformation matrix to the identity matrix (no transformation).<br>\n         * the identity matrix and parameters position : <br>\n         * <img src=\"images/identity-matrix_2x.png\"/>\n         * @name identity\n         * @memberOf me.Matrix2d\n         * @function\n         * @return {me.Matrix2d} Reference to this object for method chaining\n         */\n        identity : function () {\n            this.set(\n                1, 0, 0,\n                0, 1, 0,\n                0, 0, 1\n            );\n\n            return this;\n        },\n\n        /**\n         * set the matrix to the specified value\n         * @name set\n         * @memberOf me.Matrix2d\n         * @function\n         * @param {Number} aX\n         * @param {Number} aY\n         * @param {Number} aW\n         * @param {Number} bX\n         * @param {Number} bY\n         * @param {Number} bW\n         * @param {Number} cX\n         * @param {Number} cY\n         * @param {Number} cW\n         * @return {me.Matrix2d} Reference to this object for method chaining\n         */\n        set : function () {\n            var a = this.val;\n\n            a[0] = arguments[0];\n            a[1] = arguments[1];\n            a[2] = arguments[2];\n            a[3] = arguments[3];\n            a[4] = arguments[4];\n            a[5] = arguments[5];\n            a[6] = arguments[6];\n            a[7] = arguments[7];\n            a[8] = arguments[8];\n\n            return this;\n        },\n\n        /**\n         * Copies over the values from another me.Matrix2d.\n         * @name copy\n         * @memberOf me.Matrix2d\n         * @function\n         * @param {me.Matrix2d} b the matrix object to copy from\n         * @return {me.Matrix2d} Reference to this object for method chaining\n         */\n        copy : function (b) {\n            this.val.set(b.val);\n            return this;\n        },\n\n        /**\n         * multiply both matrix\n         * @name multiply\n         * @memberOf me.Matrix2d\n         * @function\n         * @param {me.Matrix2d} b Other matrix\n         * @return {me.Matrix2d} Reference to this object for method chaining\n         */\n        multiply : function (b) {\n            b = b.val;\n            var a = this.val,\n                a0 = a[0],\n                a1 = a[1],\n                a3 = a[3],\n                a4 = a[4],\n                b0 = b[0],\n                b1 = b[1],\n                b3 = b[3],\n                b4 = b[4],\n                b6 = b[6],\n                b7 = b[7];\n\n            a[0] = a0 * b0 + a3 * b1;\n            a[1] = a1 * b0 + a4 * b1;\n            a[3] = a0 * b3 + a3 * b4;\n            a[4] = a1 * b3 + a4 * b4;\n            a[6] += a0 * b6 + a3 * b7;\n            a[7] += a1 * b6 + a4 * b7;\n\n            return this;\n        },\n\n        /**\n         * Multiply this matrix into a vector\n         * @ignore\n         */\n        vectorMultiply : function (v) {\n            var a = this.val,\n                x = v.x,\n                y = v.y;\n\n            v.x = x * a[0] + y * a[3] + a[6];\n            v.y = x * a[1] + y * a[4] + a[7];\n\n            return v;\n        },\n\n        /**\n         * scale the matrix\n         * @name scale\n         * @memberOf me.Matrix2d\n         * @function\n         * @param {Number} x a number representing the abscissa of the scaling vector.\n         * @param {Number} y a number representing the ordinate of the scaling vector.\n         * @return {me.Matrix2d} Reference to this object for method chaining\n         */\n        scale : function (x, y) {\n            var a = this.val;\n\n            a[0] *= x;\n            a[1] *= x;\n            a[3] *= y;\n            a[4] *= y;\n\n            return this;\n        },\n\n        /**\n         * rotate the matrix (counter-clockwise) by the specified angle (in radians).\n         * @name rotate\n         * @memberOf me.Matrix2d\n         * @function\n         * @param {Number} angle Rotation angle in radians.\n         * @return {me.Matrix2d} Reference to this object for method chaining\n         */\n        rotate : function (angle) {\n            if (angle !== 0) {\n                var a = this.val,\n                    a0 = a[0],\n                    a1 = a[1],\n                    a3 = a[3],\n                    a4 = a[4],\n                    s = Math.sin(angle),\n                    c = Math.cos(angle);\n\n                a[0] = a0 * c + a3 * s;\n                a[1] = a1 * c + a4 * s;\n                a[3] = a0 * -s + a3 * c;\n                a[4] = a1 * -s + a4 * c;\n            }\n            return this;\n        },\n\n        /**\n         * translate the matrix\n         * @name translate\n         * @memberOf me.Matrix2d\n         * @function\n         * @param {Number} x the x coordindates to translate the matrix by\n         * @param {Number} y the y coordindates to translate the matrix by\n         * @return {me.Matrix2d} Reference to this object for method chaining\n         */\n        translate : function (x, y) {\n            var a = this.val;\n\n            a[6] += x * a[0] + y * a[3];\n            a[7] += x * a[1] + y * a[4];\n\n            return this;\n        },\n\n        /**\n         * translate the matrix by a vector\n         * @name translateV\n         * @memberOf me.Matrix2d\n         * @function\n         * @param {me.Vector2d} v the vector to translate the matrix by\n         * @return {me.Matrix2d} Reference to this object for method chaining\n         */\n        translateV : function (v) {\n            return this.translate(v.x, v.y);\n        },\n\n        /**\n         * returns true if the matrix is an identity matrix.\n         * @name isIdentity\n         * @memberOf me.Matrix2d\n         * @function\n         * @return {Boolean}\n         **/\n        isIdentity : function () {\n            var a = this.val;\n\n            return (\n                a[0] === 1 &&\n                a[1] === 0 &&\n                a[2] === 0 &&\n                a[3] === 0 &&\n                a[4] === 1 &&\n                a[5] === 0 &&\n                a[6] === 0 &&\n                a[7] === 0 &&\n                a[8] === 1\n            );\n        },\n\n        /**\n         * Clone the Matrix\n         * @name clone\n         * @memberOf me.Matrix2d\n         * @function\n         * @return {me.Matrix2d}\n         */\n        clone : function () {\n            return new me.Matrix2d(this);\n        },\n\n        /**\n         * convert the object to a string representation\n         * @name toString\n         * @memberOf me.Matrix2d\n         * @function\n         * @return {String}\n         */\n        toString : function () {\n            var a = this.val;\n\n            return \"me.Matrix2d(\" +\n                a[0] + \", \" + a[1] + \", \" + a[2] + \", \" +\n                a[3] + \", \" + a[4] + \", \" + a[5] + \", \" +\n                a[6] + \", \" + a[7] + \", \" + a[8] +\n            \")\";\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n    /**\n     * an ellipse Object\n     * @class\n     * @extends Object\n     * @memberOf me\n     * @constructor\n     * @param {Number} x the center x coordinate of the ellipse\n     * @param {Number} y the center y coordinate of the ellipse\n     * @param {Number} w width (diameter) of the ellipse\n     * @param {Number} h height (diameter) of the ellipse\n     */\n    me.Ellipse = me.Object.extend(\n    {\n        /** @scope me.Ellipse.prototype */\n        /** @ignore */\n        init : function (x, y, w, h) {\n            /**\n             * the center coordinates of the ellipse\n             * @public\n             * @type {me.Vector2d}\n             * @name pos\n             * @memberOf me.Ellipse\n             */\n            this.pos = new me.Vector2d();\n\n            /**\n             * The bounding rectangle for this shape\n             * @private\n             * @type {me.Rect}\n             * @name _bounds\n             * @memberOf me.Ellipse\n             */\n            this._bounds = undefined;\n\n            /**\n             * Maximum radius of the ellipse\n             * @public\n             * @type {Number}\n             * @name radius\n             * @memberOf me.Ellipse\n             */\n            this.radius = NaN;\n\n            /**\n             * Pre-scaled radius vector for ellipse\n             * @public\n             * @type {me.Vector2d}\n             * @name radiusV\n             * @memberOf me.Ellipse\n             */\n            this.radiusV = new me.Vector2d();\n\n            /**\n             * Radius squared, for pythagorean theorom\n             * @public\n             * @type {me.Vector2d}\n             * @name radiusSq\n             * @memberOf me.Ellipse\n             */\n            this.radiusSq = new me.Vector2d();\n\n            /**\n             * x/y scaling ratio for ellipse\n             * @public\n             * @type {me.Vector2d}\n             * @name ratio\n             * @memberOf me.Ellipse\n             */\n            this.ratio = new me.Vector2d();\n\n            // the shape type\n            this.shapeType = \"Ellipse\";\n            this.setShape(x, y, w, h);\n        },\n\n        /**\n         * set new value to the Ellipse shape\n         * @name setShape\n         * @memberOf me.Ellipse\n         * @function\n         * @param {Number} x position of the ellipse\n         * @param {Number} y position of the ellipse\n         * @param {Number} w width (diameter) of the ellipse\n         * @param {Number} h height (diameter) of the ellipse\n         */\n        setShape : function (x, y, w, h) {\n            var hW = w / 2;\n            var hH = h / 2;\n            this.pos.set(x, y);\n            this.radius = Math.max(hW, hH);\n            this.ratio.set(hW / this.radius, hH / this.radius);\n            this.radiusV.set(this.radius, this.radius).scaleV(this.ratio);\n            var r = this.radius * this.radius;\n            this.radiusSq.set(r, r).scaleV(this.ratio);\n            this.updateBounds();\n            return this;\n        },\n\n        /**\n         * Rotate this Ellipse (counter-clockwise) by the specified angle (in radians).\n         * @name rotate\n         * @memberOf me.Ellipse\n         * @function\n         * @param {Number} angle The angle to rotate (in radians)\n         * @return {me.Ellipse} Reference to this object for method chaining\n         */\n        rotate : function (/*angle*/) {\n            // TODO\n            return this;\n        },\n\n        /**\n         * Scale this Ellipse by the specified scalar.\n         * @name scale\n         * @memberOf me.Ellipse\n         * @function\n         * @param {Number} x\n         * @param {Number} [y=x]\n         * @return {me.Ellipse} Reference to this object for method chaining\n         */\n        scale : function (x, y) {\n            y = typeof (y) !== \"undefined\" ? y : x;\n            return this.setShape(\n                this.pos.x,\n                this.pos.y,\n                this.radiusV.x * 2 * x,\n                this.radiusV.y * 2 * y\n            );\n        },\n\n        /**\n         * Scale this Ellipse by the specified vector.\n         * @name scale\n         * @memberOf me.Ellipse\n         * @function\n         * @param {me.Vector2d} v\n         * @return {me.Ellipse} Reference to this object for method chaining\n         */\n        scaleV : function (v) {\n            return this.scale(v.x, v.y);\n        },\n\n        /**\n         * translate the circle/ellipse by the specified offset\n         * @name translate\n         * @memberOf me.Ellipse\n         * @function\n         * @param {Number} x x offset\n         * @param {Number} y y offset\n         * @return {me.Ellipse} this ellipse\n         */\n        translate : function (x, y) {\n            this.pos.x += x;\n            this.pos.y += y;\n            this._bounds.translate(x, y);\n            return this;\n        },\n\n        /**\n         * translate the circle/ellipse by the specified vector\n         * @name translateV\n         * @memberOf me.Ellipse\n         * @function\n         * @param {me.Vector2d} v vector offset\n         * @return {me.Rect} this ellipse\n         */\n        translateV : function (v) {\n            this.pos.add(v);\n            this._bounds.translateV(v);\n            return this;\n        },\n\n        /**\n         * check if this circle/ellipse contains the specified point\n         * @name containsPointV\n         * @memberOf me.Ellipse\n         * @function\n         * @param  {me.Vector2d} point\n         * @return {boolean} true if contains\n         */\n        containsPointV: function (v) {\n            return this.containsPoint(v.x, v.y);\n        },\n\n        /**\n         * check if this circle/ellipse contains the specified point\n         * @name containsPoint\n         * @memberOf me.Ellipse\n         * @function\n         * @param  {Number} x x coordinate\n         * @param  {Number} y y coordinate\n         * @return {boolean} true if contains\n         */\n        containsPoint: function (x, y) {\n            // Make position relative to object center point.\n            x -= this.pos.x;\n            y -= this.pos.y;\n            // Pythagorean theorem.\n            return (\n                ((x * x) / this.radiusSq.x) +\n                ((y * y) / this.radiusSq.y)\n            ) <= 1.0;\n        },\n\n        /**\n         * returns the bounding box for this shape, the smallest Rectangle object completely containing this shape.\n         * @name getBounds\n         * @memberOf me.Ellipse\n         * @function\n         * @return {me.Rect} this shape bounding box Rectangle object\n         */\n        getBounds : function () {\n            return this._bounds;\n        },\n\n        /**\n         * update the bounding box for this shape.\n         * @name updateBounds\n         * @memberOf me.Ellipse\n         * @function\n         * @return {me.Rect} this shape bounding box Rectangle object\n         */\n        updateBounds : function () {\n            var rx = this.radiusV.x,\n                ry = this.radiusV.y,\n                x = this.pos.x - rx,\n                y = this.pos.y - ry,\n                w = rx * 2,\n                h = ry * 2;\n\n            if (!this._bounds) {\n                this._bounds = new me.Rect(x, y, w, h);\n            }  else {\n                this._bounds.setShape(x, y, w, h);\n            }\n            return this._bounds;\n        },\n\n        /**\n         * clone this Ellipse\n         * @name clone\n         * @memberOf me.Ellipse\n         * @function\n         * @return {me.Ellipse} new Ellipse\n         */\n        clone : function () {\n            return new me.Ellipse(\n                this.pos.x,\n                this.pos.y,\n                this.radiusV.x * 2,\n                this.radiusV.y * 2\n            );\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n    /**\n     * a polygon Object.<br>\n     * Please do note that melonJS implements a simple Axis-Aligned Boxes collision algorithm, which requires all polygons used for collision to be convex with all vertices defined with clockwise winding.\n     * A polygon is convex when all line segments connecting two points in the interior do not cross any edge of the polygon\n     * (which means that all angles are less than 180 degrees), as described here below : <br>\n     * <center><img src=\"images/convex_polygon.png\"/></center><br>\n     * A polygon's `winding` is clockwise iff its vertices (points) are declared turning to the right. The image above shows COUNTERCLOCKWISE winding.\n     * @class\n     * @extends Object\n     * @memberOf me\n     * @constructor\n     * @param {Number} x origin point of the Polygon\n     * @param {Number} y origin point of the Polygon\n     * @param {me.Vector2d[]} points array of vector defining the Polygon\n     */\n    me.Polygon = me.Object.extend(\n    /** @scope me.Polygon.prototype */ {\n\n        /** @ignore */\n        init : function (x, y, points) {\n            /**\n             * origin point of the Polygon\n             * @public\n             * @type {me.Vector2d}\n             * @name pos\n             * @memberOf me.Polygon\n             */\n            this.pos = new me.Vector2d();\n\n            /**\n             * The bounding rectangle for this shape\n             * @private\n             * @type {me.Rect}\n             * @name _bounds\n             * @memberOf me.Polygon\n             */\n            this._bounds = undefined;\n\n            /**\n             * Array of points defining the Polygon <br>\n             * Note: If you manually change `points`, you **must** call `recalc`afterwards so that the changes get applied correctly.\n             * @public\n             * @type {me.Vector2d[]}\n             * @name points\n             * @memberOf me.Polygon\n             */\n            this.points = null;\n\n            // the shape type\n            this.shapeType = \"Polygon\";\n            this.setShape(x, y, points);\n        },\n\n        /**\n         * set new value to the Polygon\n         * @name setShape\n         * @memberOf me.Polygon\n         * @function\n         * @param {Number} x position of the Polygon\n         * @param {Number} y position of the Polygon\n         * @param {me.Vector2d[]} points array of vector defining the Polygon\n         */\n        setShape : function (x, y, points) {\n            this.pos.set(x, y);\n            this.points = points;\n            this.recalc();\n            this.updateBounds();\n            return this;\n        },\n\n        /**\n         * Rotate this Polygon (counter-clockwise) by the specified angle (in radians).\n         * @name rotate\n         * @memberOf me.Polygon\n         * @function\n         * @param {Number} angle The angle to rotate (in radians)\n         * @return {me.Polygon} Reference to this object for method chaining\n         */\n        rotate : function (angle) {\n            if (angle !== 0) {\n                var points = this.points;\n                var len = points.length;\n                for (var i = 0; i < len; i++) {\n                    points[i].rotate(angle);\n                }\n                this.recalc();\n                this.updateBounds();\n            }\n            return this;\n        },\n\n        /**\n         * Scale this Polygon by the given scalar.\n         * @name scale\n         * @memberOf me.Polygon\n         * @function\n         * @param {Number} x\n         * @param {Number} [y=x]\n         * @return {me.Polygon} Reference to this object for method chaining\n         */\n        scale : function (x, y) {\n            y = typeof (y) !== \"undefined\" ? y : x;\n\n            var points = this.points;\n            var len = points.length;\n            for (var i = 0; i < len; i++) {\n                points[i].scale(x, y);\n            }\n            this.recalc();\n            this.updateBounds();\n            return this;\n        },\n\n        /**\n         * Scale this Polygon by the given vector\n         * @name scaleV\n         * @memberOf me.Polygon\n         * @function\n         * @param {me.Vector2d} v\n         * @return {me.Polygon} Reference to this object for method chaining\n         */\n        scaleV : function (v) {\n            return this.scale(v.x, v.y);\n        },\n\n        /**\n         * Computes the calculated collision polygon.\n         * This **must** be called if the `points` array, `angle`, or `offset` is modified manually.\n         * @name recalc\n         * @memberOf me.Polygon\n         * @function\n         */\n        recalc : function () {\n            var i;\n            // The edges here are the direction of the `n`th edge of the polygon, relative to\n            // the `n`th point. If you want to draw a given edge from the edge value, you must\n            // first translate to the position of the starting point.\n            var edges = this.edges = [];\n            // The normals here are the direction of the normal for the `n`th edge of the polygon, relative\n            // to the position of the `n`th point. If you want to draw an edge normal, you must first\n            // translate to the position of the starting point.\n            var normals = this.normals = [];\n            // Copy the original points array and apply the offset/angle\n            var points = this.points;\n            var len = points.length;\n\n            if (len < 3) {\n                throw new me.Polygon.Error(\"Requires at least 3 points\");\n            }\n\n            // Calculate the edges/normals\n            for (i = 0; i < len; i++) {\n                var e = new me.Vector2d().copy(points[(i + 1) % len]).sub(points[i]);\n                edges.push(e);\n                normals.push(new me.Vector2d().copy(e).perp().normalize());\n            }\n            return this;\n        },\n\n        /**\n         * translate the Polygon by the specified offset\n         * @name translate\n         * @memberOf me.Polygon\n         * @function\n         * @param {Number} x x offset\n         * @param {Number} y y offset\n         * @return {me.Polygon} this Polygon\n         */\n        translate : function (x, y) {\n            this.pos.x += x;\n            this.pos.y += y;\n            this._bounds.translate(x, y);\n            return this;\n        },\n\n        /**\n         * translate the Polygon by the specified vector\n         * @name translateV\n         * @memberOf me.Polygon\n         * @function\n         * @param {me.Vector2d} v vector offset\n         * @return {me.Polygon} this Polygon\n         */\n        translateV : function (v) {\n            this.pos.add(v);\n            this._bounds.translateV(v);\n            return this;\n        },\n\n        /**\n         * check if this Polygon contains the specified point\n         * @name containsPointV\n         * @memberOf me.Polygon\n         * @function\n         * @param  {me.Vector2d} point\n         * @return {boolean} true if contains\n         */\n        containsPointV: function (v) {\n            return this.containsPoint(v.x, v.y);\n        },\n\n        /**\n         * check if this Polygon contains the specified point <br>\n         * (Note: it is highly recommended to first do a hit test on the corresponding <br>\n         *  bounding rect, as the function can be highly consuming with complex shapes)\n         * @name containsPoint\n         * @memberOf me.Polygon\n         * @function\n         * @param  {Number} x x coordinate\n         * @param  {Number} y y coordinate\n         * @return {boolean} true if contains\n         */\n        containsPoint: function (x, y) {\n            var intersects = false;\n            var posx = this.pos.x, posy = this.pos.y;\n            var points = this.points;\n            var len = points.length;\n\n            //http://www.ecse.rpi.edu/Homepages/wrf/Research/Short_Notes/pnpoly.html\n            for (var i = 0, j = len - 1; i < len; j = i++) {\n                var iy = points[i].y + posy, ix = points[i].x + posx,\n                    jy = points[j].y + posy, jx = points[j].x + posx;\n                if (((iy > y) !== (jy > y)) && (x < (jx - ix) * (y - iy) / (jy - iy) + ix)) {\n                    intersects = !intersects;\n                }\n            }\n            return intersects;\n        },\n\n        /**\n         * returns the bounding box for this shape, the smallest Rectangle object completely containing this shape.\n         * @name getBounds\n         * @memberOf me.Polygon\n         * @function\n         * @return {me.Rect} this shape bounding box Rectangle object\n         */\n        getBounds : function () {\n            return this._bounds;\n        },\n\n        /**\n         * update the bounding box for this shape.\n         * @name updateBounds\n         * @memberOf me.Polygon\n         * @function\n         * @return {me.Rect} this shape bounding box Rectangle object\n         */\n        updateBounds : function () {\n            var x = Infinity, y = Infinity, right = -Infinity, bottom = -Infinity;\n            this.points.forEach(function (point) {\n                x = Math.min(x, point.x);\n                y = Math.min(y, point.y);\n                right = Math.max(right, point.x);\n                bottom = Math.max(bottom, point.y);\n            });\n\n            if (!this._bounds) {\n                this._bounds = new me.Rect(x, y, right - x, bottom - y);\n            } else {\n                this._bounds.setShape(x, y, right - x, bottom - y);\n            }\n\n            return this._bounds.translateV(this.pos);\n        },\n\n        /**\n         * clone this Polygon\n         * @name clone\n         * @memberOf me.Polygon\n         * @function\n         * @return {me.Polygon} new Polygon\n         */\n        clone : function () {\n            var copy = [];\n            this.points.forEach(function (point) {\n                copy.push(new me.Vector2d(point.x, point.y));\n            });\n            return new me.Polygon(this.pos.x, this.pos.y, copy);\n        }\n    });\n\n    /**\n     * Base class for Polygon exception handling.\n     * @name Error\n     * @class\n     * @memberOf me.Polygon\n     * @constructor\n     * @param {String} msg Error message.\n     */\n    me.Polygon.Error = me.Error.extend({\n        init : function (msg) {\n            me.Error.prototype.init.apply(this, [ msg ]);\n            this.name = \"me.Polygon.Error\";\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n    /**\n     * a rectangle Object\n     * @class\n     * @extends me.Polygon\n     * @memberOf me\n     * @constructor\n     * @param {Number} x position of the Rectangle\n     * @param {Number} y position of the Rectangle\n     * @param {Number} w width of the rectangle\n     * @param {Number} h height of the rectangle\n     */\n    me.Rect = me.Polygon.extend(\n    /** @scope me.Rect.prototype */ {\n\n        /** @ignore */\n        init : function (x, y, w, h) {\n\n            this.pos = new me.Vector2d();\n\n            // pre-allocate the vector array\n            this.points = [\n                new me.Vector2d(), new me.Vector2d(),\n                new me.Vector2d(), new me.Vector2d()\n            ];\n            \n            this.shapeType = \"Polygon\";\n            this.setShape(x, y, w, h);\n        },\n\n        /**\n         * set new value to the rectangle shape\n         * @name setShape\n         * @memberOf me.Rect\n         * @function\n         * @param {Number} x position of the Rectangle\n         * @param {Number} y position of the Rectangle\n         * @param {Number} w width of the rectangle\n         * @param {Number} h height of the rectangle\n         * @return {me.Rect} this rectangle\n         */\n        setShape : function (x, y, w, h) {\n\n            this.points[0].set(0, 0); // 0, 0 \n            this.points[1].set(w, 0); // 1, 0\n            this.points[2].set(w, h); // 1, 1\n            this.points[3].set(0, h); // 0, 1\n\n            me.Polygon.prototype.setShape.apply(this, [x, y, this.points]);\n\n            // private properties to cache w & h\n            this._width = w;\n            this._height = h;\n\n            return this;\n        },\n\n        /**\n         * resize the rectangle\n         * @name resize\n         * @memberOf me.Rect\n         * @function\n         * @param {Number} w new width of the rectangle\n         * @param {Number} h new height of the rectangle\n         * @return {me.Rect} this rectangle\n         */\n        resize : function (w, h) {\n            this.width = w;\n            this.height = h;\n            return this;\n        },\n\n        /**\n         * returns the bounding box for this shape, the smallest rectangle object completely containing this shape.\n         * @name getBounds\n         * @memberOf me.Rect\n         * @function\n         * @return {me.Rect} this shape bounding box Rectangle object\n         */\n        getBounds : function () {\n            return this;\n        },\n\n        /**\n         * update the bounding box for this shape.\n         * @name updateBounds\n         * @memberOf me.Rect\n         * @function\n         * @return {me.Rect} this shape bounding box Rectangle object\n         */\n        updateBounds : function () {\n            return this;\n        },\n\n        /**\n         * clone this rectangle\n         * @name clone\n         * @memberOf me.Rect\n         * @function\n         * @return {me.Rect} new rectangle\n         */\n        clone : function () {\n            return new me.Rect(this.pos.x, this.pos.y, this._width, this._height);\n        },\n\n        /**\n         * copy the position and size of the given rectangle into this one\n         * @name copy\n         * @memberOf me.Rect\n         * @function\n         * @param {me.Rect} rect Source rectangle\n         * @return {me.Rect} new rectangle\n         */\n        copy : function (rect) {\n            return this.setShape(rect.pos.x, rect.pos.y, rect._width, rect._height);\n        },\n\n        /**\n         * translate the rect by the specified offset\n         * @name translate\n         * @memberOf me.Rect\n         * @function\n         * @param {Number} x x offset\n         * @param {Number} y y offset\n         * @return {me.Rect} this rectangle\n         */\n        translate : function (x, y) {\n            this.pos.x += x;\n            this.pos.y += y;\n            return this;\n        },\n\n        /**\n         * translate the rect by the specified vector\n         * @name translateV\n         * @memberOf me.Rect\n         * @function\n         * @param {me.Vector2d} v vector offset\n         * @return {me.Rect} this rectangle\n         */\n        translateV : function (v) {\n            return this.translate(v.x, v.y);\n        },\n\n        /**\n         * merge this rectangle with another one\n         * @name union\n         * @memberOf me.Rect\n         * @function\n         * @param {me.Rect} rect other rectangle to union with\n         * @return {me.Rect} the union(ed) rectangle\n         */\n        union : function (/** {me.Rect} */ r) {\n            var x1 = Math.min(this.left, r.left);\n            var y1 = Math.min(this.top, r.top);\n\n            this.resize(\n                Math.max(this.right, r.right) - x1,\n                Math.max(this.bottom, r.bottom) - y1\n            );\n\n            this.pos.set(x1, y1);\n\n            return this;\n        },\n\n        /**\n         * check if this rectangle is intersecting with the specified one\n         * @name overlaps\n         * @memberOf me.Rect\n         * @function\n         * @param  {me.Rect} rect\n         * @return {boolean} true if overlaps\n         */\n        overlaps : function (r)    {\n            return (\n                this.left < r.right &&\n                r.left < this.right &&\n                this.top < r.bottom &&\n                r.top < this.bottom\n            );\n        },\n\n        /**\n         * check if this rectangle contains the specified one\n         * @name contains\n         * @memberOf me.Rect\n         * @function\n         * @param  {me.Rect} rect\n         * @return {boolean} true if contains\n         */\n        contains: function (r) {\n            return (\n                r.left >= this.left &&\n                r.right <= this.right &&\n                r.top >= this.top &&\n                r.bottom <= this.bottom\n            );\n        },\n\n        /**\n         * check if this rectangle contains the specified point\n         * @name containsPoint\n         * @memberOf me.Rect\n         * @function\n         * @param  {Number} x x coordinate\n         * @param  {Number} y y coordinate\n         * @return {boolean} true if contains\n         */\n        containsPoint: function (x, y) {\n            return (\n                x >= this.left &&\n                x <= this.right &&\n                y >= this.top &&\n                y <= this.bottom\n            );\n        },\n\n        /**\n         * Returns a polygon whose edges are the same as this box.\n         * @name toPolygon\n         * @memberOf me.Rect\n         * @function\n         * @return {me.Polygon} a new Polygon that represents this rectangle.\n         */\n        toPolygon: function () {\n            return new me.Polygon(\n                this.pos.x, this.pos.y, this.points\n            );\n        }\n    });\n\n    // redefine some properties to ease our life when getting the rectangle coordinates\n    \n    /**\n     * left coordinate of the Rectangle\n     * @public\n     * @type {Number}\n     * @name left\n     * @memberOf me.Rect\n     */\n    Object.defineProperty(me.Rect.prototype, \"left\", {\n        get : function () {\n            return this.pos.x;\n        },\n        configurable : true\n    });\n\n    /**\n     * right coordinate of the Rectangle\n     * @public\n     * @type {Number}\n     * @name right\n     * @memberOf me.Rect\n     */\n    Object.defineProperty(me.Rect.prototype, \"right\", {\n        get : function () {\n            var w = this._width;\n            return (this.pos.x + w) || w;\n        },\n        configurable : true\n    });\n\n    /**\n     * top coordinate of the Rectangle\n     * @public\n     * @type {Number}\n     * @name top\n     * @memberOf me.Rect\n     */\n    Object.defineProperty(me.Rect.prototype, \"top\", {\n        get : function () {\n            return this.pos.y;\n        },\n        configurable : true\n    });\n\n    /**\n     * bottom coordinate of the Rectangle\n     * @public\n     * @type {Number}\n     * @name bottom\n     * @memberOf me.Rect\n     */\n    Object.defineProperty(me.Rect.prototype, \"bottom\", {\n        get : function () {\n            var h = this._height;\n            return (this.pos.y + h) || h;\n        },\n        configurable : true\n    });\n    \n    /**\n     * width of the Rectangle\n     * @public\n     * @type {Number}\n     * @name width\n     * @memberOf me.Rect\n     */\n    Object.defineProperty(me.Rect.prototype, \"width\", {\n        get : function () {\n            return this._width;\n        },\n        set : function (value) {\n            this._width = value;\n            this.points[1].x = this.points[2].x = value;\n            this.recalc();\n        },\n        configurable : true\n    });\n\n    /**\n     * height of the Rectangle\n     * @public\n     * @type {Number}\n     * @name height\n     * @memberOf me.Rect\n     */\n    Object.defineProperty(me.Rect.prototype, \"height\", {\n        get : function () {\n            return this._height;\n        },\n        set : function (value) {\n            this._height = value;\n            this.points[2].y = this.points[3].y = value;\n            this.recalc();\n        },\n        configurable : true\n    });\n    \n})();\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n    /**\n     * a line segment Object.<br>\n     * @class\n     * @extends Object\n     * @memberOf me\n     * @constructor\n     * @param {Number} x origin point of the Line\n     * @param {Number} y origin point of the Line\n     * @param {me.Vector2d[]} points array of vectors defining the Line\n     */\n    me.Line = me.Polygon.extend(\n    /** @scope me.Line.prototype */ {\n\n        /**\n         * check if this line segment contains the specified point\n         * @name containsPointV\n         * @memberOf me.Line\n         * @function\n         * @param  {me.Vector2d} point\n         * @return {boolean} true if contains\n         */\n        containsPointV: function (v) {\n            return this.containsPoint(v.x, v.y);\n        },\n\n        /**\n         * check if this line segment contains the specified point\n         * @name containsPoint\n         * @memberOf me.Line\n         * @function\n         * @param  {Number} x x coordinate\n         * @param  {Number} y y coordinate\n         * @return {boolean} true if contains\n         */\n        containsPoint: function (x, y) {\n            // translate the given coordinates,\n            // rather than creating temp translated vectors\n            x -= this.pos.x; // Cx\n            y -= this.pos.y; // Cy\n            var start = this.points[0]; // Ax/Ay\n            var end = this.points[1]; // Bx/By\n\n            //(Cy - Ay) * (Bx - Ax) = (By - Ay) * (Cx - Ax)\n            return (y - start.y) * (end.x - start.x) === (end.y - start.y) * (x - start.x);\n        },\n\n        /**\n         * Computes the calculated collision edges and normals.\n         * This **must** be called if the `points` array, `angle`, or `offset` is modified manually.\n         * @name recalc\n         * @memberOf me.Line\n         * @function\n         */\n        recalc : function () {\n            // The edges here are the direction of the `n`th edge of the polygon, relative to\n            // the `n`th point. If you want to draw a given edge from the edge value, you must\n            // first translate to the position of the starting point.\n            var edges = this.edges = [];\n            // The normals here are the direction of the normal for the `n`th edge of the polygon, relative\n            // to the position of the `n`th point. If you want to draw an edge normal, you must first\n            // translate to the position of the starting point.\n            var normals = this.normals = [];\n            // Copy the original points array and apply the offset/angle\n            var points = this.points;\n\n            if (points.length !== 2) {\n                throw new me.Line.Error(\"Requires exactly 2 points\");\n            }\n\n            // Calculate the edges/normals\n            var e = new me.Vector2d().copy(points[1]).sub(points[0]);\n            edges.push(e);\n            normals.push(new me.Vector2d().copy(e).perp().normalize());\n\n            return this;\n        },\n        \n        /**\n         * clone this line segment\n         * @name clone\n         * @memberOf me.Line\n         * @function\n         * @return {me.Line} new Line\n         */\n        clone : function () {\n            var copy = [];\n            this.points.forEach(function (point) {\n                copy.push(new me.Vector2d(point.x, point.y));\n            });\n            return new me.Line(this.pos.x, this.pos.y, copy);\n        }\n    });\n\n    /**\n     * Base class for Line exception handling.\n     * @name Error\n     * @class\n     * @memberOf me.Line\n     * @constructor\n     * @param {String} msg Error message.\n     */\n    me.Line.Error = me.Error.extend({\n        init : function (msg) {\n            me.Error.prototype.init.apply(this, [ msg ]);\n            this.name = \"me.Line.Error\";\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n\n(function () {\n\n    /**\n     * a Generic Body Object <br>\n     * @class\n     * @extends me.Rect\n     * @memberOf me\n     * @constructor\n     * @param {me.Entity} entity the parent entity\n     * @param {me.Rect[]|me.Polygon[]|me.Line[]|me.Ellipse[]} [shapes] the initial list of shapes\n     */\n    me.Body = me.Rect.extend(\n    /** @scope me.Body.prototype */\n    {\n        /** @ignore */\n        init : function (entity, shapes) {\n\n            /**\n             * reference to the parent entity\n             * @ignore\n             */\n            this.entity = entity;\n\n            /**\n             * The collision shapes of the entity <br>\n             * @ignore\n             * @type {me.Polygon[]|me.Line[]|me.Ellipse[]}\n             * @name shapes\n             * @memberOf me.Body\n             */\n            this.shapes = [];\n\n            /**\n             * The body collision mask, that defines what should collide with what.<br>\n             * (by default will collide with all entities)\n             * @ignore\n             * @type Number\n             * @default me.collision.types.ALL_OBJECT\n             * @name collisionMask\n             * @see me.collision.types\n             * @memberOf me.Body\n             */\n            this.collisionMask = me.collision.types.ALL_OBJECT;\n\n            /**\n             * define the collision type of the body for collision filtering\n             * @public\n             * @type Number\n             * @default me.collision.types.ENEMY_OBJECT\n             * @name collisionType\n             * @see me.collision.types\n             * @memberOf me.Body\n             * @example\n             * // set the entity body collision type\n             * myEntity.body.collisionType = me.collision.types.PLAYER_OBJECT;\n             */\n            this.collisionType = me.collision.types.ENEMY_OBJECT;\n\n            /**\n             * entity current velocity<br>\n             * @public\n             * @type me.Vector2d\n             * @default <0,0>\n             * @name vel\n             * @memberOf me.Body\n             */\n            if (typeof(this.vel) === \"undefined\") {\n                this.vel = new me.Vector2d();\n            }\n            this.vel.set(0, 0);\n\n            /**\n             * entity current acceleration<br>\n             * @public\n             * @type me.Vector2d\n             * @default <0,0>\n             * @name accel\n             * @memberOf me.Body\n             */\n            if (typeof(this.accel) === \"undefined\") {\n                this.accel = new me.Vector2d();\n            }\n            this.accel.set(0, 0);\n\n            /**\n             * entity current friction<br>\n             * @public\n             * @type me.Vector2d\n             * @default <0,0>\n             * @name friction\n             * @memberOf me.Body\n             */\n            if (typeof(this.friction) === \"undefined\") {\n                this.friction = new me.Vector2d();\n            }\n            this.friction.set(0, 0);\n\n            /**\n             * max velocity (to limit entity velocity)<br>\n             * @public\n             * @type me.Vector2d\n             * @default <1000,1000>\n             * @name maxVel\n             * @memberOf me.Body\n             */\n            if (typeof(this.maxVel) === \"undefined\") {\n                this.maxVel = new me.Vector2d();\n            }\n            this.maxVel.set(1000, 1000);\n\n            /**\n             * Default gravity value of the entity<br>\n             * to be set to 0 for RPG, shooter, etc...<br>\n             * Note: Gravity can also globally be defined through me.sys.gravity\n             * @public\n             * @see me.sys.gravity\n             * @type Number\n             * @default 0.98\n             * @name gravity\n             * @memberOf me.Body\n             */\n            this.gravity = typeof(me.sys.gravity) !== \"undefined\" ? me.sys.gravity : 0.98;\n\n            /**\n             * falling state of the object<br>\n             * true if the object is falling<br>\n             * false if the object is standing on something<br>\n             * @readonly\n             * @public\n             * @type Boolean\n             * @default false\n             * @name falling\n             * @memberOf me.Body\n             */\n            this.falling = false;\n\n            /**\n             * jumping state of the object<br>\n             * equal true if the entity is jumping<br>\n             * @readonly\n             * @public\n             * @type Boolean\n             * @default false\n             * @name jumping\n             * @memberOf me.Body\n             */\n            this.jumping = false;\n\n            // call the super constructor\n            me.Rect.prototype.init.apply(this, [\n                    0,\n                    0,\n                    entity.width,\n                    entity.height\n                ]\n            );\n\n            // parses the given shapes array and add them\n            for (var s = 0; s < shapes.length; s++) {\n                this.addShape(shapes[s].clone(), true);\n            }\n        },\n\n        /**\n         * add a collision shape to this entity <br>\n         * (note: me.Rect objects will be converted to me.Polygon before being added)\n         * @name addShape\n         * @memberOf me.Body\n         * @public\n         * @function\n         * @param {me.Rect|me.Polygon|me.Line|me.Ellipse} shape a shape object\n         * @return {Number} the shape array length\n         */\n        addShape : function (shape, batchInsert) {\n            if (shape instanceof me.Rect) {\n                this.shapes.push(shape.toPolygon());\n            } else {\n                // else polygon or circle\n                this.shapes.push(shape);\n            }\n\n            if (batchInsert !== true) {\n                // update the body bounds to take in account the added shape\n                this.updateBounds();\n            }\n\n            // return the length of the shape list\n            return this.shapes.length;\n        },\n\n        /**\n         * add collision shapes based on the given PhysicsEditor JSON object\n         * @name addShapesFromJSON\n         * @memberOf me.Body\n         * @public\n         * @function\n         * @param {Object} json a JSON object as exported from the PhysicsEditor tool\n         * @param {String} id the shape identifier within the given the json object\n         * @param {String} [scale=1] the desired scale of the body (physic-body-editor only)\n         * @see https://www.codeandweb.com/physicseditor\n         * @return {Number} the shape array length\n         */\n        addShapesFromJSON : function (json, id, scale) {\n            var data;\n            scale = scale || 1;\n\n            // identify the json format\n            if (typeof(json.rigidBodies) === \"undefined\") {\n                // Physic Editor Format (https://www.codeandweb.com/physicseditor)\n                data = json[id];\n\n                if (typeof(data) === \"undefined\") {\n                    throw new me.Body.Error(\"Identifier (\" + id + \") undefined for the given PhysicsEditor JSON object)\");\n                }\n\n                // go through all shapes and add them to the body\n                for (var i = 0; i < data.length; i++) {\n                    var points = [];\n                    for (var s = 0; s < data[i].shape.length; s += 2) {\n                        points.push(new me.Vector2d(data[i].shape[s], data[i].shape[s + 1]));\n                    }\n                    this.addShape(new me.Polygon(0, 0, points), true);\n                }\n            } else {\n                // Physic Body Editor Format (http://www.aurelienribon.com/blog/projects/physics-body-editor/)\n                json.rigidBodies.forEach(function (shape) {\n                    if (shape.name === id) {\n                        data = shape;\n                        // how to stop a forEach loop?\n                    }\n                });\n\n                if (typeof(data) === \"undefined\") {\n                    throw new me.Body.Error(\"Identifier (\" + id + \") undefined for the given PhysicsEditor JSON object)\");\n                }\n\n                // shapes origin point\n                // top-left origin in the editor is (0,1)\n                this.pos.set(data.origin.x, 1.0 - data.origin.y).scale(scale);\n\n                var self = this;\n                // parse all polygons\n                data.polygons.forEach(function (poly) {\n                    var points = [];\n                    poly.forEach(function (point) {\n                        // top-left origin in the editor is (0,1)\n                        points.push(new me.Vector2d(point.x, 1.0 - point.y).scale(scale));\n                    });\n                    self.addShape(new me.Polygon(0, 0, points), true);\n                });\n                // parse all circles\n                data.circles.forEach(function (circle) {\n                    self.addShape(new me.Ellipse(\n                        circle.cx * scale,\n                        (1.0 - circle.cy) * scale,\n                        circle.r * 2 * scale,\n                        circle.r * 2 * scale\n                    ), true);\n                });\n            }\n\n            // update the body bounds to take in account the added shapes\n            this.updateBounds();\n\n            // return the length of the shape list\n            return this.shapes.length;\n        },\n\n        /**\n         * return the collision shape at the given index\n         * @name getShape\n         * @memberOf me.Body\n         * @public\n         * @function\n         * @param {Number} [index=0] the shape object at the specified index\n         * @return {me.Polygon|me.Line|me.Ellipse} shape a shape object\n         */\n        getShape : function (index) {\n            return this.shapes[index || 0];\n        },\n\n        /**\n         * remove the specified shape from the body shape list\n         * @name removeShape\n         * @memberOf me.Body\n         * @public\n         * @function\n         * @param {me.Polygon|me.Line|me.Ellipse} shape a shape object\n         * @return {Number} the shape array length\n         */\n        removeShape : function (shape) {\n            this.shapes.remove(shape);\n\n            // update the body bounds to take in account the removed shape\n            this.updateBounds();\n\n            // return the length of the shape list\n            return this.shapes.length;\n        },\n\n        /**\n         * remove the shape at the given index from the body shape list\n         * @name removeShapeAt\n         * @memberOf me.Body\n         * @public\n         * @function\n         * @param {Number} index the shape object at the specified index\n         * @return {Number} the shape array length\n         */\n        removeShapeAt : function (index) {\n            return this.removeShape(this.getShape(index));\n        },\n\n        /**\n         * By default all entities are able to collide with all other entities, <br>\n         * but it's also possible to specificy 'collision filters' to provide a finer <br>\n         * control over which entities can collide with each other.\n         * @name setCollisionMask\n         * @memberOf me.Body\n         * @public\n         * @function\n         * @see me.collision.types\n         * @param {Number} bitmask the collision mask\n         * @example\n         * // filter collision detection with collision shapes, enemies and collectables\n         * myEntity.body.setCollisionMask(me.collision.types.WORLD_SHAPE | me.collision.types.ENEMY_OBJECT | me.collision.types.COLLECTABLE_OBJECT);\n         * ...\n         * // disable collision detection with all other objects\n         * myEntity.body.setCollisionMask(me.collision.types.NO_OBJECT);\n         */\n        setCollisionMask : function (bitmask) {\n            this.collisionMask = bitmask;\n        },\n\n        /**\n         * the built-in function to solve the collision response\n         * @protected\n         * @name respondToCollision\n         * @memberOf me.Body\n         * @function\n         * @param {me.collision.ResponseObject} response the collision response object\n         */\n        respondToCollision: function (response) {\n            // the overlap vector\n            var overlap = response.overlapV;\n\n            // FIXME: Respond proportionally to object mass\n\n            // Move out of the other object shape\n            this.entity.pos.sub(overlap);\n\n            // adjust velocity\n            if (overlap.x !== 0) {\n                this.vel.x = ~~(0.5 + this.vel.x - overlap.x) || 0;\n            }\n            if (overlap.y !== 0) {\n                this.vel.y = ~~(0.5 + this.vel.y - overlap.y) || 0;\n\n                // cancel the falling an jumping flags if necessary\n                this.falling = overlap.y >= 1;\n                this.jumping = overlap.y <= -1;\n            }\n        },\n\n        /**\n         * update the body bounding rect (private)\n         * the body rect size is here used to cache the total bounding rect\n         * @private\n         * @name updateBounds\n         * @memberOf me.Body\n         * @function\n         */\n        updateBounds : function () {\n            if (this.shapes.length > 0) {\n                // reset the rect with default values\n                var _bounds = this.shapes[0].getBounds();\n                this.pos.setV(_bounds.pos);\n                this.resize(_bounds.width, _bounds.height);\n\n                for (var i = 1 ; i < this.shapes.length; i++) {\n                    this.union(this.shapes[i].getBounds());\n                }\n            }\n\n            // update the parent entity bounds\n            this.entity.onBodyUpdate(this.pos, this.width, this.height);\n\n            return this;\n        },\n\n        /**\n         * set the entity default velocity<br>\n         * note : velocity is by default limited to the same value, see\n         * setMaxVelocity if needed<br>\n         * @name setVelocity\n         * @memberOf me.Body\n         * @function\n         * @param {Number} x velocity on x axis\n         * @param {Number} y velocity on y axis\n         * @protected\n         */\n        setVelocity : function (x, y) {\n            this.accel.x = x !== 0 ? x : this.accel.x;\n            this.accel.y = y !== 0 ? y : this.accel.y;\n\n            // limit by default to the same max value\n            this.setMaxVelocity(x, y);\n        },\n\n        /**\n         * cap the entity velocity to the specified value<br>\n         * @name setMaxVelocity\n         * @memberOf me.Body\n         * @function\n         * @param {Number} x max velocity on x axis\n         * @param {Number} y max velocity on y axis\n         * @protected\n         */\n        setMaxVelocity : function (x, y) {\n            this.maxVel.x = x;\n            this.maxVel.y = y;\n        },\n\n        /**\n         * set the entity default friction<br>\n         * @name setFriction\n         * @memberOf me.Body\n         * @function\n         * @param {Number} x horizontal friction\n         * @param {Number} y vertical friction\n         * @protected\n         */\n        setFriction : function (x, y) {\n            this.friction.x = x || 0;\n            this.friction.y = y || 0;\n        },\n\n        /**\n         * apply friction to a vector\n         * @ignore\n         */\n        applyFriction : function (vel) {\n            var fx = this.friction.x * me.timer.tick,\n                nx = vel.x + fx,\n                x = vel.x - fx,\n                fy = this.friction.y * me.timer.tick,\n                ny = vel.y + fy,\n                y = vel.y - fy;\n\n            vel.x = (\n                (nx < 0) ? nx :\n                ( x > 0) ? x  : 0\n            );\n            vel.y = (\n                (ny < 0) ? ny :\n                ( y > 0) ? y  : 0\n            );\n        },\n\n        /**\n         * compute the new velocity value\n         * @ignore\n         */\n        computeVelocity : function (vel) {\n\n            // apply gravity (if any)\n            if (this.gravity) {\n                // apply a constant gravity (if not on a ladder)\n                vel.y += this.gravity * me.timer.tick;\n\n                // check if falling / jumping\n                this.falling = (vel.y > 0);\n                this.jumping = (this.falling ? false : this.jumping);\n            }\n\n            // apply friction\n            if (this.friction.x || this.friction.y) {\n                this.applyFriction(vel);\n            }\n\n            // cap velocity\n            if (vel.y !== 0) {\n                vel.y = vel.y.clamp(-this.maxVel.y, this.maxVel.y);\n            }\n            if (vel.x !== 0) {\n                vel.x = vel.x.clamp(-this.maxVel.x, this.maxVel.x);\n            }\n        },\n\n        /**\n         * update the body position\n         * @name update\n         * @memberOf me.Body\n         * @function\n         * @return {boolean} true if resulting velocity is different than 0\n         */\n        update : function (/* dt */) {\n            // update the velocity\n            this.computeVelocity(this.vel);\n\n            // update player entity position\n            this.entity.pos.add(this.vel);\n\n            // returns true if vel is different from 0\n            return (this.vel.x !== 0 || this.vel.y !== 0);\n        },\n\n        /**\n         * Destroy function<br>\n         * @ignore\n         */\n        destroy : function () {\n            this.entity = null;\n            this.shapes = [];\n        }\n    });\n\n    /**\n     * Base class for Body exception handling.\n     * @name Error\n     * @class\n     * @memberOf me.Body\n     * @constructor\n     * @param {String} msg Error message.\n     */\n    me.Body.Error = me.Error.extend({\n        init : function (msg) {\n            me.Error.prototype.init.apply(this, [ msg ]);\n            this.name = \"me.Body.Error\";\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n * A QuadTree implementation in JavaScript, a 2d spatial subdivision algorithm.\n * Based on the QuadTree Library by Timo Hausmann and released under the MIT license\n * https://github.com/timohausmann/quadtree-js/\n**/\n\n(function () {\n\n\n    /**\n     * a pool of `QuadTree` objects\n     */\n    var QT_ARRAY = [];\n\n    /**\n     * will pop a quadtree object from the array\n     * or create a new one if the array is empty\n     */\n    var QT_ARRAY_POP = function (bounds, max_objects, max_levels, level) {\n        if (QT_ARRAY.length > 0) {\n            var _qt =  QT_ARRAY.pop();\n            _qt.bounds = bounds;\n            _qt.max_objects = max_objects || 4;\n            _qt.max_levels  = max_levels || 4;\n            _qt.level = level || 0;\n            return _qt;\n        } else {\n            return new me.QuadTree(bounds, max_objects, max_levels, level);\n        }\n    };\n\n    /**\n     * Push back a quadtree back into the array\n     */\n    var QT_ARRAY_PUSH = function (qt) {\n        QT_ARRAY.push(qt);\n    };\n\n\n    /**\n     * Quadtree Constructor <br>\n     * note: the global quadtree instance is available through `me.collision.quadTree`\n     * @class\n     * @name QuadTree\n     * @extends Object\n     * @memberOf me\n     * @constructor\n     * @see me.collision.quadTree\n     * @param {me.Rect} bounds bounds of the node\n     * @param {Number} [max_objects=4] max objects a node can hold before splitting into 4 subnodes\n     * @param {Number} [max_levels=4] total max levels inside root Quadtree\n     * @param {Number} [level] deepth level, required for subnodes\n     */\n    function Quadtree(bounds, max_objects, max_levels, level) {\n        this.max_objects = max_objects || 4;\n        this.max_levels  = max_levels || 4;\n\n        this.level = level || 0;\n        this.bounds = bounds;\n\n        this.objects = [];\n        this.nodes = [];\n    }\n\n\n    /*\n     * Split the node into 4 subnodes\n     */\n    Quadtree.prototype.split = function () {\n\n        var nextLevel = this.level + 1,\n            subWidth  = ~~(0.5 + this.bounds.width / 2),\n            subHeight = ~~(0.5 + this.bounds.height / 2),\n            x = ~~(0.5 + this.bounds.pos.x),\n            y = ~~(0.5 + this.bounds.pos.y);\n\n         //top right node\n        this.nodes[0] = QT_ARRAY_POP({\n            pos : {\n                x : x + subWidth,\n                y : y\n            },\n            width : subWidth,\n            height : subHeight\n        }, this.max_objects, this.max_levels, nextLevel);\n\n        //top left node\n        this.nodes[1] = QT_ARRAY_POP({\n            pos : {\n                x : x,\n                y : y\n            },\n            width : subWidth,\n            height : subHeight\n        }, this.max_objects, this.max_levels, nextLevel);\n\n        //bottom left node\n        this.nodes[2] = QT_ARRAY_POP({\n            pos : {\n                x : x,\n                y : y + subHeight\n            },\n            width : subWidth,\n            height : subHeight\n        }, this.max_objects, this.max_levels, nextLevel);\n\n        //bottom right node\n        this.nodes[3] = QT_ARRAY_POP({\n            pos : {\n                x : x + subWidth,\n                y : y + subHeight\n            },\n            width : subWidth,\n            height : subHeight\n        }, this.max_objects, this.max_levels, nextLevel);\n    };\n\n\n    /*\n     * Determine which node the object belongs to\n     * @param {me.Rect} rect bounds of the area to be checked\n     * @return Integer index of the subnode (0-3), or -1 if rect cannot completely fit within a subnode and is part of the parent node\n     */\n    Quadtree.prototype.getIndex = function (rect) {\n\n        var index = -1,\n            rx = rect.pos.x,\n            ry = rect.pos.y,\n            rw = rect.width,\n            rh = rect.height,\n            verticalMidpoint = this.bounds.pos.x + (this.bounds.width / 2),\n            horizontalMidpoint = this.bounds.pos.y + (this.bounds.height / 2),\n            //rect can completely fit within the top quadrants\n            topQuadrant = (ry < horizontalMidpoint && ry + rh < horizontalMidpoint),\n            //rect can completely fit within the bottom quadrants\n            bottomQuadrant = (ry > horizontalMidpoint);\n\n        //rect can completely fit within the left quadrants\n        if (rx < verticalMidpoint && rx + rw < verticalMidpoint) {\n            if (topQuadrant) {\n                index = 1;\n            } else if (bottomQuadrant) {\n                index = 2;\n            }\n        } else if (rx > verticalMidpoint) {\n            //rect can completely fit within the right quadrants\n            if (topQuadrant) {\n                index = 0;\n            } else if (bottomQuadrant) {\n                index = 3;\n            }\n        }\n\n        return index;\n    };\n\n    /**\n     * Insert the given object container into the node.\n     * @name insertContainer\n     * @memberOf me.QuadTree\n     * @function\n     * @param {me.Container} container group of objects to be added\n     */\n    Quadtree.prototype.insertContainer = function (container) {\n\n        for (var i = container.children.length, child; i--, (child = container.children[i]);) {\n            if (child instanceof me.Container) {\n                // recursivly insert childs\n                this.insertContainer(child);\n            } else {\n                // only insert object with a bounding box\n                if (typeof (child.getBounds) === \"function\") {\n                    this.insert(child);\n                }\n            }\n        }\n    };\n\n    /**\n     * Insert the given object into the node. If the node\n     * exceeds the capacity, it will split and add all\n     * objects to their corresponding subnodes.\n     * @name insert\n     * @memberOf me.QuadTree\n     * @function\n     * @param {Object} item object to be added\n     */\n    Quadtree.prototype.insert = function (item) {\n\n        var index = -1;\n\n        //if we have subnodes ...\n        if (this.nodes.length > 0) {\n            index = this.getIndex(item.getBounds());\n\n            if (index !== -1) {\n                this.nodes[index].insert(item);\n                return;\n            }\n        }\n\n        this.objects.push(item);\n\n        if (this.objects.length > this.max_objects && this.level < this.max_levels) {\n\n            //split if we don't already have subnodes\n            if (this.nodes.length === 0) {\n                this.split();\n            }\n\n            var i = 0;\n\n            //add all objects to there corresponding subnodes\n            while (i < this.objects.length) {\n\n                index = this.getIndex(this.objects[i].getBounds());\n\n                if (index !== -1) {\n                    this.nodes[index].insert(this.objects.splice(i, 1)[0]);\n                } else {\n                    i = i + 1;\n                }\n            }\n        }\n    };\n\n    /**\n     * Return all objects that could collide with the given object\n     * @name retrieve\n     * @memberOf me.QuadTree\n     * @function\n     * @param {Object} object object to be checked against\n     * @param {Object} [function] a sorting function for the returned array\n     * @return {Object[]} array with all detected objects\n     */\n    Quadtree.prototype.retrieve = function (item, fn) {\n\n        var returnObjects = this.objects;\n\n        //if we have subnodes ...\n        if (this.nodes.length > 0) {\n\n            var index = this.getIndex(item.getBounds());\n\n            //if rect fits into a subnode ..\n            if (index !== -1) {\n                returnObjects = returnObjects.concat(this.nodes[index].retrieve(item));\n            } else {\n                 //if rect does not fit into a subnode, check it against all subnodes\n                for (var i = 0; i < this.nodes.length; i = i + 1) {\n                    returnObjects = returnObjects.concat(this.nodes[i].retrieve(item));\n                }\n            }\n        }\n\n        if (typeof(fn) === \"function\") {\n            returnObjects.sort(fn);\n        }\n\n        return returnObjects;\n    };\n\n\n    /**\n     * clear the quadtree\n     * @name clear\n     * @memberOf me.QuadTree\n     * @function\n     */\n    Quadtree.prototype.clear = function (bounds) {\n\n        this.objects.length = 0;\n\n        for (var i = 0; i < this.nodes.length; i = i + 1) {\n            this.nodes[i].clear();\n            // recycle the quadTree object\n            QT_ARRAY_PUSH(this.nodes[i]);\n        }\n        // empty the array\n        this.nodes = [];\n\n        // resize the root bounds if required\n        if (typeof bounds !== \"undefined\") {\n            this.bounds.setShape(bounds.pos.x, bounds.pos.y, bounds.width, bounds.height);\n        }\n    };\n\n    //make Quadtree available in the me namespace\n    me.QuadTree = Quadtree;\n\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n * Separating Axis Theorem implementation, based on the SAT.js library by Jim Riecken <jimr@jimr.ca>\n * Available under the MIT License - https://github.com/jriecken/sat-js\n */\n\n(function () {\n\n    /**\n     * Constants for Vornoi regions\n     * @ignore\n     */\n    var LEFT_VORNOI_REGION = -1;\n\n    /**\n     * Constants for Vornoi regions\n     * @ignore\n     */\n    var MIDDLE_VORNOI_REGION = 0;\n\n    /**\n     * Constants for Vornoi regions\n     * @ignore\n     */\n    var RIGHT_VORNOI_REGION = 1;\n\n\n    /**\n     * A pool of `Vector` objects that are used in calculations to avoid allocating memory.\n     * @type {Array.<Vector>}\n     */\n    var T_VECTORS = [];\n    for (var v = 0; v < 10; v++) { T_VECTORS.push(new me.Vector2d()); }\n\n    /**\n     * A pool of arrays of numbers used in calculations to avoid allocating memory.\n     * @type {Array.<Array.<number>>}\n     */\n    var T_ARRAYS = [];\n    for (var a = 0; a < 5; a++) { T_ARRAYS.push([]); }\n\n\n    /**\n     * Flattens the specified array of points onto a unit vector axis,\n     * resulting in a one dimensional range of the minimum and\n     * maximum value on that axis.\n     * @param {Array.<Vector>} points The points to flatten.\n     * @param {Vector} normal The unit vector axis to flatten on.\n     * @param {Array.<number>} result An array.  After calling this function,\n     *   result[0] will be the minimum value,\n     *   result[1] will be the maximum value.\n     */\n    function flattenPointsOn(points, normal, result) {\n        var min = Number.MAX_VALUE;\n        var max = -Number.MAX_VALUE;\n        var len = points.length;\n        for (var i = 0; i < len; i++) {\n            // The magnitude of the projection of the point onto the normal\n            var dot = points[i].dotProduct(normal);\n            if (dot < min) { min = dot; }\n            if (dot > max) { max = dot; }\n        }\n        result[0] = min;\n        result[1] = max;\n    }\n\n    /**\n     * Check whether two convex polygons are separated by the specified\n     * axis (must be a unit vector).\n     * @param {Vector} aPos The position of the first polygon.\n     * @param {Vector} bPos The position of the second polygon.\n     * @param {Array.<Vector>} aPoints The points in the first polygon.\n     * @param {Array.<Vector>} bPoints The points in the second polygon.\n     * @param {Vector} axis The axis (unit sized) to test against.  The points of both polygons\n     *   will be projected onto this axis.\n     * @param {Response=} response A Response object (optional) which will be populated\n     *   if the axis is not a separating axis.\n     * @return {boolean} true if it is a separating axis, false otherwise.  If false,\n     *   and a response is passed in, information about how much overlap and\n     *   the direction of the overlap will be populated.\n     */\n    function isSeparatingAxis(aPos, bPos, aPoints, bPoints, axis, response) {\n        var rangeA = T_ARRAYS.pop();\n        var rangeB = T_ARRAYS.pop();\n        // The magnitude of the offset between the two polygons\n        var offsetV = T_VECTORS.pop().copy(bPos).sub(aPos);\n        var projectedOffset = offsetV.dotProduct(axis);\n\n        // Project the polygons onto the axis.\n        flattenPointsOn(aPoints, axis, rangeA);\n        flattenPointsOn(bPoints, axis, rangeB);\n        // Move B's range to its position relative to A.\n        rangeB[0] += projectedOffset;\n        rangeB[1] += projectedOffset;\n        // Check if there is a gap. If there is, this is a separating axis and we can stop\n        if (rangeA[0] > rangeB[1] || rangeB[0] > rangeA[1]) {\n            T_VECTORS.push(offsetV);\n            T_ARRAYS.push(rangeA);\n            T_ARRAYS.push(rangeB);\n            return true;\n        }\n\n        // This is not a separating axis. If we're calculating a response, calculate the overlap.\n        if (response) {\n            var overlap = 0;\n            // A starts further left than B\n            if (rangeA[0] < rangeB[0]) {\n                response.aInB = false;\n                // A ends before B does. We have to pull A out of B\n                if (rangeA[1] < rangeB[1]) {\n                    overlap = rangeA[1] - rangeB[0];\n                    response.bInA = false;\n                // B is fully inside A.  Pick the shortest way out.\n                } else {\n                    var option1 = rangeA[1] - rangeB[0];\n                    var option2 = rangeB[1] - rangeA[0];\n                    overlap = option1 < option2 ? option1 : -option2;\n                }\n            // B starts further left than A\n            } else {\n                response.bInA = false;\n                // B ends before A ends. We have to push A out of B\n                if (rangeA[1] > rangeB[1]) {\n                    overlap = rangeA[0] - rangeB[1];\n                    response.aInB = false;\n                // A is fully inside B.  Pick the shortest way out.\n                } else {\n                    var option11 = rangeA[1] - rangeB[0];\n                    var option22 = rangeB[1] - rangeA[0];\n                    overlap = option11 < option22 ? option11 : -option22;\n                }\n            }\n\n            // If this is the smallest amount of overlap we've seen so far, set it as the minimum overlap.\n            var absOverlap = Math.abs(overlap);\n            if (absOverlap < response.overlap) {\n                response.overlap = absOverlap;\n                response.overlapN.copy(axis);\n                if (overlap < 0) {\n                    response.overlapN.negateSelf();\n                }\n            }\n        }\n        T_VECTORS.push(offsetV);\n        T_ARRAYS.push(rangeA);\n        T_ARRAYS.push(rangeB);\n        return false;\n    }\n\n\n    /**\n     * Calculates which Vornoi region a point is on a line segment. <br>\n     * It is assumed that both the line and the point are relative to `(0,0)`<br>\n     * <pre>\n     *             |       (0)      |\n     *      (-1)  [S]--------------[E]  (1)\n     *             |       (0)      |\n     * </pre>\n     *\n     * @ignore\n     * @param {Vector} line The line segment.\n     * @param {Vector} point The point.\n     * @return  {number} LEFT_VORNOI_REGION (-1) if it is the left region,\n     *          MIDDLE_VORNOI_REGION (0) if it is the middle region,\n     *          RIGHT_VORNOI_REGION (1) if it is the right region.\n     */\n    function vornoiRegion(line, point) {\n        var len2 = line.length2();\n        var dp = point.dotProduct(line);\n        if (dp < 0) {\n            // If the point is beyond the start of the line, it is in the\n            // left vornoi region.\n            return LEFT_VORNOI_REGION;\n        } else if (dp > len2) {\n            // If the point is beyond the end of the line, it is in the\n            // right vornoi region.\n            return RIGHT_VORNOI_REGION;\n        } else {\n            // Otherwise, it's in the middle one.\n            return MIDDLE_VORNOI_REGION;\n        }\n    }\n\n    /**\n     * A singleton for managing collision detection (and projection-based collision response) of 2D shapes.<br>\n     * Based on the Separating Axis Theorem and supports detecting collisions between simple Axis-Aligned Boxes, convex polygons and circles based shapes.\n     * @namespace me.collision\n     * @memberOf me\n     */\n    me.collision = (function () {\n        // hold public stuff in our singleton\n        var api = {};\n\n        /*\n         * PUBLIC STUFF\n         */\n\n        /**\n         * the world quadtree used for the collision broadphase\n         * @name quadTree\n         * @memberOf me.collision\n         * @public\n         * @type {me.QuadTree}\n         */\n        api.quadTree = null;\n\n        /**\n         * The maximum number of levels that the quadtree will create. Default is 4.\n         * @name maxDepth\n         * @memberOf me.collision\n         * @public\n         * @type {number}\n         * @see me.collision.quadTree\n         *\n         */\n        api.maxDepth = 4;\n\n        /**\n         * The maximum number of children that a quadtree node can contain before it is split into sub-nodes. Default is 8.\n         * @name maxChildren\n         * @memberOf me.collision\n         * @public\n         * @type {boolean}\n         * @see me.collision.quadTree\n         */\n        api.maxChildren = 8;\n\n        /**\n         * bounds of the physic world.\n         * @name bounds\n         * @memberOf me.collision\n         * @public\n         * @type {me.Rect}\n         */\n        api.bounds = null;\n\n        /**\n         * Enum for collision type values.\n         * @property NO_OBJECT to disable collision check\n         * @property PLAYER_OBJECT\n         * @property NPC_OBJECT\n         * @property ENEMY_OBJECT\n         * @property COLLECTABLE_OBJECT\n         * @property ACTION_OBJECT e.g. doors\n         * @property PROJECTILE_OBJECT e.g. missiles\n         * @property WORLD_SHAPE e.g. walls; for map collision shapes\n         * @property USER user-defined collision types (see example)\n         * @property ALL_OBJECT all of the above (including user-defined types)\n         * @readonly\n         * @enum {Number}\n         * @name types\n         * @memberOf me.collision\n         * @see me.body.setCollisionMask\n         * @see me.body.collisionType\n         * @example\n         * // set the entity body collision type\n         * myEntity.body.collisionType = me.collision.types.PLAYER_OBJECT;\n         *\n         * // filter collision detection with collision shapes, enemies and collectables\n         * myEntity.body.setCollisionMask(\n         *     me.collision.types.WORLD_SHAPE |\n         *     me.collision.types.ENEMY_OBJECT |\n         *     me.collision.types.COLLECTABLE_OBJECT\n         * );\n         *\n         * // User-defined collision types are defined using BITWISE LEFT-SHIFT:\n         * game.collisionTypes = {\n         *     LOCKED_DOOR : me.collision.types.USER << 0,\n         *     OPEN_DOOR   : me.collision.types.USER << 1,\n         *     LOOT        : me.collision.types.USER << 2,\n         * };\n         *\n         * // Set collision type for a door entity\n         * myDoorEntity.body.collisionType = game.collisionTypes.LOCKED_DOOR;\n         *\n         * // Set collision mask for the player entity, so it collides with locked doors and loot\n         * myPlayerEntity.body.setCollisionMask(\n         *     me.collision.types.ENEMY_OBJECT |\n         *     me.collision.types.WORLD_SHAPE |\n         *     game.collisionTypes.LOCKED_DOOR |\n         *     game.collisionTypes.LOOT\n         * );\n         */\n        api.types = {\n            /** to disable collision check */\n            NO_OBJECT           : 0,\n            PLAYER_OBJECT       : 1 << 0,\n            NPC_OBJECT          : 1 << 1,\n            ENEMY_OBJECT        : 1 << 2,\n            COLLECTABLE_OBJECT  : 1 << 3,\n            ACTION_OBJECT       : 1 << 4, // door, etc...\n            PROJECTILE_OBJECT   : 1 << 5, // missiles, etc...\n            WORLD_SHAPE         : 1 << 6, // walls, etc...\n            USER                : 1 << 7, // user-defined types start here...\n            ALL_OBJECT          : 0xFFFFFFFF // all objects\n        };\n\n        /**\n         * Initialize the collision/physic world\n         * @ignore\n         */\n        api.init = function () {\n            // default bounds to the game viewport\n            api.bounds = me.game.viewport.clone();\n            // initializa the quadtree\n            api.quadTree = new me.QuadTree(api.bounds, api.maxChildren, api.maxDepth);\n\n            // reset the collision detection engine if a TMX level is loaded\n            me.event.subscribe(me.event.LEVEL_LOADED, function () {\n                // default bounds to game world\n                api.bounds = me.game.world.clone();\n                // reset the quadtree\n                api.quadTree.clear(api.bounds);\n            });\n        };\n\n        /**\n         * An object representing the result of an intersection.\n         * @property {me.Entity} a The first object participating in the intersection\n         * @property {me.Entity} b The second object participating in the intersection\n         * @property {Number} overlap Magnitude of the overlap on the shortest colliding axis\n         * @property {me.Vector2d} overlapV The overlap vector (i.e. `overlapN.scale(overlap, overlap)`). If this vector is subtracted from the position of a, a and b will no longer be colliding\n         * @property {me.Vector2d} overlapN The shortest colliding axis (unit-vector)\n         * @property {Boolean} aInB Whether the first object is entirely inside the second\n         * @property {Boolean} bInA Whether the second object is entirely inside the first\n         * @property {Number} indexShapeA The index of the colliding shape for the object a body\n         * @property {Number} indexShapeB The index of the colliding shape for the object b body\n         * @name ResponseObject\n         * @memberOf me.collision\n         * @public\n         * @type {Object}\n         * @see me.collision.check\n         */\n        api.ResponseObject = function () {\n            this.a = null;\n            this.b = null;\n            this.overlapN = new me.Vector2d();\n            this.overlapV = new me.Vector2d();\n            this.aInB = true;\n            this.bInA = true;\n            this.indexShapeA = -1;\n            this.indexShapeB = -1;\n            this.overlap = Number.MAX_VALUE;\n        };\n\n        /**\n         * Set some values of the response back to their defaults. <br>\n         * Call this between tests if you are going to reuse a single <br>\n         * Response object for multiple intersection tests <br>\n         * (recommended as it will avoid allocating extra memory) <br>\n         * @name clear\n         * @memberOf me.collision.ResponseObject\n         * @public\n         * @function\n         */\n        api.ResponseObject.prototype.clear = function () {\n            this.aInB = true;\n            this.bInA = true;\n            this.overlap = Number.MAX_VALUE;\n            this.indexShapeA = -1;\n            this.indexShapeB = -1;\n            return this;\n        };\n\n        /**\n         * a global instance of a response object used for collision detection <br>\n         * this object will be reused amongst collision detection call if not user-defined response is specified\n         * @name response\n         * @memberOf me.collision\n         * @public\n         * @type {me.collision.ResponseObject}\n         */\n        api.response = new api.ResponseObject();\n\n        /**\n         * a callback used to determine if two objects should collide (based on both respective objects collision mask and type).<br>\n         * you can redefine this function if you need any specific rules over what should collide with what.\n         * @name shouldCollide\n         * @memberOf me.collision\n         * @public\n         * @function\n         * @param {me.Entity} a a reference to the object A.\n         * @param {me.Entity} b a reference to the object B.\n         * @return {Boolean} true if they should collide, false otherwise\n         */\n        api.shouldCollide = function (a, b) {\n            return (\n                a.body && b.body &&\n                (a.body.collisionMask & b.body.collisionType) !== 0 &&\n                (a.body.collisionType & b.body.collisionMask) !== 0\n            );\n        };\n\n        /**\n         * Checks if the specified entity collides with others entities\n         * @name check\n         * @memberOf me.collision\n         * @public\n         * @function\n         * @param {me.Entity} obj entity to be tested for collision\n         * @param {me.collision.ResponseObject} [respObj=me.collision.response] a user defined response object that will be populated if they intersect.\n         * @return {Boolean} in case of collision, false otherwise\n         * @example\n         * update : function (dt) {\n         *    // ...\n         *\n         *    // handle collisions against other shapes\n         *    me.collision.check(this);\n         *\n         *    // ...\n         * },\n         *\n         * // colision handler\n         * onCollision : function (response) {\n         *     if (response.b.body.collisionType === me.collision.types.ENEMY_OBJECT) {\n         *         // makes the other entity solid, by substracting the overlap vector to the current position\n         *         this.pos.sub(response.overlapV);\n         *         this.hurt();\n         *         // not solid\n         *         return false;\n         *     }\n         *     // Make the object solid\n         *     return true;\n         * },\n         */\n        api.check = function (objA, responseObject) {\n            var collision = 0;\n            var response = responseObject || api.response;\n\n            // retreive a list of potential colliding objects\n            var candidates = api.quadTree.retrieve(objA);\n\n            for (var i = candidates.length, objB; i--, (objB = candidates[i]);) {\n\n                // check if both objects \"should\" collide\n                if ((objB !== objA) && api.shouldCollide(objA, objB) &&\n                    // fast AABB check if both bounding boxes are overlaping\n                    objA.getBounds().overlaps(objB.getBounds())) {\n\n                    // go trough all defined shapes in A\n                    var aLen = objA.body.shapes.length;\n                    var bLen = objB.body.shapes.length;\n                    if (aLen === 0 || bLen === 0) {\n                        continue;\n                    }\n\n                    var indexA = 0;\n                    do {\n                        var shapeA = objA.body.getShape(indexA);\n                        // go through all defined shapes in B\n                        var indexB = 0;\n                        do {\n                            var shapeB = objB.body.getShape(indexB);\n\n                            // full SAT collision check\n                            if (api[\"test\" + shapeA.shapeType + shapeB.shapeType]\n                                .call(\n                                    this,\n                                    objA, // a reference to the object A\n                                    shapeA,\n                                    objB,  // a reference to the object B\n                                    shapeB,\n                                     // clear response object before reusing\n                                    response.clear()) === true\n                            ) {\n                                // we touched something !\n                                collision++;\n\n                                // set the shape index\n                                response.indexShapeA = indexA;\n                                response.indexShapeB = indexB;\n\n                                // execute the onCollision callback\n                                if (objA.onCollision(response, objB) !== false) {\n                                    objA.body.respondToCollision.call(objA.body, response);\n                                }\n                                if (objB.onCollision(response, objA) !== false) {\n                                    objB.body.respondToCollision.call(objB.body, response);\n                                }\n                            }\n                            indexB++;\n                        } while (indexB < bLen);\n                        indexA++;\n                    } while (indexA < aLen);\n                }\n            }\n            // we could return the amount of objects we collided with ?\n            return collision > 0;\n        };\n\n        /**\n         * Checks whether polygons collide.\n         * @ignore\n         * @param {me.Entity} a a reference to the object A.\n         * @param {me.Polygon} polyA a reference to the object A Polygon to be tested\n         * @param {me.Entity} b a reference to the object B.\n         * @param {me.Polygon} polyB a reference to the object B Polygon to be tested\n         * @param {Response=} response Response object (optional) that will be populated if they intersect.\n         * @return {boolean} true if they intersect, false if they don't.\n         */\n        api.testPolygonPolygon = function (a, polyA, b, polyB, response) {\n            // specific point for\n            var aPoints = polyA.points;\n            var aNormals = polyA.normals;\n            var aLen = aNormals.length;\n            var bPoints = polyB.points;\n            var bNormals = polyB.normals;\n            var bLen = bNormals.length;\n            // aboslute shape position\n            var posA = T_VECTORS.pop().copy(a.pos).add(a.ancestor._absPos).add(polyA.pos);\n            var posB = T_VECTORS.pop().copy(b.pos).add(b.ancestor._absPos).add(polyB.pos);\n            var i;\n\n            // If any of the edge normals of A is a separating axis, no intersection.\n            for (i = 0; i < aLen; i++) {\n                if (isSeparatingAxis(posA, posB, aPoints, bPoints, aNormals[i], response)) {\n                    T_VECTORS.push(posA);\n                    T_VECTORS.push(posB);\n                    return false;\n                }\n            }\n\n            // If any of the edge normals of B is a separating axis, no intersection.\n            for (i = 0;i < bLen; i++) {\n                if (isSeparatingAxis(posA, posB, aPoints, bPoints, bNormals[i], response)) {\n                    T_VECTORS.push(posA);\n                    T_VECTORS.push(posB);\n                    return false;\n                }\n            }\n\n            // Since none of the edge normals of A or B are a separating axis, there is an intersection\n            // and we've already calculated the smallest overlap (in isSeparatingAxis).  Calculate the\n            // final overlap vector.\n            if (response) {\n                response.a = a;\n                response.b = b;\n                response.overlapV.copy(response.overlapN).scale(response.overlap);\n            }\n            T_VECTORS.push(posA);\n            T_VECTORS.push(posB);\n            return true;\n        };\n\n        /**\n         * Check if two Ellipse collide.\n         * @ignore\n         * @param {me.Entity} a a reference to the object A.\n         * @param {me.Ellipse} ellipseA a reference to the object A Ellipse to be tested\n         * @param {me.Entity} b a reference to the object B.\n         * @param {me.Ellipse} ellipseB a reference to the object B Ellipse to be tested\n         * @param {Response=} response Response object (optional) that will be populated if\n         *   the circles intersect.\n         * @return {boolean} true if the circles intersect, false if they don't.\n         */\n        api.testEllipseEllipse = function (a, ellipseA, b, ellipseB, response) {\n            // Check if the distance between the centers of the two\n            // circles is greater than their combined radius.\n            var differenceV = T_VECTORS.pop().copy(b.pos).add(b.ancestor._absPos).add(ellipseB.pos)\n                .sub(a.pos).add(a.ancestor._absPos).sub(ellipseA.pos);\n            var radiusA = ellipseA.radius;\n            var radiusB = ellipseB.radius;\n            var totalRadius = radiusA + radiusB;\n            var totalRadiusSq = totalRadius * totalRadius;\n            var distanceSq = differenceV.length2();\n            // If the distance is bigger than the combined radius, they don't intersect.\n            if (distanceSq > totalRadiusSq) {\n                T_VECTORS.push(differenceV);\n                return false;\n            }\n            // They intersect.  If we're calculating a response, calculate the overlap.\n            if (response) {\n                var dist = Math.sqrt(distanceSq);\n                response.a = a;\n                response.b = b;\n                response.overlap = totalRadius - dist;\n                response.overlapN.copy(differenceV.normalize());\n                response.overlapV.copy(differenceV).scale(response.overlap);\n                response.aInB = radiusA <= radiusB && dist <= radiusB - radiusA;\n                response.bInA = radiusB <= radiusA && dist <= radiusA - radiusB;\n            }\n            T_VECTORS.push(differenceV);\n            return true;\n        };\n\n        /**\n         * Check if a polygon and an ellipse collide.\n         * @ignore\n         * @param {me.Entity} a a reference to the object A.\n         * @param {me.Polygon} polyA a reference to the object A Polygon to be tested\n         * @param {me.Entity} b a reference to the object B.\n         * @param {me.Ellipse} ellipseB a reference to the object B Ellipse to be tested\n         * @param {Response=} response Response object (optional) that will be populated if they intersect.\n         * @return {boolean} true if they intersect, false if they don't.\n         */\n        api.testPolygonEllipse = function (a, polyA, b, ellipseB, response) {\n            // Get the position of the circle relative to the polygon.\n            var circlePos = T_VECTORS.pop().copy(b.pos).add(b.ancestor._absPos).add(ellipseB.pos)\n                .sub(a.pos).add(a.ancestor._absPos).sub(polyA.pos);\n            var radius = ellipseB.radius;\n            var radius2 = radius * radius;\n            var points = polyA.points;\n            var edges = polyA.edges;\n            var len = edges.length;\n            var edge = T_VECTORS.pop();\n            var normal = T_VECTORS.pop();\n            var point = T_VECTORS.pop();\n            var dist = 0;\n\n            // For each edge in the polygon:\n            for (var i = 0; i < len; i++) {\n                var next = i === len - 1 ? 0 : i + 1;\n                var prev = i === 0 ? len - 1 : i - 1;\n                var overlap = 0;\n                var overlapN = null;\n\n                // Get the edge.\n                edge.copy(edges[i]);\n                // Calculate the center of the circle relative to the starting point of the edge.\n                point.copy(circlePos).sub(points[i]);\n\n                // If the distance between the center of the circle and the point\n                // is bigger than the radius, the polygon is definitely not fully in\n                // the circle.\n                if (response && point.length2() > radius2) {\n                    response.aInB = false;\n                }\n\n                // Calculate which Vornoi region the center of the circle is in.\n                var region = vornoiRegion(edge, point);\n                var inRegion = true;\n                // If it's the left region:\n                if (region === LEFT_VORNOI_REGION) {\n                    var point2 = null;\n                    if (len > 1) {\n                        // We need to make sure we're in the RIGHT_VORNOI_REGION of the previous edge.\n                        edge.copy(edges[prev]);\n                        // Calculate the center of the circle relative the starting point of the previous edge\n                        point2 = T_VECTORS.pop().copy(circlePos).sub(points[prev]);\n                        region = vornoiRegion(edge, point2);\n                        if (region !== RIGHT_VORNOI_REGION) {\n                            inRegion = false;\n                        }\n                    }\n\n                    if (inRegion) {\n                        // It's in the region we want.  Check if the circle intersects the point.\n                        dist = point.length();\n                        if (dist > radius) {\n                            // No intersection\n                            T_VECTORS.push(circlePos);\n                            T_VECTORS.push(edge);\n                            T_VECTORS.push(normal);\n                            T_VECTORS.push(point);\n                            if (point2) {\n                                T_VECTORS.push(point2);\n                            }\n                            return false;\n                        } else if (response) {\n                            // It intersects, calculate the overlap.\n                            response.bInA = false;\n                            overlapN = point.normalize();\n                            overlap = radius - dist;\n                        }\n                    }\n\n                    if (point2) {\n                        T_VECTORS.push(point2);\n                    }\n                // If it's the right region:\n                } else if (region === RIGHT_VORNOI_REGION) {\n                    if (len > 1) {\n                        // We need to make sure we're in the left region on the next edge\n                        edge.copy(edges[next]);\n                        // Calculate the center of the circle relative to the starting point of the next edge.\n                        point.copy(circlePos).sub(points[next]);\n                        region = vornoiRegion(edge, point);\n                        if (region !== LEFT_VORNOI_REGION) {\n                            inRegion = false;\n                        }\n                    }\n\n                    if (inRegion) {\n                        // It's in the region we want.  Check if the circle intersects the point.\n                        dist = point.length();\n                        if (dist > radius) {\n                            // No intersection\n                            T_VECTORS.push(circlePos);\n                            T_VECTORS.push(edge);\n                            T_VECTORS.push(normal);\n                            T_VECTORS.push(point);\n                            return false;\n                        } else if (response) {\n                            // It intersects, calculate the overlap.\n                            response.bInA = false;\n                            overlapN = point.normalize();\n                            overlap = radius - dist;\n                        }\n                    }\n                // Otherwise, it's the middle region:\n                } else {\n                    // Need to check if the circle is intersecting the edge,\n                    // Get the normal.\n                    normal.copy(polyA.normals[i]);\n                    // Find the perpendicular distance between the center of the\n                    // circle and the edge.\n                    dist = point.dotProduct(normal);\n                    var distAbs = Math.abs(dist);\n                    // If the circle is on the outside of the edge, there is no intersection.\n                    if ((len === 1 || dist > 0) && distAbs > radius) {\n                        // No intersection\n                        T_VECTORS.push(circlePos);\n                        T_VECTORS.push(edge);\n                        T_VECTORS.push(normal);\n                        T_VECTORS.push(point);\n                        return false;\n                    } else if (response) {\n                        // It intersects, calculate the overlap.\n                        overlapN = normal;\n                        overlap = radius - dist;\n                        // If the center of the circle is on the outside of the edge, or part of the\n                        // circle is on the outside, the circle is not fully inside the polygon.\n                        if (dist >= 0 || overlap < 2 * radius) {\n                            response.bInA = false;\n                        }\n                    }\n                }\n\n                // If this is the smallest overlap we've seen, keep it.\n                // (overlapN may be null if the circle was in the wrong Vornoi region).\n                if (overlapN && response && Math.abs(overlap) < Math.abs(response.overlap)) {\n                    response.overlap = overlap;\n                    response.overlapN.copy(overlapN);\n                }\n            }\n\n            // Calculate the final overlap vector - based on the smallest overlap.\n            if (response) {\n                response.a = a;\n                response.b = b;\n                response.overlapV.copy(response.overlapN).scale(response.overlap);\n            }\n            T_VECTORS.push(circlePos);\n            T_VECTORS.push(edge);\n            T_VECTORS.push(normal);\n            T_VECTORS.push(point);\n            return true;\n        };\n\n        /**\n         * Check if an ellipse and a polygon collide. <br>\n         * **NOTE:** This is slightly less efficient than testPolygonEllipse as it just\n         * runs testPolygonEllipse and reverses the response at the end.\n         * @ignore\n         * @param {me.Entity} a a reference to the object A.\n         * @param {me.Ellipse} ellipseA a reference to the object A Ellipse to be tested\n         * @param {me.Entity} a a reference to the object B.\n         * @param {me.Polygon} polyB a reference to the object B Polygon to be tested\n         * @param {Response=} response Response object (optional) that will be populated if\n         *   they intersect.\n         * @return {boolean} true if they intersect, false if they don't.\n         */\n        api.testEllipsePolygon = function (a, ellipseA, b, polyB, response) {\n            // Test the polygon against the circle.\n            var result = api.testPolygonEllipse(b, polyB, a, ellipseA, response);\n            if (result && response) {\n                // Swap A and B in the response.\n                var resa = response.a;\n                var aInB = response.aInB;\n                response.overlapN.negateSelf();\n                response.overlapV.negateSelf();\n                response.a = response.b;\n                response.b = resa;\n                response.aInB = response.bInA;\n                response.bInA = aInB;\n            }\n            return result;\n        };\n\n        // return our object\n        return api;\n    })();\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n\n    /**\n     * A base class for renderable objects.\n     * @class\n     * @extends me.Rect\n     * @memberOf me\n     * @constructor\n     * @param {Number} x position of the renderable object\n     * @param {Number} y position of the renderable object\n     * @param {Number} width object width\n     * @param {Number} height object height\n     */\n    me.Renderable = me.Rect.extend(\n    /** @scope me.Renderable.prototype */\n    {\n        /**\n         * @ignore\n         */\n        init : function (x, y, width, height) {\n            /**\n             * to identify the object as a renderable object\n             * @ignore\n             */\n            this.isRenderable = true;\n\n           /**\n            * (G)ame (U)nique (Id)entifier\" <br>\n            * a GUID will be allocated for any renderable object added <br>\n            * to an object container (including the `me.game.world` container)\n            * @public\n            * @type String\n            * @name GUID\n            * @memberOf me.Renderable\n            */\n            this.GUID = undefined;\n\n            /**\n             * Whether the renderable object is visible and within the viewport<br>\n             * @public\n             * @readonly\n             * @type Boolean\n             * @default false\n             * @name inViewport\n             * @memberOf me.Renderable\n             */\n            this.inViewport = false;\n\n            /**\n             * Whether the renderable object will always update, even when outside of the viewport<br>\n             * @public\n             * @type Boolean\n             * @default false\n             * @name alwaysUpdate\n             * @memberOf me.Renderable\n             */\n            this.alwaysUpdate = false;\n\n            /**\n             * Whether to update this object when the game is paused.\n             * @public\n             * @type Boolean\n             * @default false\n             * @name updateWhenPaused\n             * @memberOf me.Renderable\n             */\n            this.updateWhenPaused = false;\n\n            /**\n             * make the renderable object persistent over level changes<br>\n             * @public\n             * @type Boolean\n             * @default false\n             * @name isPersistent\n             * @memberOf me.Renderable\n             */\n            this.isPersistent = false;\n\n            /**\n             * Define if a renderable follows screen coordinates (floating)<br>\n             * or the world coordinates (not floating)<br>\n             * @public\n             * @type Boolean\n             * @default false\n             * @name floating\n             * @memberOf me.Renderable\n             */\n            this.floating = false;\n\n            /**\n             * Define the object anchoring point<br>\n             * This is used when positioning, or scaling the object<br>\n             * The anchor point is a value between 0.0 and 1.0 (1.0 being the maximum size of the object) <br>\n             * (0, 0) means the top-left corner, <br>\n             * (1, 1) means the bottom-right corner, <br>\n             * @public\n             * @type me.Vector2d\n             * @default <0.5,0.5>\n             * @name anchorPoint\n             * @memberOf me.Renderable\n             */\n            this.anchorPoint = new me.Vector2d(0.5, 0.5);\n\n            /**\n             * Define the renderable opacity<br>\n             * Set to zero if you do not wish an object to be drawn\n             * @see me.Renderable#setOpacity\n             * @see me.Renderable#getOpacity\n             * @public\n             * @type Number\n             * @default 1.0\n             * @name me.Renderable#alpha\n             */\n            this.alpha = 1.0;\n\n            /**\n             * The bounding rectangle for this renderable\n             * @ignore\n             * @type {me.Rect}\n             * @name _bounds\n             * @memberOf me.Renderable\n             */\n            if (this._bounds) {\n                this._bounds.setShape(x, y, width, height);\n            }\n            else {\n                this._bounds = new me.Rect(x, y, width, height);\n            }\n\n            /**\n             * Absolute position in the game world\n             * @ignore\n             * @type {me.Vector2d}\n             * @name _absPos\n             * @memberOf me.Renderable\n             */\n            if (this._absPos) {\n                this._absPos.set(x, y);\n            }\n            else {\n                this._absPos = new me.Vector2d(x, y);\n            }\n\n            // set position to observable. Can use updateBounds, as _bounds using a regular vector.\n            // will not lead to stack too deep.\n            if (this.pos) {\n                this.pos.setMuted(x, y, 0).setCallback(this.updateBoundsPos.bind(this));\n            } else {\n                this.pos = new me.ObservableVector3d(x, y, 0, { onUpdate: this.updateBoundsPos.bind(this) });\n            }\n\n            this._width = width;\n            this._height = height;\n\n            this.shapeType = \"Rectangle\";\n\n            // ensure it's fully opaque by default\n            this.setOpacity(1.0);\n        },\n\n        /**\n         * returns the bounding box for this renderable\n         * @name getBounds\n         * @memberOf me.Renderable\n         * @function\n         * @return {me.Rect} bounding box Rectangle object\n         */\n        getBounds : function () {\n            return this._bounds;\n        },\n\n        /**\n         * get the renderable alpha channel value<br>\n         * @name getOpacity\n         * @memberOf me.Renderable\n         * @function\n         * @return {Number} current opacity value between 0 and 1\n         */\n        getOpacity : function () {\n            return this.alpha;\n        },\n\n        /**\n         * update the renderable's bounding rect dimensions\n         * @private\n         * @name resizeBounds\n         * @memberOf me.Renderable\n         * @function\n         */\n        resizeBounds : function (width, height) {\n            this._bounds.resize(width, height);\n            return this._bounds;\n        },\n\n        /**\n         * set the renderable alpha channel value<br>\n         * @name setOpacity\n         * @memberOf me.Renderable\n         * @function\n         * @param {Number} alpha opacity value between 0.0 and 1.0\n         */\n        setOpacity : function (alpha) {\n            if (typeof (alpha) === \"number\") {\n                this.alpha = alpha.clamp(0.0, 1.0);\n                // Set to 1 if alpha is NaN\n                if (this.alpha !== this.alpha) {\n                    this.alpha = 1.0;\n                }\n            }\n        },\n\n        /**\n         * update function\n         * called by the game manager on each game loop\n         * @name update\n         * @memberOf me.Renderable\n         * @function\n         * @protected\n         * @param {Number} dt time since the last update in milliseconds.\n         * @return false\n         **/\n        update : function () {\n            return false;\n        },\n\n        /**\n         * update the renderable's bounding rect (private)\n         * @private\n         * @name updateBoundsPos\n         * @memberOf me.Renderable\n         * @function\n         */\n        updateBoundsPos : function (newX, newY) {\n            this._bounds.pos.set(newX, newY);\n            // XXX: This is called from the constructor, before it gets an ancestor\n            if (this.ancestor) {\n                this._bounds.pos.add(this.ancestor._absPos);\n            }\n            return this._bounds;\n        },\n\n        /**\n         * update the bounds\n         * @private\n         * @deprecated\n         * @name updateBounds\n         * @memberOf me.Entity\n         * @function\n         */\n        updateBounds : function () {\n            console.warn(\"Deprecated: me.Renderable.updateBounds\");\n            return me.Rect.prototype.updateBounds.apply(this);\n        },\n\n        /**\n         * object draw\n         * called by the game manager on each game loop\n         * @name draw\n         * @memberOf me.Renderable\n         * @function\n         * @protected\n         * @param {me.CanvasRenderer|me.WebGLRenderer} renderer a renderer object\n         **/\n        draw : function (/*renderer*/) {\n            // empty one !\n        }\n    });\n\n    /**\n     * width of the Renderable bounding box<br>\n     * @public\n     * @type {Number}\n     * @name width\n     * @memberOf me.Renderable\n     */\n    Object.defineProperty(me.Renderable.prototype, \"width\", {\n        get : function () {\n            return this._width;\n        },\n        set : function (value) {\n            this.resizeBounds(value, this._height);\n            this._width = value;\n        },\n        configurable : true\n    });\n\n    /**\n     * height of the Renderable bounding box <br>\n     * @public\n     * @type {Number}\n     * @name height\n     * @memberOf me.Renderable\n     */\n    Object.defineProperty(me.Renderable.prototype, \"height\", {\n        get : function () {\n            return this._height;\n        },\n        set : function (value) {\n            this.resizeBounds(this._width, value);\n            this._height = value;\n        },\n        configurable : true\n    });\n\n    /**\n     * Base class for Renderable exception handling.\n     * @name Error\n     * @class\n     * @memberOf me.Renderable\n     * @constructor\n     * @param {String} msg Error message.\n     */\n    me.Renderable.Error = me.Error.extend({\n        init : function (msg) {\n            me.Error.prototype.init.apply(this, [ msg ]);\n            this.name = \"me.Renderable.Error\";\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n    /**\n     * A Simple object to display a sprite on screen.\n     * @class\n     * @extends me.Renderable\n     * @memberOf me\n     * @constructor\n     * @param {Number} x the x coordinates of the sprite object\n     * @param {Number} y the y coordinates of the sprite object\n     * @param {Object} settings Contains additional parameters for the sprite\n     * @param {me.video.renderer.Texture|Image|String} settings.image reference to a sprite image or to a texture atlas.\n     * @param {String} [settings.region] the region name containing the sprite within a specified texture atlas\n     * @param {Number} [settings.framewidth=settings.image.width] Image source width.\n     * @param {Number} [settings.frameheight=settings.image.height] Image source height.\n     * @param {Number} [settings.rotation] Initial rotation angle in radians.\n     * @param {Boolean} [settings.flipX] Initial flip for X-axis.\n     * @param {Boolean} [settings.flipY] Initial flip for Y-axis.\n     * @param {me.Vector2d} [settings.anchorPoint] Anchor point.\n     * @example\n     * // create a static Sprite Object\n     * mySprite = new me.Sprite (100, 100, {\n     *     image : me.loader.getImage(\"mySpriteImage\")\n     * });\n     */\n    me.Sprite = me.Renderable.extend(\n    /** @scope me.Sprite.prototype */\n    {\n        /**\n         * @ignore\n         */\n        init : function (x, y, settings) {\n\n            /**\n             * private/internal scale factor\n             * @ignore\n             */\n            this._scale = new me.Vector2d(1, 1);\n\n            // if true, image flipping/scaling is needed\n            this.scaleFlag = false;\n\n            // just to keep track of when we flip\n            this.lastflipX = false;\n            this.lastflipY = false;\n\n            this.flipX(!!settings.flipX);\n            this.flipY(!!settings.flipY);\n\n            // current frame texture offset\n            /**\n             * The position to draw from on the source image.\n             * @public\n             * @type me.Vector2d\n             * @name offset\n             * @memberOf me.Vector2d\n             */\n            this.offset = new me.Vector2d();\n\n            /**\n             * Set the angle (in Radians) of a sprite to rotate it <br>\n             * WARNING: rotating sprites decreases performance with Canvas Renderer\n             * @public\n             * @type Number\n             * @default 0\n             * @name me.Sprite#angle\n             */\n            this.angle = settings.rotation || 0;\n\n            /**\n             * Source rotation angle for pre-rotating the source image<br>\n             * Commonly used for TexturePacker\n             * @ignore\n             */\n            this._sourceAngle = 0;\n\n            // to manage the flickering effect\n            this.flickering = false;\n            this.flickerDuration = 0;\n            this.flickercb = null;\n            this.flickerState = false;\n\n            // Used by the game engine to adjust visibility as the\n            // sprite moves in and out of the viewport\n            this.isSprite = true;\n            \n            var image = settings.image;\n            \n            if (typeof (settings.region) !== \"undefined\") {\n                if ((typeof (image) === \"object\") && image.getRegion) {\n                    // use a texture atlas\n                    var region = image.getRegion(settings.region);\n                    if (region) {\n                        this.image = image.getTexture();\n                        // set the sprite offset within the texture\n                        this.offset.setV(region.offset);\n                        // set angle if defined\n                        this._sourceAngle = region.angle;\n                        settings.framewidth = settings.framewidth || region.width;\n                        settings.frameheight = settings.frameheight || region.height;\n                    } else {\n                        // throw an error\n                        throw new me.Renderable.Error(\"Texture - region for \" + settings.region + \" not found\");\n                    }\n                } else {\n                    // throw an error\n                    throw new me.Renderable.Error(\"Texture - invalid texture atlas : \" + image);\n                }\n            } else {\n               // use a standard image\n               this.image = me.utils.getImage(image);\n            }\n\n            // call the super constructor\n            me.Renderable.prototype.init.apply(this, [\n                x, y,\n                settings.framewidth  || image.width,\n                settings.frameheight || image.height\n            ]);\n            \n            // update anchorPoint\n            if (settings.anchorPoint) {\n                this.anchorPoint.set(settings.anchorPoint.x, settings.anchorPoint.y);\n            }\n\n        },\n\n        /**\n         * return the flickering state of the object\n         * @name isFlickering\n         * @memberOf me.Sprite\n         * @function\n         * @return {Boolean}\n         */\n        isFlickering : function () {\n            return this.flickering;\n        },\n\n        /**\n         * make the object flicker\n         * @name flicker\n         * @memberOf me.Sprite\n         * @function\n         * @param {Number} duration expressed in milliseconds\n         * @param {Function} callback Function to call when flickering ends\n         * @example\n         * // make the object flicker for 1 second\n         * // and then remove it\n         * this.flicker(1000, function () {\n         *     me.game.world.removeChild(this);\n         * });\n         */\n        flicker : function (duration, callback) {\n            this.flickerDuration = duration;\n            if (this.flickerDuration <= 0) {\n                this.flickering = false;\n                this.flickercb = null;\n            }\n            else if (!this.flickering) {\n                this.flickercb = callback;\n                this.flickering = true;\n            }\n        },\n\n        /**\n         * Flip object on horizontal axis\n         * @name flipX\n         * @memberOf me.Sprite\n         * @function\n         * @param {Boolean} flip enable/disable flip\n         */\n        flipX : function (flip) {\n            if (flip !== this.lastflipX) {\n                this.lastflipX = flip;\n\n                // invert the scale.x value\n                this._scale.x = -this._scale.x;\n\n                // set the scaleFlag\n                this.scaleFlag = this._scale.x !== 1.0 || this._scale.y !== 1.0;\n            }\n        },\n\n        /**\n         * Flip object on vertical axis\n         * @name flipY\n         * @memberOf me.Sprite\n         * @function\n         * @param {Boolean} flip enable/disable flip\n         */\n        flipY : function (flip) {\n            if (flip !== this.lastflipY) {\n                this.lastflipY = flip;\n\n                // invert the scale.x value\n                this._scale.y = -this._scale.y;\n\n                // set the scaleFlag\n                this.scaleFlag = this._scale.x !== 1.0 || this._scale.y !== 1.0;\n            }\n        },\n\n        /**\n         * scale the sprite around his center<br>\n         * @name scale\n         * @memberOf me.Sprite\n         * @function\n         * @param {Number} ratioX x scaling ratio\n         * @param {Number} ratioY y scaling ratio\n         */\n        scale : function (ratioX, ratioY) {\n            var x = ratioX;\n            var y = typeof(ratioY) === \"undefined\" ? ratioX : ratioY;\n            if (x > 0) {\n                this._scale.x = this._scale.x < 0.0 ? -x : x;\n            }\n            if (y > 0) {\n                this._scale.y = this._scale.y < 0.0 ? -y : y;\n            }\n            // set the scaleFlag\n            this.scaleFlag = this._scale.x !== 1.0 || this._scale.y !== 1.0;\n\n        },\n\n        /**\n         * scale the sprite around his center<br>\n         * @name scaleV\n         * @memberOf me.Sprite\n         * @function\n         * @param {me.Vector2d} vector ratio\n         */\n        scaleV : function (ratio) {\n            this.scale(ratio.x, ratio.y);\n        },\n\n        /**\n         * sprite update<br>\n         * not to be called by the end user<br>\n         * called by the game manager on each game loop\n         * @name update\n         * @memberOf me.Sprite\n         * @function\n         * @protected\n         * @return false\n         **/\n        update : function (dt) {\n            //update the \"flickering\" state if necessary\n            if (this.flickering) {\n                this.flickerDuration -= dt;\n                if (this.flickerDuration < 0) {\n                    if (this.flickercb) {\n                        this.flickercb();\n                    }\n                    this.flicker(-1);\n                }\n                return true;\n            }\n            return false;\n        },\n\n        /**\n         * object draw<br>\n         * not to be called by the end user<br>\n         * called by the game manager on each game loop\n         * @name draw\n         * @memberOf me.Sprite\n         * @function\n         * @protected\n         * @param {me.CanvasRenderer|me.WebGLRenderer} renderer a renderer object\n         **/\n        draw : function (renderer) {\n            // do nothing if we are flickering\n            if (this.flickering) {\n                this.flickerState = !this.flickerState;\n                if (!this.flickerState) {\n                    return;\n                }\n            }\n            // save global alpha\n            var alpha = renderer.globalAlpha();\n            // sprite alpha value\n            renderer.setGlobalAlpha(alpha * this.getOpacity());\n\n            // clamp position vector to pixel grid\n            var xpos = ~~this.pos.x, ypos = ~~this.pos.y;\n\n            var w = this.width, h = this.height;\n\n            // save context\n            renderer.save();\n\n            // calculate pixel pos of the anchor point\n            var ax = w * this.anchorPoint.x, ay = h * this.anchorPoint.y;\n            xpos -= ax;\n            ypos -= ay;\n\n            if ((this.scaleFlag) || (this.angle !== 0) || (this._sourceAngle !== 0)) {\n                // translate to the defined anchor point\n                xpos += ax;\n                ypos += ay;\n                renderer.translate(xpos, ypos);\n                // rotate\n                if (this.angle !== 0) {\n                    renderer.rotate(this.angle);\n                }\n                // scale\n                if (this.scaleFlag) {\n                    renderer.scale(this._scale.x, this._scale.y);\n                }\n                // remove image's TexturePacker/ShoeBox rotation\n                if (this._sourceAngle !== 0) {\n                    renderer.translate(-(xpos+ax), -(ypos+ay));\n                    renderer.rotate(this._sourceAngle);\n                    xpos -= this.height;\n                    w = this.height;\n                    h = this.width;\n                } else {\n                    xpos = -ax;\n                    ypos = -ay;\n                }\n            }\n\n            renderer.drawImage(\n                this.image,\n                this.offset.x, this.offset.y,   // sx,sy\n                w, h,                           // sw,sh\n                xpos, ypos,                     // dx,dy\n                w, h                            // dw,dh\n            );\n\n            // restore context\n            renderer.restore();\n\n            // restore global alpha\n            renderer.setGlobalAlpha(alpha);\n        },\n\n        /**\n         * Destroy function<br>\n         * @ignore\n         */\n        destroy : function () {\n            this.onDestroyEvent.apply(this, arguments);\n        },\n\n        /**\n         * OnDestroy Notification function<br>\n         * Called by engine before deleting the object\n         * @name onDestroyEvent\n         * @memberOf me.Sprite\n         * @function\n         */\n        onDestroyEvent : function () {\n            // to be extended !\n        }\n    });\n\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n\n    /**\n     * an object to manage animation\n     * @class\n     * @extends me.Sprite\n     * @memberOf me\n     * @constructor\n     * @param {Number} x the x coordinates of the sprite object\n     * @param {Number} y the y coordinates of the sprite object\n     * @param {Object} settings Contains additional parameters for the animation sheet\n     * @param {Image|String} settings.image Image to use for the animation\n     * @param {Number} [settings.framewidth] Width of a single frame within the spritesheet\n     * @param {Number} [settings.frameheight] Height of a single frame within the spritesheet\n     * @param {me.Vector2d} [settings.anchorPoint] Anchor point to draw the frame at\n     * @example\n     * // standalone image, with anchor in the center\n     * var animationSheet = new me.AnimationSheet(0, 0, {\n     *     image : \"animationsheet\",\n     *     framewidth : 64,\n     *     frameheight : 64,\n     *     anchorPoint : new me.Vector2d(0.5, 0.5)\n     * });\n     */\n    me.AnimationSheet = me.Sprite.extend(\n    /** @scope me.AnimationSheet.prototype */\n    {\n        /** @ignore */\n        init : function (x, y, settings) {\n\n            /**\n             * pause and resume animation<br>\n             * default value : false;\n             * @public\n             * @type Boolean\n             * @name me.AnimationSheet#animationpause\n             */\n            this.animationpause = false;\n\n            /**\n             * animation cycling speed (delay between frame in ms)<br>\n             * default value : 100ms;\n             * @public\n             * @type Number\n             * @name me.AnimationSheet#animationspeed\n             */\n            this.animationspeed = 100;\n\n            // hold all defined animation\n            this.anim = {};\n\n            // a flag to reset animation\n            this.resetAnim = null;\n\n            // default animation sequence\n            this.current = null;\n\n            // animation frame delta\n            this.dt = 0;\n\n            // default animation speed (ms)\n            this.animationspeed = 100;\n\n            // call the constructor\n            me.Sprite.prototype.init.apply(this, [ x, y, settings ]);\n\n            // store/reset the current atlas information\n            if (typeof(settings.atlas) !== \"undefined\") {\n                this.textureAtlas = settings.atlas;\n                this.atlasIndices = settings.atlasIndices;\n            } else {\n                // \"regular\" spritesheet\n                this.textureAtlas = me.video.renderer.cache.get(\n                    me.utils.getImage(settings.image),\n                    settings\n                ).getAtlas();\n                this.atlasIndices = null;\n            }\n\n            // create a default animation sequence with all sprites\n            this.addAnimation(\"default\", null);\n\n            // set as default\n            this.setCurrentAnimation(\"default\");\n        },\n\n        /**\n         * add an animation <br>\n         * For fixed-sized cell sprite sheet, the index list must follow the\n         * logic as per the following example :<br>\n         * <img src=\"images/spritesheet_grid.png\"/>\n         * @name addAnimation\n         * @memberOf me.AnimationSheet\n         * @function\n         * @param {String} name animation id\n         * @param {Number[]|String[]|Object[]} index list of sprite index or name\n         * defining the animation. Can also use objects to specify delay for each frame, see below\n         * @param {Number} [animationspeed] cycling speed for animation in ms\n         * (delay between each frame).\n         * @see me.AnimationSheet#animationspeed\n         * @example\n         * // walking animation\n         * this.addAnimation(\"walk\", [ 0, 1, 2, 3, 4, 5 ]);\n         * // eating animation\n         * this.addAnimation(\"eat\", [ 6, 6 ]);\n         * // rolling animation\n         * this.addAnimation(\"roll\", [ 7, 8, 9, 10 ]);\n         * // slower animation\n         * this.addAnimation(\"roll\", [ 7, 8, 9, 10 ], 200);\n         * // or get more specific with delay for each frame. Good solution instead of repeating:\n         * this.addAnimation(\"turn\", [{ name: 0, delay: 200 }, { name: 1, delay: 100 }])\n         * // can do this with atlas values as well:\n         * this.addAnimation(\"turn\", [{ name: \"turnone\", delay: 200 }, { name: \"turntwo\", delay: 100 }])\n         * // define an dying animation that stop on the last frame\n         * this.addAnimation(\"die\", [{ name: 3, delay: 200 }, { name: 4, delay: 100 }, { name: 5, delay: Infinity }])\n         */\n        addAnimation : function (name, index, animationspeed) {\n            this.anim[name] = {\n                name : name,\n                frames : [],\n                idx : 0,\n                length : 0\n            };\n\n            if (index == null) {\n                index = [];\n                // create a default animation with all frame\n                Object.keys(this.textureAtlas).forEach(function (v, i) {\n                    index[i] = i;\n                });\n            }\n\n            // # of frames\n            var counter = 0;\n            // set each frame configuration (offset, size, etc..)\n            for (var i = 0, len = index.length; i < len; i++) {\n                var frame = index[i];\n                var frameObject;\n                if (typeof(frame) === \"number\" || typeof(frame) === \"string\") {\n                    frameObject = {\n                        name: frame,\n                        delay: animationspeed || this.animationspeed\n                    };\n                }\n                else {\n                  frameObject = frame;\n                }\n                var frameObjectName = frameObject.name;\n                if (typeof(frameObjectName) === \"number\") {\n                    if (typeof (this.textureAtlas[frameObjectName]) !== \"undefined\") {\n                        // TODO: adding the cache source coordinates add undefined entries in webGL mode\n                        this.anim[name].frames[i] = Object.assign(\n                            {},\n                            this.textureAtlas[frameObjectName],\n                            frameObject\n                        );\n                        counter++;\n                    }\n                } else { // string\n                    if (this.atlasIndices === null) {\n                        throw new me.Renderable.Error(\n                            \"string parameters for addAnimation are not allowed for standard spritesheet based Texture\"\n                        );\n                    } else {\n                        this.anim[name].frames[i] = Object.assign(\n                            {},\n                            this.textureAtlas[this.atlasIndices[frameObjectName]],\n                            frameObject\n                        );\n                        counter++;\n                    }\n                }\n            }\n            this.anim[name].length = counter;\n        },\n\n        /**\n         * set the current animation\n         * this will always change the animation & set the frame to zero\n         * @name setCurrentAnimation\n         * @memberOf me.AnimationSheet\n         * @function\n         * @param {String} name animation id\n         * @param {String|Function} [onComplete] animation id to switch to when\n         * complete, or callback\n         * @example\n         * // set \"walk\" animation\n         * this.setCurrentAnimation(\"walk\");\n         *\n         * // set \"walk\" animation if it is not the current animation\n         * if (this.isCurrentAnimation(\"walk\")) {\n         *     this.setCurrentAnimation(\"walk\");\n         * }\n         *\n         * // set \"eat\" animation, and switch to \"walk\" when complete\n         * this.setCurrentAnimation(\"eat\", \"walk\");\n         *\n         * // set \"die\" animation, and remove the object when finished\n         * this.setCurrentAnimation(\"die\", (function () {\n         *    me.game.world.removeChild(this);\n         *    return false; // do not reset to first frame\n         * }).bind(this));\n         *\n         * // set \"attack\" animation, and pause for a short duration\n         * this.setCurrentAnimation(\"die\", (function () {\n         *    this.animationpause = true;\n         *\n         *    // back to \"standing\" animation after 1 second\n         *    setTimeout(function () {\n         *        this.setCurrentAnimation(\"standing\");\n         *    }, 1000);\n         *\n         *    return false; // do not reset to first frame\n         * }).bind(this));\n         **/\n        setCurrentAnimation : function (name, resetAnim, _preserve_dt) {\n            if (this.anim[name]) {\n                this.current = this.anim[name];\n                this.resetAnim = resetAnim || null;\n                this.setAnimationFrame(this.current.idx);\n                if (!_preserve_dt) {\n                    this.dt = 0;\n                }\n            } else {\n                throw new me.Renderable.Error(\"animation id '\" + name + \"' not defined\");\n            }\n        },\n\n        /**\n         * return true if the specified animation is the current one.\n         * @name isCurrentAnimation\n         * @memberOf me.AnimationSheet\n         * @function\n         * @param {String} name animation id\n         * @return {Boolean}\n         * @example\n         * if (!this.isCurrentAnimation(\"walk\")) {\n         *     // do something funny...\n         * }\n         */\n        isCurrentAnimation : function (name) {\n            return this.current.name === name;\n        },\n\n        /**\n         * force the current animation frame index.\n         * @name setAnimationFrame\n         * @memberOf me.AnimationSheet\n         * @function\n         * @param {Number} [index=0] animation frame index\n         * @example\n         * // reset the current animation to the first frame\n         * this.setAnimationFrame();\n         */\n        setAnimationFrame : function (idx) {\n            this.current.idx = (idx || 0) % this.current.length;\n            var frame = this.getAnimationFrameObjectByIndex(this.current.idx);\n            this.offset = frame.offset;\n            this.width = frame.width;\n            this.height = frame.height;\n            this._sourceAngle = frame.angle;\n            if (frame.anchorPoint) {\n                this.anchorPoint = frame.anchorPoint;\n            }\n        },\n\n        /**\n         * return the current animation frame index.\n         * @name getCurrentAnimationFrame\n         * @memberOf me.AnimationSheet\n         * @function\n         * @return {Number} current animation frame index\n         */\n        getCurrentAnimationFrame : function () {\n            return this.current.idx;\n        },\n\n        /**\n         * Returns the frame object by the index.\n         * @name getAnimationFrameObjectByIndex\n         * @memberOf me.AnimationSheet\n         * @function\n         * @private\n         * @return {Number} if using number indices. Returns {Object} containing frame data if using texture atlas\n         */\n        getAnimationFrameObjectByIndex : function (id) {\n            return this.current.frames[id];\n        },\n\n        /**\n         * update the animation<br>\n         * this is automatically called by the game manager {@link me.game}\n         * @name update\n         * @memberOf me.AnimationSheet\n         * @function\n         * @protected\n         * @param {Number} dt time since the last update in milliseconds.\n         */\n        update : function (dt) {\n            // Update animation if necessary\n            if (this.animationpause || this.current.length <= 1) {\n                return me.Sprite.prototype.update.apply(this, [ dt ]);\n            }\n\n            var duration = 0,\n                result = false;\n\n            this.dt += dt;\n            duration = this.getAnimationFrameObjectByIndex(this.current.idx).delay;\n            while (this.dt >= duration) {\n                result = true;\n                this.dt -= duration;\n                this.setAnimationFrame(this.current.idx + 1);\n\n                // Switch animation if we reach the end of the strip and a callback is defined\n                if (this.current.idx === 0 && this.resetAnim)  {\n                    // If string, change to the corresponding animation\n                    if (typeof this.resetAnim === \"string\") {\n                        this.setCurrentAnimation(this.resetAnim, null, true);\n                    }\n                    // Otherwise is must be callable\n                    else if (this.resetAnim() === false) {\n                        // Reset to last frame\n                        this.setAnimationFrame(this.current.length - 1);\n\n                        // Bail early without skipping any more frames.\n                        this.dt %= duration;\n                        break;\n                    }\n                }\n\n                // Get next frame duration\n                duration = this.getAnimationFrameObjectByIndex(this.current.idx).delay;\n            }\n\n            return me.Sprite.prototype.update.apply(this, [ dt ]) || result;\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n\n(function () {\n    // some ref shortcut\n    var MIN = Math.min, MAX = Math.max;\n\n    /**\n     * a camera/viewport Object\n     * @class\n     * @extends me.Renderable\n     * @memberOf me\n     * @constructor\n     * @param {Number} minX start x offset\n     * @param {Number} minY start y offset\n     * @param {Number} maxX end x offset\n     * @param {Number} maxY end y offset\n     */\n    me.Viewport = me.Renderable.extend(\n    /** @scope me.Viewport.prototype */ {\n        /** @ignore */\n        init : function (minX, minY, maxX, maxY) {\n            me.Renderable.prototype.init.apply(this, [minX, minY, maxX - minX, maxY - minY]);\n\n            /**\n             * Axis definition\n             * @property NONE\n             * @property HORIZONTAL\n             * @property VERTICAL\n             * @property BOTH\n             * @public\n             * @constant\n             * @enum {Number}\n             * @name AXIS\n             * @memberOf me.Viewport\n             */\n            this.AXIS = {\n                NONE : 0,\n                HORIZONTAL : 1,\n                VERTICAL : 2,\n                BOTH : 3\n            };\n\n            /**\n             * Camera bounds\n             * @public\n             * @constant\n             * @type me.Rect\n             * @name bounds\n             * @memberOf me.Viewport\n             */\n            this.bounds = new me.Rect(-Infinity, -Infinity, Infinity, Infinity);\n\n            // offset for shake effect\n            this.offset = new me.Vector2d();\n\n            // target to follow\n            this.target = null;\n\n            // default value follow\n            this.follow_axis = this.AXIS.NONE;\n\n            // shake variables\n            this._shake = {\n                intensity : 0,\n                duration : 0,\n                axis : this.AXIS.BOTH,\n                onComplete : null\n            };\n\n            // flash variables\n            this._fadeOut = {\n                color : null,\n                duration : 0,\n                tween : null\n            };\n            // fade variables\n            this._fadeIn = {\n                color : null,\n                duration : 0,\n                tween : null\n            };\n\n            // set a default deadzone\n            this.setDeadzone(this.width / 6, this.height / 6);\n        },\n\n        // -- some private function ---\n\n        /** @ignore */\n        _followH : function (target) {\n            var _x = this.pos.x;\n            if ((target.x - this.pos.x) > (this.deadzone.right)) {\n                this.pos.x = ~~MIN((target.x) - (this.deadzone.right), this.bounds.width - this.width);\n            }\n            else if ((target.x - this.pos.x) < (this.deadzone.pos.x)) {\n                this.pos.x = ~~MAX((target.x) - this.deadzone.pos.x, this.bounds.pos.x);\n            }\n            return (_x !== this.pos.x);\n        },\n\n        /** @ignore */\n        _followV : function (target) {\n            var _y = this.pos.y;\n            if ((target.y - this.pos.y) > (this.deadzone.bottom)) {\n                this.pos.y = ~~MIN((target.y) - (this.deadzone.bottom),    this.bounds.height - this.height);\n            }\n            else if ((target.y - this.pos.y) < (this.deadzone.pos.y)) {\n                this.pos.y = ~~MAX((target.y) - this.deadzone.pos.y, this.bounds.pos.y);\n            }\n            return (_y !== this.pos.y);\n        },\n\n        // -- public function ---\n\n        /**\n         * reset the viewport to specified coordinates\n         * @name reset\n         * @memberOf me.Viewport\n         * @function\n         * @param {Number} [x=0]\n         * @param {Number} [y=0]\n         */\n        reset : function (x, y) {\n            // reset the initial viewport position to 0,0\n            this.pos.x = x || 0;\n            this.pos.y = y || 0;\n\n            // reset the target\n            this.target = null;\n\n            // reset default axis value for follow\n            this.follow_axis = null;\n        },\n\n        /**\n         * change the deadzone settings.\n         * the \"deadzone\" defines an area within the current viewport in which\n         * the followed entity can move without scrolling the viewport.\n         * @name setDeadzone\n         * @see me.Viewport.follow\n         * @memberOf me.Viewport\n         * @function\n         * @param {Number} w deadzone width\n         * @param {Number} h deadzone height\n         */\n        setDeadzone : function (w, h) {\n            if (typeof(this.deadzone) === \"undefined\") {\n                this.deadzone = new me.Rect(0, 0, 0, 0);\n            }\n\n            // reusing the old code for now...\n            this.deadzone.pos.set(\n                ~~((this.width - w) / 2),\n                ~~((this.height - h) / 2 - h * 0.25)\n            );\n            this.deadzone.resize(w, h);\n\n            // force a camera update\n            this.updateTarget();\n        },\n\n\n        /**\n         * resize the viewport\n         * @name resize\n         * @memberOf me.Viewport\n         * @function\n         * @param {Number} w new width of the viewport\n         * @param {Number} h new height of the viewport\n         * @return {me.Viewport} this viewport\n        */\n        resize : function (w, h) {\n            me.Renderable.prototype.resize.apply(this, [w, h]);\n            var level = me.levelDirector.getCurrentLevel();\n\n            this.setBounds(\n                0, 0,\n                Math.max(w, level ? level.width : 0),\n                Math.max(h, level ? level.height : 0)\n            );\n\n            this.setDeadzone(w / 6, h / 6);\n            this.moveTo(0, 0);\n            this.update();\n            me.event.publish(me.event.VIEWPORT_ONRESIZE, [ this.width, this.height ]);\n            return this;\n        },\n\n        /**\n         * set the viewport boundaries (set to the world limit by default).\n         * the viewport is bound to the given coordinates and cannot move/be scrolled outside of it.\n         * @name setBounds\n         * @memberOf me.Viewport\n         * @function\n         * @param {Number} x world left limit\n         * @param {Number} y world top limit\n         * @param {Number} w world width limit\n         * @param {Number} h world height limit\n         */\n        setBounds : function (x, y, w, h) {\n            this.bounds.pos.set(x, y);\n            this.bounds.resize(w, h);\n            this.moveTo(this.pos.x, this.pos.y);\n        },\n\n        /**\n         * set the viewport to follow the specified entity\n         * @name follow\n         * @memberOf me.Viewport\n         * @function\n         * @param {me.Entity|me.Vector2d} target Entity or Position\n         * Vector to follow\n         * @param {me.Viewport.AXIS} [axis=this.AXIS.BOTH] Which axis to follow\n         */\n        follow : function (target, axis) {\n            if (target instanceof me.Entity) {\n                this.target = target.pos;\n            }\n            else if (target instanceof me.Vector2d) {\n                this.target = target;\n            }\n            else {\n                throw new me.Renderable.Error(\"invalid target for viewport.follow\");\n            }\n            // if axis is null, camera is moved on target center\n            this.follow_axis = (\n                typeof(axis) === \"undefined\" ? this.AXIS.BOTH : axis\n            );\n            // force a camera update\n            this.updateTarget();\n        },\n\n        /**\n         * move the viewport position by the specified offset\n         * @name move\n         * @memberOf me.Viewport\n         * @function\n         * @param {Number} x\n         * @param {Number} y\n         * @example\n         * // Move the viewport up by four pixels\n         * me.game.viewport.move(0, -4);\n         */\n        move : function (x, y) {\n            this.moveTo(~~(this.pos.x + x), ~~(this.pos.y + y));\n        },\n\n        /**\n         * move the viewport to the specified coordinates\n         * @name moveTo\n         * @memberOf me.Viewport\n         * @function\n         * @param {Number} x\n         * @param {Number} y\n         */\n\n        moveTo : function (x, y) {\n            this.pos.x = (~~x).clamp(\n                this.bounds.pos.x,\n                this.bounds.width - this.width\n            );\n            this.pos.y = (~~y).clamp(\n                this.bounds.pos.y,\n                this.bounds.height - this.height\n            );\n\n            //publish the corresponding message\n            me.event.publish(me.event.VIEWPORT_ONCHANGE, [this.pos]);\n        },\n\n        /** @ignore */\n        updateTarget : function () {\n            var updated = false;\n\n            if (this.target) {\n                switch (this.follow_axis) {\n                    case this.AXIS.NONE:\n                        //this.focusOn(this.target);\n                        break;\n\n                    case this.AXIS.HORIZONTAL:\n                        updated = this._followH(this.target);\n                        break;\n\n                    case this.AXIS.VERTICAL:\n                        updated = this._followV(this.target);\n                        break;\n\n                    case this.AXIS.BOTH:\n                        updated = this._followH(this.target);\n                        updated = this._followV(this.target) || updated;\n                        break;\n\n                    default:\n                        break;\n                }\n            }\n\n            return updated;\n        },\n\n        /** @ignore */\n        update : function (dt) {\n            var updated = this.updateTarget();\n\n            if (this._shake.duration > 0) {\n                this._shake.duration -= dt;\n                if (this._shake.duration <= 0) {\n                    this._shake.duration = 0;\n                    this.offset.setZero();\n                    if (typeof(this._shake.onComplete) === \"function\") {\n                        this._shake.onComplete();\n                    }\n                }\n                else {\n                    if (this._shake.axis === this.AXIS.BOTH ||\n                        this._shake.axis === this.AXIS.HORIZONTAL) {\n                        this.offset.x = (Math.random() - 0.5) * this._shake.intensity;\n                    }\n                    if (this._shake.axis === this.AXIS.BOTH ||\n                        this._shake.axis === this.AXIS.VERTICAL) {\n                        this.offset.y = (Math.random() - 0.5) * this._shake.intensity;\n                    }\n                }\n                // updated!\n                updated = true;\n            }\n\n            if (updated === true) {\n                //publish the corresponding message\n                me.event.publish(me.event.VIEWPORT_ONCHANGE, [this.pos]);\n            }\n\n            // check for fade/flash effect\n            if ((this._fadeIn.tween != null) || (this._fadeOut.tween != null)) {\n                updated = true;\n            }\n\n            return updated;\n        },\n\n        /**\n         * shake the camera\n         * @name shake\n         * @memberOf me.Viewport\n         * @function\n         * @param {Number} intensity maximum offset that the screen can be moved\n         * while shaking\n         * @param {Number} duration expressed in milliseconds\n         * @param {me.Viewport.AXIS} [axis=this.AXIS.BOTH] specify on which axis you\n         *   want the shake effect\n         * @param {Function} [onComplete] callback once shaking effect is over\n         * @example\n         * // shake it baby !\n         * me.game.viewport.shake(10, 500, me.game.viewport.AXIS.BOTH);\n         */\n        shake : function (intensity, duration, axis, onComplete) {\n            if (this._shake.duration > 0) {\n                return;\n            }\n\n            this._shake = {\n                intensity : intensity,\n                duration : duration,\n                axis : axis || this.AXIS.BOTH,\n                onComplete : onComplete\n            };\n        },\n\n        /**\n         * fadeOut(flash) effect<p>\n         * screen is filled with the specified color and slowly goes back to normal\n         * @name fadeOut\n         * @memberOf me.Viewport\n         * @function\n         * @param {me.Color|String} color a CSS color value\n         * @param {Number} [duration=1000] expressed in milliseconds\n         * @param {Function} [onComplete] callback once effect is over\n         */\n        fadeOut : function (color, duration, onComplete) {\n            this._fadeOut.color = me.pool.pull(\"me.Color\").copy(color);\n            this._fadeOut.color.alpha = 1.0;\n            this._fadeOut.duration = duration || 1000; // convert to ms\n            this._fadeOut.tween = me.pool.pull(\"me.Tween\", this._fadeOut.color)\n                .to({ alpha: 0.0 }, this._fadeOut.duration)\n                .onComplete(onComplete || null);\n            this._fadeOut.tween.isPersistent = true;\n            this._fadeOut.tween.start();\n        },\n\n        /**\n         * fadeIn effect <p>\n         * fade to the specified color\n         * @name fadeIn\n         * @memberOf me.Viewport\n         * @function\n         * @param {me.Color|String} color a CSS color value\n         * @param {Number} [duration=1000] expressed in milliseconds\n         * @param {Function} [onComplete] callback once effect is over\n         */\n        fadeIn : function (color, duration, onComplete) {\n            this._fadeIn.color = me.pool.pull(\"me.Color\").copy(color);\n            this._fadeIn.color.alpha = 0.0;\n            this._fadeIn.duration = duration || 1000; //convert to ms\n            this._fadeIn.tween = me.pool.pull(\"me.Tween\", this._fadeIn.color)\n                .to({ alpha: 1.0 }, this._fadeIn.duration)\n                .onComplete(onComplete || null);\n            this._fadeIn.tween.isPersistent = true;\n            this._fadeIn.tween.start();\n        },\n\n        /**\n         * return the viewport width\n         * @name getWidth\n         * @memberOf me.Viewport\n         * @function\n         * @return {Number}\n         */\n        getWidth : function () {\n            return this.width;\n        },\n\n        /**\n         * return the viewport height\n         * @name getHeight\n         * @memberOf me.Viewport\n         * @function\n         * @return {Number}\n         */\n        getHeight : function () {\n            return this.height;\n        },\n\n        /**\n         * set the viewport position around the specified object\n         * @name focusOn\n         * @memberOf me.Viewport\n         * @function\n         * @param {me.Renderable}\n         */\n        focusOn : function (target) {\n            var bounds = target.getBounds();\n            this.moveTo(\n                target.pos.x + bounds.pos.x + (bounds.width / 2),\n                target.pos.y + bounds.pos.y + (bounds.height / 2)\n            );\n        },\n\n        /**\n         * check if the specified rectangle is in the viewport\n         * @name isVisible\n         * @memberOf me.Viewport\n         * @function\n         * @param {me.Rect} rect\n         * @return {Boolean}\n         */\n        isVisible : function (rect) {\n            return rect.overlaps(this);\n        },\n\n        /**\n         * convert the given \"local\" (screen) coordinates into world coordinates\n         * @name localToWorld\n         * @memberOf me.Viewport\n         * @function\n         * @param {Number} x\n         * @param {Number} y\n         * @param {Number} [v] an optional vector object where to set the\n         * converted value\n         * @return {me.Vector2d}\n         */\n        localToWorld : function (x, y, v) {\n            v = v || new me.Vector2d();\n            return (v.set(x, y)).add(this.pos).sub(me.game.world.pos);\n        },\n\n        /**\n         * convert the given world coordinates into \"local\" (screen) coordinates\n         * @name worldToLocal\n         * @memberOf me.Viewport\n         * @function\n         * @param {Number} x\n         * @param {Number} y\n         * @param {Number} [v] an optional vector object where to set the\n         * converted value\n         * @return {me.Vector2d}\n         */\n        worldToLocal : function (x, y, v) {\n            v = v || new me.Vector2d();\n            return (v.set(x, y)).sub(this.pos).add(me.game.world.pos);\n        },\n\n        /**\n         * render the camera effects\n         * @ignore\n         */\n        draw : function () {\n            // fading effect\n            if (this._fadeIn.tween) {\n                me.video.renderer.clearSurface(null, this._fadeIn.color);\n                // remove the tween if over\n                if (this._fadeIn.color.alpha === 1.0) {\n                    this._fadeIn.tween = null;\n                    me.pool.push(this._fadeIn.color);\n                    this._fadeIn.color = null;\n                }\n            }\n\n            // flashing effect\n            if (this._fadeOut.tween) {\n                me.video.renderer.clearSurface(null, this._fadeOut.color);\n                // remove the tween if over\n                if (this._fadeOut.color.alpha === 0.0) {\n                    this._fadeOut.tween = null;\n                    me.pool.push(this._fadeOut.color);\n                    this._fadeOut.color = null;\n                }\n            }\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n\n    /**\n     * GUI Object<br>\n     * A very basic object to manage GUI elements <br>\n     * The object simply register on the \"pointerdown\" <br>\n     * or \"touchstart\" event and call the onClick function\"\n     * @class\n     * @extends me.Sprite\n     * @memberOf me\n     * @constructor\n     * @param {Number} x the x coordinate of the GUI Object\n     * @param {Number} y the y coordinate of the GUI Object\n     * @param {Object} settings See {@link me.Entity}\n     * @example\n     *\n     * // create a basic GUI Object\n     * var myButton = me.GUI_Object.extend(\n     * {\n     *    init:function (x, y)\n     *    {\n     *       var settings = {}\n     *       settings.image = \"button\";\n     *       settings.framewidth = 100;\n     *       settings.frameheight = 50;\n     *       // super constructor\n     *       me.GUI_Object.prototype.init.apply(this, [x, y, settings]);\n     *       // define the object z order\n     *       this.pos.z = 4;\n     *    },\n     *\n     *    // output something in the console\n     *    // when the object is clicked\n     *    onClick:function (event)\n     *    {\n     *       console.log(\"clicked!\");\n     *       // don't propagate the event\n     *       return false;\n     *    }\n     * });\n     *\n     * // add the object at pos (10,10)\n     * me.game.world.addChild(new myButton(10,10));\n     *\n     */\n    me.GUI_Object = me.Sprite.extend({\n    /** @scope me.GUI_Object.prototype */\n\n        /**\n         * @ignore\n         */\n        init : function (x, y, settings) {\n            /**\n             * object can be clicked or not\n             * @public\n             * @type boolean\n             * @default true\n             * @name me.GUI_Object#isClickable\n             */\n            this.isClickable = true;\n\n            /**\n             * Tap and hold threshold timeout in ms\n             * @type {number}\n             * @default 250\n             * @name me.GUI_Object#holdThreshold\n             */\n            this.holdThreshold = 250;\n\n            /**\n             * object can be tap and hold\n             * @public\n             * @type boolean\n             * @default false\n             * @name me.GUI_Object#isHoldable\n             */\n            this.isHoldable = false;\n            \n            /**\n             * true if the pointer is over the object\n             * @public\n             * @type boolean\n             * @default false\n             * @name me.GUI_Object#hover\n             */\n            this.hover = false;\n\n            // object has been updated (clicked,etc..)\n            this.holdTimeout = null;\n            this.updated = false;\n            this.released = true;\n\n            // call the parent constructor\n            me.Sprite.prototype.init.apply(this, [ x, y, settings ]);\n\n            // GUI items use screen coordinates\n            this.floating = true;\n        },\n\n        /**\n         * return true if the object has been clicked\n         * @ignore\n         */\n        update : function () {\n            if (this.updated) {\n                // clear the flag\n                if (!this.released) {\n                    this.updated = false;\n                }\n                return true;\n            }\n            return false;\n        },\n\n        /**\n         * function callback for the pointerdown event\n         * @ignore\n         */\n        clicked : function (event) {\n            // Check if left mouse button is pressed OR if device has touch\n            if ((event.which === 1 || me.device.touch) && this.isClickable) {\n                this.updated = true;\n                if (this.isHoldable) {\n                    if (this.holdTimeout !== null) {\n                        me.timer.clearTimeout(this.holdTimeout);\n                    }\n                    this.holdTimeout = me.timer.setTimeout(this.hold.bind(this), this.holdThreshold, false);\n                    this.released = false;\n                }\n                return this.onClick(event);\n            }\n        },\n\n        /**\n         * function called when the object is pressed <br>\n         * to be extended <br>\n         * return false if we need to stop propagating the event\n         * @name onClick\n         * @memberOf me.GUI_Object\n         * @public\n         * @function\n         * @param {Event} event the event object\n         */\n        onClick : function (/* event */) {\n            return false;\n        },\n        \n        /**\n         * function callback for the pointerEnter event\n         * @ignore\n         */\n        enter : function (event) {\n            this.hover = true;\n            return this.onOver(event);\n        },\n        \n        /**\n         * function called when the pointer is over the object\n         * @name onOver\n         * @memberOf me.GUI_Object\n         * @public\n         * @function\n         * @param {Event} event the event object\n         */\n        onOver : function (/* event */) {},\n        \n        /**\n         * function callback for the pointerLeave event\n         * @ignore\n         */\n        leave : function (event) {\n            this.hover = false;\n            this.release.call(this, event);\n            return this.onOut(event);\n        },\n        \n        /**\n         * function called when the pointer is leaving the object area\n         * @name onOut\n         * @memberOf me.GUI_Object\n         * @public\n         * @function\n         * @param {Event} event the event object\n         */\n        onOut : function (/* event */) {},\n        \n        /**\n         * function callback for the pointerup event\n         * @ignore\n         */\n        release : function (event) {\n            if (this.released === false) {\n                this.released = true;\n                me.timer.clearTimeout(this.holdTimeout);\n                return this.onRelease(event);\n            }\n        },\n\n        /**\n         * function called when the object is pressed and released <br>\n         * to be extended <br>\n         * return false if we need to stop propagating the event\n         * @name onRelease\n         * @memberOf me.GUI_Object\n         * @public\n         * @function\n         * @param {Event} event the event object\n         */\n        onRelease : function () {\n            return false;\n        },\n\n        /**\n         * function callback for the tap and hold timer event\n         * @ignore\n         */\n        hold : function () {\n            me.timer.clearTimeout(this.holdTimeout);\n            if (!this.released) {\n                this.onHold();\n            }\n        },\n\n        /**\n         * function called when the object is pressed and held<br>\n         * to be extended <br>\n         * @name onHold\n         * @memberOf me.GUI_Object\n         * @public\n         * @function\n         */\n        onHold : function () {},\n\n        /**\n         * function called when added to the game world or a container\n         */\n        onActivateEvent : function () {\n            // register pointer events\n            me.input.registerPointerEvent(\"pointerdown\", this, this.clicked.bind(this));\n            me.input.registerPointerEvent(\"pointerup\", this, this.release.bind(this));\n            me.input.registerPointerEvent(\"pointercancel\", this, this.release.bind(this));\n            me.input.registerPointerEvent(\"pointerenter\", this, this.enter.bind(this));\n            me.input.registerPointerEvent(\"pointerleave\", this, this.leave.bind(this));\n            \n        },\n\n        /**\n         * function called when removed from the game world or a container\n         */\n        onDeactivateEvent : function () {\n            // release pointer events\n            me.input.releasePointerEvent(\"pointerdown\", this);\n            me.input.releasePointerEvent(\"pointerup\", this);\n            me.input.releasePointerEvent(\"pointercancel\", this);\n            me.input.releasePointerEvent(\"pointerenter\", this);\n            me.input.releasePointerEvent(\"pointerleave\", this);\n        },\n\n        /**\n         * OnDestroy notification function<br>\n         * Called by engine before deleting the object<br>\n         * be sure to call the parent function if overwritten\n         * @name onDestroyEvent\n         * @memberOf me.GUI_Object\n         * @public\n         * @function\n         */\n        onDestroyEvent : function () {\n            me.timer.clearTimeout(this.holdTimeout);\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n    /**\n     * Private function to re-use for object removal in a defer\n     * @ignore\n     */\n    var deferredRemove = function (child, keepalive) {\n        this.removeChildNow(child, keepalive);\n    };\n\n    var globalFloatingCounter = 0;\n\n    /**\n     * me.Container represents a collection of child objects\n     * @class\n     * @extends me.Renderable\n     * @memberOf me\n     * @constructor\n     * @param {Number} [x=0] position of the container\n     * @param {Number} [y=0] position of the container\n     * @param {Number} [w=me.game.viewport.width] width of the container\n     * @param {number} [h=me.game.viewport.height] height of the container\n     */\n    me.Container = me.Renderable.extend(\n    /** @scope me.Container.prototype */\n    {\n        /**\n         * constructor\n         * @ignore\n         */\n        init : function (x, y, width, height) {\n            /**\n             * keep track of pending sort\n             * @ignore\n             */\n            this.pendingSort = null;\n\n            // TODO; container do not have a physic body\n            // ADD child container child one by one to the quadtree?\n\n            /**\n             * the container default transformation matrix\n             * @public\n             * @type me.Matrix2d\n             * @name transform\n             * @memberOf me.Container\n             */\n            this.transform = new me.Matrix2d();\n\n            /**\n             * whether the container is the root of the scene\n             * @private\n             * @ignore\n             */\n            this._root = false;\n\n            // call the _super constructor\n            me.Renderable.prototype.init.apply(this,\n                [x || 0, y || 0,\n                width || Infinity,\n                height || Infinity]\n            );\n\n            /**\n             * The array of children of this container.\n             * @ignore\n             */\n            this.children = [];\n\n            /**\n             * The property of the child object that should be used to sort on <br>\n             * value : \"x\", \"y\", \"z\"\n             * @public\n             * @type String\n             * @default me.game.sortOn\n             * @name sortOn\n             * @memberOf me.Container\n             */\n            this.sortOn = me.game.sortOn;\n\n            /**\n             * Specify if the children list should be automatically sorted when adding a new child\n             * @public\n             * @type Boolean\n             * @default true\n             * @name autoSort\n             * @memberOf me.Container\n             */\n            this.autoSort = true;\n\n            /**\n             * Specify if the children z index should automatically be managed by the parent container\n             * @public\n             * @type Boolean\n             * @default true\n             * @name autoDepth\n             * @memberOf me.Container\n             */\n            this.autoDepth = true;\n\n            /**\n             * Used by the debug panel plugin\n             * @ignore\n             */\n            this.drawCount = 0;\n\n            /**\n             * The bounds that contains all its children\n             * @public\n             * @type me.Rect\n             * @name childBounds\n             * @memberOf me.Container\n             */\n            this.childBounds = this.getBounds().clone();\n\n            // reset the transformation matrix\n            this.transform.identity();\n        },\n\n\n        /**\n         * Add a child to the container <br>\n         * if auto-sort is disable, the object will be appended at the bottom of the list\n         * @name addChild\n         * @memberOf me.Container\n         * @function\n         * @param {me.Renderable} child\n         * @param {number} [z] forces the z index of the child to the specified value\n         * @return {me.Renderable} the added child\n         */\n        addChild : function (child, z) {\n            if (typeof(child.ancestor) !== \"undefined\") {\n                child.ancestor.removeChildNow(child);\n            }\n            else {\n                // only allocate a GUID if the object has no previous ancestor\n                // (e.g. move one child from one container to another)\n                if (child.isRenderable) {\n                    // allocated a GUID value (use child.id as based index if defined)\n                    child.GUID = me.utils.createGUID(child.id);\n                }\n            }\n\n            child.ancestor = this;\n            this.children.push(child);\n\n            // set the child z value if required\n            if (typeof(child.pos) !== \"undefined\") {\n                if (typeof(z) === \"number\") {\n                        child.pos.z = z;\n                } else if (this.autoDepth === true) {\n                    child.pos.z = this.children.length;\n                }\n            }\n\n            if (this.autoSort === true) {\n                this.sort();\n            }\n\n            if (typeof child.onActivateEvent === \"function\" && this.isAttachedToRoot()) {\n                child.onActivateEvent();\n            }\n\n            return child;\n        },\n\n        /**\n         * Add a child to the container at the specified index<br>\n         * (the list won't be sorted after insertion)\n         * @name addChildAt\n         * @memberOf me.Container\n         * @function\n         * @param {me.Renderable} child\n         * @param {Number} index\n         * @return {me.Renderable} the added child\n         */\n        addChildAt : function (child, index) {\n            if (index >= 0 && index < this.children.length) {\n                if (typeof(child.ancestor) !== \"undefined\") {\n                    child.ancestor.removeChildNow(child);\n                }\n                else {\n                    // only allocate a GUID if the object has no previous ancestor\n                    // (e.g. move one child from one container to another)\n                    if (child.isRenderable) {\n                        // allocated a GUID value\n                        child.GUID = me.utils.createGUID();\n                    }\n                }\n                child.ancestor = this;\n\n                this.children.splice(index, 0, child);\n\n                if (typeof child.onActivateEvent === \"function\" && this.isAttachedToRoot()) {\n                    child.onActivateEvent();\n                }\n\n                return child;\n            }\n            else {\n                throw new me.Container.Error(\"Index (\" + index + \") Out Of Bounds for addChildAt()\");\n            }\n        },\n\n        /**\n         * Swaps the position (z-index) of 2 children\n         * @name swapChildren\n         * @memberOf me.Container\n         * @function\n         * @param {me.Renderable} child\n         * @param {me.Renderable} child2\n         */\n        swapChildren : function (child, child2) {\n            var index = this.getChildIndex(child);\n            var index2 = this.getChildIndex(child2);\n\n            if ((index !== -1) && (index2 !== -1)) {\n                // swap z index\n                var _z = child.pos.z;\n                child.pos.z = child2.pos.z;\n                child2.pos.z = _z;\n                // swap the positions..\n                this.children[index] = child2;\n                this.children[index2] = child;\n            }\n            else {\n                throw new me.Container.Error(child + \" Both the supplied childs must be a child of the caller \" + this);\n            }\n        },\n\n        /**\n         * Returns the Child at the specified index\n         * @name getChildAt\n         * @memberOf me.Container\n         * @function\n         * @param {Number} index\n         */\n        getChildAt : function (index) {\n            if (index >= 0 && index < this.children.length) {\n                return this.children[index];\n            }\n            else {\n                throw new me.Container.Error(\"Index (\" + index + \") Out Of Bounds for getChildAt()\");\n            }\n        },\n\n        /**\n         * Returns the index of the Child\n         * @name getChildAt\n         * @memberOf me.Container\n         * @function\n         * @param {me.Renderable} child\n         */\n        getChildIndex : function (child) {\n            return this.children.indexOf(child);\n        },\n\n        /**\n         * Returns true if contains the specified Child\n         * @name hasChild\n         * @memberOf me.Container\n         * @function\n         * @param {me.Renderable} child\n         * @return {Boolean}\n         */\n        hasChild : function (child) {\n            return this === child.ancestor;\n        },\n\n        /**\n         * return the child corresponding to the given property and value.<br>\n         * note : avoid calling this function every frame since\n         * it parses the whole object tree each time\n         * @name getChildByProp\n         * @memberOf me.Container\n         * @public\n         * @function\n         * @param {String} prop Property name\n         * @param {String|RegExp|Number|Boolean} value Value of the property\n         * @return {me.Renderable[]} Array of childs\n         * @example\n         * // get the first child object called \"mainPlayer\" in a specific container :\n         * var ent = myContainer.getChildByProp(\"name\", \"mainPlayer\");\n         *\n         * // or query the whole world :\n         * var ent = me.game.world.getChildByProp(\"name\", \"mainPlayer\");\n         *\n         * // partial property matches are also allowed by using a RegExp.\n         * // the following matches \"redCOIN\", \"bluecoin\", \"bagOfCoins\", etc :\n         * var allCoins = me.game.world.getChildByProp(\"name\", /coin/i);\n         *\n         * // searching for numbers or other data types :\n         * var zIndex10 = me.game.world.getChildByProp(\"z\", 10);\n         * var inViewport = me.game.world.getChildByProp(\"inViewport\", true);\n         */\n        getChildByProp : function (prop, value)    {\n            var objList = [];\n\n            function compare(obj, prop) {\n                var v = obj[prop];\n                if (value instanceof RegExp && typeof(v) === \"string\") {\n                    if (value.test(v)) {\n                        objList.push(obj);\n                    }\n                }\n                else if (v === value) {\n                    objList.push(obj);\n                }\n            }\n\n            for (var i = this.children.length - 1; i >= 0; i--) {\n                var obj = this.children[i];\n                compare(obj, prop);\n                if (obj instanceof me.Container) {\n                    objList = objList.concat(obj.getChildByProp(prop, value));\n                }\n            }\n            return objList;\n        },\n\n        /**\n         * returns the list of childs with the specified class type\n         * @name getChildByType\n         * @memberOf me.Container\n         * @public\n         * @function\n         * @param {Object} class type\n         * @return {me.Renderable[]} Array of children\n         */\n        getChildByType : function (_class) {\n            var objList = [];\n\n            for (var i = this.children.length - 1; i >= 0; i--) {\n                var obj = this.children[i];\n                if (obj instanceof _class) {\n                    objList.push(obj);\n                }\n                if (obj instanceof me.Container) {\n                    objList = objList.concat(obj.getChildByType(_class));\n                }\n            }\n            return objList;\n        },\n\n        /**\n         * returns the list of childs with the specified name<br>\n         * as defined in Tiled (Name field of the Object Properties)<br>\n         * note : avoid calling this function every frame since\n         * it parses the whole object list each time\n         * @name getChildByName\n         * @memberOf me.Container\n         * @public\n         * @function\n         * @param {String|RegExp|Number|Boolean} name entity name\n         * @return {me.Renderable[]} Array of children\n         */\n        getChildByName : function (name) {\n            return this.getChildByProp(\"name\", name);\n        },\n\n        /**\n         * return the child corresponding to the specified GUID<br>\n         * note : avoid calling this function every frame since\n         * it parses the whole object list each time\n         * @name getChildByGUID\n         * @memberOf me.Container\n         * @public\n         * @function\n         * @param {String|RegExp|Number|Boolean} GUID entity GUID\n         * @return {me.Renderable} corresponding child or null\n         */\n        getChildByGUID : function (guid) {\n            var obj = this.getChildByProp(\"GUID\", guid);\n            return (obj.length > 0) ? obj[0] : null;\n        },\n\n        /**\n         * resizes the child bounds rectangle, based on children bounds.\n         * @name updateChildBounds\n         * @memberOf me.Container\n         * @function\n         * @return {me.Rect} updated child bounds\n         */\n        updateChildBounds : function () {\n            this.childBounds.pos.set(Infinity, Infinity);\n            this.childBounds.resize(-Infinity, -Infinity);\n            var childBounds;\n            for (var i = this.children.length, child; i--, (child = this.children[i]);) {\n                if (child.isRenderable) {\n                    if (child instanceof me.Container) {\n                        childBounds = child.childBounds;\n                    }\n                    else {\n                        childBounds = child.getBounds();\n                    }\n                    // TODO : returns an \"empty\" rect instead of null (e.g. EntityObject)\n                    // TODO : getBounds should always return something anyway\n                    if (childBounds !== null) {\n                        this.childBounds.union(childBounds);\n                    }\n                }\n            }\n            return this.childBounds;\n        },\n\n        /**\n         * Checks if this container is root or if ti's attached to the root container.\n         * @private\n         * @name isAttachedToRoot\n         * @memberOf me.Container\n         * @function\n         * @returns Boolean\n         */\n        isAttachedToRoot : function () {\n            if (this._root) {\n                return true;\n            } else {\n                var hasRoot = false;\n                var ancestor = this.ancestor;\n                while (ancestor) {\n                    hasRoot = ancestor._root;\n                    if (hasRoot) {\n                        break;\n                    } else {\n                        ancestor = ancestor.ancestor;\n                    }\n                }\n\n                return hasRoot;\n            }\n        },\n\n        /**\n         * update the renderable's bounding rect (private)\n         * @private\n         * @name updateBoundsPos\n         * @memberOf me.Container\n         * @function\n         */\n        updateBoundsPos : function (newX, newY) {\n            me.Renderable.prototype.updateBoundsPos.apply(this, [ newX, newY ]);\n\n            // Update container's absolute position\n            this._absPos.set(newX, newY);\n            if (this.ancestor) {\n                this._absPos.add(this.ancestor._absPos);\n            }\n\n            // Notify children that the parent's position has changed\n            for (var i = this.children.length, child; i--, (child = this.children[i]);) {\n                if (child.isRenderable) {\n                    child.updateBoundsPos(child.pos.x, child.pos.y);\n                }\n            }\n\n            return this._bounds;\n        },\n\n        onActivateEvent : function () {\n          for (var i = this.children.length, obj; i--, (obj = this.children[i]);) {\n              var child = this.children[i];\n              if (typeof child.onActivateEvent === \"function\") {\n                  child.onActivateEvent();\n              }\n          }\n        },\n\n        /**\n         * Invokes the removeChildNow in a defer, to ensure the child is removed safely after the update & draw stack has completed\n         * @name removeChild\n         * @memberOf me.Container\n         * @public\n         * @function\n         * @param {me.Renderable} child\n         * @param {Boolean} [keepalive=False] True to prevent calling child.destroy()\n         */\n        removeChild : function (child, keepalive) {\n            if (child.ancestor) {\n                deferredRemove.defer(this, child, keepalive);\n            }\n        },\n\n\n        /**\n         * Removes (and optionally destroys) a child from the container.<br>\n         * (removal is immediate and unconditional)<br>\n         * Never use keepalive=true with objects from {@link me.pool}. Doing so will create a memory leak.\n         * @name removeChildNow\n         * @memberOf me.Container\n         * @function\n         * @param {me.Renderable} child\n         * @param {Boolean} [keepalive=False] True to prevent calling child.destroy()\n         */\n        removeChildNow : function (child, keepalive) {\n            var childIndex = -1;\n            if (this.hasChild(child) && ((childIndex = this.getChildIndex(child)) >= 0)) {\n                child.ancestor = undefined;\n\n                if (typeof child.onDeactivateEvent === \"function\") {\n                    child.onDeactivateEvent();\n                }\n\n                if (!keepalive) {\n                    if (typeof (child.destroy) === \"function\") {\n                        child.destroy();\n                    }\n\n                    me.pool.push(child);\n                }\n\n                this.children.splice(childIndex, 1);\n            }\n            else {\n                throw new me.Container.Error(child + \" The supplied child must be a child of the caller \" + this);\n            }\n        },\n\n        /**\n         * Automatically set the specified property of all childs to the given value\n         * @name setChildsProperty\n         * @memberOf me.Container\n         * @function\n         * @param {String} property property name\n         * @param {Object} value property value\n         * @param {Boolean} [recursive=false] recursively apply the value to child containers if true\n         */\n        setChildsProperty : function (prop, val, recursive) {\n            for (var i = this.children.length; i >= 0; i--) {\n                var obj = this.children[i];\n                if ((recursive === true) && (obj instanceof me.Container)) {\n                    obj.setChildsProperty(prop, val, recursive);\n                }\n                obj[prop] = val;\n            }\n        },\n\n        /**\n         * Move the child in the group one step forward (z depth).\n         * @name moveUp\n         * @memberOf me.Container\n         * @function\n         * @param {me.Renderable} child\n         */\n        moveUp : function (child) {\n            var childIndex = this.getChildIndex(child);\n            if (childIndex - 1 >= 0) {\n                // note : we use an inverted loop\n                this.swapChildren(child, this.getChildAt(childIndex - 1));\n            }\n        },\n\n        /**\n         * Move the child in the group one step backward (z depth).\n         * @name moveDown\n         * @memberOf me.Container\n         * @function\n         * @param {me.Renderable} child\n         */\n        moveDown : function (child) {\n            var childIndex = this.getChildIndex(child);\n            if (childIndex >= 0 && (childIndex + 1) < this.children.length) {\n                // note : we use an inverted loop\n                this.swapChildren(child, this.getChildAt(childIndex + 1));\n            }\n        },\n\n        /**\n         * Move the specified child to the top(z depth).\n         * @name moveToTop\n         * @memberOf me.Container\n         * @function\n         * @param {me.Renderable} child\n         */\n        moveToTop : function (child) {\n            var childIndex = this.getChildIndex(child);\n            if (childIndex > 0) {\n                // note : we use an inverted loop\n                this.children.splice(0, 0, this.children.splice(childIndex, 1)[0]);\n                // increment our child z value based on the previous child depth\n                child.pos.z = this.children[1].pos.z + 1;\n            }\n        },\n\n        /**\n         * Move the specified child the bottom (z depth).\n         * @name moveToBottom\n         * @memberOf me.Container\n         * @function\n         * @param {me.Renderable} child\n         */\n        moveToBottom : function (child) {\n            var childIndex = this.getChildIndex(child);\n            if (childIndex >= 0 && childIndex < (this.children.length - 1)) {\n                // note : we use an inverted loop\n                this.children.splice((this.children.length - 1), 0, this.children.splice(childIndex, 1)[0]);\n                // increment our child z value based on the next child depth\n                child.pos.z = this.children[(this.children.length - 2)].pos.z - 1;\n            }\n        },\n\n        /**\n         * Manually trigger the sort of all the childs in the container</p>\n         * @name sort\n         * @memberOf me.Container\n         * @public\n         * @function\n         * @param {Boolean} [recursive=false] recursively sort all containers if true\n         */\n        sort : function (recursive) {\n            // do nothing if there is already a pending sort\n            if (!this.pendingSort) {\n                if (recursive === true) {\n                    // trigger other child container sort function (if any)\n                    for (var i = this.children.length, obj; i--, (obj = this.children[i]);) {\n                        if (obj instanceof me.Container) {\n                            // note : this will generate one defered sorting function\n                            // for each existing containe\n                            obj.sort(recursive);\n                        }\n                    }\n                }\n                /** @ignore */\n                this.pendingSort = function (self) {\n                    // sort everything in this container\n                    self.children.sort(self[\"_sort\" + self.sortOn.toUpperCase()]);\n                    // clear the defer id\n                    self.pendingSort = null;\n                    // make sure we redraw everything\n                    me.game.repaint();\n                }.defer(this, this);\n            }\n        },\n\n        onDeactivateEvent : function () {\n            for (var i = this.children.length, obj; i--, (obj = this.children[i]);) {\n                var child = this.children[i];\n                if (typeof child.onDeactivateEvent === \"function\") {\n                    child.onDeactivateEvent();\n                }\n            }\n        },\n\n        /**\n         * Z Sorting function\n         * @ignore\n         */\n        _sortZ : function (a, b) {\n            return (b.pos && a.pos) ? (b.pos.z - a.pos.z) : (a.pos ? -Infinity : Infinity);\n        },\n\n        /**\n         * X Sorting function\n         * @ignore\n         */\n        _sortX : function (a, b) {\n            if (!b.pos || !a.pos) {\n                return (a.pos ? -Infinity : Infinity);\n            }\n            var result = b.pos.z - a.pos.z;\n            return (result ? result : (b.pos.x - a.pos.x));\n        },\n\n        /**\n         * Y Sorting function\n         * @ignore\n         */\n        _sortY : function (a, b) {\n            if (!b.pos || !a.pos) {\n                return (a.pos ? -Infinity : Infinity);\n            }\n            var result = b.pos.z - a.pos.z;\n            return (result ? result : (b.pos.y - a.pos.y));\n        },\n\n        /**\n         * Destroy function<br>\n         * @ignore\n         */\n        destroy : function () {\n            // cancel any sort operation\n            if (this.pendingSort) {\n                clearTimeout(this.pendingSort);\n                this.pendingSort = null;\n            }\n\n            // delete all children\n            for (var i = this.children.length, obj; i--, (obj = this.children[i]);) {\n                // don't remove it if a persistent object\n                if (!obj.isPersistent) {\n                    this.removeChildNow(obj);\n                }\n            }\n\n            // reset the transformation matrix\n            this.transform.identity();\n        },\n\n        /**\n         * @ignore\n         */\n        update : function (dt) {\n            me.Renderable.prototype.update.apply(this, [dt]);\n            var isDirty = false;\n            var isFloating = false;\n            var isPaused = me.state.isPaused();\n            var viewport = me.game.viewport;\n\n            // Update container's absolute position\n            this._absPos.setV(this.pos);\n            if (this.ancestor) {\n                this._absPos.add(this.ancestor._absPos);\n            }\n\n            for (var i = this.children.length, obj; i--, (obj = this.children[i]);) {\n                if (isPaused && (!obj.updateWhenPaused)) {\n                    // skip this object\n                    continue;\n                }\n\n                if (obj.isRenderable) {\n                    isFloating = (globalFloatingCounter > 0 || obj.floating);\n                    if (isFloating) {\n                        globalFloatingCounter++;\n                    }\n                    // check if object is visible\n                    obj.inViewport = isFloating || viewport.isVisible(obj.getBounds());\n\n                    // update our object\n                    isDirty = ((obj.inViewport || obj.alwaysUpdate) && obj.update(dt)) || isDirty;\n\n                    // Update child's absolute position\n                    obj._absPos.setV(this._absPos).add(obj.pos);\n\n                    if (globalFloatingCounter > 0) {\n                        globalFloatingCounter--;\n                    }\n                }\n                else {\n                    // just directly call update() for non renderable object\n                    isDirty = obj.update(dt) || isDirty;\n                }\n            }\n\n            return isDirty;\n        },\n\n        /**\n         * @ignore\n         */\n        draw : function (renderer, rect) {\n            var isFloating = false,\n                restore = false,\n                alpha = renderer.globalAlpha();\n\n            this.drawCount = 0;\n\n            if (this.transform.isIdentity()) {\n                renderer.translate(this.pos.x, this.pos.y);\n            }\n            else {\n                restore = true;\n                renderer.save();\n                renderer.transform(this.transform);\n            }\n\n            // apply the group opacity\n            renderer.setGlobalAlpha(alpha * this.getOpacity());\n\n            for (var i = this.children.length, obj; i--, (obj = this.children[i]);) {\n                isFloating = obj.floating;\n                if ((obj.inViewport || isFloating) && obj.isRenderable) {\n                    if (isFloating) {\n                        // translate to screen coordinates\n                        renderer.save();\n                        renderer.resetTransform();\n                    }\n\n                    // draw the object\n                    obj.draw(renderer, rect);\n\n                    if (isFloating) {\n                        renderer.restore();\n                    }\n\n                    this.drawCount++;\n                }\n            }\n\n            if (restore) {\n                renderer.restore();\n            }\n            else {\n                renderer.translate(-this.pos.x, -this.pos.y);\n                renderer.setGlobalAlpha(alpha);\n            }\n        }\n    });\n\n    /**\n     * Base class for ObjectContainer exception handling.\n     * @name Error\n     * @class\n     * @memberOf me.Container\n     * @constructor\n     * @param {String} msg Error message.\n     */\n    me.Container.Error = me.Renderable.Error.extend({\n        init : function (msg) {\n            me.Renderable.Error.prototype.init.apply(this, [ msg ]);\n            this.name = \"me.Container.Error\";\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n\n(function () {\n\n    /**\n     * a Generic Object Entity<br>\n     * @class\n     * @extends me.Renderable\n     * @memberOf me\n     * @constructor\n     * @param {Number} x the x coordinates of the entity object\n     * @param {Number} y the y coordinates of the entity object\n     * @param {Object} settings Entity properties, to be defined through Tiled or when calling the entity constructor\n     * <img src=\"images/object_properties.png\"/>\n     * @param {String} [settings.name] object entity name\n     * @param {String} [settings.id] object unique IDs\n     * @param {Image|String} [settings.image] resource name of a spritesheet to use for the entity renderable component\n     * @param {Number} [settings.framewidth] width of a single frame in the given spritesheet\n     * @param {Number} [settings.frameheight] height of a single frame in the given spritesheet\n     * @param {String} [settings.type] object type\n     * @param {Number} [settings.collisionMask] Mask collision detection for this object\n     * @param {{me.Rect[],me.Polygon[],me.Line[],me.Ellipse[]}} [settings.shapes] the initial list of collision shapes (usually populated through Tiled)\n     */\n    me.Entity = me.Renderable.extend(\n    /** @scope me.Entity.prototype */\n    {\n        /** @ignore */\n        init : function (x, y, settings) {\n\n            /**\n             * The entity renderable object (if defined)\n             * @public\n             * @type me.Renderable\n             * @name renderable\n             * @memberOf me.Entity\n             */\n            this.renderable = null;\n\n            // ensure mandatory properties are defined\n            if ((typeof settings.width !== \"number\") || (typeof settings.height !== \"number\")) {\n                throw new me.Entity.Error(\"height and width properties are mandatory when passing settings parameters to an object entity\");\n            }\n\n            // call the super constructor\n            me.Renderable.prototype.init.apply(this, [x, y,\n                        settings.width,\n                        settings.height]);\n\n            if (settings.image) {\n                this.renderable = new me.AnimationSheet(0, 0, {\n                    \"image\" : settings.image,\n                    \"framewidth\" : ~~(settings.framewidth || settings.width),\n                    \"frameheight\" : ~~(settings.frameheight || settings.height),\n                    \"spacing\" : ~~settings.spacing,\n                    \"margin\" : ~~settings.margin,\n                    \"anchorPoint\" : settings.anchorPoint,\n                });\n            }\n\n            // Update anchorPoint\n            if (settings.anchorPoint) {\n                this.anchorPoint.set(settings.anchorPoint.x, settings.anchorPoint.y);\n            }\n\n            /**\n             * Entity name<br>\n             * as defined in the Tiled Object Properties\n             * @public\n             * @type String\n             * @name name\n             * @memberOf me.Entity\n             */\n            this.name = settings.name || \"\";\n\n            /**\n             * object type (as defined in Tiled)\n             * @public\n             * @type String\n             * @name type\n             * @memberOf me.Entity\n             */\n            this.type = settings.type || \"\";\n\n            /**\n             * object unique ID (as defined in Tiled)\n             * @public\n             * @type Number\n             * @name id\n             * @memberOf me.Entity\n             */\n            this.id = settings.id || \"\";\n\n            /**\n             * dead/living state of the entity<br>\n             * default value : true\n             * @public\n             * @type Boolean\n             * @name alive\n             * @memberOf me.Entity\n             */\n            this.alive = true;\n\n            /**\n             * the entity body object\n             * @public\n             * @type me.Body\n             * @name body\n             * @memberOf me.Entity\n             */\n            // initialize the default body\n            var shapes = (\n                Array.isArray(settings.shapes) ?\n                settings.shapes :\n                [ new me.Rect(0, 0, this.width, this.height) ]\n            );\n            if (this.body) {\n                this.body.init(this, shapes);\n            }\n            else {\n                this.body = new me.Body(this, shapes);\n            }\n\n            // ensure the entity bounds and pos are up-to-date\n            var bounds = this.body.updateBounds();\n\n            // resize the entity if required\n            if (this.width === 0 && this.height === 0) {\n                this.resize(bounds.width, bounds.height);\n            }\n\n            // set the  collision mask if defined\n            if (typeof(settings.collisionMask) !== \"undefined\") {\n                this.body.setCollisionMask(settings.collisionMask);\n            }\n\n            // set the  collision mask if defined\n            if (typeof(settings.collisionType) !== \"undefined\") {\n                if (typeof me.collision.types[settings.collisionType] !== \"undefined\") {\n                    this.body.collisionType = me.collision.types[settings.collisionType];\n                } else {\n                    throw new me.Entity.Error(\"Invalid value for the collisionType property\");\n                }\n            }\n        },\n\n        /**\n         * return the distance to the specified entity\n         * @name distanceTo\n         * @memberOf me.Entity\n         * @function\n         * @param {me.Entity} entity Entity\n         * @return {Number} distance\n         */\n        distanceTo: function (e) {\n            var a = this.getBounds();\n            var b = e.getBounds();\n            // the me.Vector2d object also implements the same function, but\n            // we have to use here the center of both entities\n            var dx = (a.pos.x + (a.width / 2))  - (b.pos.x + (b.width / 2));\n            var dy = (a.pos.y + (a.height / 2)) - (b.pos.y + (b.height / 2));\n            return Math.sqrt(dx * dx + dy * dy);\n        },\n\n        /**\n         * return the distance to the specified point\n         * @name distanceToPoint\n         * @memberOf me.Entity\n         * @function\n         * @param {me.Vector2d} vector vector\n         * @return {Number} distance\n         */\n        distanceToPoint: function (v) {\n            var a = this.getBounds();\n            // the me.Vector2d object also implements the same function, but\n            // we have to use here the center of both entities\n            var dx = (a.pos.x + (a.width / 2))  - (v.x);\n            var dy = (a.pos.y + (a.height / 2)) - (v.y);\n            return Math.sqrt(dx * dx + dy * dy);\n        },\n\n        /**\n         * return the angle to the specified entity\n         * @name angleTo\n         * @memberOf me.Entity\n         * @function\n         * @param {me.Entity} entity Entity\n         * @return {Number} angle in radians\n         */\n        angleTo: function (e) {\n            var a = this.getBounds();\n            var b = e.getBounds();\n            // the me.Vector2d object also implements the same function, but\n            // we have to use here the center of both entities\n            var ax = (b.pos.x + (b.width / 2)) - (a.pos.x + (a.width / 2));\n            var ay = (b.pos.y + (b.height / 2)) - (a.pos.y + (a.height / 2));\n            return Math.atan2(ay, ax);\n        },\n\n        /**\n         * return the angle to the specified point\n         * @name angleToPoint\n         * @memberOf me.Entity\n         * @function\n         * @param {me.Vector2d} vector vector\n         * @return {Number} angle in radians\n         */\n        angleToPoint: function (v) {\n            var a = this.getBounds();\n            // the me.Vector2d object also implements the same function, but\n            // we have to use here the center of both entities\n            var ax = (v.x) - (a.pos.x + (a.width / 2));\n            var ay = (v.y) - (a.pos.y + (a.height / 2));\n            return Math.atan2(ay, ax);\n        },\n\n        /**\n         * update the bounding rect dimensions\n         * @private\n         * @name resizeBounds\n         * @memberOf me.Entity\n         * @function\n         */\n        resizeBounds : function (width, height) {\n            this._bounds.resize(width, height);\n        },\n\n        /** @ignore */\n        update : function (dt) {\n            if (this.renderable) {\n                return this.renderable.update(dt);\n            }\n            return me.Renderable.prototype.update.apply(this, [dt]);\n        },\n\n        /**\n         * update the bounds position when the position is modified\n         * @private\n         * @name updateBoundsPos\n         * @memberOf me.Entity\n         * @function\n         */\n        updateBoundsPos : function (x, y) {\n            var _pos = this.body.pos;\n            me.Renderable.prototype.updateBoundsPos.apply(this, [\n                x + _pos.x,\n                y + _pos.y\n            ]);\n            return this._bounds;\n        },\n\n        /**\n         * update the bounds position when the body is modified\n         * @private\n         * @name onBodyUpdate\n         * @memberOf me.Entity\n         * @function\n         */\n        onBodyUpdate : function (pos, w, h) {\n            this._bounds.pos.setV(this.pos).add(pos);\n            // XXX: This is called from the constructor, before it gets an ancestor\n            if (this.ancestor) {\n                this._bounds.pos.add(this.ancestor._absPos);\n            }\n            this._bounds.resize(w, h);\n        },\n\n        /**\n         * object draw<br>\n         * not to be called by the end user<br>\n         * called by the game manager on each game loop\n         * @name draw\n         * @memberOf me.Entity\n         * @function\n         * @protected\n         * @param {me.CanvasRenderer|me.WebGLRenderer} renderer a renderer object\n         **/\n        draw : function (renderer) {\n            // draw the sprite if defined\n            if (this.renderable) {\n\n                // draw the renderable's anchorPoint at the entity's anchor point\n                // the entity's anchor point is a scale from body position to body width/height\n                var x = ~~( 0.5 + this.pos.x + this.body.pos.x +\n                    (this.anchorPoint.x * this.body.width));\n                var y = ~~( 0.5 + this.pos.y + this.body.pos.y +\n                    (this.anchorPoint.y * this.body.height));\n\n                renderer.translate(x, y);\n                this.renderable.draw(renderer);\n                renderer.translate(-x, -y);\n            }\n        },\n\n        /**\n         * Destroy function<br>\n         * @ignore\n         */\n        destroy : function () {\n            // free some property objects\n            if (this.renderable) {\n                this.renderable.destroy.apply(this.renderable, arguments);\n                this.renderable = null;\n            }\n            this.body.destroy.apply(this.body, arguments);\n            this.body = null;\n        },\n\n        /**\n         * onDeactivateEvent Notification function<br>\n         * Called by engine before deleting the object\n         * @name onDeactivateEvent\n         * @memberOf me.Entity\n         * @function\n         */\n        onDeactivateEvent : function () {\n          if (this.renderable && this.renderable.onDeactivateEvent) {\n              this.renderable.onDeactivateEvent();\n          }\n        },\n\n        /**\n         * onCollision callback<br>\n         * triggered in case of collision, when this entity body is being \"touched\" by another one<br>\n         * @name onCollision\n         * @memberOf me.Entity\n         * @function\n         * @param {me.collision.ResponseObject} response the collision response object\n         * @param {me.Entity} other the other entity touching this one (a reference to response.a or response.b)\n         * @return {Boolean} true if the object should respond to the collision (its position and velocity will be corrected)\n         */\n        onCollision : function () {\n            return false;\n        }\n    });\n\n    /**\n     * Base class for Entity exception handling.\n     * @name Error\n     * @class\n     * @memberOf me.Entity\n     * @constructor\n     * @param {String} msg Error message.\n     */\n    me.Entity.Error = me.Renderable.Error.extend({\n        init : function (msg) {\n            me.Renderable.Error.prototype.init.apply(this, [ msg ]);\n            this.name = \"me.Entity.Error\";\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n * Screens objects & State machine\n *\n */\n\n(function () {\n    /**\n     * A class skeleton for \"Screen\" Object <br>\n     * every \"screen\" object (title screen, credits, ingame, etc...) to be managed <br>\n     * through the state manager must inherit from this base class.\n     * @class\n     * @extends Object\n     * @memberOf me\n     * @constructor\n     * @see me.state\n     */\n    me.ScreenObject = me.Object.extend(\n    /** @scope me.ScreenObject.prototype */\n    {\n        /** @ignore */\n        init: function () {},\n\n        /**\n         * Object reset function\n         * @ignore\n         */\n        reset : function () {\n            // reset the game manager\n            me.game.reset();\n            // call the onReset Function\n            this.onResetEvent.apply(this, arguments);\n        },\n\n        /**\n         * destroy function\n         * @ignore\n         */\n        destroy : function () {\n            // notify the object\n            this.onDestroyEvent.apply(this, arguments);\n        },\n\n        /**\n         * onResetEvent function<br>\n         * called by the state manager when reseting the object<br>\n         * this is typically where you will load a level, etc...\n         * to be extended\n         * @name onResetEvent\n         * @memberOf me.ScreenObject\n         * @function\n         * @param {} [arguments...] optional arguments passed when switching state\n         * @see me.state#change\n         */\n        onResetEvent : function () {\n            // to be extended\n        },\n\n        /**\n         * onDestroyEvent function<br>\n         * called by the state manager before switching to another state<br>\n         * @name onDestroyEvent\n         * @memberOf me.ScreenObject\n         * @function\n         */\n        onDestroyEvent : function () {\n            // to be extended\n        }\n    });\n\n    // based on the requestAnimationFrame polyfill by Erik Möller\n    (function () {\n        var lastTime = 0;\n        var frameDuration = 1000 / 60;\n        // get unprefixed rAF and cAF, if present\n        var requestAnimationFrame = me.agent.prefixed(\"requestAnimationFrame\");\n        var cancelAnimationFrame = me.agent.prefixed(\"cancelAnimationFrame\") ||\n                                   me.agent.prefixed(\"cancelRequestAnimationFrame\");\n\n        if (!requestAnimationFrame || !cancelAnimationFrame) {\n            requestAnimationFrame = function (callback) {\n                var currTime = window.performance.now();\n                var timeToCall = Math.max(0, frameDuration - (currTime - lastTime));\n                var id = window.setTimeout(function () {\n                    callback(currTime + timeToCall);\n                }, timeToCall);\n                lastTime = currTime + timeToCall;\n                return id;\n            };\n\n            cancelAnimationFrame = function (id) {\n                window.clearTimeout(id);\n            };\n        }\n\n         // put back in global namespace\n        window.requestAnimationFrame = requestAnimationFrame;\n        window.cancelAnimationFrame = cancelAnimationFrame;\n    }());\n\n\n    /**\n     * a State Manager (state machine)<p>\n     * There is no constructor function for me.state.\n     * @namespace me.state\n     * @memberOf me\n     */\n\n    me.state = (function () {\n        // hold public stuff in our singleton\n        var api = {};\n\n        /*-------------------------------------------\n            PRIVATE STUFF\n         --------------------------------------------*/\n\n        // current state\n        var _state = -1;\n\n        // requestAnimeFrame Id\n        var _animFrameId = -1;\n\n        // whether the game state is \"paused\"\n        var _isPaused = false;\n\n        // list of screenObject\n        var _screenObject = {};\n\n        // fading transition parameters between screen\n        var _fade = {\n            color : \"\",\n            duration : 0\n        };\n\n        // callback when state switch is done\n        /** @ignore */\n        var _onSwitchComplete = null;\n\n        // just to keep track of possible extra arguments\n        var _extraArgs = null;\n\n        // store the elapsed time during pause/stop period\n        var _pauseTime = 0;\n\n        /**\n         * @ignore\n         */\n        function _startRunLoop() {\n            // ensure nothing is running first and in valid state\n            if ((_animFrameId === -1) && (_state !== -1)) {\n                // reset the timer\n                me.timer.reset();\n\n                // start the main loop\n                _animFrameId = window.requestAnimationFrame(_renderFrame);\n            }\n        }\n\n        /**\n         * Resume the game loop after a pause.\n         * @ignore\n         */\n        function _resumeRunLoop() {\n            // ensure game is actually paused and in valid state\n            if (_isPaused && (_state !== -1)) {\n                // reset the timer\n                me.timer.reset();\n\n                _isPaused = false;\n            }\n        }\n\n        /**\n         * Pause the loop for most screen objects.\n         * @ignore\n         */\n        function _pauseRunLoop() {\n            // Set the paused boolean to stop updates on (most) entities\n            _isPaused = true;\n        }\n\n        /**\n         * this is only called when using requestAnimFrame stuff\n         * @param {Number} time current timestamp in milliseconds\n         * @ignore\n         */\n        function _renderFrame(time) {\n            // update all game objects\n            me.game.update(time);\n            // render all game objects\n            me.game.draw();\n            // schedule the next frame update\n            if (_animFrameId !== -1) {\n                _animFrameId = window.requestAnimationFrame(_renderFrame);\n            }\n        }\n\n        /**\n         * stop the SO main loop\n         * @ignore\n         */\n        function _stopRunLoop() {\n            // cancel any previous animationRequestFrame\n            window.cancelAnimationFrame(_animFrameId);\n            _animFrameId = -1;\n        }\n\n        /**\n         * start the SO main loop\n         * @ignore\n         */\n        function _switchState(state) {\n            // clear previous interval if any\n            _stopRunLoop();\n\n            // call the screen object destroy method\n            if (_screenObject[_state]) {\n                // just notify the object\n                _screenObject[_state].screen.destroy();\n            }\n\n            if (_screenObject[state]) {\n                // set the global variable\n                _state = state;\n\n                // call the reset function with _extraArgs as arguments\n                _screenObject[_state].screen.reset.apply(_screenObject[_state].screen, _extraArgs);\n\n                // and start the main loop of the\n                // new requested state\n                _startRunLoop();\n\n                // execute callback if defined\n                if (_onSwitchComplete) {\n                    _onSwitchComplete();\n                }\n\n                // force repaint\n                me.game.repaint();\n            }\n        }\n\n        /*\n         * PUBLIC STUFF\n         */\n\n        /**\n         * default state ID for Loading Screen\n         * @constant\n         * @name LOADING\n         * @memberOf me.state\n         */\n        api.LOADING = 0;\n\n        /**\n         * default state ID for Menu Screen\n         * @constant\n         * @name MENU\n         * @memberOf me.state\n         */\n\n        api.MENU = 1;\n        /**\n         * default state ID for \"Ready\" Screen\n         * @constant\n         * @name READY\n         * @memberOf me.state\n         */\n\n        api.READY = 2;\n        /**\n         * default state ID for Play Screen\n         * @constant\n         * @name PLAY\n         * @memberOf me.state\n         */\n\n        api.PLAY = 3;\n        /**\n         * default state ID for Game Over Screen\n         * @constant\n         * @name GAMEOVER\n         * @memberOf me.state\n         */\n\n        api.GAMEOVER = 4;\n        /**\n         * default state ID for Game End Screen\n         * @constant\n         * @name GAME_END\n         * @memberOf me.state\n         */\n\n        api.GAME_END = 5;\n        /**\n         * default state ID for High Score Screen\n         * @constant\n         * @name SCORE\n         * @memberOf me.state\n         */\n\n        api.SCORE = 6;\n        /**\n         * default state ID for Credits Screen\n         * @constant\n         * @name CREDITS\n         * @memberOf me.state\n         */\n\n        api.CREDITS = 7;\n        /**\n         * default state ID for Settings Screen\n         * @constant\n         * @name SETTINGS\n         * @memberOf me.state\n         */\n        api.SETTINGS = 8;\n\n        /**\n         * default state ID for user defined constants<br>\n         * @constant\n         * @name USER\n         * @memberOf me.state\n         * @example\n         * var STATE_INFO = me.state.USER + 0;\n         * var STATE_WARN = me.state.USER + 1;\n         * var STATE_ERROR = me.state.USER + 2;\n         * var STATE_CUTSCENE = me.state.USER + 3;\n         */\n        api.USER = 100;\n\n        /**\n         * onPause callback\n         * @callback\n         * @name onPause\n         * @memberOf me.state\n         */\n        api.onPause = null;\n\n        /**\n         * onResume callback\n         * @callback\n         * @name onResume\n         * @memberOf me.state\n         */\n        api.onResume = null;\n\n        /**\n         * onStop callback\n         * @callback\n         * @name onStop\n         * @memberOf me.state\n         */\n        api.onStop = null;\n\n        /**\n         * onRestart callback\n         * @callback\n         * @name onRestart\n         * @memberOf me.state\n         */\n        api.onRestart = null;\n\n        /**\n         * @ignore\n         */\n        api.init = function () {\n            // set the embedded loading screen\n            api.set(api.LOADING, new me.DefaultLoadingScreen());\n        };\n\n        /**\n         * Stop the current screen object.\n         * @name stop\n         * @memberOf me.state\n         * @public\n         * @function\n         * @param {Boolean} pauseTrack pause current track on screen stop.\n         */\n        api.stop = function (music) {\n            // only stop when we are not loading stuff\n            if ((_state !== api.LOADING) && api.isRunning()) {\n                // stop the main loop\n                _stopRunLoop();\n                // current music stop\n                if (music === true) {\n                    me.audio.pauseTrack();\n                }\n\n                // store time when stopped\n                _pauseTime = window.performance.now();\n\n                // publish the stop notification\n                me.event.publish(me.event.STATE_STOP);\n                // any callback defined ?\n                if (typeof(api.onStop) === \"function\") {\n                    api.onStop();\n                }\n            }\n        };\n\n        /**\n         * pause the current screen object\n         * @name pause\n         * @memberOf me.state\n         * @public\n         * @function\n         * @param {Boolean} pauseTrack pause current track on screen pause\n         */\n        api.pause = function (music) {\n            // only pause when we are not loading stuff\n            if ((_state !== api.LOADING) && !api.isPaused()) {\n                // stop the main loop\n                _pauseRunLoop();\n                // current music stop\n                if (music === true) {\n                    me.audio.pauseTrack();\n                }\n\n                // store time when paused\n                _pauseTime = window.performance.now();\n\n                // publish the pause event\n                me.event.publish(me.event.STATE_PAUSE);\n                // any callback defined ?\n                if (typeof(api.onPause) === \"function\") {\n                    api.onPause();\n                }\n            }\n        };\n\n        /**\n         * Restart the screen object from a full stop.\n         * @name restart\n         * @memberOf me.state\n         * @public\n         * @function\n         * @param {Boolean} resumeTrack resume current track on screen resume\n         */\n        api.restart = function (music) {\n            if (!api.isRunning()) {\n                // restart the main loop\n                _startRunLoop();\n                // current music stop\n                if (music === true) {\n                    me.audio.resumeTrack();\n                }\n\n                // calculate the elpased time\n                _pauseTime = window.performance.now() - _pauseTime;\n\n                // force repaint\n                me.game.repaint();\n\n                // publish the restart notification\n                me.event.publish(me.event.STATE_RESTART, [ _pauseTime ]);\n                // any callback defined ?\n                if (typeof(api.onRestart) === \"function\") {\n                    api.onRestart();\n                }\n            }\n        };\n\n        /**\n         * resume the screen object\n         * @name resume\n         * @memberOf me.state\n         * @public\n         * @function\n         * @param {Boolean} resumeTrack resume current track on screen resume\n         */\n        api.resume = function (music) {\n            if (api.isPaused()) {\n                // resume the main loop\n                _resumeRunLoop();\n                // current music stop\n                if (music === true) {\n                    me.audio.resumeTrack();\n                }\n\n                // calculate the elpased time\n                _pauseTime = window.performance.now() - _pauseTime;\n\n                // publish the resume event\n                me.event.publish(me.event.STATE_RESUME, [ _pauseTime ]);\n                // any callback defined ?\n                if (typeof(api.onResume) === \"function\") {\n                    api.onResume();\n                }\n            }\n        };\n\n        /**\n         * return the running state of the state manager\n         * @name isRunning\n         * @memberOf me.state\n         * @public\n         * @function\n         * @return {Boolean} true if a \"process is running\"\n         */\n        api.isRunning = function () {\n            return _animFrameId !== -1;\n        };\n\n        /**\n         * Return the pause state of the state manager\n         * @name isPaused\n         * @memberOf me.state\n         * @public\n         * @function\n         * @return {Boolean} true if the game is paused\n         */\n        api.isPaused = function () {\n            return _isPaused;\n        };\n\n        /**\n         * associate the specified state with a screen object\n         * @name set\n         * @memberOf me.state\n         * @public\n         * @function\n         * @param {Number} state State ID (see constants)\n         * @param {me.ScreenObject} so Instantiated ScreenObject to associate\n         * with state ID\n         * @example\n         * var MenuButton = me.GUI_Object.extend({\n         *     \"onClick\" : function () {\n         *         // Change to the PLAY state when the button is clicked\n         *         me.state.change(me.state.PLAY);\n         *         return true;\n         *     }\n         * });\n         *\n         * var MenuScreen = me.ScreenObject.extend({\n         *     onResetEvent: function() {\n         *         // Load background image\n         *         me.game.world.addChild(\n         *             new me.ImageLayer(0, 0, {\n         *                 image : \"bg\",\n         *                 z: 0 // z-index\n         *             }\n         *         );\n         *\n         *         // Add a button\n         *         me.game.world.addChild(\n         *             new MenuButton(350, 200, { \"image\" : \"start\" }),\n         *             1 // z-index\n         *         );\n         *\n         *         // Play music\n         *         me.audio.playTrack(\"menu\");\n         *     },\n         *\n         *     \"onDestroyEvent\" : function () {\n         *         // Stop music\n         *         me.audio.stopTrack();\n         *     }\n         * });\n         *\n         * me.state.set(me.state.MENU, new MenuScreen());\n         */\n        api.set = function (state, so) {\n            _screenObject[state] = {};\n            _screenObject[state].screen = so;\n            _screenObject[state].transition = true;\n        };\n\n        /**\n         * return a reference to the current screen object<br>\n         * useful to call a object specific method\n         * @name current\n         * @memberOf me.state\n         * @public\n         * @function\n         * @return {me.ScreenObject}\n         */\n        api.current = function () {\n            return _screenObject[_state].screen;\n        };\n\n        /**\n         * specify a global transition effect\n         * @name transition\n         * @memberOf me.state\n         * @public\n         * @function\n         * @param {String} effect (only \"fade\" is supported for now)\n         * @param {me.Color|String} color a CSS color value\n         * @param {Number} [duration=1000] expressed in milliseconds\n         */\n        api.transition = function (effect, color, duration) {\n            if (effect === \"fade\") {\n                _fade.color = color;\n                _fade.duration = duration;\n            }\n        };\n\n        /**\n         * enable/disable transition for a specific state (by default enabled for all)\n         * @name setTransition\n         * @memberOf me.state\n         * @public\n         * @function\n         * @param {Number} state State ID (see constants)\n         * @param {Boolean} enable\n         */\n        api.setTransition = function (state, enable) {\n            _screenObject[state].transition = enable;\n        };\n\n        /**\n         * change the game/app state\n         * @name change\n         * @memberOf me.state\n         * @public\n         * @function\n         * @param {Number} state State ID (see constants)\n         * @param {} [arguments...] extra arguments to be passed to the reset functions\n         * @example\n         * // The onResetEvent method on the play screen will receive two args:\n         * // \"level_1\" and the number 3\n         * me.state.change(me.state.PLAY, \"level_1\", 3);\n         */\n        api.change = function (state) {\n            // Protect against undefined ScreenObject\n            if (typeof(_screenObject[state]) === \"undefined\") {\n                throw new me.Error(\"Undefined ScreenObject for state '\" + state + \"'\");\n            }\n\n            _extraArgs = null;\n            if (arguments.length > 1) {\n                // store extra arguments if any\n                _extraArgs = Array.prototype.slice.call(arguments, 1);\n            }\n            // if fading effect\n            if (_fade.duration && _screenObject[state].transition) {\n                /** @ignore */\n                _onSwitchComplete = function () {\n                    me.game.viewport.fadeOut(_fade.color, _fade.duration);\n                };\n                me.game.viewport.fadeIn(\n                    _fade.color,\n                    _fade.duration,\n                    function () {\n                        _switchState.defer(this, state);\n                    }\n                );\n\n            }\n            // else just switch without any effects\n            else {\n                // wait for the last frame to be\n                // \"finished\" before switching\n                _switchState.defer(this, state);\n            }\n        };\n\n        /**\n         * return true if the specified state is the current one\n         * @name isCurrent\n         * @memberOf me.state\n         * @public\n         * @function\n         * @param {Number} state State ID (see constants)\n         */\n        api.isCurrent = function (state) {\n            return _state === state;\n        };\n\n        // return our object\n        return api;\n    })();\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n */\n(function () {\n    // a basic progress bar object\n    var ProgressBar = me.Renderable.extend({\n\n        init: function (v, w, h) {\n            me.Renderable.prototype.init.apply(this, [v.x, v.y, w, h]);\n            // flag to know if we need to refresh the display\n            this.invalidate = false;\n\n            // default progress bar height\n            this.barHeight = 4;\n\n            // current progress\n            this.progress = 0;\n        },\n\n        // make sure the screen is refreshed every frame\n        onProgressUpdate : function (progress) {\n            this.progress = ~~(progress * this.width);\n            this.invalidate = true;\n        },\n\n        // make sure the screen is refreshed every frame\n        update : function () {\n            if (this.invalidate === true) {\n                // clear the flag\n                this.invalidate = false;\n                // and return true\n                return true;\n            }\n            // else return false\n            return false;\n        },\n\n         // draw function\n        draw : function (renderer) {\n            // draw the progress bar\n            renderer.setColor(\"black\");\n            renderer.fillRect(0, (this.height / 2) - (this.barHeight / 2), this.width, this.barHeight);\n\n            renderer.setColor(\"#55aa00\");\n            renderer.fillRect(2, (this.height / 2) - (this.barHeight / 2), this.progress, this.barHeight);\n\n            renderer.setColor(\"white\");\n        }\n    });\n\n    // the melonJS Logo\n    var IconLogo = me.Renderable.extend({\n        init : function (iconCanvas, x, y) {\n            me.Renderable.prototype.init.apply(this, [x, y, 100, 85]);\n\n            this.iconCanvas = iconCanvas;\n\n            var context = me.video.renderer.getContext2d(this.iconCanvas);\n\n            context.translate(this.pos.x, this.pos.y);\n            context.beginPath();\n            context.moveTo(0.7, 48.9);\n            context.bezierCurveTo(10.8, 68.9, 38.4, 75.8, 62.2, 64.5);\n            context.bezierCurveTo(86.1, 53.1, 97.2, 27.7, 87.0, 7.7);\n            context.lineTo(87.0, 7.7);\n            context.bezierCurveTo(89.9, 15.4, 73.9, 30.2, 50.5, 41.4);\n            context.bezierCurveTo(27.1, 52.5, 5.2, 55.8, 0.7, 48.9);\n            context.lineTo(0.7, 48.9);\n            context.lineTo(0.7, 48.9);\n            context.closePath();\n            context.fillStyle = \"rgb(255, 255, 255)\";\n            context.fill();\n\n            context.beginPath();\n            context.moveTo(84.0, 7.0);\n            context.bezierCurveTo(87.6, 14.7, 72.5, 30.2, 50.2, 41.6);\n            context.bezierCurveTo(27.9, 53.0, 6.9, 55.9, 3.2, 48.2);\n            context.bezierCurveTo(-0.5, 40.4, 14.6, 24.9, 36.9, 13.5);\n            context.bezierCurveTo(59.2, 2.2, 80.3, -0.8, 84.0, 7.0);\n            context.lineTo(84.0, 7.0);\n            context.closePath();\n            context.lineWidth = 5.3;\n            context.strokeStyle = \"rgb(255, 255, 255)\";\n            context.lineJoin = \"miter\";\n            context.miterLimit = 4.0;\n            context.stroke();\n        },\n\n        draw : function (renderer) {\n            renderer.drawImage(this.iconCanvas, 0, 0);\n        }\n    });\n\n    // the melonJS Text Logo\n    var TextLogo = me.Renderable.extend({\n        // constructor\n        init : function (w, h) {\n            me.Renderable.prototype.init.apply(this, [0, 0, w, h]);\n            this.logo1 = new me.Font(\"century gothic\", 32, \"white\", \"middle\");\n            this.logo2 = new me.Font(\"century gothic\", 32, \"#55aa00\", \"middle\");\n            this.logo2.bold();\n            this.logo1.textBaseline = this.logo2.textBaseline = \"alphabetic\";\n        },\n\n        draw : function (renderer) {\n            // measure the logo size\n            var logo1_width = this.logo1.measureText(renderer, \"melon\").width;\n            var xpos = (this.width - logo1_width - this.logo2.measureText(renderer, \"JS\").width) / 2;\n            var ypos = (this.height / 2) + (this.logo2.measureText(renderer, \"melon\").height);\n\n            // draw the melonJS string\n            this.logo1.draw(renderer, \"melon\", xpos, ypos);\n            xpos += logo1_width;\n            this.logo2.draw(renderer, \"JS\", xpos, ypos);\n        }\n\n    });\n\n    /**\n     * a default loading screen\n     * @memberOf me\n     * @ignore\n     * @constructor\n     */\n    me.DefaultLoadingScreen = me.ScreenObject.extend({\n        // call when the loader is resetted\n        onResetEvent : function () {\n            // background color\n            me.game.world.addChild(new me.ColorLayer(\"background\", \"#202020\", 0), 0);\n\n            // progress bar\n            var progressBar = new ProgressBar(\n                new me.Vector2d(),\n                me.video.renderer.getWidth(),\n                me.video.renderer.getHeight()\n            );\n\n            this.loaderHdlr = me.event.subscribe(\n                me.event.LOADER_PROGRESS,\n                progressBar.onProgressUpdate.bind(progressBar)\n            );\n\n            this.resizeHdlr = me.event.subscribe(\n                me.event.VIEWPORT_ONRESIZE,\n                progressBar.resize.bind(progressBar)\n            );\n\n            me.game.world.addChild(progressBar, 1);\n            this.iconCanvas = me.video.createCanvas(me.game.viewport.width, me.game.viewport.height, false);\n            // melonJS text & logo\n            var icon = new IconLogo(\n                this.iconCanvas,\n                (me.video.renderer.getWidth() - 100) / 2,\n                (me.video.renderer.getHeight() / 2) - (progressBar.barHeight / 2) - 90\n            );\n            me.game.world.addChild(icon, 1);\n            me.game.world.addChild(new TextLogo(me.video.renderer.getWidth(), me.video.renderer.getHeight()), 1);\n        },\n\n        // destroy object at end of loading\n        onDestroyEvent : function () {\n            // cancel the callback\n            me.event.unsubscribe(this.loaderHdlr);\n            me.event.unsubscribe(this.resizeHdlr);\n            this.loaderHdlr = this.resizeHdlr = null;\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n    /**\n     * a small class to manage loading of stuff and manage resources\n     * There is no constructor function for me.input.\n     * @namespace me.loader\n     * @memberOf me\n     */\n    me.loader = (function () {\n        // hold public stuff in our singleton\n        var api = {};\n\n        // contains all the images loaded\n        var imgList = {};\n        // contains all the TMX loaded\n        var tmxList = {};\n        // contains all the binary files loaded\n        var binList = {};\n        // contains all the JSON files\n        var jsonList = {};\n        // flag to check loading status\n        var resourceCount = 0;\n        var loadCount = 0;\n        var timerId = 0;\n\n        /**\n         * check the loading status\n         * @ignore\n         */\n        function checkLoadStatus() {\n            if (loadCount === resourceCount) {\n                // wait 1/2s and execute callback (cheap workaround to ensure everything is loaded)\n                if (api.onload) {\n                    // make sure we clear the timer\n                    clearTimeout(timerId);\n                    // trigger the onload callback\n                    setTimeout(function () {\n                        api.onload();\n                        me.event.publish(me.event.LOADER_COMPLETE);\n                    }, 300);\n                }\n                else {\n                    console.error(\"no load callback defined\");\n                }\n            }\n            else {\n                timerId = setTimeout(checkLoadStatus, 100);\n            }\n        }\n\n        /**\n         * load Images\n         * @example\n         * preloadImages([\n         *     { name : 'image1', src : 'images/image1.png'},\n         *     { name : 'image2', src : 'images/image2.png'},\n         *     { name : 'image3', src : 'images/image3.png'},\n         *     { name : 'image4', src : 'images/image4.png'}\n         * ]);\n         * @ignore\n         */\n        function preloadImage(img, onload, onerror) {\n            // create new Image object and add to list\n            imgList[img.name] = new Image();\n            imgList[img.name].onload = onload;\n            imgList[img.name].onerror = onerror;\n            imgList[img.name].src = img.src + api.nocache;\n        }\n\n        /**\n         * preload TMX files\n         * @ignore\n         */\n        function preloadTMX(tmxData, onload, onerror) {\n            function addToTMXList(data) {\n                // set the TMX content\n                tmxList[tmxData.name] = data;\n\n                // add the tmx to the levelDirector\n                if (tmxData.type === \"tmx\") {\n                    me.levelDirector.addTMXLevel(tmxData.name);\n                }\n            }\n\n\n            //if the data is in the tmxData object, don't get it via a XMLHTTPRequest\n            if (tmxData.data) {\n                addToTMXList(tmxData.data);\n                onload();\n                return;\n            }\n\n            var xmlhttp = new XMLHttpRequest();\n            // check the data format ('tmx', 'json')\n            var format = me.utils.getFileExtension(tmxData.src);\n\n            if (xmlhttp.overrideMimeType) {\n                if (format === \"json\") {\n                    xmlhttp.overrideMimeType(\"application/json\");\n                }\n                else {\n                    xmlhttp.overrideMimeType(\"text/xml\");\n                }\n            }\n\n            xmlhttp.open(\"GET\", tmxData.src + api.nocache, true);\n\n\n            // set the callbacks\n            xmlhttp.ontimeout = onerror;\n            xmlhttp.onreadystatechange = function () {\n                if (xmlhttp.readyState === 4) {\n                    // status = 0 when file protocol is used, or cross-domain origin,\n                    // (With Chrome use \"--allow-file-access-from-files --disable-web-security\")\n                    if ((xmlhttp.status === 200) || ((xmlhttp.status === 0) && xmlhttp.responseText)) {\n                        var result = null;\n\n                        // parse response\n                        switch (format) {\n                            case \"xml\":\n                            case \"tmx\":\n                            case \"tsx\":\n                                // ie9 does not fully implement the responseXML\n                                if (me.device.ua.match(/msie/i) || !xmlhttp.responseXML) {\n                                    if (window.DOMParser) {\n                                        // manually create the XML DOM\n                                        result = (new DOMParser()).parseFromString(xmlhttp.responseText, \"text/xml\");\n                                    } else {\n                                        throw new api.Error(\"XML file format loading not supported, use the JSON file format instead\");\n                                    }\n                                }\n                                else {\n                                    result = xmlhttp.responseXML;\n                                }\n                                // converts to a JS object\n                                var data = me.TMXUtils.parse(result);\n                                switch (format) {\n                                    case \"tmx\":\n                                        result = data.map;\n                                        break;\n\n                                    case \"tsx\":\n                                        result = data.tilesets[0];\n                                        break;\n                                }\n\n                                break;\n\n                            case \"json\":\n                                result = JSON.parse(xmlhttp.responseText);\n                                break;\n\n                            default:\n                                throw new api.Error(\"TMX file format \" + format + \"not supported !\");\n                        }\n\n                        //set the TMX content\n                        addToTMXList(result);\n\n                        // fire the callback\n                        onload();\n                    }\n                    else {\n                        onerror();\n                    }\n                }\n            };\n            // send the request\n            xmlhttp.send(null);\n        }\n\n        /**\n         * preload TMX files\n         * @ignore\n         */\n        function preloadJSON(data, onload, onerror) {\n            var xmlhttp = new XMLHttpRequest();\n\n            if (xmlhttp.overrideMimeType) {\n                xmlhttp.overrideMimeType(\"application/json\");\n            }\n\n            xmlhttp.open(\"GET\", data.src + api.nocache, true);\n\n            // set the callbacks\n            xmlhttp.ontimeout = onerror;\n            xmlhttp.onreadystatechange = function () {\n                if (xmlhttp.readyState === 4) {\n                    // status = 0 when file protocol is used, or cross-domain origin,\n                    // (With Chrome use \"--allow-file-access-from-files --disable-web-security\")\n                    if ((xmlhttp.status === 200) || ((xmlhttp.status === 0) && xmlhttp.responseText)) {\n                        // get the Texture Packer Atlas content\n                        jsonList[data.name] = JSON.parse(xmlhttp.responseText);\n                        // fire the callback\n                        onload();\n                    }\n                    else {\n                        onerror();\n                    }\n                }\n            };\n            // send the request\n            xmlhttp.send(null);\n        }\n\n        /**\n         * preload Binary files\n         * @ignore\n         */\n        function preloadBinary(data, onload, onerror) {\n            var httpReq = new XMLHttpRequest();\n\n            // load our file\n            httpReq.open(\"GET\", data.src + api.nocache, true);\n            httpReq.responseType = \"arraybuffer\";\n            httpReq.onerror = onerror;\n            httpReq.onload = function () {\n                var arrayBuffer = httpReq.response;\n                if (arrayBuffer) {\n                    var byteArray = new Uint8Array(arrayBuffer);\n                    var buffer = [];\n                    for (var i = 0; i < byteArray.byteLength; i++) {\n                        buffer[i] = String.fromCharCode(byteArray[i]);\n                    }\n                    binList[data.name] = buffer.join(\"\");\n                    // callback\n                    onload();\n                }\n            };\n            httpReq.send();\n        }\n\n        /**\n         * to enable/disable caching\n         * @ignore\n         */\n        api.nocache = \"\";\n\n        /*\n         * PUBLIC STUFF\n         */\n\n        /**\n         * onload callback\n         * @public\n         * @callback\n         * @name onload\n         * @memberOf me.loader\n         * @example\n         * // set a callback when everything is loaded\n         * me.loader.onload = this.loaded.bind(this);\n         */\n        api.onload = undefined;\n\n        /**\n         * onProgress callback<br>\n         * each time a resource is loaded, the loader will fire the specified function,\n         * giving the actual progress [0 ... 1], as argument, and an object describing the resource loaded\n         * @public\n         * @callback\n         * @name onProgress\n         * @memberOf me.loader\n         * @example\n         * // set a callback for progress notification\n         * me.loader.onProgress = this.updateProgress.bind(this);\n         */\n        api.onProgress = undefined;\n\n        /**\n         * Base class for Loader exception handling.\n         * @name Error\n         * @class\n         * @memberOf me.loader\n         * @constructor\n         * @param {String} msg Error message.\n         */\n        api.Error = me.Error.extend({\n            init : function (msg) {\n                me.Error.prototype.init.apply(this, [ msg ]);\n                this.name = \"me.loader.Error\";\n            }\n        });\n\n        /**\n         * just increment the number of already loaded resources\n         * @ignore\n         */\n        api.onResourceLoaded = function (res) {\n            // increment the loading counter\n            loadCount++;\n\n            // callback ?\n            var progress = api.getLoadProgress();\n            if (api.onProgress) {\n                // pass the load progress in percent, as parameter\n                api.onProgress(progress, res);\n            }\n            me.event.publish(me.event.LOADER_PROGRESS, [progress, res]);\n        };\n\n        /**\n         * on error callback for image loading\n         * @ignore\n         */\n        api.onLoadingError = function (res) {\n            throw new api.Error(\"Failed loading resource \" + res.src);\n        };\n\n        /**\n         * enable the nocache mechanism\n         * @ignore\n         */\n        api.setNocache = function (enable) {\n            api.nocache = enable ? \"?\" + ~~(Math.random() * 10000000) : \"\";\n        };\n\n\n        /**\n         * set all the specified game resources to be preloaded.<br>\n         * each resource item must contain the following fields :<br>\n         * - name    : internal name of the resource<br>\n         * - type    : \"binary\", \"image\", \"tmx\", \"tsx\", \"audio\"<br>\n         * each resource except type \"tmx\" must contain the following field :<br>\n         * - src     : path and file name of the resource<br>\n         * (!) for tmx :<br>\n         * - src     : path and file name of the resource<br>\n         * or<br>\n         * - data    : the json or xml object representation of the tmx file<br>\n         * - format  : \"xml\" or \"json\"<br>\n         * (!) for audio :<br>\n         * - src     : path (only) where resources are located<br>\n         * <br>\n         * @name preload\n         * @memberOf me.loader\n         * @public\n         * @function\n         * @param {Object[]} resources\n         * @example\n         * var g_resources = [\n         *   // PNG tileset\n         *   {name: \"tileset-platformer\", type: \"image\",  src: \"data/map/tileset.png\"},\n         *   // PNG packed texture\n         *   {name: \"texture\", type:\"image\", src: \"data/gfx/texture.png\"}\n         *   // TSX file\n         *   {name: \"meta_tiles\", type: \"tsx\", src: \"data/map/meta_tiles.tsx\"},\n         *   // TMX level (XML & JSON)\n         *   {name: \"map1\", type: \"tmx\", src: \"data/map/map1.json\"},\n         *   {name: \"map2\", type: \"tmx\", src: \"data/map/map2.tmx\"},\n         *   {name: \"map3\", type: \"tmx\", format: \"json\", data: {\"height\":15,\"layers\":[...],\"tilewidth\":32,\"version\":1,\"width\":20}},\n         *   {name: \"map4\", type: \"tmx\", format: \"xml\", data: {xml representation of tmx}},\n         *   // audio resources\n         *   {name: \"bgmusic\", type: \"audio\",  src: \"data/audio/\"},\n         *   {name: \"cling\",   type: \"audio\",  src: \"data/audio/\"},\n         *   // binary file\n         *   {name: \"ymTrack\", type: \"binary\", src: \"data/audio/main.ym\"},\n         *   // JSON file (used for texturePacker)\n         *   {name: \"texture\", type: \"json\", src: \"data/gfx/texture.json\"}\n         * ];\n         *\n         * // set all resources to be loaded\n         * me.loader.preload(g_resources);\n         */\n        api.preload = function (res) {\n            // parse the resources\n            for (var i = 0; i < res.length; i++) {\n                resourceCount += api.load(\n                    res[i],\n                    api.onResourceLoaded.bind(api, res[i]),\n                    api.onLoadingError.bind(api, res[i])\n                );\n            }\n            // check load status\n            checkLoadStatus();\n        };\n\n        /**\n         * Load a single resource (to be used if you need to load additional resource during the game)<br>\n         * Given parameter must contain the following fields :<br>\n         * - name    : internal name of the resource<br>\n         * - type    : \"audio\", binary\", \"image\", \"json\", \"tmx\", \"tsx\"<br>\n         * each resource except type \"tmx\" must contain the following field :<br>\n         * - src     : path and file name of the resource<br>\n         * (!) for tmx :<br>\n         * - src     : path and file name of the resource<br>\n         * or<br>\n         * - data    : the json or xml object representation of the tmx file<br>\n         * - format  : \"xml\" or \"json\"<br>\n         * (!) for audio :<br>\n         * - src     : path (only) where resources are located<br>\n         * @name load\n         * @memberOf me.loader\n         * @public\n         * @function\n         * @param {Object} resource\n         * @param {Function} onload function to be called when the resource is loaded\n         * @param {Function} onerror function to be called in case of error\n         * @example\n         * // load an image asset\n         * me.loader.load({name: \"avatar\",  type:\"image\",  src: \"data/avatar.png\"}, this.onload.bind(this), this.onerror.bind(this));\n         *\n         * // start loading music\n         * me.loader.load({\n         *     name   : \"bgmusic\",\n         *     type   : \"audio\",\n         *     src    : \"data/audio/\"\n         * }, function () {\n         *     me.audio.play(\"bgmusic\");\n         * });\n         */\n        api.load = function (res, onload, onerror) {\n            // check ressource type\n            switch (res.type) {\n                case \"binary\":\n                    // reuse the preloadImage fn\n                    preloadBinary.call(this, res, onload, onerror);\n                    return 1;\n\n                case \"image\":\n                    // reuse the preloadImage fn\n                    preloadImage.call(this, res, onload, onerror);\n                    return 1;\n\n                case \"json\":\n                    preloadJSON.call(this, res, onload, onerror);\n                    return 1;\n\n                case \"tmx\":\n                case \"tsx\":\n                    preloadTMX.call(this, res, onload, onerror);\n                    return 1;\n\n                case \"audio\":\n                    me.audio.load(res, onload, onerror);\n                    return 1;\n\n                default:\n                    throw new api.Error(\"load : unknown or invalid resource type : \" + res.type);\n            }\n        };\n\n        /**\n         * unload specified resource to free memory\n         * @name unload\n         * @memberOf me.loader\n         * @public\n         * @function\n         * @param {Object} resource\n         * @return {Boolean} true if unloaded\n         * @example me.loader.unload({name: \"avatar\",  type:\"image\",  src: \"data/avatar.png\"});\n         */\n        api.unload = function (res) {\n            switch (res.type) {\n                case \"binary\":\n                    if (!(res.name in binList)) {\n                        return false;\n                    }\n\n                    delete binList[res.name];\n                    return true;\n\n                case \"image\":\n                    if (!(res.name in imgList)) {\n                        return false;\n                    }\n                    if (typeof(imgList[res.name].dispose) === \"function\") {\n                        // cocoonJS implements a dispose function to free\n                        // corresponding allocated texture in memory\n                        imgList[res.name].dispose();\n                    }\n                    delete imgList[res.name];\n                    return true;\n\n                case \"json\":\n                    if (!(res.name in jsonList)) {\n                        return false;\n                    }\n\n                    delete jsonList[res.name];\n                    return true;\n\n                case \"tmx\":\n                case \"tsx\":\n                    if (!(res.name in tmxList)) {\n                        return false;\n                    }\n\n                    delete tmxList[res.name];\n                    return true;\n\n                case \"audio\":\n                    return me.audio.unload(res.name);\n\n                default:\n                    throw new api.Error(\"unload : unknown or invalid resource type : \" + res.type);\n            }\n        };\n\n        /**\n         * unload all resources to free memory\n         * @name unloadAll\n         * @memberOf me.loader\n         * @public\n         * @function\n         * @example me.loader.unloadAll();\n         */\n        api.unloadAll = function () {\n            var name;\n\n            // unload all binary resources\n            for (name in binList) {\n                if (binList.hasOwnProperty(name)) {\n                    api.unload({\n                        \"name\" : name,\n                        \"type\" : \"binary\"\n                    });\n                }\n            }\n\n            // unload all image resources\n            for (name in imgList) {\n                if (imgList.hasOwnProperty(name)) {\n                    api.unload({\n                        \"name\" : name,\n                        \"type\" : \"image\"\n                    });\n                }\n            }\n\n            // unload all tmx resources\n            for (name in tmxList) {\n                if (tmxList.hasOwnProperty(name)) {\n                    api.unload({\n                        \"name\" : name,\n                        \"type\" : \"tmx\"\n                    });\n                }\n            }\n\n            // unload all in json resources\n            for (name in jsonList) {\n                if (jsonList.hasOwnProperty(name)) {\n                    api.unload({\n                        \"name\" : name,\n                        \"type\" : \"json\"\n                    });\n                }\n            }\n\n            // unload all audio resources\n            me.audio.unloadAll();\n        };\n\n        /**\n         * return the specified TMX/TSX object\n         * @name getTMX\n         * @memberOf me.loader\n         * @public\n         * @function\n         * @param {String} tmx name of the tmx/tsx element (\"map1\");\n         * @return {XML|Object}\n         */\n        api.getTMX = function (elt) {\n            // force as string\n            elt = \"\" + elt;\n            if (elt in tmxList) {\n                return tmxList[elt];\n            }\n            else {\n                //console.log (\"warning %s resource not yet loaded!\",name);\n                return null;\n            }\n        };\n\n        /**\n         * return the specified Binary object\n         * @name getBinary\n         * @memberOf me.loader\n         * @public\n         * @function\n         * @param {String} name of the binary object (\"ymTrack\");\n         * @return {Object}\n         */\n        api.getBinary = function (elt) {\n            // force as string\n            elt = \"\" + elt;\n            if (elt in binList) {\n                return binList[elt];\n            }\n            else {\n                //console.log (\"warning %s resource not yet loaded!\",name);\n                return null;\n            }\n\n        };\n\n        /**\n         * return the specified Image Object\n         * @name getImage\n         * @memberOf me.loader\n         * @public\n         * @function\n         * @param {String} Image name of the Image element (\"tileset-platformer\");\n         * @return {Image}\n         */\n        api.getImage = function (elt) {\n            // force as string\n            elt = \"\" + elt;\n            if (elt in imgList) {\n                // return the corresponding Image object\n                return imgList[elt];\n            }\n            else {\n                //console.log (\"warning %s resource not yet loaded!\",name);\n                return null;\n            }\n\n        };\n\n        /**\n         * return the specified JSON Object\n         * @name getJSON\n         * @memberOf me.loader\n         * @public\n         * @function\n         * @param {String} Name for the json file to load\n         * @return {Object}\n         */\n        api.getJSON = function (elt) {\n            // force as string\n            elt = \"\" + elt;\n            if (elt in jsonList) {\n                return jsonList[elt];\n            }\n            else {\n                return null;\n            }\n        };\n\n        /**\n         * Return the loading progress in percent\n         * @name getLoadProgress\n         * @memberOf me.loader\n         * @public\n         * @function\n         * @deprecated use callback instead\n         * @return {Number}\n         */\n        api.getLoadProgress = function () {\n            return loadCount / resourceCount;\n        };\n\n        // return our object\n        return api;\n    })();\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n * Font / Bitmap font\n *\n * ASCII Table\n * http://www.asciitable.com/\n * [ !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz]\n *\n * -> first char \" \" 32d (0x20);\n */\n(function () {\n\n    var runits = [\"ex\", \"em\", \"pt\", \"px\"];\n    var toPX = [12, 24, 0.75, 1];\n\n    /**\n     * a generic system font object.\n     * @class\n     * @extends me.Renderable\n     * @memberOf me\n     * @constructor\n     * @param {String} font a CSS font name\n     * @param {Number|String} size size, or size + suffix (px, em, pt)\n     * @param {me.Color|String} fillStyle a CSS color value\n     * @param {String} [textAlign=\"left\"] horizontal alignment\n     */\n    me.Font = me.Renderable.extend(\n    /** @scope me.Font.prototype */ {\n\n        /** @ignore */\n        init : function (font, size, fillStyle, textAlign) {\n            // private font properties\n            /** @ignore */\n            this.fontSize = new me.Vector2d();\n\n            /**\n             * defines the color used to draw the font.<br>\n             * @public\n             * @type me.Color\n             * @default black\n             * @name me.Font#fillStyle\n             */\n            this.fillStyle = new me.Color().copy(fillStyle);\n\n            /**\n             * defines the color used to draw the font stroke.<br>\n             * @public\n             * @type me.Color\n             * @default black\n             * @name me.Font#strokeStyle\n             */\n            this.strokeStyle = new me.Color(0, 0, 0);\n\n            /**\n             * sets the current line width, in pixels, when drawing stroke\n             * @public\n             * @type Number\n             * @default 1\n             * @name me.Font#lineWidth\n             */\n            this.lineWidth = 1;\n\n            /**\n             * Set the default text alignment (or justification),<br>\n             * possible values are \"left\", \"right\", and \"center\".<br>\n             * @public\n             * @type String\n             * @default \"left\"\n             * @name me.Font#textAlign\n             */\n            this.textAlign = textAlign || \"left\";\n\n            /**\n             * Set the text baseline (e.g. the Y-coordinate for the draw operation), <br>\n             * possible values are \"top\", \"hanging, \"middle, \"alphabetic, \"ideographic, \"bottom\"<br>\n             * @public\n             * @type String\n             * @default \"top\"\n             * @name me.Font#textBaseline\n             */\n            this.textBaseline = \"top\";\n\n            /**\n             * Set the line spacing height (when displaying multi-line strings). <br>\n             * Current font height will be multiplied with this value to set the line height.\n             * @public\n             * @type Number\n             * @default 1.0\n             * @name me.Font#lineHeight\n             */\n            this.lineHeight = 1.0;\n\n            // super constructor\n            me.Renderable.prototype.init.apply(this, [0, 0, 0, 0]);\n\n            // font name and type\n            this.setFont(font, size, fillStyle, textAlign);\n\n            if (!this.gid) {\n                this.gid = me.utils.createGUID();\n            }\n        },\n\n        /**\n         * make the font bold\n         * @name bold\n         * @memberOf me.Font\n         * @function\n         */\n        bold : function () {\n            this.font = \"bold \" + this.font;\n        },\n\n        /**\n         * make the font italic\n         * @name italic\n         * @memberOf me.Font\n         * @function\n         */\n        italic : function () {\n            this.font = \"italic \" + this.font;\n        },\n\n        /**\n         * Change the font settings\n         * @name setFont\n         * @memberOf me.Font\n         * @function\n         * @param {String} font a CSS font name\n         * @param {Number|String} size size, or size + suffix (px, em, pt)\n         * @param {me.Color|String} [fillStyle] a CSS color value\n         * @param {String} [textAlign=\"left\"] horizontal alignment\n         * @example\n         * font.setFont(\"Arial\", 20, \"white\");\n         * font.setFont(\"Arial\", \"1.5em\", \"white\");\n         */\n        setFont : function (font, size, fillStyle, textAlign) {\n            // font name and type\n            var font_names = font.split(\",\").map(function (value) {\n                value = value.trim();\n                return (\n                    !/(^\".*\"$)|(^'.*'$)/.test(value)\n                ) ? \"\\\"\" + value + \"\\\"\" : value;\n            });\n           \n            if (typeof size === \"number\") {\n                this.fontSize.y = size;\n                size += \"px\";\n            } else /* string */ {\n                // extract the units and convert if necessary\n                var CSSval =  size.match(/([-+]?[\\d.]*)(.*)/);\n                this.fontSize.y = parseFloat(CSSval[1]);\n                if (CSSval[2]) {\n                    this.fontSize.y *= toPX[runits.indexOf(CSSval[2])];                    \n                } else {\n                    // no unit define, assume px\n                    size += \"px\";\n                }\n            }\n            this.height = this.fontSize.y;\n\n            this.font = size + \" \" + font_names.join(\",\");\n            if (typeof(fillStyle) !== \"undefined\") {\n                this.fillStyle.copy(fillStyle);\n            }\n            if (textAlign) {\n                this.textAlign = textAlign;\n            }\n        },\n\n        /**\n         * measure the given text size in pixels\n         * @name measureText\n         * @memberOf me.Font\n         * @function\n         * @param {me.CanvasRenderer|me.WebGLRenderer} renderer Reference to the destination renderer instance\n         * @param {String} text\n         * @return {Object} returns an object, with two attributes: width (the width of the text) and height (the height of the text).\n         */\n        measureText : function (renderer, text) {\n            var context = renderer.fontContext2D;\n\n            // draw the text\n            context.font = this.font;\n            context.fillStyle = this.fillStyle.toRGBA();\n            context.textAlign = this.textAlign;\n            context.textBaseline = this.textBaseline;\n\n            this.height = this.width = 0;\n\n            var strings = (\"\" + text).split(\"\\n\");\n            for (var i = 0; i < strings.length; i++) {\n                this.width = Math.max(context.measureText(strings[i].trimRight()).width, this.width);\n                this.height += this.fontSize.y * this.lineHeight;\n            }\n            return {\n                width : this.width,\n                height : this.height\n            };\n        },\n\n        /**\n         * draw a text at the specified coord\n         * @name draw\n         * @memberOf me.Font\n         * @function\n         * @param {me.CanvasRenderer|me.WebGLRenderer} renderer Reference to the destination renderer instance\n         * @param {String} text\n         * @param {Number} x\n         * @param {Number} y\n         */\n\n        draw : function (renderer, text, x, y) {\n            // save the previous global alpha value\n            var _alpha = renderer.globalAlpha();\n\n            renderer.setGlobalAlpha(_alpha * this.getOpacity());\n\n            // draw the text\n            renderer.drawFont(this._drawFont(renderer.fontContext2D, text, ~~x, ~~y, false));\n\n            // restore the previous global alpha value\n            renderer.setGlobalAlpha(_alpha);\n        },\n\n        /**\n         * draw a stroke text at the specified coord, as defined <br>\n         * by the `lineWidth` and `fillStroke` properties. <br>\n         * Note : using drawStroke is not recommended for performance reasons\n         * @name drawStroke\n         * @memberOf me.Font\n         * @function\n         * @param {me.CanvasRenderer|me.WebGLRenderer} renderer Reference to the destination renderer instance\n         * @param {String} text\n         * @param {Number} x\n         * @param {Number} y\n         */\n        drawStroke : function (renderer, text, x, y) {\n            // save the previous global alpha value\n            var _alpha = renderer.globalAlpha();\n            \n            renderer.setGlobalAlpha(_alpha * this.getOpacity());\n\n            // draw the text\n            renderer.drawFont(this._drawFont(renderer.fontContext2D, text, ~~x, ~~y, true));\n\n            // restore the previous global alpha value\n            renderer.setGlobalAlpha(_alpha);\n        },\n\n        /**\n         * @ignore\n         */\n        _drawFont : function (context, text, x, y, stroke) {\n            context.font = this.font;\n            context.fillStyle = this.fillStyle.toRGBA();\n            if (stroke) {\n                context.strokeStyle = this.strokeStyle.toRGBA();\n                context.lineWidth = this.lineWidth;\n            }\n            context.textAlign = this.textAlign;\n            context.textBaseline = this.textBaseline;\n\n            var strings = (\"\" + text).split(\"\\n\"), string = \"\";\n            var dw = 0;\n            var dy = y;\n            var lineHeight = this.fontSize.y * this.lineHeight;\n            for (var i = 0; i < strings.length; i++) {\n                string = strings[i].trimRight();\n                // measure the string\n                dw = Math.max(dw, context.measureText(string).width);\n                // draw the string\n                context[stroke ? \"strokeText\" : \"fillText\"](string, x, y);\n                // add leading space\n                y += lineHeight;\n            }\n\n            // compute bounds\n            // TODO : memoize me !\n            var dx = (this.textAlign === \"right\" ? x - dw : (\n                this.textAlign === \"center\" ? x - ~~(dw / 2) : x\n            ));\n            dy = (this.textBaseline.search(/^(top|hanging)$/) === 0) ? dy : (\n                this.textBaseline === \"middle\" ? dy - ~~(lineHeight / 2) : dy - lineHeight\n            );\n\n            // update the renderable bounds\n            return this._bounds.setShape(\n                ~~dx,\n                ~~dy,\n                ~~(dw + 0.5),\n                ~~(strings.length * lineHeight + 0.5)\n            );\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n * Font / Bitmap font\n *\n * ASCII Table\n * http://www.asciitable.com/\n * [ !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz]\n *\n * -> first char \" \" 32d (0x20);\n */\n(function () {\n    /**\n     * a bitpmap font object\n     * @class\n     * @extends me.Font\n     * @memberOf me\n     * @constructor\n     * @param {String} font font name\n     * @param {Number|Object} size either a number value, or an object like { x : 16, y : 16 }\n     * @param {Number} [scale=1.0]\n     * @param {Number} [firstChar=0x20] charcode for the first character in the font sheet. Default is the space character.\n     */\n    me.BitmapFont = me.Font.extend(\n    /** @scope me.BitmapFont.prototype */ {\n        /** @ignore */\n        init : function (font, size, scale, firstChar) {\n            /** @ignore */\n            // scaled font size;\n            this.sSize = new me.Vector2d();\n\n            // #char per row\n            this.charCount = 0;\n            // font name and type\n            me.Font.prototype.init.apply(this, [font, size.x || size, \"#000000\"]);\n            // first char in the ascii table\n            this.firstChar = firstChar || 0x20;\n\n            // load the font metrics\n            this.loadFontMetrics(font, size);\n\n            // set a default alignement\n            this.textAlign = \"left\";\n            this.textBaseline = \"top\";\n            // resize if necessary\n            if (scale) {\n                this.resize(scale);\n            }\n        },\n\n        /**\n         * Load the font metrics\n         * @ignore\n         */\n        loadFontMetrics : function (font, size) {\n            this.font = me.loader.getImage(font);\n\n            // some cheap metrics\n            this.fontSize.x = size.x || size;\n            this.fontSize.y = size.y || this.font.height;\n            this.sSize.copy(this.fontSize);\n            this.height = this.sSize.y;\n\n            // #char per row\n            this.charCount = ~~(this.font.width / this.fontSize.x);\n        },\n\n        /**\n         * change the font settings\n         * @name set\n         * @memberOf me.BitmapFont\n         * @function\n         * @param {String} textAlign (\"left\", \"center\", \"right\")\n         * @param {Number} [scale]\n         */\n        set : function (textAlign, scale) {\n            this.textAlign = textAlign;\n            // updated scaled Size\n            if (scale) {\n                this.resize(scale);\n            }\n        },\n\n        /**\n         * change the font display size\n         * @name resize\n         * @memberOf me.BitmapFont\n         * @function\n         * @param {Number} scale ratio\n         */\n        resize : function (scale) {\n            // updated scaled Size\n            this.sSize.setV(this.fontSize);\n            this.sSize.x *= scale;\n            this.sSize.y *= scale;\n            this.height = this.sSize.y;\n        },\n\n        /**\n         * measure the given text size in pixels\n         * @name measureText\n         * @memberOf me.BitmapFont\n         * @function\n         * @param {me.CanvasRenderer|me.WebGLRenderer} renderer Reference to the destination renderer instance\n         * @param {String} text\n         * @return {Object} an object with two properties: `width` and `height`, defining the output dimensions\n         */\n        measureText : function (renderer, text) {\n            var strings = (\"\" + text).split(\"\\n\");\n\n            this.height = this.width = 0;\n\n            for (var i = 0; i < strings.length; i++) {\n                this.width = Math.max((strings[i].trimRight().length * this.sSize.x), this.width);\n                this.height += this.sSize.y * this.lineHeight;\n            }\n            return {width: this.width, height: this.height};\n        },\n\n        /**\n         * draw a text at the specified coord\n         * @name draw\n         * @memberOf me.BitmapFont\n         * @function\n         * @param {me.CanvasRenderer|me.WebGLRenderer} renderer Reference to the destination renderer instance\n         * @param {String} text\n         * @param {Number} x\n         * @param {Number} y\n         */\n        draw : function (renderer, text, x, y) {\n            var strings = (\"\" + text).split(\"\\n\");\n            var lX = x;\n            var height = this.sSize.y * this.lineHeight;\n\n            // save the previous global alpha value\n            var _alpha = renderer.globalAlpha();\n            renderer.setGlobalAlpha(_alpha * this.getOpacity());\n\n            // update initial position\n            this.pos.set(x, y, this.pos.z); // TODO : z ?\n            for (var i = 0; i < strings.length; i++) {\n                x = lX;\n                var string = strings[i].trimRight();\n                // adjust x pos based on alignment value\n                var width = string.length * this.sSize.x;\n                switch (this.textAlign) {\n                    case \"right\":\n                        x -= width;\n                        break;\n\n                    case \"center\":\n                        x -= width * 0.5;\n                        break;\n\n                    default :\n                        break;\n                }\n\n                // adjust y pos based on alignment value\n                switch (this.textBaseline) {\n                    case \"middle\":\n                        y -= height * 0.5;\n                        break;\n\n                    case \"ideographic\":\n                    case \"alphabetic\":\n                    case \"bottom\":\n                        y -= height;\n                        break;\n\n                    default :\n                        break;\n                }\n\n                // draw the string\n                for (var c = 0, len = string.length; c < len; c++) {\n                    // calculate the char index\n                    var idx = string.charCodeAt(c) - this.firstChar;\n                    if (idx >= 0) {\n                        // draw it\n                        renderer.drawImage(this.font,\n                            this.fontSize.x * (idx % this.charCount),\n                            this.fontSize.y * ~~(idx / this.charCount),\n                            this.fontSize.x, this.fontSize.y,\n                            ~~x, ~~y,\n                            this.sSize.x, this.sSize.y);\n                    }\n                    x += this.sSize.x;\n                }\n                // increment line\n                y += height;\n            }\n            // restore the previous global alpha value\n            renderer.setGlobalAlpha(_alpha);\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n * Audio Mngt Objects\n *\n *\n */\n(function () {\n    /**\n     * There is no constructor function for me.audio.\n     * @namespace me.audio\n     * @memberOf me\n     */\n    me.audio = (function () {\n        /*\n         * PRIVATE STUFF\n         */\n\n        // hold public stuff in our singleton\n        var api = {};\n\n        // audio channel list\n        var audioTracks = {};\n\n        // current music\n        var current_track_id = null;\n\n        // a retry counter\n        var retry_counter = 0;\n\n        /**\n         * event listener callback on load error\n         * @ignore\n         */\n        function soundLoadError(sound_name, onerror_cb) {\n            // check the retry counter\n            if (retry_counter++ > 3) {\n                // something went wrong\n                var errmsg = \"melonJS: failed loading \" + sound_name;\n                if (me.sys.stopOnAudioError === false) {\n                    // disable audio\n                    me.audio.disable();\n                    // call error callback if defined\n                    if (onerror_cb) {\n                        onerror_cb();\n                    }\n                    // warning\n                    console.log(errmsg + \", disabling audio\");\n                }\n                else {\n                    // throw an exception and stop everything !\n                    throw new api.Error(errmsg);\n                }\n            // else try loading again !\n            }\n            else {\n                audioTracks[sound_name].load();\n            }\n        }\n\n        /*\n         * PUBLIC STUFF\n         */\n\n        /**\n         * Base class for Audio exception handling.\n         * @name Error\n         * @class\n         * @memberOf me.audio\n         * @constructor\n         * @param {String} msg Error message.\n         */\n        api.Error = me.Error.extend({\n            init : function (msg) {\n                me.Error.prototype.init.apply(this, [ msg ]);\n                this.name = \"me.audio.Error\";\n            }\n        });\n\n        /**\n         * initialize the audio engine<br>\n         * the melonJS loader will try to load audio files corresponding to the\n         * browser supported audio format<br>\n         * if no compatible audio codecs are found, audio will be disabled\n         * @name init\n         * @memberOf me.audio\n         * @public\n         * @function\n         * @param {String}\n         *          audioFormat audio format provided (\"mp3, ogg, m4a, wav\")\n         * @return {Boolean} Indicates whether audio initialization was successful\n         * @example\n         * // initialize the \"sound engine\", giving \"mp3\" and \"ogg\" as desired audio format\n         * // i.e. on Safari, the loader will load all audio.mp3 files,\n         * // on Opera the loader will however load audio.ogg files\n         * if (!me.audio.init(\"mp3,ogg\")) {\n         *     alert(\"Sorry but your browser does not support html 5 audio !\");\n         *     return;\n         * }\n         */\n        api.init = function (audioFormat) {\n            if (!me.initialized) {\n                throw new api.Error(\"me.audio.init() called before engine initialization.\");\n            }\n            // if no param is given to init we use mp3 by default\n            audioFormat = typeof audioFormat === \"string\" ? audioFormat : \"mp3\";\n            // convert it into an array\n            this.audioFormats = audioFormat.split(\",\");\n\n            return !Howler.noAudio;\n        };\n\n        /**\n         * enable audio output <br>\n         * only useful if audio supported and previously disabled through\n         *\n         * @see me.audio#disable\n         * @name enable\n         * @memberOf me.audio\n         * @public\n         * @function\n         */\n        api.enable = function () {\n            this.unmuteAll();\n        };\n\n        /**\n         * disable audio output\n         *\n         * @name disable\n         * @memberOf me.audio\n         * @public\n         * @function\n         */\n        api.disable = function () {\n            this.muteAll();\n        };\n\n        /**\n         * Load an audio file.<br>\n         * <br>\n         * sound item must contain the following fields :<br>\n         * - name    : name of the sound<br>\n         * - src     : source path<br>\n         * @ignore\n         */\n        api.load = function (sound, onload_cb, onerror_cb) {\n            var urls = [];\n            if (typeof(this.audioFormats) === \"undefined\" || this.audioFormats.length === 0) {\n                throw new api.Error(\"target audio extension(s) should be set through me.audio.init() before calling the preloader.\");\n            }\n            for (var i = 0; i < this.audioFormats.length; i++) {\n                urls.push(sound.src + sound.name + \".\" + this.audioFormats[i] + me.loader.nocache);\n            }\n            audioTracks[sound.name] = new Howl({\n                src : urls,\n                volume : Howler.volume(),\n                onloaderror : function () {\n                    audioTracks[sound.name] = this;\n                    soundLoadError.call(me.audio, sound.name, onerror_cb);\n                },\n                onload : function () {\n                    audioTracks[sound.name] = this;\n                    retry_counter = 0;\n                    if (onload_cb) {\n                        onload_cb();\n                    }\n                }\n            });\n\n            return 1;\n        };\n\n        /**\n         * play the specified sound\n         * @name play\n         * @memberOf me.audio\n         * @public\n         * @function\n         * @param {String} sound_name audio clip name - case sensitive\n         * @param {Boolean} [loop=false] loop audio\n         * @param {Function} [onend] Function to call when sound instance ends playing.\n         * @param {Number} [volume=default] Float specifying volume (0.0 - 1.0 values accepted).\n         * @return {Number} the sound instance ID.\n         * @example\n         * // play the \"cling\" audio clip\n         * me.audio.play(\"cling\");\n         * // play & repeat the \"engine\" audio clip\n         * me.audio.play(\"engine\", true);\n         * // play the \"gameover_sfx\" audio clip and call myFunc when finished\n         * me.audio.play(\"gameover_sfx\", false, myFunc);\n         * // play the \"gameover_sfx\" audio clip with a lower volume level\n         * me.audio.play(\"gameover_sfx\", false, null, 0.5);\n         */\n        api.play = function (sound_name, loop, onend, volume) {\n            var sound = audioTracks[sound_name];\n            if (sound && typeof sound !== \"undefined\") {\n                var instance_id = sound.play();\n                if (typeof loop === \"boolean\") {\n                    // arg[0] can take different types in howler 2.0\n                    sound.loop(loop, instance_id);\n                }\n                sound.volume(typeof(volume) === \"number\" ? volume.clamp(0.0, 1.0) : Howler.volume(), instance_id);\n                if (typeof(onend) === \"function\") {\n                    if (loop === true) {\n                        sound.on(\"end\", onend, instance_id);\n                    }\n                    else {\n                        sound.once(\"end\", onend, instance_id);\n                    }\n                }\n                return instance_id;\n            }\n        };\n\n        /**\n         * Fade a currently playing sound between two volumee.\n         * @name fade\n         * @memberOf me.audio\n         * @public\n         * @function\n         * @param {String} sound_name audio clip name - case sensitive\n         * @param {Number} from Volume to fade from (0.0 to 1.0).\n         * @param {Number} to Volume to fade to (0.0 to 1.0).\n         * @param {Number} duration Time in milliseconds to fade.\n         * @param {Number} [id] the sound instance ID. If none is passed, all sounds in group will fade.\n         */\n        api.fade = function (sound_name, from, to, duration, instance_id) {\n            var sound = audioTracks[sound_name];\n            if (sound && typeof sound !== \"undefined\") {\n                sound.fade(from, to, duration, instance_id);\n            }\n        };\n\n        /**\n         * stop the specified sound on all channels\n         * @name stop\n         * @memberOf me.audio\n         * @public\n         * @function\n         * @param {String} sound_name audio clip name - case sensitive\n         * @param {Number} [id] the sound instance ID. If none is passed, all sounds in group will stop.\n         * @example\n         * me.audio.stop(\"cling\");\n         */\n        api.stop = function (sound_name, instance_id) {\n            var sound = audioTracks[sound_name];\n            if (sound && typeof sound !== \"undefined\") {\n                sound.stop(instance_id);\n                // remove the defined onend callback (if any defined)\n                sound.off(\"end\", instance_id);\n            }\n        };\n\n        /**\n         * pause the specified sound on all channels<br>\n         * this function does not reset the currentTime property\n         * @name pause\n         * @memberOf me.audio\n         * @public\n         * @function\n         * @param {String} sound_name audio clip name - case sensitive\n         * @param {Number} [id] the sound instance ID. If none is passed, all sounds in group will pause.\n         * @example\n         * me.audio.pause(\"cling\");\n         */\n        api.pause = function (sound_name, instance_id) {\n            var sound = audioTracks[sound_name];\n            if (sound && typeof sound !== \"undefined\") {\n                sound.pause(instance_id);\n            }\n        };\n\n        /**\n         * play the specified audio track<br>\n         * this function automatically set the loop property to true<br>\n         * and keep track of the current sound being played.\n         * @name playTrack\n         * @memberOf me.audio\n         * @public\n         * @function\n         * @param {String} sound_name audio track name - case sensitive\n         * @param {Number} [volume=default] Float specifying volume (0.0 - 1.0 values accepted).\n         * @return {Number} the sound instance ID.\n         * @example\n         * me.audio.playTrack(\"awesome_music\");\n         */\n        api.playTrack = function (sound_name, volume) {\n            current_track_id = sound_name;\n            return me.audio.play(\n                current_track_id,\n                true,\n                null,\n                volume\n            );\n        };\n\n        /**\n         * stop the current audio track\n         *\n         * @see me.audio#playTrack\n         * @name stopTrack\n         * @memberOf me.audio\n         * @public\n         * @function\n         * @example\n         * // play a awesome music\n         * me.audio.playTrack(\"awesome_music\");\n         * // stop the current music\n         * me.audio.stopTrack();\n         */\n        api.stopTrack = function () {\n            if (current_track_id !== null) {\n                audioTracks[current_track_id].stop();\n                current_track_id = null;\n            }\n        };\n\n        /**\n         * pause the current audio track\n         *\n         * @name pauseTrack\n         * @memberOf me.audio\n         * @public\n         * @function\n         * @example\n         * me.audio.pauseTrack();\n         */\n        api.pauseTrack = function () {\n            if (current_track_id !== null) {\n                audioTracks[current_track_id].pause();\n            }\n        };\n\n        /**\n         * resume the previously paused audio track\n         *\n         * @name resumeTrack\n         * @memberOf me.audio\n         * @public\n         * @function\n         * @example\n         * // play an awesome music\n         * me.audio.playTrack(\"awesome_music\");\n         * // pause the audio track\n         * me.audio.pauseTrack();\n         * // resume the music\n         * me.audio.resumeTrack();\n         */\n        api.resumeTrack = function () {\n            if (current_track_id !== null) {\n                audioTracks[current_track_id].play();\n            }\n        };\n\n        /**\n         * returns the current track Id\n         * @name getCurrentTrack\n         * @memberOf me.audio\n         * @public\n         * @function\n         * @return {String} audio track name\n         */\n        api.getCurrentTrack = function () {\n            return current_track_id;\n        };\n\n        /**\n         * set the default global volume\n         * @name setVolume\n         * @memberOf me.audio\n         * @public\n         * @function\n         * @param {Number} volume Float specifying volume (0.0 - 1.0 values accepted).\n         */\n        api.setVolume = function (volume) {\n            Howler.volume(volume);\n        };\n\n        /**\n         * get the default global volume\n         * @name getVolume\n         * @memberOf me.audio\n         * @public\n         * @function\n         * @returns {Number} current volume value in Float [0.0 - 1.0] .\n         */\n        api.getVolume = function () {\n            return Howler.volume();\n        };\n\n        /**\n         * mute the specified sound\n         * @name mute\n         * @memberOf me.audio\n         * @public\n         * @function\n         * @param {String} sound_name audio clip name - case sensitive\n         * @param {Number} [id] the sound instance ID. If none is passed, all sounds in group will mute.\n         */\n        api.mute = function (sound_name, instance_id, mute) {\n            // if not defined : true\n            mute = (typeof(mute) === \"undefined\" ? true : !!mute);\n            var sound = audioTracks[sound_name];\n            if (sound && typeof(sound) !== \"undefined\") {\n                sound.mute(mute, instance_id);\n            }\n        };\n\n        /**\n         * unmute the specified sound\n         * @name unmute\n         * @memberOf me.audio\n         * @public\n         * @function\n         * @param {String} sound_name audio clip name\n         * @param {Number} [id] the sound instance ID. If none is passed, all sounds in group will unmute.\n         */\n        api.unmute = function (sound_name, instance_id) {\n            api.mute(sound_name, instance_id, false);\n        };\n\n        /**\n         * mute all audio\n         * @name muteAll\n         * @memberOf me.audio\n         * @public\n         * @function\n         */\n        api.muteAll = function () {\n            Howler.mute(true);\n        };\n\n        /**\n         * unmute all audio\n         * @name unmuteAll\n         * @memberOf me.audio\n         * @public\n         * @function\n         */\n        api.unmuteAll = function () {\n            Howler.mute(false);\n        };\n\n        /**\n         * unload specified audio track to free memory\n         *\n         * @name unload\n         * @memberOf me.audio\n         * @public\n         * @function\n         * @param {String} sound_name audio track name - case sensitive\n         * @return {Boolean} true if unloaded\n         * @example\n         * me.audio.unload(\"awesome_music\");\n         */\n        api.unload = function (sound_name) {\n            sound_name = sound_name;\n            if (!(sound_name in audioTracks)) {\n                return false;\n            }\n\n            // destroy the Howl object\n            audioTracks[sound_name].unload();\n            if (typeof(audioTracks[sound_name].dispose) === \"function\") {\n                // cocoonJS implements a dispose function to free\n                // corresponding allocated audio in memory\n                audioTracks[sound_name].dispose();\n            }\n            delete audioTracks[sound_name];\n            return true;\n        };\n\n        /**\n         * unload all audio to free memory\n         *\n         * @name unloadAll\n         * @memberOf me.audio\n         * @public\n         * @function\n         * @example\n         * me.audio.unloadAll();\n         */\n        api.unloadAll = function () {\n            for (var sound_name in audioTracks) {\n                if (audioTracks.hasOwnProperty(sound_name)) {\n                    api.unload(sound_name);\n                }\n            }\n        };\n\n        // return our object\n        return api;\n    })();\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n    /**\n     * video functions\n     * There is no constructor function for me.video\n     * @namespace me.video\n     * @memberOf me\n     */\n    me.video = (function () {\n        // hold public stuff in our apig\n        var api = {};\n\n        // internal variables\n        var canvas = null;\n\n        var deferResizeId = 0;\n\n        var designRatio = 1;\n        var designWidth = 0;\n        var designHeight = 0;\n\n        // max display size\n        var maxWidth = Infinity;\n        var maxHeight = Infinity;\n\n        // default video settings\n        var settings = {\n            wrapper : undefined,\n            renderer : 0, // canvas\n            doubleBuffering : false,\n            autoScale : false,\n            scale : 1.0,\n            scaleMethod : \"fit\",\n            transparent : false,\n            antiAlias : false,\n        };\n\n\n        /**\n         * Auto-detect the best renderer to use\n         * @ignore\n         */\n        function autoDetectRenderer(c, width, height, options) {\n            try {\n                return new me.WebGLRenderer(c, width, height, options);\n            }\n            catch (e) {\n                return new me.CanvasRenderer(c, width, height, options);\n            }\n        }\n\n        /*\n         * PUBLIC STUFF\n         */\n\n        /**\n         * Base class for Video exception handling.\n         * @name Error\n         * @class\n         * @constructor\n         * @memberOf me.video\n         * @param {String} msg Error message.\n         */\n        api.Error = me.Error.extend({\n            init : function (msg) {\n                me.Error.prototype.init.apply(this, [ msg ]);\n                this.name = \"me.video.Error\";\n            }\n        });\n\n        /**\n         * Select the HTML5 Canvas renderer\n         * @public\n         * @name CANVAS\n         * @memberOf me.video\n         * @enum {Number}\n         */\n        api.CANVAS = 0;\n\n        /**\n         * Select the WebGL renderer\n         * @public\n         * @name WEBGL\n         * @memberOf me.video\n         * @enum {Number}\n         */\n        api.WEBGL = 1;\n\n        /**\n         * Auto-select the renderer (Attempt WebGL first, with fallback to Canvas)\n         * @public\n         * @name AUTO\n         * @memberOf me.video\n         * @enum {Number}\n         */\n        api.AUTO = 2;\n\n        /**\n         * Initialize the \"video\" system (create a canvas based on the given arguments, and the related renderer). <br>\n         * melonJS support various scaling mode : <br>\n         *  - <i>`fit`</i> : Letterboxed; content is scaled to design aspect ratio <br>\n         *  - <i>`fill-max`</i> : Canvas is resized to fit maximum design resolution; content is scaled to design aspect ratio <br>\n         *  - <i>`flex-height`</i> : Canvas height is resized to fit; content is scaled to design aspect ratio <br>\n         *  - <i>`flex-width`</i> : Canvas width is resized to fit; content is scaled to design aspect ratio <br>\n         *  - <i>`stretch`</i> : Canvas is resized to fit; content is scaled to screen aspect ratio\n         * @name init\n         * @memberOf me.video\n         * @function\n         * @param {Number} width the width of the canvas viewport\n         * @param {Number} height the height of the canvas viewport\n         * @param {Object} [options] The optional video/renderer parameters\n         * @param {String} [options.wrapper=document.body] the \"div\" element name to hold the canvas in the HTML file\n         * @param {Number} [options.renderer=me.video.CANVAS] renderer to use.\n         * @param {Boolean} [options.doubleBuffering=false] enable/disable double buffering\n         * @param {Number|String} [options.scale=1.0] enable scaling of the canvas ('auto' for automatic scaling)\n         * @param {String} [options.scaleMethod=\"fit\"] ('fit','fill-min','fill-max','flex','flex-width','flex-height','stretch') screen scaling modes\n         * @param {Boolean} [options.transparent=false] whether to allow transparent pixels in the front buffer (screen)\n         * @param {Boolean} [options.antiAlias=false] whether to enable or not video scaling interpolation\n         * @return {Boolean} false if initialization failed (canvas not supported)\n         * @example\n         * // init the video with a 640x480 canvas\n         * me.video.init(640, 480, {\n         *     wrapper : \"screen\",\n         *     renderer : me.video.CANVAS,\n         *     scale : \"auto\",\n         *     scaleMethod : \"fit\",\n         *     doubleBuffering : true\n         * });\n         */\n        api.init = function (game_width, game_height, options) {\n            // ensure melonjs has been properly initialized\n            if (!me.initialized) {\n                throw new api.Error(\"me.video.init() called before engine initialization.\");\n            }\n\n            // revert to default options if not defined\n            settings = Object.assign(settings, options || {});\n\n            // sanitize potential given parameters\n            settings.doubleBuffering = !!(settings.doubleBuffering);\n            settings.autoScale = (settings.scale === \"auto\") || false;\n            if (settings.scaleMethod.search(/^(fill-(min|max)|fit|flex(-(width|height))?|stretch)$/) !== 0) {\n                settings.scaleMethod = \"fit\";\n            }\n            settings.transparent = !!(settings.transparent);\n\n            // override renderer settings if &webgl is defined in the URL\n            if (me.game.HASH.webgl === true) {\n                settings.renderer = api.WEBGL;\n            }\n\n            // normalize scale\n            settings.scale = (settings.autoScale) ? 1.0 : (+settings.scale || 1.0);\n            me.sys.scale = new me.Vector2d(settings.scale, settings.scale);\n\n            // force double buffering if scaling is required\n            if (settings.autoScale || (settings.scale !== 1.0)) {\n                settings.doubleBuffering = true;\n            }\n\n            // hold the requested video size ratio\n            designRatio = game_width / game_height;\n            designWidth = game_width;\n            designHeight = game_height;\n\n            // default scaled size value\n            var game_width_zoom = game_width * me.sys.scale.x;\n            var game_height_zoom = game_height * me.sys.scale.y;\n            settings.zoomX = game_width_zoom;\n            settings.zoomY = game_height_zoom;\n\n            //add a channel for the onresize/onorientationchange event\n            window.addEventListener(\n                \"resize\",\n                throttle(\n                    100,\n                    false,\n                    function (event) {\n                        me.event.publish(me.event.WINDOW_ONRESIZE, [ event ]);\n                    }\n                ),\n                false\n            );\n            window.addEventListener(\n                \"orientationchange\",\n                function (event) {\n                    me.event.publish(me.event.WINDOW_ONORIENTATION_CHANGE, [ event ]);\n                },\n                false\n            );\n\n            // register to the channel\n            me.event.subscribe(\n                me.event.WINDOW_ONRESIZE,\n                me.video.onresize.bind(me.video)\n            );\n            me.event.subscribe(\n                me.event.WINDOW_ONORIENTATION_CHANGE,\n                me.video.onresize.bind(me.video)\n            );\n\n            // create the main screen canvas\n            canvas = api.createCanvas(game_width_zoom, game_height_zoom, true);\n\n            // add our canvas\n            if (options.wrapper) {\n                settings.wrapper = document.getElementById(options.wrapper);\n            }\n            // if wrapperid is not defined (null)\n            if (!settings.wrapper) {\n                // add the canvas to document.body\n                settings.wrapper = document.body;\n            }\n            settings.wrapper.appendChild(canvas);\n\n            // stop here if not supported\n            if (!canvas.getContext) {\n                return false;\n            }\n\n            /**\n             * A reference to the current video renderer\n             * @public\n             * @memberOf me.video\n             * @name renderer\n             * @type {me.Renderer|me.CanvasRenderer|me.WebGLRenderer}\n             */\n            switch (settings.renderer) {\n                case api.WEBGL:\n                    this.renderer = new me.WebGLRenderer(canvas, game_width, game_height, settings);\n                    break;\n                case api.AUTO:\n                    this.renderer = autoDetectRenderer(canvas, game_width, game_height, settings);\n                    break;\n                default:\n                    this.renderer = new me.CanvasRenderer(canvas, game_width, game_height, settings);\n                    break;\n            }\n\n            // adjust CSS style for High-DPI devices\n            var ratio = me.device.getPixelRatio();\n            if (ratio > 1) {\n                canvas.style.width = (canvas.width / ratio) + \"px\";\n                canvas.style.height = (canvas.height / ratio) + \"px\";\n            }\n\n\n            // set max the canvas max size if CSS values are defined\n            if (window.getComputedStyle) {\n                var style = window.getComputedStyle(canvas, null);\n                me.video.setMaxSize(parseInt(style.maxWidth, 10), parseInt(style.maxHeight, 10));\n            }\n\n            me.game.init();\n\n            // trigger an initial resize();\n            me.video.onresize();\n\n            return true;\n        };\n\n        /**\n         * return the relative (to the page) position of the specified Canvas\n         * @name getPos\n         * @memberOf me.video\n         * @function\n         * @param {Canvas} [canvas] system one if none specified\n         * @return {me.Vector2d}\n         */\n        api.getPos = function (c) {\n            c = c || this.renderer.getScreenCanvas();\n            return (\n                c.getBoundingClientRect ?\n                c.getBoundingClientRect() : { left : 0, top : 0 }\n            );\n        };\n\n        /**\n         * set the max canvas display size (when scaling)\n         * @name setMaxSize\n         * @memberOf me.video\n         * @function\n         * @param {Number} width width\n         * @param {Number} height height\n         */\n        api.setMaxSize = function (w, h) {\n            // max display size\n            maxWidth = w || Infinity;\n            maxHeight = h || Infinity;\n            // trigger a resize\n            // defer it to ensure everything is properly intialized\n            this.onresize.defer(this);\n\n        };\n\n        /**\n         * Create and return a new Canvas\n         * @name createCanvas\n         * @memberOf me.video\n         * @function\n         * @param {Number} width width\n         * @param {Number} height height\n         * @param {Boolean} [screencanvas=false] set to true if this canvas renders directly to the screen\n         * @return {Canvas}\n         */\n        api.createCanvas = function (width, height, screencanvas) {\n            if (width === 0 || height === 0)  {\n                throw new api.Error(\"width or height was zero, Canvas could not be initialized !\");\n            }\n\n            var _canvas = document.createElement(\"canvas\");\n\n            if ((screencanvas === true) && (navigator.isCocoonJS) && (me.device.android2 !== true)) {\n                // enable ScreenCanvas on cocoonJS\n                _canvas.screencanvas = true;\n            }\n\n            _canvas.width = width || canvas.width;\n            _canvas.height = height || canvas.height;\n\n            return _canvas;\n        };\n\n        /**\n         * return a reference to the wrapper\n         * @name getWrapper\n         * @memberOf me.video\n         * @function\n         * @return {Document}\n         */\n        api.getWrapper = function () {\n            return settings.wrapper;\n        };\n\n        /**\n         * callback for window resize event\n         * @ignore\n         */\n        api.onresize = function () {\n            // default (no scaling)\n            var scaleX = 1, scaleY = 1;\n\n            // check for orientation information\n            if (typeof window.orientation !== \"undefined\") {\n                me.device.orientation = window.orientation;\n            }\n            else {\n                // is this actually not the best option since default \"portrait\"\n                // orientation might vary between for example an ipad and and android tab\n                me.device.orientation = (\n                    window.outerWidth > window.outerHeight ?\n                    90 : 0\n                );\n            }\n\n            if (settings.autoScale) {\n                var parent = me.video.renderer.getScreenCanvas().parentNode;\n                var _max_width = Math.min(maxWidth, parent.width || window.innerWidth);\n                var _max_height = Math.min(maxHeight, parent.height || window.innerHeight);\n                var screenRatio = _max_width / _max_height;\n                var sWidth = Infinity;\n                var sHeight = Infinity;\n\n                if (\n                    (settings.scaleMethod === \"fill-min\" && screenRatio > designRatio) ||\n                    (settings.scaleMethod === \"fill-max\" && screenRatio < designRatio) ||\n                    (settings.scaleMethod === \"flex-width\")\n                ) {\n                    // resize the display canvas to fill the parent container\n                    sWidth = Math.min(maxWidth, designHeight * screenRatio);\n                    scaleX = scaleY = _max_width / sWidth;\n                    sWidth = ~~(sWidth + 0.5);\n                    this.renderer.resize(sWidth, designHeight);\n                    me.game.viewport.resize(sWidth, designHeight);\n                    /*\n                     * XXX: Workaround for not updating container child-bounds\n                     * automatically (it's expensive!)\n                     */\n                    me.game.world.updateChildBounds();\n                }\n                else if (\n                    (settings.scaleMethod === \"fill-min\" && screenRatio < designRatio) ||\n                    (settings.scaleMethod === \"fill-max\" && screenRatio > designRatio) ||\n                    (settings.scaleMethod === \"flex-height\")\n                ) {\n                    // resize the display canvas to fill the parent container\n                    sHeight = Math.min(maxHeight, designWidth * (_max_height / _max_width));\n                    scaleX = scaleY = _max_height / sHeight;\n                    sHeight = ~~(sHeight + 0.5);\n                    this.renderer.resize(designWidth, sHeight);\n                    me.game.viewport.resize(designWidth, sHeight);\n                    /*\n                     * XXX: Workaround for not updating container child-bounds\n                     * automatically (it's expensive!)\n                     */\n                    me.game.world.updateChildBounds();\n                }\n                else if (settings.scaleMethod === \"flex\") {\n                    // resize the display canvas to fill the parent container\n                    this.renderer.resize(_max_width, _max_height);\n                    me.game.viewport.resize(_max_width, _max_height);\n                    /*\n                     * XXX: Workaround for not updating container child-bounds\n                     * automatically (it's expensive!)\n                     */\n                    me.game.world.updateChildBounds();\n                }\n                else if (settings.scaleMethod === \"stretch\") {\n                    // scale the display canvas to fit with the parent container\n                    scaleX = _max_width / designWidth;\n                    scaleY = _max_height / designHeight;\n                }\n                else {\n                    // scale the display canvas to fit the parent container\n                    // make sure we maintain the original aspect ratio\n                    if (screenRatio < designRatio) {\n                        scaleX = scaleY = _max_width / designWidth;\n                    }\n                    else {\n                        scaleX = scaleY = _max_height / designHeight;\n                    }\n                }\n\n                // adjust scaling ratio based on the device pixel ratio\n                scaleX *= me.device.getPixelRatio();\n                scaleY *= me.device.getPixelRatio();\n\n                if (deferResizeId) {\n                    // cancel any previous pending resize\n                    clearTimeout(deferResizeId);\n                }\n                deferResizeId = me.video.updateDisplaySize.defer(this, scaleX, scaleY);\n            }\n        };\n\n        /**\n         * Modify the \"displayed\" canvas size\n         * @name updateDisplaySize\n         * @memberOf me.video\n         * @function\n         * @param {Number} scaleX X scaling multiplier\n         * @param {Number} scaleY Y scaling multiplier\n         */\n        api.updateDisplaySize = function (scaleX, scaleY) {\n            // update the global scale variable\n            me.sys.scale.set(scaleX, scaleY);\n\n            // renderer resize logic\n            this.renderer.scaleCanvas(scaleX, scaleY);\n            me.game.repaint();\n\n            // make sure we have the correct relative canvas position cached\n            me.input._offset = me.video.getPos();\n\n            // clear the timeout id\n            deferResizeId = 0;\n        };\n\n        // return our api\n        return api;\n    })();\n\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n\n(function () {\n\n    /**\n     * a base renderer object\n     * @class\n     * @extends Object\n     * @memberOf me\n     * @constructor\n     * @param {Canvas} canvas The html canvas tag to draw to on screen.\n     * @param {Number} width The width of the canvas without scaling\n     * @param {Number} height The height of the canvas without scaling\n     * @param {Object} [options] The renderer parameters\n     * @param {Boolean} [options.doubleBuffering=false] Whether to enable double buffering\n     * @param {Boolean} [options.antiAlias=false] Whether to enable anti-aliasing\n     * @param {Boolean} [options.transparent=false] Whether to enable transparency on the canvas (performance hit when enabled)\n     * @param {Number} [options.zoomX=width] The actual width of the canvas with scaling applied\n     * @param {Number} [options.zoomY=height] The actual height of the canvas with scaling applied\n     */\n    me.Renderer = me.Object.extend(\n    /** @scope me.Renderer.prototype */\n    {\n        /**\n         * @ignore\n         */\n        init : function (c, width, height, options) {\n            options = options || {};\n\n            // rendering options\n            this.transparent = !!(options.transparent);\n            this.doubleBuffering = !!(options.doubleBuffering);\n            this.antiAlias = !!(options.antiAlias);\n\n            this.gameWidthZoom = options.zoomX || width;\n            this.gameHeightZoom = options.zoomY || height;\n\n            // canvas object and context\n            this.canvas = this.backBufferCanvas = c;\n            this.context = null;\n\n            // global color\n            this.globalColor = new me.Color(255, 255, 255, 1.0);\n\n            return this;\n        },\n\n        /**\n         * @ignore\n         */\n        applyRGBFilter : function (object, effect, option) {\n            //create a output canvas using the given canvas or image size\n            var _context = this.getContext2d(me.video.createCanvas(object.width, object.height, false));\n            // get the pixels array of the give parameter\n            var imgpix = me.utils.getPixels(object);\n            // pointer to the pixels data\n            var pix = imgpix.data;\n\n            // apply selected effect\n            var i, n;\n            switch (effect) {\n                case \"b&w\":\n                    for (i = 0, n = pix.length; i < n; i += 4) {\n                        var grayscale = (3 * pix[i] + 4 * pix[i + 1] + pix[i + 2]) >>> 3;\n                        pix[i] = grayscale; // red\n                        pix[i + 1] = grayscale; // green\n                        pix[i + 2] = grayscale; // blue\n                    }\n                    break;\n\n                case \"brightness\":\n                    // make sure it's between 0.0 and 1.0\n                    var brightness = Math.abs(option).clamp(0.0, 1.0);\n                    for (i = 0, n = pix.length; i < n; i += 4) {\n\n                        pix[i] *= brightness; // red\n                        pix[i + 1] *= brightness; // green\n                        pix[i + 2] *= brightness; // blue\n                    }\n                    break;\n\n                case \"transparent\":\n                    var refColor = me.pool.pull(\"me.Color\").parseCSS(option);\n                    var pixel = me.pool.pull(\"me.Color\");\n                    for (i = 0, n = pix.length; i < n; i += 4) {\n                        pixel.setColor(pix[i], pix[i + 1], pix[i + 2]);\n                        if (pixel.equals(refColor)) {\n                            pix[i + 3] = 0;\n                        }\n                    }\n                    me.pool.push(refColor);\n                    me.pool.push(pixel);\n\n                    break;\n\n\n                default:\n                    return null;\n            }\n\n            // put our modified image back in the new filtered canvas\n            _context.putImageData(imgpix, 0, 0);\n\n            // return it\n            return _context;\n        },\n\n        /**\n         * @ignore\n         */\n        prepareSurface : function () {},\n\n        /**\n         * @ignore\n         */\n        reset : function () {\n            this.resetTransform();\n            this.cache.reset();\n        },\n\n        /**\n         * return a reference to the system canvas\n         * @name getCanvas\n         * @memberOf me.Renderer\n         * @function\n         * @return {Canvas}\n         */\n        getCanvas : function () {\n            return this.backBufferCanvas;\n        },\n\n        /**\n         * return a reference to the screen canvas\n         * @name getScreenCanvas\n         * @memberOf me.Renderer\n         * @function\n         * @return {Canvas}\n         */\n        getScreenCanvas : function () {\n            return this.canvas;\n        },\n\n        /**\n         * return a reference to the screen canvas corresponding 2d Context<br>\n         * (will return buffered context if double buffering is enabled, or a reference to the Screen Context)\n         * @name getScreenContext\n         * @memberOf me.Renderer\n         * @function\n         * @return {Context2d}\n         */\n        getScreenContext : function () {\n            return this.context;\n        },\n\n        /**\n         * Returns the 2D Context object of the given Canvas<br>\n         * Also configures anti-aliasing based on constructor options.\n         * @name getContext2d\n         * @memberOf me.Renderer\n         * @function\n         * @param {Canvas} canvas\n         * @param {Boolean} [opaque=false] True to disable transparency\n         * @return {Context2d}\n         */\n        getContext2d : function (c, opaque) {\n            if (typeof c === \"undefined\" || c === null) {\n                throw new me.video.Error(\n                    \"You must pass a canvas element in order to create \" +\n                    \"a 2d context\"\n                );\n            }\n\n            if (typeof c.getContext === \"undefined\") {\n                throw new me.video.Error(\n                    \"Your browser does not support HTML5 canvas.\"\n                );\n            }\n\n            var _context;\n            if (navigator.isCocoonJS) {\n                // cocoonJS specific extension\n                _context = c.getContext(\"2d\", {\n                    \"antialias\" : this.antiAlias,\n                    \"alpha\" : !opaque\n                });\n            }\n            else {\n                _context = c.getContext(\"2d\", {\n                    \"alpha\" : !opaque\n                });\n            }\n            if (!_context.canvas) {\n                _context.canvas = c;\n            }\n            this.setAntiAlias(_context, this.antiAlias);\n            return _context;\n        },\n\n        /**\n         * return the width of the system Canvas\n         * @name getWidth\n         * @memberOf me.Renderer\n         * @function\n         * @return {Number}\n         */\n        getWidth : function () {\n            return this.backBufferCanvas.width;\n        },\n\n        /**\n         * return the height of the system Canvas\n         * @name getHeight\n         * @memberOf me.Renderer\n         * @function\n         * @return {Number}\n         */\n        getHeight : function () {\n            return this.backBufferCanvas.height;\n        },\n\n        /**\n         * return the current global alpha\n         * @name globalAlpha\n         * @memberOf me.Renderer\n         * @function\n         * @return {Number}\n         */\n        globalAlpha : function () {\n            return this.globalColor.glArray[3];\n        },\n\n        /**\n         * resizes the canvas\n         * @name resize\n         * @memberOf me.Renderer\n         * @function\n         */\n        resize : function (width, height)\n        {\n            this.backBufferCanvas.width = width;\n            this.backBufferCanvas.height = height;\n        },\n\n        /**\n         * enable/disable image smoothing (scaling interpolation) for the specified 2d Context<br>\n         * (!) this might not be supported by all browsers <br>\n         * @name setImageSmoothing\n         * @memberOf me.Renderer\n         * @function\n         * @param {Context2d} context\n         * @param {Boolean} [enable=false]\n         */\n        setAntiAlias : function (context, enable) {\n            if (typeof(context) !== \"undefined\") {\n                // enable/disable antialis on the given context\n                me.agent.setPrefixed(\"imageSmoothingEnabled\", enable === true, context);\n            }\n\n            // disable antialias CSS scaling on the main canvas\n            var cssStyle = context.canvas.style[\"image-rendering\"];\n            if (enable === false && (cssStyle === \"\" || cssStyle === \"auto\")) {\n                // if a specific value is set through CSS or equal to the standard \"auto\" one\n                context.canvas.style[\"image-rendering\"] = \"pixelated\";\n            } else if (enable === true && cssStyle === \"pixelated\") {\n                // if set to the standard \"pixelated\"\n                context.canvas.style[\"image-rendering\"] = \"auto\";\n            }\n        },\n\n        /**\n         * @ignore\n         */\n        drawFont : function (/*bounds*/) {},\n\n    });\n\n})();\n\n/*\n* MelonJS Game Engine\n* Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n* http://www.melonjs.org\n*\n*/\n(function () {\n\n    /**\n     * a basic texture cache object\n     * @ignore\n     */\n    me.Renderer.TextureCache = me.Object.extend({\n        /**\n         * @ignore\n         */\n        init : function (max_size) {\n            this.max_size = max_size || Infinity;\n            this.reset();\n        },\n\n        /**\n         * @ignore\n         */\n        reset : function () {\n            this.cache = new Map();\n            this.units = new Map();\n            this.length = 0;\n        },\n\n        /**\n         * @ignore\n         */\n        validate : function () {\n            if (this.length >= this.max_size) {\n                // TODO: Merge textures instead of throwing an exception\n                throw new me.video.Error(\n                    \"Texture cache overflow: \" + this.max_size +\n                    \" texture units available.\"\n                );\n            }\n        },\n\n        /**\n         * @ignore\n         */\n        get : function (image, atlas) {\n            if (!this.cache.has(image)) {\n                this.validate();\n\n                if (!atlas) {\n                    var w = image.width;\n                    var h = image.height;\n                    atlas = {\n                        // FIXME: Create a texture atlas helper function\n                        \"meta\" : {\n                            \"app\" : \"melonJS\",\n                            \"size\" : { \"w\" : w, \"h\" : h }\n                        },\n                        \"frames\" : [{\n                            \"filename\" : \"default\",\n                            \"frame\" : { \"x\" : 0, \"y\" : 0, \"w\" : w, \"h\" : h }\n                        }]\n                    };\n                }\n\n                var texture = new me.video.renderer.Texture(atlas, image, true);\n                this.cache.set(image, texture);\n                this.units.set(texture, this.length++);\n            }\n            return this.cache.get(image);\n        },\n\n        /**\n         * @ignore\n         */\n        put : function (image, texture) {\n            this.validate();\n            this.cache.set(image, texture);\n            this.units.set(texture, this.length++);\n        },\n\n        /**\n         * @ignore\n         */\n        getUnit : function (texture) {\n            return this.units.get(texture);\n        }\n    });\n\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015 Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n\n(function () {\n\n    /**\n     * a canvas renderer object\n     * @class\n     * @extends me.Renderer\n     * @memberOf me\n     * @constructor\n     * @param {Canvas} canvas The html canvas tag to draw to on screen.\n     * @param {Number} width The width of the canvas without scaling\n     * @param {Number} height The height of the canvas without scaling\n     * @param {Object} [options] The renderer parameters\n     * @param {Boolean} [options.doubleBuffering=false] Whether to enable double buffering\n     * @param {Boolean} [options.antiAlias=false] Whether to enable anti-aliasing\n     * @param {Boolean} [options.transparent=false] Whether to enable transparency on the canvas (performance hit when enabled)\n     * @param {Number} [options.zoomX=width] The actual width of the canvas with scaling applied\n     * @param {Number} [options.zoomY=height] The actual height of the canvas with scaling applied\n     */\n    me.CanvasRenderer = me.Renderer.extend(\n    /** @scope me.CanvasRenderer.prototype */\n    {\n        /**\n         * @ignore\n         */\n        init : function (c, width, height, options) {\n            // parent constructor\n            me.Renderer.prototype.init.apply(this, [c, width, height, options]);\n\n            // defined the 2d context\n            this.context = this.getContext2d(this.canvas, !this.transparent);\n\n            // create the back buffer if we use double buffering\n            if (this.doubleBuffering) {\n                this.backBufferCanvas = me.video.createCanvas(width, height, false);\n                this.backBufferContext2D = this.getContext2d(this.backBufferCanvas);\n\n                if (this.transparent) {\n                    // Clears the front buffer for each frame blit\n                    this.context.globalCompositeOperation = \"copy\";\n                }\n            }\n            else {\n                this.backBufferCanvas = this.canvas;\n                this.backBufferContext2D = this.context;\n            }\n\n            this.fontContext2D = this.backBufferContext2D;\n\n            // apply the default color to the 2d context\n            this.setColor(this.globalColor);\n\n            // create a texture cache\n            this.cache = new me.Renderer.TextureCache();\n\n            return this;\n        },\n\n        /**\n         * prepare the framebuffer for drawing a new frame\n         * @name prepareSurface\n         * @memberOf me.CanvasRenderer\n         * @function\n         */\n        prepareSurface : function () {\n            if (this.transparent) {\n                this.clearSurface(null, \"rgba(0,0,0,0)\", true);\n            }\n        },\n\n        /**\n         * render the main framebuffer on screen\n         * @name blitSurface\n         * @memberOf me.CanvasRenderer\n         * @function\n         */\n        blitSurface : function () {\n            if (this.doubleBuffering) {\n                this.context.drawImage(\n                    this.backBufferCanvas, 0, 0,\n                    this.backBufferCanvas.width, this.backBufferCanvas.height,\n                    0, 0,\n                    this.gameWidthZoom, this.gameHeightZoom\n                );\n            }\n        },\n\n        /**\n         * Clear the specified context with the given color\n         * @name clearSurface\n         * @memberOf me.CanvasRenderer\n         * @function\n         * @param {Context2d} [ctx=null] Canvas context, defaults to system context if falsy.\n         * @param {me.Color|String} color CSS color.\n         * @param {Boolean} [opaque=false] Allow transparency [default] or clear the surface completely [true]\n         */\n        clearSurface : function (ctx, col, opaque) {\n            if (!ctx) {\n                ctx = this.backBufferContext2D;\n            }\n            var _canvas = ctx.canvas;\n            ctx.save();\n            ctx.setTransform(1, 0, 0, 1, 0, 0);\n            ctx.globalCompositeOperation = opaque ? \"copy\" : \"source-over\";\n            ctx.fillStyle = (col instanceof me.Color) ? col.toRGBA() : col;\n            ctx.fillRect(0, 0, _canvas.width, _canvas.height);\n            ctx.restore();\n        },\n\n        /**\n         * Create a pattern with the specified repition\n         * @name createPattern\n         * @memberOf me.CanvasRenderer\n         * @function\n         * @param {image} image Source image\n         * @param {String} repeat Define how the pattern should be repeated\n         * @return {CanvasPattern}\n         * @see me.ImageLayer#repeat\n         * @example\n         * var tileable   = renderer.createPattern(image, \"repeat\");\n         * var horizontal = renderer.createPattern(image, \"repeat-x\");\n         * var vertical   = renderer.createPattern(image, \"repeat-y\");\n         * var basic      = renderer.createPattern(image, \"no-repeat\");\n         */\n        createPattern : function (image, repeat) {\n            return this.backBufferContext2D.createPattern(image, repeat);\n        },\n\n        /**\n         * Draw an image using the canvas api\n         * @name drawImage\n         * @memberOf me.CanvasRenderer\n         * @function\n         * @param {image} image Source image\n         * @param {Number} sx Source x-coordinate\n         * @param {Number} sy Source y-coordinate\n         * @param {Number} sw Source width\n         * @param {Number} sh Source height\n         * @param {Number} dx Destination x-coordinate\n         * @param {Number} dy Destination y-coordinate\n         * @param {Number} dw Destination width\n         * @param {Number} dh Destination height\n         * @example\n         * // Can be used in three ways:\n         * renderer.drawImage(image, dx, dy);\n         * renderer.drawImage(image, dx, dy, dw, dh);\n         * renderer.drawImage(image, sx, sy, sw, sh, dx, dy, dw, dh);\n         * // dx, dy, dw, dh being the destination target & dimensions. sx, sy, sw, sh being the position & dimensions to take from the image\n         */\n        drawImage : function () {\n            if (this.backBufferContext2D.globalAlpha < 1 / 255) {\n                // Fast path: don't draw fully transparent\n                return;\n            }\n            this.backBufferContext2D.drawImage.apply(this.backBufferContext2D, arguments);\n        },\n\n        /**\n         * Draw a pattern within the given rectangle.\n         * @name drawPattern\n         * @memberOf me.CanvasRenderer\n         * @function\n         * @param {CanvasPattern} pattern Pattern object\n         * @param {Number} x\n         * @param {Number} y\n         * @param {Number} width\n         * @param {Number} height\n         * @see me.CanvasRenderer#createPattern\n         */\n        drawPattern : function (pattern, x, y, width, height) {\n            if (this.backBufferContext2D.globalAlpha < 1 / 255) {\n                // Fast path: don't draw fully transparent\n                return;\n            }\n            var fillStyle = this.backBufferContext2D.fillStyle;\n            this.backBufferContext2D.fillStyle = pattern;\n            this.backBufferContext2D.fillRect(x, y, width, height);\n            this.backBufferContext2D.fillStyle = fillStyle;\n        },\n\n        /**\n         * Fill an arc at the specified coordinates with given radius, start and end points\n         * @name fillArc\n         * @memberOf me.CanvasRenderer\n         * @function\n         * @param {Number} x arc center point x-axis\n         * @param {Number} y arc center point y-axis\n         * @param {Number} radius\n         * @param {Number} start start angle in radians\n         * @param {Number} end end angle in radians\n         * @param {Boolean} [antiClockwise=false] draw arc anti-clockwise\n         */\n        fillArc : function (x, y, radius, start, end, antiClockwise) {\n            if (this.backBufferContext2D.globalAlpha < 1 / 255) {\n                // Fast path: don't draw fully transparent\n                return;\n            }\n            this.backBufferContext2D.save();\n            this.backBufferContext2D.beginPath();\n            this.backBufferContext2D.translate(x + radius, y + radius);\n            this.backBufferContext2D.arc(0, 0, radius, start, end, antiClockwise || false);\n            this.backBufferContext2D.fill();\n            this.backBufferContext2D.closePath();\n            this.backBufferContext2D.restore();\n        },\n\n        /**\n         * Draw a filled rectangle at the specified coordinates\n         * @name fillRect\n         * @memberOf me.CanvasRenderer\n         * @function\n         * @param {Number} x\n         * @param {Number} y\n         * @param {Number} width\n         * @param {Number} height\n         */\n        fillRect : function (x, y, width, height) {\n            if (this.backBufferContext2D.globalAlpha < 1 / 255) {\n                // Fast path: don't draw fully transparent\n                return;\n            }\n            this.backBufferContext2D.fillRect(x, y, width, height);\n        },\n\n        /**\n         * return a reference to the system 2d Context\n         * @name getContext\n         * @memberOf me.CanvasRenderer\n         * @function\n         * @return {Context2d}\n         */\n        getContext : function () {\n            return this.backBufferContext2D;\n        },\n\n        /**\n         * resets the canvas transform to identity\n         * @name resetTransform\n         * @memberOf me.CanvasRenderer\n         * @function\n         */\n        resetTransform : function () {\n            this.backBufferContext2D.setTransform(1, 0, 0, 1, 0, 0);\n        },\n\n        /**\n         * scales the canvas & 2d Context\n         * @name scaleCanvas\n         * @memberOf me.CanvasRenderer\n         * @function\n         */\n        scaleCanvas : function (scaleX, scaleY) {\n            this.canvas.width = this.gameWidthZoom = this.backBufferCanvas.width * scaleX;\n            this.canvas.height = this.gameHeightZoom = this.backBufferCanvas.height * scaleY;\n\n            // adjust CSS style for High-DPI devices\n            if (me.device.getPixelRatio() > 1) {\n                this.canvas.style.width = (this.canvas.width / me.device.getPixelRatio()) + \"px\";\n                this.canvas.style.height = (this.canvas.height / me.device.getPixelRatio()) + \"px\";\n            }\n\n            if (this.doubleBuffering && this.transparent) {\n                // Clears the front buffer for each frame blit\n                this.context.globalCompositeOperation = \"copy\";\n            }\n            this.setAntiAlias(this.context, this.antiAlias);\n            this.blitSurface();\n        },\n\n        /**\n         * save the canvas context\n         * @name save\n         * @memberOf me.CanvasRenderer\n         * @function\n         */\n        save : function () {\n            this.backBufferContext2D.save();\n        },\n\n        /**\n         * restores the canvas context\n         * @name restore\n         * @memberOf me.CanvasRenderer\n         * @function\n         */\n        restore : function () {\n            this.backBufferContext2D.restore();\n            this.globalColor.glArray[3] = this.backBufferContext2D.globalAlpha;\n        },\n\n        /**\n         * rotates the canvas context\n         * @name rotate\n         * @memberOf me.CanvasRenderer\n         * @function\n         * @param {Number} angle in radians\n         */\n        rotate : function (angle) {\n            this.backBufferContext2D.rotate(angle);\n        },\n\n        /**\n         * scales the canvas context\n         * @name scale\n         * @memberOf me.CanvasRenderer\n         * @function\n         * @param {Number} x\n         * @param {Number} y\n         */\n        scale : function (x, y) {\n            this.backBufferContext2D.scale(x, y);\n        },\n\n        /**\n         * Sets the fill & stroke style colors for the context.\n         * @name setColor\n         * @memberOf me.CanvasRenderer\n         * @function\n         * @param {me.Color|String} color css color value\n         */\n        setColor : function (color) {\n            this.backBufferContext2D.strokeStyle =\n            this.backBufferContext2D.fillStyle = (\n                color instanceof me.Color ?\n                color.toRGBA() :\n                color\n            );\n        },\n\n        /**\n         * Sets the global alpha on the canvas context\n         * @name setGlobalAlpha\n         * @memberOf me.CanvasRenderer\n         * @function\n         * @param {Number} alpha 0.0 to 1.0 values accepted.\n         */\n        setGlobalAlpha : function (a) {\n            this.backBufferContext2D.globalAlpha = this.globalColor.glArray[3] = a;\n        },\n\n        /**\n         * sets the line width on the context\n         * @name setLineWidth\n         * @memberOf me.CanvasRenderer\n         * @function\n         * @param {Number} width Line width\n         */\n        setLineWidth : function (width) {\n            this.backBufferContext2D.lineWidth = width;\n        },\n\n        /**\n         * Stroke an arc at the specified coordinates with given radius, start and end points\n         * @name strokeArc\n         * @memberOf me.CanvasRenderer\n         * @function\n         * @param {Number} x arc center point x-axis\n         * @param {Number} y arc center point y-axis\n         * @param {Number} radius\n         * @param {Number} start start angle in radians\n         * @param {Number} end end angle in radians\n         * @param {Boolean} [antiClockwise=false] draw arc anti-clockwise\n         */\n        strokeArc : function (x, y, radius, start, end, antiClockwise) {\n            if (this.backBufferContext2D.globalAlpha < 1 / 255) {\n                // Fast path: don't draw fully transparent\n                return;\n            }\n            this.save();\n            this.backBufferContext2D.beginPath();\n            this.backBufferContext2D.translate(x + radius, y + radius);\n            this.backBufferContext2D.arc(0, 0, radius, start, end, antiClockwise || false);\n            this.backBufferContext2D.stroke();\n            this.backBufferContext2D.closePath();\n            this.restore();\n        },\n\n        /**\n         * Stroke an ellipse at the specified coordinates with given radius, start and end points\n         * @name strokeEllipse\n         * @memberOf me.CanvasRenderer\n         * @function\n         * @param {Number} x arc center point x-axis\n         * @param {Number} y arc center point y-axis\n         * @param {Number} w horizontal radius of the ellipse\n         * @param {Number} h vertical radius of the ellipse\n         */\n        strokeEllipse : function (x, y, w, h) {\n            if (this.backBufferContext2D.globalAlpha < 1 / 255) {\n                // Fast path: don't draw fully transparent\n                return;\n            }\n            this.save();\n            this.context.beginPath();\n            var hw = w,\n                hh = h,\n                lx = x - hw,\n                rx = x + hw,\n                ty = y - hh,\n                by = y + hh;\n\n            var xmagic = hw * 0.551784,\n                ymagic = hh * 0.551784,\n                xmin = x - xmagic,\n                xmax = x + xmagic,\n                ymin = y - ymagic,\n                ymax = y + ymagic;\n\n            this.backBufferContext2D.moveTo(x, ty);\n            this.backBufferContext2D.bezierCurveTo(xmax, ty, rx, ymin, rx, y);\n            this.backBufferContext2D.bezierCurveTo(rx, ymax, xmax, by, x, by);\n            this.backBufferContext2D.bezierCurveTo(xmin, by, lx, ymax, lx, y);\n            this.backBufferContext2D.bezierCurveTo(lx, ymin, xmin, ty, x, ty);\n            this.backBufferContext2D.stroke();\n            this.restore();\n        },\n\n        /**\n         * Stroke a line of the given two points\n         * @name strokeLine\n         * @memberOf me.CanvasRenderer\n         * @function\n         * @param {Number} startX the start x coordinate\n         * @param {Number} startY the start y coordinate\n         * @param {Number} endX the end x coordinate\n         * @param {Number} endY the end y coordinate\n         */\n        strokeLine : function (startX, startY, endX, endY) {\n            if (this.backBufferContext2D.globalAlpha < 1 / 255) {\n                // Fast path: don't draw fully transparent\n                return;\n            }\n            this.save();\n            this.backBufferContext2D.beginPath();\n            this.backBufferContext2D.moveTo(startX, startY);\n            this.backBufferContext2D.lineTo(endX, endY);\n            this.backBufferContext2D.stroke();\n            this.restore();\n        },\n\n        /**\n         * Strokes a me.Polygon on the screen with a specified color\n         * @name strokePolygon\n         * @memberOf me.CanvasRenderer\n         * @function\n         * @param {me.Polygon} poly the shape to draw\n         */\n        strokePolygon : function (poly) {\n            if (this.backBufferContext2D.globalAlpha < 1 / 255) {\n                // Fast path: don't draw fully transparent\n                return;\n            }\n            this.save();\n            this.backBufferContext2D.translate(poly.pos.x, poly.pos.y);\n            this.backBufferContext2D.beginPath();\n            this.backBufferContext2D.moveTo(poly.points[0].x, poly.points[0].y);\n            var point;\n            for (var i = 1; i < poly.points.length; i++) {\n                point = poly.points[i];\n                this.backBufferContext2D.lineTo(point.x, point.y);\n            }\n            this.backBufferContext2D.lineTo(poly.points[0].x, poly.points[0].y);\n            this.backBufferContext2D.stroke();\n            this.backBufferContext2D.closePath();\n            this.backBufferContext2D.translate(-poly.pos.x, -poly.pos.y);\n            this.restore();\n        },\n\n        /**\n         * Stroke a rectangle at the specified coordinates with a given color\n         * @name strokeRect\n         * @memberOf me.CanvasRenderer\n         * @function\n         * @param {Number} x\n         * @param {Number} y\n         * @param {Number} width\n         * @param {Number} height\n         */\n        strokeRect : function (x, y, width, height) {\n            if (this.backBufferContext2D.globalAlpha < 1 / 255) {\n                // Fast path: don't draw fully transparent\n                return;\n            }\n            this.backBufferContext2D.strokeRect(x, y, width, height);\n        },\n\n        /**\n         * draw the given shape\n         * @name drawShape\n         * @memberOf me.CanvasRenderer\n         * @function\n         * @param {me.Rect|me.Polygon|me.Line|me.Ellipse} shape a shape object\n         */\n        drawShape : function (shape) {\n            if (shape instanceof me.Rect) {\n                this.strokeRect(shape.left, shape.top, shape.width, shape.height);\n            } else if (shape instanceof me.Line || shape instanceof me.Polygon) {\n                this.strokePolygon(shape);\n            } else if (shape instanceof me.Ellipse) {\n                if (shape.radiusV.x === shape.radiusV.y) {\n                    // it's a circle\n                    this.strokeArc(\n                        shape.pos.x - shape.radius,\n                        shape.pos.y - shape.radius,\n                        shape.radius,\n                        0,\n                        2 * Math.PI\n                    );\n                } else {\n                    // it's an ellipse\n                    this.strokeEllipse(\n                        shape.pos.x,\n                        shape.pos.y,\n                        shape.radiusV.x,\n                        shape.radiusV.y\n                    );\n                }\n            }\n        },\n\n        /**\n         * Multiply given matrix into the renderer tranformation matrix\n         * @name multiplyMatrix\n         * @memberOf me.CanvasRenderer\n         * @function\n         * @param {me.Matrix2d} mat2d Matrix to transform by\n         */\n        transform : function (mat2d) {\n            var a = mat2d.val;\n            this.backBufferContext2D.transform(\n                a[0],\n                a[1],\n                a[3],\n                a[4],\n                a[6],\n                a[7]\n            );\n        },\n\n        /**\n         * Translates the context to the given position\n         * @name translate\n         * @memberOf me.CanvasRenderer\n         * @function\n         * @param {Number} x\n         * @param {Number} y\n         */\n        translate : function (x, y) {\n            this.backBufferContext2D.translate(x, y);\n        }\n\n    });\n\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n    /**\n     * a local constant for the -(Math.PI / 2) value\n     * @ignore\n     */\n    var nhPI = -(Math.PI / 2);\n\n    /**\n     * A Texture atlas object <br>\n     * For portability, a global reference to this class is available through the default renderer: {@link me.video.renderer}.Texture <br>\n     * <br>\n     * Currently supports : <br>\n     * - [TexturePacker]{@link http://www.codeandweb.com/texturepacker/} : through JSON export <br>\n     * - [ShoeBox]{@link http://renderhjs.net/shoebox/} : through JSON export using the\n     * melonJS setting [file]{@link https://github.com/melonjs/melonJS/raw/master/media/shoebox_JSON_export.sbx} <br>\n     * - Standard (fixed cell size) spritesheet : through a {framewidth:xx, frameheight:xx, anchorPoint:me.Vector2d} object\n     * @class\n     * @extends Object\n     * @memberOf me.CanvasRenderer\n     * @name Texture\n     * @constructor\n     * @param {Object} atlas atlas information. See {@link me.loader.getJSON}\n     * @param {Image} [texture=atlas.meta.image] texture name\n     * @param {Boolean} [cached=false] Use true to skip caching this Texture\n     * @example\n     * // create a texture atlas from a JSON Object\n     * texture = new me.video.renderer.Texture(\n     *     me.loader.getJSON(\"texture\"),\n     *     me.loader.getImage(\"texture\")\n     * );\n     *\n     * // create a texture atlas for a spritesheet, with (optional) an anchorPoint in the center of each frame\n     * texture = new me.video.renderer.Texture(\n     *     { framewidth : 32, frameheight : 32, anchorPoint : new me.Vector2d(0.5, 0.5) },\n     *     me.loader.getImage(\"spritesheet\")\n     * );\n     */\n    me.CanvasRenderer.prototype.Texture = me.Object.extend(\n    /** @scope me.video.renderer.Texture.prototype */\n    {\n        /**\n         * @ignore\n         */\n        init : function (atlas, texture, cached) {\n            /**\n             * to identify the atlas format (e.g. texture packer)\n             * @ignore\n             */\n            this.format = null;\n\n            /**\n             * the image texture itself (FIXME: This should be named `image`)\n             * @ignore\n             */\n            this.texture = texture || null;\n\n            /**\n             * the atlas dictionnary\n             * @ignore\n             */\n            this.atlas = null;\n\n            if (typeof (atlas) !== \"undefined\") {\n\n                if (typeof(atlas.meta) !== \"undefined\") {\n                    // Texture Packer\n                    if (atlas.meta.app.includes(\"texturepacker\")) {\n                        this.format = \"texturepacker\";\n                        // set the texture\n                        if (typeof(texture) === \"undefined\") {\n                            var image = atlas.meta.image;\n                            this.texture = me.utils.getImage(image);\n                            if (!this.texture) {\n                                throw new me.video.renderer.Texture.Error(\n                                    \"Atlas texture '\" + image + \"' not found\"\n                                );\n                            }\n                        }\n                        this.repeat = \"no-repeat\";\n                    }\n                    // ShoeBox\n                    else if (atlas.meta.app.includes(\"ShoeBox\")) {\n                        if (!atlas.meta.exporter || !atlas.meta.exporter.includes(\"melonJS\")) {\n                            throw new me.video.renderer.Texture.Error(\n                                \"ShoeBox requires the JSON exporter : \" +\n                                \"https://github.com/melonjs/melonJS/tree/master/media/shoebox_JSON_export.sbx\"\n                            );\n                        }\n                        this.format = \"ShoeBox\";\n                        this.repeat = \"no-repeat\";\n                    }\n                    // Internal texture atlas\n                    else if (atlas.meta.app.includes(\"melonJS\")) {\n                        this.format = \"melonJS\";\n                        this.repeat = atlas.meta.repeat || \"no-repeat\";\n                    }\n                    // initialize the atlas\n                    this.atlas = this.build(atlas);\n\n                } else {\n                    // a regular spritesheet ?\n                    if (typeof(atlas.framewidth) !== \"undefined\" &&\n                        typeof(atlas.frameheight) !== \"undefined\") {\n                        this.format = \"Spritesheet (fixed cell size)\";\n                        if (typeof(texture) !== undefined) {\n                            // overwrite if specified\n                            atlas.image = texture;\n                        }\n                        // initialize the atlas\n                        this.atlas = this.buildFromSpriteSheet(atlas);\n                        this.repeat = \"no-repeat\";\n                    }\n                }\n            }\n            // if format not recognized\n            if (!this.atlas) {\n                throw new me.video.renderer.Texture.Error(\"texture atlas format not supported\");\n            }\n\n            // Add self to TextureCache\n            if (!cached) {\n                me.video.renderer.cache.put(this.texture, this);\n            }\n        },\n\n        /**\n         * @ignore\n         */\n        build : function (data) {\n            var atlas = {};\n            data.frames.forEach(function (frame) {\n                // fix wrongly formatted JSON (e.g. last dummy object in ShoeBox)\n                if (frame.hasOwnProperty(\"filename\")) {\n                    // Source coordinates\n                    var s = frame.frame;\n\n                    var originX, originY;\n                    // Pixel-based offset origin from the top-left of the source frame\n                    var hasTextureAnchorPoint = (frame.spriteSourceSize && frame.sourceSize && frame.pivot);\n                    if (hasTextureAnchorPoint) {\n                        originX = (frame.sourceSize.w * frame.pivot.x) - ((frame.trimmed) ? frame.spriteSourceSize.x : 0);\n                        originY = (frame.sourceSize.h * frame.pivot.y) - ((frame.trimmed) ? frame.spriteSourceSize.y : 0);\n                    }\n\n                    atlas[frame.filename] = {\n                        name         : name, // frame name\n                        offset       : new me.Vector2d(s.x, s.y),\n                        anchorPoint  : (hasTextureAnchorPoint) ? new me.Vector2d(originX / s.w, originY / s.h) : null,\n                        width        : s.w,\n                        height       : s.h,\n                        angle        : (frame.rotated === true) ? nhPI : 0\n                    };\n                }\n            });\n            return atlas;\n        },\n\n        /**\n         * build an atlas from the given spritesheet\n         * @ignore\n         */\n        buildFromSpriteSheet : function (data) {\n            var atlas = {};\n            var image = data.image;\n            var spacing = data.spacing || 0;\n            var margin = data.margin || 0;\n\n            var width = image.width;\n            var height = image.height;\n\n            // calculate the sprite count (line, col)\n            var spritecount = new me.Vector2d(\n                ~~((width - margin + spacing) / (data.framewidth + spacing)),\n                ~~((height - margin + spacing) / (data.frameheight + spacing))\n            );\n\n            // verifying the texture size\n            if ((width % (data.framewidth + spacing)) !== 0 ||\n                (height % (data.frameheight + spacing)) !== 0) {\n                // \"truncate size\"\n                width = spritecount.x * (data.framewidth + spacing);\n                height = spritecount.y * (data.frameheight + spacing);\n                // warning message\n                console.warn(\n                    \"Spritesheet Texture for image: \" + image.src +\n                    \" is not divisible by \" + (data.framewidth + spacing) +\n                    \"x\" + (data.frameheight + spacing) +\n                    \", truncating effective size to \" + width + \"x\" + height\n                );\n            }\n\n            // build the local atlas\n            for (var frame = 0, count = spritecount.x * spritecount.y; frame < count ; frame++) {\n                atlas[\"\" + frame] = {\n                    name: \"\" + frame,\n                    offset: new me.Vector2d(\n                        margin + (spacing + data.framewidth) * (frame % spritecount.x),\n                        margin + (spacing + data.frameheight) * ~~(frame / spritecount.x)\n                    ),\n                    anchorPoint: (data.anchorPoint || null),\n                    width: data.framewidth,\n                    height: data.frameheight,\n                    angle: 0\n                };\n            }\n\n            return atlas;\n        },\n\n        /**\n         * return the Atlas dictionnary\n         * @name getAtlas\n         * @memberOf me.CanvasRenderer.Texture\n         * @function\n         * @return {Object}\n         */\n        getAtlas : function () {\n            return this.atlas;\n        },\n\n        /**\n         * return the Atlas texture\n         * @name getTexture\n         * @memberOf me.CanvasRenderer.Texture\n         * @function\n         * @return {Image}\n         */\n        getTexture : function () {\n            return this.texture;\n        },\n\n        /**\n         * return a normalized region/frame information for the specified sprite name\n         * @name getRegion\n         * @memberOf me.CanvasRenderer.Texture\n         * @function\n         * @param {String} name name of the sprite\n         * @return {Object}\n         */\n        getRegion : function (name) {\n            return this.atlas[name];\n        },\n\n        /**\n         * Create a sprite object using the first region found using the specified name\n         * @name createSpriteFromName\n         * @memberOf me.CanvasRenderer.Texture\n         * @function\n         * @param {String} name name of the sprite\n         * @param {Object} [settings] Additional settings passed to the {@link me.Sprite} contructor\n         * @return {me.Sprite}\n         * @example\n         * // create a new texture atlas object under the `game` namespace\n         * game.texture = new me.video.renderer.Texture(\n         *    me.loader.getJSON(\"texture\"),\n         *    me.loader.getImage(\"texture\")\n         * );\n         * ...\n         * ...\n         * // add the coin sprite as renderable for the entity\n         * this.renderable = game.texture.createSpriteFromName(\"coin.png\");\n         * // set the renderable position to bottom center\n         * this.anchorPoint.set(0.5, 1.0);\n         */\n        createSpriteFromName : function (name, settings) {\n            // instantiate a new sprite object\n            return me.pool.pull(\n                \"me.Sprite\",\n                0, 0,\n                Object.assign({\n                    image: this,\n                    region : name\n                }, settings || {})\n            );\n        },\n\n        /**\n         * Create an animation object using the first region found using all specified names\n         * @name createAnimationFromName\n         * @memberOf me.CanvasRenderer.Texture\n         * @function\n         * @param {String[]|Number[]} names list of names for each sprite\n         * (when manually creating a Texture out of a spritesheet, only numeric values are authorized)\n         * @param {Object} [settings] Additional settings passed to the {@link me.AnimationSheet} contructor\n         * @return {me.AnimationSheet}\n         * @example\n         * // create a new texture atlas object under the `game` namespace\n         * game.texture = new me.video.renderer.Texture(\n         *     me.loader.getJSON(\"texture\"),\n         *     me.loader.getImage(\"texture\")\n         * );\n         *\n         * // create a new animationSheet as renderable for the entity\n         * this.renderable = game.texture.createAnimationFromName([\n         *     \"walk0001.png\", \"walk0002.png\", \"walk0003.png\",\n         *     \"walk0004.png\", \"walk0005.png\", \"walk0006.png\",\n         *     \"walk0007.png\", \"walk0008.png\", \"walk0009.png\",\n         *     \"walk0010.png\", \"walk0011.png\"\n         * ]);\n         *\n         * // define an additional basic walking animation\n         * this.renderable.addAnimation (\"simple_walk\", [0,2,1]);\n         * // you can also use frame name to define your animation\n         * this.renderable.addAnimation (\"speed_walk\", [\"walk0007.png\", \"walk0008.png\", \"walk0009.png\", \"walk0010.png\"]);\n         * // set the default animation\n         * this.renderable.setCurrentAnimation(\"simple_walk\");\n         * // set the renderable position to bottom center\n         * this.anchorPoint.set(0.5, 1.0);\n         */\n        createAnimationFromName : function (names, settings) {\n            var tpAtlas = [], indices = {};\n            // iterate through the given names\n            // and create a \"normalized\" atlas\n            for (var i = 0; i < names.length;++i) {\n                tpAtlas[i] = this.getRegion(names[i]);\n                indices[names[i]] = i;\n                if (tpAtlas[i] == null) {\n                    // throw an error\n                    throw new me.video.renderer.Texture.Error(\"Texture - region for \" + names[i] + \" not found\");\n                }\n            }\n            // instantiate a new animation sheet object\n            return new me.AnimationSheet(0, 0, Object.assign({\n                image: this.texture,\n                framewidth: 0,\n                frameheight: 0,\n                margin: 0,\n                spacing: 0,\n                atlas: tpAtlas,\n                atlasIndices: indices\n            }, settings || {}));\n        }\n    });\n\n    /**\n     * Base class for Texture exception handling.\n     * @name Error\n     * @class\n     * @memberOf me.CanvasRenderer.Texture\n     * @constructor\n     * @param {String} msg Error message.\n     */\n    me.CanvasRenderer.prototype.Texture.Error = me.Error.extend({\n        init : function (msg) {\n            me.Error.prototype.init.apply(this, [ msg ]);\n            this.name = \"me.CanvasRenderer.Texture.Error\";\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015 Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n\n    /**\n     * The WebGL Shader singleton <br>\n     * There is no constructor function for me.video.shader\n     * @namespace me.video.shader\n     * @memberOf me.video\n     */\n    me.video.shader = (function () {\n        /**\n         * Public API\n         * @ignore\n         */\n        var api = {};\n\n        /**\n         * Compile GLSL into a shader object\n         * @private\n         */\n        function getShader(gl, type, source) {\n            var shader = gl.createShader(type);\n            gl.shaderSource(shader, source);\n            gl.compileShader(shader);\n\n            if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n                throw new me.video.Error(gl.getShaderInfoLog(shader));\n            }\n\n            return shader;\n        }\n\n        /**\n         * Hash map of GLSL data types to WebGL Uniform methods\n         * @private\n         */\n        var fnHash = {\n            \"bool\"      : \"1i\",\n            \"int\"       : \"1i\",\n            \"float\"     : \"1f\",\n            \"vec2\"      : \"2fv\",\n            \"vec3\"      : \"3fv\",\n            \"vec4\"      : \"4fv\",\n            \"bvec2\"     : \"2iv\",\n            \"bvec3\"     : \"3iv\",\n            \"bvec4\"     : \"4iv\",\n            \"ivec2\"     : \"2iv\",\n            \"ivec3\"     : \"3iv\",\n            \"ivec4\"     : \"4iv\",\n            \"mat2\"      : \"Matrix2fv\",\n            \"mat3\"      : \"Matrix3fv\",\n            \"mat4\"      : \"Matrix4fv\",\n            \"sampler2D\" : \"1i\",\n        };\n\n        /**\n         * Create a shader program (with bindings) using the given GLSL sources\n         * @name createShader\n         * @memberOf me.video.shader\n         * @function\n         * @param {WebGLContext} gl WebGL Context\n         * @param {String} vertex Vertex shader source\n         * @param {String} fragment Fragment shader source\n         * @return {Object} A reference to the WebGL Shader Program\n         */\n        api.createShader = function (gl, vertex, fragment) {\n            var program = {\n                    \"attributes\"    : {},\n                    \"uniforms\"      : {},\n                    \"handle\"        : null,\n                },\n                handle = program.handle = gl.createProgram(),\n                attrRx = /attribute\\s+\\w+\\s+(\\w+)/g,\n                uniRx = /uniform\\s+(\\w+)\\s+(\\w+)/g,\n                attributes = [],\n                uniforms = {},\n                match,\n                descriptor = {},\n                locations = {};\n\n            gl.attachShader(handle, getShader(gl, gl.VERTEX_SHADER, vertex));\n            gl.attachShader(handle, getShader(gl, gl.FRAGMENT_SHADER, fragment));\n            gl.linkProgram(handle);\n\n            if (!gl.getProgramParameter(handle, gl.LINK_STATUS)) {\n                throw new me.video.Error(gl.getProgramInfoLog(handle));\n            }\n\n            gl.useProgram(handle);\n\n            // Detect all attribute names\n            while ((match = attrRx.exec(vertex))) {\n                attributes.push(match[1]);\n            }\n\n            // Detect all uniform names and types\n            [ vertex, fragment ].forEach(function (shader) {\n                while ((match = uniRx.exec(shader))) {\n                    uniforms[match[2]] = match[1];\n                }\n            });\n\n            // Get attribute references\n            attributes.forEach(function (attr) {\n                program.attributes[attr] = gl.getAttribLocation(handle, attr);\n                gl.enableVertexAttribArray(program.attributes[attr]);\n            });\n\n            // Get uniform references\n            Object.keys(uniforms).forEach(function (name) {\n                var type = uniforms[name];\n                locations[name] = gl.getUniformLocation(handle, name);\n\n                descriptor[name] = {\n                    \"get\" : (function (name) {\n                        /**\n                         * A getter for the uniform location\n                         * @ignore\n                         */\n                        return function () {\n                            return locations[name];\n                        };\n                    })(name),\n                    \"set\" : (function (name, type, fn) {\n                        if (type.indexOf(\"mat\") === 0) {\n                            /**\n                             * A generic setter for uniform matrices\n                             * @ignore\n                             */\n                            return function (val) {\n                                gl[fn](locations[name], false, val);\n                            };\n                        }\n                        else {\n                            /**\n                            * A generic setter for uniform vectors\n                            * @ignore\n                            */\n                            return function (val) {\n                                var fnv = fn;\n                                if (val.length && fn.substr(-1) !== \"v\") {\n                                    fnv += \"v\";\n                                }\n                                gl[fnv](locations[name], val);\n                            };\n                        }\n                    })(name, type, \"uniform\" + fnHash[type]),\n                };\n            });\n            Object.defineProperties(program.uniforms, descriptor);\n\n            return program;\n        };\n\n        /**\n         * Create a texture from an image\n         * @name createTexture\n         * @memberOf me.video.shader\n         * @function\n         * @param {WebGLContext} gl WebGL Context\n         * @param {Number} unit Destination texture unit\n         * @param {Image|Canvas|ImageData|UInt8Array[]|Float32Array[]} image Source image\n         * @param {String} [repeat=\"no-repeat\"] Image repeat behavior (see {@link me.ImageLayer#repeat})\n         * @param {Number} [w] Source image width (Only use with UInt8Array[] or Float32Array[] source image)\n         * @param {Number} [h] Source image height (Only use with UInt8Array[] or Float32Array[] source image)\n         * @param {Number} [b] Source image border (Only use with UInt8Array[] or Float32Array[] source image)\n         * @return {WebGLTexture} A texture object\n         */\n        api.createTexture = function (gl, unit, image, repeat, w, h, b) {\n            repeat = repeat || \"no-repeat\";\n\n            var texture = gl.createTexture(),\n                filter = me.video.renderer.antiAlias ? gl.LINEAR : gl.NEAREST,\n                rs = (repeat.search(/^repeat(-x)?$/) === 0) ? gl.REPEAT : gl.CLAMP_TO_EDGE,\n                rt = (repeat.search(/^repeat(-y)?$/) === 0) ? gl.REPEAT : gl.CLAMP_TO_EDGE;\n\n            gl.activeTexture(gl.TEXTURE0 + unit);\n            gl.bindTexture(gl.TEXTURE_2D, texture);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, rs);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, rt);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, filter);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, filter);\n            if (w || h || b) {\n                gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, w, h, b, gl.RGBA, gl.UNSIGNED_BYTE, image);\n            }\n            else {\n                gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);\n            }\n\n            return texture;\n        };\n\n        return api;\n    })();\n\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015 Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n\n    /**\n     * a WebGL renderer object\n     * @extends me.Renderer\n     * @namespace me.WebGLRenderer\n     * @memberOf me\n     * @constructor\n     * @param {Canvas} canvas The html canvas tag to draw to on screen.\n     * @param {Number} width The width of the canvas without scaling\n     * @param {Number} height The height of the canvas without scaling\n     * @param {Object} [options] The renderer parameters\n     * @param {Boolean} [options.doubleBuffering=false] Whether to enable double buffering\n     * @param {Boolean} [options.antiAlias=false] Whether to enable anti-aliasing\n     * @param {Boolean} [options.transparent=false] Whether to enable transparency on the canvas (performance hit when enabled)\n     * @param {Number} [options.zoomX=width] The actual width of the canvas with scaling applied\n     * @param {Number} [options.zoomY=height] The actual height of the canvas with scaling applied\n     * @param {me.WebGLRenderer.Compositor} [options.compositor] A class that implements the compositor API\n     */\n    me.WebGLRenderer = me.Renderer.extend(\n    /** @scope me.WebGLRenderer.prototype */\n    {\n        /**\n         * @ignore\n         */\n        init : function (c, width, height, options) {\n            me.Renderer.prototype.init.apply(this, [c, width, height, options]);\n\n            /**\n             * The WebGL context\n             * @name gl\n             * @memberOf me.WebGLRenderer\n             */\n            this.gl = this.getContextGL(c, !this.transparent);\n            var gl = this.gl;\n\n            /**\n             * @ignore\n             */\n            this.colorStack = [];\n\n            /**\n             * @ignore\n             */\n            this._matrixStack = [];\n\n            /**\n             * @ignore\n             */\n            this._linePoints = [\n                new me.Vector2d(),\n                new me.Vector2d(),\n                new me.Vector2d(),\n                new me.Vector2d()\n            ];\n\n            /**\n             * The global matrix. Used for transformations on the overall scene\n             * @name globalMatrix\n             * @type me.Matrix3d\n             * @memberOf me.WebGLRenderer\n             */\n            this.globalMatrix = new me.Matrix2d();\n\n            // Create a compositor\n            var Compositor = options.compositor || me.WebGLRenderer.Compositor;\n            this.compositor = new Compositor(\n                gl,\n                this.globalMatrix,\n                this.globalColor\n            );\n\n            // Create a texture cache\n            this.cache = new me.Renderer.TextureCache(\n                this.compositor.maxTextures\n            );\n\n            // FIXME: Cannot reference me.video.renderer yet\n            me.video.renderer = this;\n\n            this.createFillTexture();\n            this.createFontTexture();\n\n            // Configure the WebGL viewport\n            this.scaleCanvas(1, 1);\n\n            return this;\n        },\n\n        /**\n         * @ignore\n         */\n        createFillTexture : function () {\n            // Create a 1x1 white texture for fill operations\n            var img = new Uint8Array([255, 255, 255, 255]);\n\n            /**\n             * @ignore\n             */\n            this.fillTexture = new this.Texture({\n                // FIXME: Create a texture atlas helper function\n                \"meta\" : {\n                    \"app\" : \"melonJS\",\n                    \"size\" : { \"w\" : 1, \"h\" : 1 }\n                },\n                \"frames\" : [{\n                    \"filename\" : \"default\",\n                    \"frame\" : { \"x\" : 0, \"y\" : 0, \"w\" : 1, \"h\" : 1 }\n                }]\n            }, img);\n\n            this.compositor.uploadTexture(\n                this.fillTexture,\n                1,\n                1,\n                0\n            );\n        },\n\n        /**\n         * @ignore\n         */\n        createFontTexture : function () {\n            var img = me.video.createCanvas(\n                this.backBufferCanvas.width,\n                this.backBufferCanvas.height\n            );\n\n            /**\n             * @ignore\n             */\n            this.fontContext2D = this.getContext2d(img);\n\n            /**\n             * @ignore\n             */\n            this.fontTexture = new this.Texture({\n                // FIXME: Create a texture atlas helper function\n                \"meta\" : {\n                    \"app\" : \"melonJS\",\n                    \"size\" : {\n                        \"w\" : this.backBufferCanvas.width,\n                        \"h\" : this.backBufferCanvas.height\n                    }\n                },\n                \"frames\" : [{\n                    \"filename\" : \"default\",\n                    \"frame\" : {\n                        \"x\" : 0,\n                        \"y\" : 0,\n                        \"w\" : this.backBufferCanvas.width,\n                        \"h\" : this.backBufferCanvas.height\n                    }\n                }]\n            }, img);\n\n            this.compositor.uploadTexture(this.fontTexture);\n        },\n\n        /**\n         * Create a pattern with the specified repition\n         * @name createPattern\n         * @memberOf me.WebGLRenderer\n         * @function\n         * @param {image} image Source image\n         * @param {String} repeat Define how the pattern should be repeated\n         * @return {me.video.renderer.Texture}\n         * @see me.ImageLayer#repeat\n         * @example\n         * var tileable   = renderer.createPattern(image, \"repeat\");\n         * var horizontal = renderer.createPattern(image, \"repeat-x\");\n         * var vertical   = renderer.createPattern(image, \"repeat-y\");\n         * var basic      = renderer.createPattern(image, \"no-repeat\");\n         */\n        createPattern : function (image, repeat) {\n            var texture = new this.Texture({\n                // FIXME: Create a texture atlas helper function\n                \"meta\" : {\n                    \"app\" : \"melonJS\",\n                    \"size\" : { \"w\" : image.width, \"h\" : image.height },\n                    \"repeat\" : repeat\n                },\n                \"frames\" : [{\n                    \"filename\" : \"default\",\n                    \"frame\" : { \"x\" : 0, \"y\" : 0, \"w\" : image.width, \"h\" : image.height }\n                }]\n            }, image);\n\n            // FIXME: Remove old cache entry and texture when changing the repeat mode\n            this.compositor.uploadTexture(texture);\n\n            return texture;\n        },\n\n        /**\n         * Flush the compositor to the frame buffer\n         * @name blitSurface\n         * @memberOf me.WebGLRenderer\n         * @function\n         */\n        blitSurface : function () {\n            this.compositor.flush();\n        },\n\n        /**\n         * Clears the gl context. Accepts a gl context or defaults to stored gl renderer.\n         * @name clearSurface\n         * @memberOf me.WebGLRenderer\n         * @function\n         * @param {WebGLContext} [ctx=null] For compatibility only.\n         * @param {me.Color|String} color CSS color.\n         * @param {Boolean} [opaque=false] Allow transparency [default] or clear the surface completely [true]\n         */\n        clearSurface : function (ctx, col, opaque) {\n            var color = this.globalColor.clone();\n            var matrix = this.globalMatrix.clone();\n            this.globalColor.copy(col);\n            this.globalMatrix.identity();\n\n            if (opaque) {\n                this.compositor.clear();\n            }\n            else {\n                this.fillRect(0, 0, this.canvas.width, this.canvas.height);\n            }\n\n            this.globalMatrix.copy(matrix);\n            this.globalColor.copy(color);\n            me.pool.push(color);\n        },\n\n        /**\n         * @ignore\n         */\n        drawFont : function (bounds) {\n            // Flush the compositor so we can upload a new texture\n            this.compositor.flush();\n\n            // Force-upload the new texture\n            this.compositor.uploadTexture(this.fontTexture, 0, 0, 0, true);\n\n            // Add the new quad\n            var key = bounds.pos.x + \",\" + bounds.pos.y + \",\" + bounds.width + \",\" + bounds.height;\n            this.compositor.addQuad(\n                this.fontTexture,\n                key,\n                bounds.pos.x,\n                bounds.pos.y,\n                bounds.width,\n                bounds.height\n            );\n\n            // Clear font context2D\n            this.fontContext2D.clearRect(0, 0, this.backBufferCanvas.width, this.backBufferCanvas.height);\n        },\n\n        /**\n         * Draw an image to the gl context\n         * @name drawImage\n         * @memberOf me.WebGLRenderer\n         * @function\n         * @param {Image} image Source image\n         * @param {Number} sx Source x-coordinate\n         * @param {Number} sy Source y-coordinate\n         * @param {Number} sw Source width\n         * @param {Number} sh Source height\n         * @param {Number} dx Destination x-coordinate\n         * @param {Number} dy Destination y-coordinate\n         * @param {Number} dw Destination width\n         * @param {Number} dh Destination height\n         * @example\n         * // Can be used in three ways:\n         * renderer.drawImage(image, dx, dy);\n         * renderer.drawImage(image, dx, dy, dw, dh);\n         * renderer.drawImage(image, sx, sy, sw, sh, dx, dy, dw, dh);\n         * // dx, dy, dw, dh being the destination target & dimensions. sx, sy, sw, sh being the position & dimensions to take from the image\n         */\n        drawImage : function (image, sx, sy, sw, sh, dx, dy, dw, dh) {\n            // TODO: Replace the function signature with:\n            // drawImage(Image|Object, sx, sy, sw, sh, dx, dy, dw, dh)\n            if (typeof sw === \"undefined\") {\n                sw = dw = image.width;\n                sh = dh = image.height;\n                dx = sx;\n                dy = sy;\n                sx = 0;\n                sy = 0;\n            }\n            else if (typeof dx === \"undefined\") {\n                dx = sx;\n                dy = sy;\n                dw = sw;\n                dh = sh;\n                sw = image.width;\n                sh = image.height;\n                sx = 0;\n                sy = 0;\n            }\n\n            var key = sx + \",\" + sy + \",\" + sw + \",\" + sh;\n            this.compositor.addQuad(this.cache.get(image), key, dx, dy, dw, dh);\n        },\n\n        /**\n         * Draw a pattern within the given rectangle.\n         * @name drawPattern\n         * @memberOf me.WebGLRenderer\n         * @function\n         * @param {me.video.renderer.Texture} pattern Pattern object\n         * @param {Number} x\n         * @param {Number} y\n         * @param {Number} width\n         * @param {Number} height\n         * @see me.WebGLRenderer#createPattern\n         */\n        drawPattern : function (pattern, x, y, width, height) {\n            var key = \"0,0,\" + width + \",\" + height;\n            this.compositor.addQuad(pattern, key, x, y, width, height);\n        },\n\n        /**\n         * Draw a filled rectangle at the specified coordinates\n         * @name fillRect\n         * @memberOf me.WebGLRenderer\n         * @function\n         * @param {Number} x\n         * @param {Number} y\n         * @param {Number} width\n         * @param {Number} height\n         */\n        fillRect : function (x, y, width, height) {\n            this.compositor.addQuad(this.fillTexture, \"default\", x, y, width, height);\n        },\n\n        /**\n         * return a reference to the screen canvas corresponding WebGL Context<br>\n         * @name getScreenContext\n         * @memberOf me.WebGLRenderer\n         * @function\n         * @return {WebGLContext}\n         */\n        getScreenContext : function () {\n            return this.gl;\n        },\n\n        /**\n         * Returns the WebGL Context object of the given Canvas\n         * @name getContextGL\n         * @memberOf me.WebGLRenderer\n         * @function\n         * @param {Canvas} canvas\n         * @param {Boolean} [opaque=false] Use true to disable transparency\n         * @return {WebGLContext}\n         */\n        getContextGL : function (c, opaque) {\n            if (typeof c === \"undefined\" || c === null) {\n                throw new me.video.Error(\n                    \"You must pass a canvas element in order to create \" +\n                    \"a GL context\"\n                );\n            }\n\n            if (typeof c.getContext === \"undefined\") {\n                throw new me.video.Error(\n                    \"Your browser does not support WebGL.\"\n                );\n            }\n\n            var attr = {\n                antialias : this.antiAlias,\n                alpha : !opaque,\n            };\n            return (\n                c.getContext(\"webgl\", attr) ||\n                c.getContext(\"experimental-webgl\", attr)\n            );\n        },\n\n        /**\n         * Returns the WebGLContext instance for the renderer\n         * return a reference to the system 2d Context\n         * @name getContext\n         * @memberOf me.WebGLRenderer\n         * @function\n         * @return {WebGLContext}\n         */\n        getContext : function () {\n            return this.gl;\n        },\n\n        /**\n         * resets the gl transform to identity\n         * @name resetTransform\n         * @memberOf me.WebGLRenderer\n         * @function\n         */\n        resetTransform : function () {\n            this.globalMatrix.identity();\n        },\n\n        /**\n         * Reset context state\n         * @name reset\n         * @memberOf me.WebGLRenderer\n         * @function\n         */\n        reset : function () {\n            this.globalMatrix.identity();\n            this.cache.reset();\n            this.compositor.reset();\n            this.createFillTexture();\n            this.createFontTexture();\n        },\n\n        /**\n         * scales the canvas & GL Context\n         * @name scaleCanvas\n         * @memberOf me.WebGLRenderer\n         * @function\n         */\n        scaleCanvas : function (scaleX, scaleY) {\n            var w = this.canvas.width * scaleX;\n            var h = this.canvas.height * scaleY;\n\n            // adjust CSS style for High-DPI devices\n            if (me.device.getPixelRatio() > 1) {\n                this.canvas.style.width = (w / me.device.getPixelRatio()) + \"px\";\n                this.canvas.style.height = (h / me.device.getPixelRatio()) + \"px\";\n            }\n            else {\n                this.canvas.style.width = w + \"px\";\n                this.canvas.style.height = h + \"px\";\n            }\n\n            this.compositor.setProjection(this.canvas.width, this.canvas.height);\n        },\n\n        /**\n         * restores the canvas context\n         * @name restore\n         * @memberOf me.WebGLRenderer\n         * @function\n         */\n        restore : function () {\n            var color = this.colorStack.pop();\n            me.pool.push(color);\n            this.globalColor.copy(color);\n            this.globalMatrix.copy(this._matrixStack.pop());\n        },\n\n        /**\n         * rotates the uniform matrix\n         * @name rotate\n         * @memberOf me.WebGLRenderer\n         * @function\n         * @param {Number} angle in radians\n         */\n        rotate : function (angle) {\n            this.globalMatrix.rotate(angle);\n        },\n\n        /**\n         * save the canvas context\n         * @name save\n         * @memberOf me.WebGLRenderer\n         * @function\n         */\n        save : function () {\n            this.colorStack.push(this.globalColor.clone());\n            this._matrixStack.push(this.globalMatrix.clone());\n        },\n\n        /**\n         * scales the uniform matrix\n         * @name scale\n         * @memberOf me.WebGLRenderer\n         * @function\n         * @param {Number} x\n         * @param {Number} y\n         */\n        scale : function (x, y) {\n            this.globalMatrix.scale(x, y);\n        },\n\n        /**\n         * not used by this renderer?\n         * @ignore\n         */\n        setAntiAlias : function (context, enable) {\n            me.Renderer.prototype.setAntiAlias.apply(this, [context, enable]);\n            // TODO: perhaps handle GLNEAREST or other options with texture binding\n        },\n\n        /**\n         * return the current global alpha\n         * @name globalAlpha\n         * @memberOf me.WebGLRenderer\n         * @function\n         * @return {Number}\n         */\n        setGlobalAlpha : function (a) {\n            this.globalColor.glArray[3] = a;\n        },\n\n        /**\n         * Sets the color for further draw calls\n         * @name setColor\n         * @memberOf me.WebGLRenderer\n         * @function\n         * @param {me.Color|String} color css color string.\n         */\n        setColor : function (color) {\n            this.globalColor.copy(color);\n        },\n\n        /**\n         * Set the line width\n         * @name setLineWidth\n         * @memberOf me.WebGLRenderer\n         * @function\n         * @param {Number} width Line width\n         */\n        setLineWidth : function (width) {\n            this.compositor.lineWidth(width);\n        },\n\n        /**\n         * Stroke an arc at the specified coordinates with given radius, start and end points\n         * @name strokeArc\n         * @memberOf me.WebGLRenderer\n         * @function\n         * @param {Number} x arc center point x-axis\n         * @param {Number} y arc center point y-axis\n         * @param {Number} radius\n         * @param {Number} start start angle in radians\n         * @param {Number} end end angle in radians\n         * @param {Boolean} [antiClockwise=false] draw arc anti-clockwise\n         */\n        strokeArc : function (/*x, y, radius, start, end, antiClockwise*/) {\n            // TODO\n        },\n\n        /**\n         * Stroke an ellipse at the specified coordinates with given radius, start and end points\n         * @name strokeEllipse\n         * @memberOf me.WebGLRenderer\n         * @function\n         * @param {Number} x arc center point x-axis\n         * @param {Number} y arc center point y-axis\n         * @param {Number} w horizontal radius of the ellipse\n         * @param {Number} h vertical radius of the ellipse\n         */\n        strokeEllipse : function (/*x, y, w, h*/) {\n            // TODO\n        },\n\n        /**\n         * Stroke a line of the given two points\n         * @name strokeLine\n         * @memberOf me.WebGLRenderer\n         * @function\n         * @param {Number} startX the start x coordinate\n         * @param {Number} startY the start y coordinate\n         * @param {Number} endX the end x coordinate\n         * @param {Number} endY the end y coordinate\n         */\n        strokeLine : function (startX, startY, endX, endY) {\n            var points = this._linePoints.slice(0, 2);\n            points[0].x = startX;\n            points[0].y = startY;\n            points[1].x = endX;\n            points[1].y = endY;\n            this.compositor.drawLine(points, true);\n        },\n\n        /**\n         * Strokes a me.Polygon on the screen with a specified color\n         * @name strokePolygon\n         * @memberOf me.WebGLRenderer\n         * @function\n         * @param {me.Polygon} poly the shape to draw\n         */\n        strokePolygon : function (poly) {\n            var len = poly.points.length,\n                points,\n                i;\n\n            // Grow internal points buffer if necessary\n            for (i = this._linePoints.length; i < len; i++) {\n                this._linePoints.push(new me.Vector2d());\n            }\n\n            points = this._linePoints.slice(0, len);\n            for (i = 0; i < len; i++) {\n                points[i].x = poly.pos.x + poly.points[i].x;\n                points[i].y = poly.pos.y + poly.points[i].y;\n            }\n            this.compositor.drawLine(points);\n        },\n\n        /**\n         * Draw a stroke rectangle at the specified coordinates\n         * @name strokeRect\n         * @memberOf me.WebGLRenderer\n         * @function\n         * @param {Number} x\n         * @param {Number} y\n         * @param {Number} width\n         * @param {Number} height\n         */\n        strokeRect : function (x, y, width, height) {\n            var points = this._linePoints.slice(0, 4);\n            points[0].x = x;\n            points[0].y = y;\n            points[1].x = x + width;\n            points[1].y = y;\n            points[2].x = x + width;\n            points[2].y = y + height;\n            points[3].x = x;\n            points[3].y = y + height;\n            this.compositor.drawLine(points);\n        },\n\n        /**\n         * draw the given shape\n         * @name drawShape\n         * @memberOf me.WebGLRenderer\n         * @function\n         * @param {me.Rect|me.Polygon|me.Line|me.Ellipse} shape a shape object\n         */\n        drawShape : function (shape) {\n            if (shape instanceof me.Rect) {\n                this.strokeRect(shape.left, shape.top, shape.width, shape.height);\n            } else if (shape instanceof me.Line || shape instanceof me.Polygon) {\n                this.save();\n                this.strokePolygon(shape);\n                this.restore();\n            } else if (shape instanceof me.Ellipse) {\n                this.save();\n                if (shape.radiusV.x === shape.radiusV.y) {\n                    // it's a circle\n                    this.strokeArc(\n                        shape.pos.x - shape.radius,\n                        shape.pos.y - shape.radius,\n                        shape.radius,\n                        0,\n                        2 * Math.PI\n                    );\n                } else {\n                    // it's an ellipse\n                    this.strokeEllipse(\n                        shape.pos.x,\n                        shape.pos.y,\n                        shape.radiusV.x,\n                        shape.radiusV.y\n                    );\n                }\n                this.restore();\n            }\n        },\n\n        /**\n         * Multiply given matrix into the renderer tranformation matrix\n         * @name multiplyMatrix\n         * @memberOf me.WebGLRenderer\n         * @function\n         * @param {me.Matrix2d} mat2d Matrix to transform by\n         */\n        transform : function (mat2d) {\n            this.globalMatrix.multiply(mat2d);\n        },\n\n        /**\n         * Translates the uniform matrix by the given coordinates\n         * @name translate\n         * @memberOf me.WebGLRenderer\n         * @function\n         * @param {Number} x\n         * @param {Number} y\n         */\n        translate : function (x, y) {\n            this.globalMatrix.translate(x, y);\n        }\n    });\n\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n    /**\n     * A Texture atlas object for WebGL <br>\n     * For portability, a global reference to this class is available through the default renderer: {@link me.video.renderer}.Texture <br>\n     * <br>\n     * Currently supports : <br>\n     * - [TexturePacker]{@link http://www.codeandweb.com/texturepacker/} : through JSON export <br>\n     * - [ShoeBox]{@link http://renderhjs.net/shoebox/} : through JSON export using the\n     * melonJS setting [file]{@link https://github.com/melonjs/melonJS/raw/master/media/shoebox_JSON_export.sbx} <br>\n     * - Standard (fixed cell size) spritesheet : through a {framewidth:xx, frameheight:xx} object\n     * @class\n     * @extends me.CanvasRenderer\n     * @memberOf me.WebGLRenderer\n     * @name Texture\n     * @constructor\n     * @param {Object} atlas atlas information. See {@link me.loader.getJSON}\n     * @param {Image} [texture=atlas.meta.image] texture name\n     * @param {Boolean} [cached=false] Use true to skip caching this Texture\n     * @example\n     * // create a texture atlas from a JSON Object\n     * texture = new me.video.renderer.Texture(\n     *     me.loader.getJSON(\"texture\"),\n     *     me.loader.getImage(\"texture\")\n     * );\n     *\n     * // create a texture atlas for a spritesheet\n     * texture = new me.video.renderer.Texture(\n     *     { framewidth : 32, frameheight : 32 },\n     *     me.loader.getImage(\"spritesheet\")\n     * );\n     */\n    me.WebGLRenderer.prototype.Texture = me.CanvasRenderer.prototype.Texture.extend(\n    /** @scope me.video.renderer.Texture.prototype */\n    {\n        /**\n         * @ignore\n         */\n        build : function (data) {\n            var w = data.meta.size.w;\n            var h = data.meta.size.h;\n            var atlas = me.CanvasRenderer.prototype.Texture.prototype.build.apply(this, [ data ]);\n\n            return this._addStMap(atlas, w, h);\n        },\n\n        /**\n         * @ignore\n         */\n        buildFromSpriteSheet : function (data) {\n            var w = data.image.width;\n            var h = data.image.height;\n            var atlas = me.CanvasRenderer.prototype.Texture.prototype.buildFromSpriteSheet.apply(this, [ data ]);\n\n            return this._addStMap(atlas, w, h);\n        },\n\n        /**\n         * @ignore\n         */\n        _addStMap : function (atlas, w, h) {\n            Object.keys(atlas).forEach(function (frame) {\n                // Source coordinates\n                var s = atlas[frame].offset;\n                var sw = atlas[frame].width;\n                var sh = atlas[frame].height;\n\n                // ST texture coordinates\n                atlas[frame].stMap = new Float32Array([\n                    s.x / w,        // Left\n                    s.y / h,        // Top\n                    (s.x + sw) / w, // Right\n                    (s.y + sh) / h  // Bottom\n                ]);\n\n                // Cache source coordinates\n                // TODO: Remove this when the Batcher only accepts a region name\n                var key = s.x + \",\" + s.y + \",\" + w + \",\" + h;\n                atlas[key] = atlas[frame];\n            });\n            return atlas;\n        },\n\n        /**\n         * @ignore\n         */\n        _insertRegion : function (name, x, y, w, h) {\n            var dw = this.texture.width;\n            var dh = this.texture.height;\n            this.atlas[name] = {\n                name    : name,\n                offset  : new me.Vector2d(x, y),\n                width   : w,\n                height  : h,\n                angle   : 0,\n                stMap   : new Float32Array([\n                    x / dw,         // Left\n                    y / dh,         // Top\n                    (x + w) / dw,   // Right\n                    (y + h) / dh    // Bottom\n                ])\n            };\n\n            return this.atlas[name];\n        }\n    });\n\n    /**\n    * Base class for Texture exception handling.\n    * @ignore\n    */\n    me.WebGLRenderer.prototype.Texture.Error = me.Error.extend({\n        init : function (msg) {\n            me.Error.prototype.init.apply(this, [ msg ]);\n            this.name = \"me.WebGLRenderer.Texture.Error\";\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015 Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n */\n(function () {\n\n    // Handy constants\n    var VERTEX_SIZE = 2;\n    var COLOR_SIZE = 4;\n    var TEXTURE_SIZE = 1;\n    var REGION_SIZE = 2;\n\n    var ELEMENT_SIZE = VERTEX_SIZE + COLOR_SIZE + TEXTURE_SIZE + REGION_SIZE;\n    var ELEMENT_OFFSET = ELEMENT_SIZE * Float32Array.BYTES_PER_ELEMENT;\n\n    var VERTEX_ELEMENT = 0;\n    var COLOR_ELEMENT = VERTEX_ELEMENT + VERTEX_SIZE;\n    var TEXTURE_ELEMENT = COLOR_ELEMENT + COLOR_SIZE;\n    var REGION_ELEMENT = TEXTURE_ELEMENT + TEXTURE_SIZE;\n\n    var VERTEX_OFFSET = VERTEX_ELEMENT * Float32Array.BYTES_PER_ELEMENT;\n    var COLOR_OFFSET = COLOR_ELEMENT * Float32Array.BYTES_PER_ELEMENT;\n    var TEXTURE_OFFSET = TEXTURE_ELEMENT * Float32Array.BYTES_PER_ELEMENT;\n    var REGION_OFFSET = REGION_ELEMENT * Float32Array.BYTES_PER_ELEMENT;\n\n    var ELEMENTS_PER_QUAD = 4;\n    var INDICES_PER_QUAD = 6;\n\n    var MAX_LENGTH = 16000;\n\n    /**\n     * A WebGL texture Compositor object. This class handles all of the WebGL state<br>\n     * Pushes texture regions into WebGL buffers, automatically flushes to GPU\n     * @extends Object\n     * @namespace me.WebGLRenderer.Compositor\n     * @memberOf me\n     * @constructor\n     * @param {WebGLContext} gl Destination WebGL Context\n     * @param {me.Matrix2d} matrix Global transformation matrix\n     * @param {me.Color} color Global color\n     */\n    me.WebGLRenderer.Compositor = me.Object.extend(\n    /** @scope me.WebGLRenderer.Compositor.prototype */\n    {\n        /**\n         * @ignore\n         */\n        init : function (gl, matrix, color) {\n            /**\n             * The number of quads held in the batch\n             * @name length\n             * @memberOf me.WebGLRenderer.Compositor\n             * @type Number\n             * @readonly\n             */\n            this.length = 0;\n\n            // Hash map of texture units\n            this.units = [];\n            /*\n             * XXX: The GLSL compiler pukes with \"memory exhausted\" when it is\n             * given long if-then-else chains.\n             *\n             * See: http://stackoverflow.com/questions/15828966/glsl-compile-error-memory-exhausted\n             *\n             * Workaround the problem by limiting the max texture support to 24.\n             * The magic number was determined by testing under different UAs.\n             * All Desktop UAs were capable of compiling with 27 fragment shader\n             * samplers. Using 24 seems like a reasonable compromise;\n             *\n             * 24 = 2^4 + 2^3\n             *\n             * As of July 2015, approximately 1.5% of all WebGL-enabled UAs\n             * support more than 24 max textures, according to\n             * http://webglstats.com/\n             */\n            this.maxTextures = Math.min(24, gl.getParameter(\n                gl.MAX_TEXTURE_IMAGE_UNITS\n            ));\n\n            // Vector pool\n            this.v = [\n                new me.Vector2d(),\n                new me.Vector2d(),\n                new me.Vector2d(),\n                new me.Vector2d()\n            ];\n\n            // WebGL context\n            this.gl = gl;\n\n            // Global transformation matrix\n            this.matrix = matrix;\n\n            // Global color\n            this.color = color;\n\n            // Uniform projection matrix\n            this.uMatrix = new me.Matrix2d();\n\n            // Detect GPU capabilities\n            var precision = (gl.getShaderPrecisionFormat(\n                gl.FRAGMENT_SHADER,\n                gl.HIGH_FLOAT\n            ).precision < 16) ? \"mediump\" : \"highp\";\n\n            // Load and create shader programs\n            this.lineShader = me.video.shader.createShader(\n                this.gl,\n                (function anonymous(ctx){var out='precision highp float;attribute vec2 aVertex;uniform mat3 uMatrix;void main(void){gl_Position=vec4((uMatrix*vec3(aVertex,1)).xy,0,1);}';return out;})(),\n                (function anonymous(ctx){var out='precision '+(ctx.precision)+' float;uniform vec4 uColor;void main(void){gl_FragColor=uColor;}';return out;})({\n                    \"precision\"     : precision\n                })\n            );\n            this.quadShader = me.video.shader.createShader(\n                this.gl,\n                (function anonymous(ctx){var out='precision highp float;attribute vec2 aVertex;attribute vec4 aColor;attribute float aTexture;attribute vec2 aRegion;uniform mat3 uMatrix;varying vec4 vColor;varying float vTexture;varying vec2 vRegion;void main(void){gl_Position=vec4((uMatrix*vec3(aVertex,1)).xy,0,1);vColor=vec4(aColor.rgb*aColor.a,aColor.a);vTexture=aTexture;vRegion=aRegion;}';return out;})(),\n                (function anonymous(ctx){var out='precision '+(ctx.precision)+' float;uniform sampler2D uSampler['+(ctx.maxTextures)+'];varying vec4 vColor;varying float vTexture;varying vec2 vRegion;void main(void){int texture=int(vTexture);if(texture==0){gl_FragColor=texture2D(uSampler[0],vRegion)*vColor;}';for(var i=1;i<ctx.maxTextures-1;i++){out+='else if(texture=='+(i)+'){gl_FragColor=texture2D(uSampler['+(i)+'],vRegion)*vColor;}';}out+='else{gl_FragColor=texture2D(uSampler['+(ctx.maxTextures-1)+'],vRegion)*vColor;}}';return out;})({\n                    \"precision\"     : precision,\n                    \"maxTextures\"   : this.maxTextures\n                })\n            );\n\n            this.shader = this.quadShader.handle;\n\n            // Stream buffer\n            this.sb = gl.createBuffer();\n            gl.bindBuffer(gl.ARRAY_BUFFER, this.sb);\n            gl.bufferData(\n                gl.ARRAY_BUFFER,\n                MAX_LENGTH * ELEMENT_OFFSET * ELEMENTS_PER_QUAD,\n                gl.STREAM_DRAW\n            );\n\n            this.sbSize = 256;\n            this.sbIndex = 0;\n\n            // Quad stream buffer\n            this.stream = new Float32Array(\n                this.sbSize * ELEMENT_SIZE * ELEMENTS_PER_QUAD\n            );\n\n            // Index buffer\n            this.ib = gl.createBuffer();\n            gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.ib);\n            gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, this.createIB(), gl.STATIC_DRAW);\n\n            // Bind attribute pointers for quad shader\n            gl.vertexAttribPointer(\n                this.quadShader.attributes.aVertex,\n                VERTEX_SIZE,\n                gl.FLOAT,\n                false,\n                ELEMENT_OFFSET,\n                VERTEX_OFFSET\n            );\n            gl.vertexAttribPointer(\n                this.quadShader.attributes.aColor,\n                COLOR_SIZE,\n                gl.FLOAT,\n                false,\n                ELEMENT_OFFSET,\n                COLOR_OFFSET\n            );\n            gl.vertexAttribPointer(\n                this.quadShader.attributes.aTexture,\n                TEXTURE_SIZE,\n                gl.FLOAT,\n                false,\n                ELEMENT_OFFSET,\n                TEXTURE_OFFSET\n            );\n            gl.vertexAttribPointer(\n                this.quadShader.attributes.aRegion,\n                REGION_SIZE,\n                gl.FLOAT,\n                false,\n                ELEMENT_OFFSET,\n                REGION_OFFSET\n            );\n\n            this.reset();\n            this.setProjection(gl.canvas.width, gl.canvas.height);\n\n            // Initialize clear color and blend function\n            gl.clearColor(0.0, 0.0, 0.0, 1.0);\n            gl.enable(gl.BLEND);\n            gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n            gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, 1);\n        },\n\n        /**\n         * Sets the projection matrix with the given size\n         * @name setProjection\n         * @memberOf me.WebGLRenderer.Compositor\n         * @function\n         * @param {Number} w WebGL Canvas width\n         * @param {Number} h WebGL Canvas height\n         */\n        setProjection : function (w, h) {\n            this.flush();\n            this.gl.viewport(0, 0, w, h);\n            this.uMatrix.set(\n                2 / w,  0,      0,\n                0,      -2 / h, 0,\n                -1,     1,      1\n            );\n            // FIXME: Configure the projection matrix in `useShader`\n            this.quadShader.uniforms.uMatrix = this.uMatrix.val;\n        },\n\n        /**\n         * @ignore\n         */\n        uploadTexture : function (texture, w, h, b, force) {\n            var unit = me.video.renderer.cache.getUnit(texture);\n            if (!this.units[unit] || force) {\n                this.units[unit] = true;\n                me.video.shader.createTexture(\n                    this.gl,\n                    unit,\n                    texture.texture,\n                    texture.repeat,\n                    w,\n                    h,\n                    b\n                );\n            }\n\n            return unit;\n        },\n\n        /**\n         * Reset compositor internal state\n         * @ignore\n         */\n        reset : function () {\n            this.sbIndex = 0;\n            this.length = 0;\n\n            var samplers = [];\n\n            for (var i = 0; i < this.maxTextures; i++) {\n                this.units[i] = false;\n                samplers[i] = i;\n            }\n\n            this.quadShader.uniforms.uSampler = samplers;\n        },\n\n        /**\n         * Create a full index buffer for the element array\n         * @ignore\n         */\n        createIB : function () {\n            var indices = [\n                0, 1, 2,\n                2, 1, 3\n            ];\n\n            // ~384KB index buffer\n            var data = new Array(MAX_LENGTH * INDICES_PER_QUAD);\n            for (var i = 0; i < data.length; i++) {\n                data[i] = indices[i % INDICES_PER_QUAD] +\n                    ~~(i / INDICES_PER_QUAD) * ELEMENTS_PER_QUAD;\n            }\n\n            return new Uint16Array(data);\n        },\n\n        /**\n         * Resize the stream buffer, retaining its original contents\n         * @ignore\n         */\n        resizeSB : function () {\n            this.sbSize <<= 1;\n            var stream = new Float32Array(this.sbSize * ELEMENT_SIZE * ELEMENTS_PER_QUAD);\n            stream.set(this.stream);\n            this.stream = stream;\n        },\n\n        /**\n         * Select the shader to use for compositing\n         * @name useShader\n         * @memberOf me.WebGLRenderer.Compositor\n         * @function\n         * @param {WebGLProgram} shader The shader program to use\n         */\n        useShader : function (shader) {\n            if (this.shader !== shader) {\n                this.flush();\n                this.shader = shader;\n                this.gl.useProgram(this.shader);\n            }\n        },\n\n        /**\n         * Add a textured quad\n         * @name addQuad\n         * @memberOf me.WebGLRenderer.Compositor\n         * @function\n         * @param {me.video.renderer.Texture} texture Source texture\n         * @param {String} key Source texture region name\n         * @param {Number} x Destination x-coordinate\n         * @param {Number} y Destination y-coordinate\n         * @param {Number} w Destination width\n         * @param {Number} h Destination height\n         */\n        addQuad : function (texture, key, x, y, w, h) {\n            var color = this.color.toGL();\n\n            if (color[3] < 1 / 255) {\n                // Fast path: don't send fully transparent quads\n                return;\n            }\n\n            this.useShader(this.quadShader.handle);\n            if (this.length >= MAX_LENGTH) {\n                this.flush();\n            }\n            if (this.length >= this.sbSize) {\n                this.resizeSB();\n            }\n\n            // Transform vertices\n            var m = this.matrix,\n                v0 = this.v[0].set(x, y),\n                v1 = this.v[1].set(x + w, y),\n                v2 = this.v[2].set(x, y + h),\n                v3 = this.v[3].set(x + w, y + h);\n\n            if (!m.isIdentity()) {\n                m.vectorMultiply(v0);\n                m.vectorMultiply(v1);\n                m.vectorMultiply(v2);\n                m.vectorMultiply(v3);\n            }\n\n            // Array index computation\n            var idx0 = this.sbIndex,\n                idx1 = idx0 + ELEMENT_SIZE,\n                idx2 = idx1 + ELEMENT_SIZE,\n                idx3 = idx2 + ELEMENT_SIZE;\n\n            // Fill vertex buffer\n            // FIXME: Pack each vertex vector into single float\n            this.stream[idx0 + VERTEX_ELEMENT + 0] = v0.x;\n            this.stream[idx0 + VERTEX_ELEMENT + 1] = v0.y;\n            this.stream[idx1 + VERTEX_ELEMENT + 0] = v1.x;\n            this.stream[idx1 + VERTEX_ELEMENT + 1] = v1.y;\n            this.stream[idx2 + VERTEX_ELEMENT + 0] = v2.x;\n            this.stream[idx2 + VERTEX_ELEMENT + 1] = v2.y;\n            this.stream[idx3 + VERTEX_ELEMENT + 0] = v3.x;\n            this.stream[idx3 + VERTEX_ELEMENT + 1] = v3.y;\n\n            // Fill color buffer\n            // FIXME: Pack color vector into single float\n            this.stream.set(color, idx0 + COLOR_ELEMENT);\n            this.stream.set(color, idx1 + COLOR_ELEMENT);\n            this.stream.set(color, idx2 + COLOR_ELEMENT);\n            this.stream.set(color, idx3 + COLOR_ELEMENT);\n\n            // Fill texture index buffer\n            // FIXME: Can the texture index be packed into another element?\n            var unit = this.uploadTexture(texture);\n            this.stream[idx0 + TEXTURE_ELEMENT] =\n            this.stream[idx1 + TEXTURE_ELEMENT] =\n            this.stream[idx2 + TEXTURE_ELEMENT] =\n            this.stream[idx3 + TEXTURE_ELEMENT] = unit;\n\n            // Get the source texture region\n            var region = texture.getRegion(key);\n            if (typeof(region) === \"undefined\") {\n                // TODO: Require proper atlas regions instead of caching arbitrary region keys\n                console.warn(\"Adding texture region\", key, \"for texture\", texture);\n\n                var keys = key.split(\",\"),\n                    sx = +keys[0],\n                    sy = +keys[1],\n                    sw = +keys[2],\n                    sh = +keys[3];\n                region = texture._insertRegion(key, sx, sy, sw, sh);\n            }\n\n            // Fill texture coordinates buffer\n            // FIXME: Pack each texture coordinate into single floats\n            var stMap = region.stMap;\n            this.stream[idx0 + REGION_ELEMENT + 0] = stMap[0];\n            this.stream[idx0 + REGION_ELEMENT + 1] = stMap[1];\n            this.stream[idx1 + REGION_ELEMENT + 0] = stMap[2];\n            this.stream[idx1 + REGION_ELEMENT + 1] = stMap[1];\n            this.stream[idx2 + REGION_ELEMENT + 0] = stMap[0];\n            this.stream[idx2 + REGION_ELEMENT + 1] = stMap[3];\n            this.stream[idx3 + REGION_ELEMENT + 0] = stMap[2];\n            this.stream[idx3 + REGION_ELEMENT + 1] = stMap[3];\n\n            this.sbIndex += ELEMENT_SIZE * ELEMENTS_PER_QUAD;\n            this.length++;\n        },\n\n        /**\n         * Flush batched texture operations to the GPU\n         * @name flush\n         * @memberOf me.WebGLRenderer.Compositor\n         * @function\n         */\n        flush : function () {\n            if (this.length) {\n                var gl = this.gl;\n\n                // Copy data into stream buffer\n                var len = this.length * ELEMENT_SIZE * ELEMENTS_PER_QUAD;\n                gl.bufferData(\n                    gl.ARRAY_BUFFER,\n                    this.stream.subarray(0, len),\n                    gl.STREAM_DRAW\n                );\n\n                // Draw the stream buffer\n                gl.drawElements(\n                    gl.TRIANGLES,\n                    this.length * INDICES_PER_QUAD,\n                    gl.UNSIGNED_SHORT,\n                    0\n                );\n\n                this.sbIndex = 0;\n                this.length = 0;\n            }\n        },\n\n        /**\n         * Draw a line\n         * @name drawLine\n         * @memberOf me.WebGLRenderer.Compositor\n         * @function\n         * @param {me.Vector2d[]} points Line vertices\n         * @param {Boolean} [open=false] Whether the line is open (true) or closed (false)\n         */\n        drawLine : function (points, open) {\n            this.useShader(this.lineShader.handle);\n\n            // Put vertex data into the stream buffer\n            var j = 0;\n            for (var i = 0; i < points.length; i++) {\n                if (!this.matrix.isIdentity()) {\n                    this.matrix.vectorMultiply(points[i]);\n                }\n                this.stream[j++] = points[i].x;\n                this.stream[j++] = points[i].y;\n            }\n\n            var gl = this.gl;\n\n            // FIXME\n            this.lineShader.uniforms.uMatrix = this.uMatrix.val;\n\n            // Set the line color\n            this.lineShader.uniforms.uColor = this.color.glArray;\n\n            // Copy data into the stream buffer\n            gl.bufferData(\n                gl.ARRAY_BUFFER,\n                this.stream.subarray(0, points.length * 2),\n                gl.STREAM_DRAW\n            );\n\n            // FIXME: Configure vertex attrib pointers in `useShader`\n            gl.vertexAttribPointer(\n                this.lineShader.attributes.aVertex,\n                VERTEX_SIZE,\n                gl.FLOAT,\n                false,\n                0,\n                0\n            );\n\n            // Draw the stream buffer\n            gl.drawArrays(open ? gl.LINE_STRIP : gl.LINE_LOOP, 0, points.length);\n\n            // FIXME: Configure vertex attrib pointers in `useShader`\n            gl.vertexAttribPointer(\n                this.quadShader.attributes.aVertex,\n                VERTEX_SIZE,\n                gl.FLOAT,\n                false,\n                ELEMENT_OFFSET,\n                VERTEX_OFFSET\n            );\n        },\n\n        /**\n         * Set the line width\n         * @name lineWidth\n         * @memberOf me.WebGLRenderer.Compositor\n         * @function\n         * @param {Number} width Line width\n         */\n        lineWidth : function (width) {\n            this.gl.lineWidth(width);\n        },\n\n        /**\n         * Clear the frame buffer, flushes the composite operations and calls\n         * gl.clear()\n         * @name clear\n         * @memberOf me.WebGLRenderer.Compositor\n         * @function\n         */\n        clear : function () {\n            this.flush();\n            this.gl.clear(this.gl.COLOR_BUFFER_BIT);\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org/\n *\n */\n(function () {\n    /**\n     * @namespace me.input\n     * @memberOf me\n     */\n    me.input = (function () {\n        // hold public stuff in our singleton\n        var api = {};\n\n        /*\n         * PRIVATE STUFF\n         */\n\n        /**\n         * prevent event propagation\n         * @ignore\n         */\n        api._preventDefault = function (e) {\n            // stop event propagation\n            if (e.stopPropagation) {\n                e.stopPropagation();\n            }\n            else {\n                e.cancelBubble = true;\n            }\n            // stop event default processing\n            if (e.preventDefault)  {\n                e.preventDefault();\n            }\n            else  {\n                e.returnValue = false;\n            }\n\n            return false;\n        };\n\n        /*\n         * PUBLIC STUFF\n         */\n\n        /**\n         * Global flag to specify if melonJS should prevent default browser action on registered key events <br>\n         * This is also configurable per key through the bindKey function\n         * default : true\n         * @public\n         * @type Boolean\n         * @name preventDefault\n         * @memberOf me.input\n         */\n        api.preventDefault = true;\n\n        // return our object\n        return api;\n    })();\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org/\n *\n */\n(function (api) {\n    /*\n     * PRIVATE STUFF\n     */\n\n    // list of binded keys\n    api._KeyBinding = {};\n\n    // corresponding actions\n    var keyStatus = {};\n\n    // lock enable flag for keys\n    var keyLock = {};\n    // actual lock status of each key\n    var keyLocked = {};\n\n    // List of binded keys being held\n    var keyRefs = {};\n\n    // whether default event should be prevented for a given keypress\n    var preventDefaultForKeys = {};\n\n    // some useful flags\n    var keyboardInitialized = false;\n\n    /**\n     * enable keyboard event\n     * @ignore\n     */\n    api._enableKeyboardEvent = function () {\n        if (!keyboardInitialized) {\n            window.addEventListener(\"keydown\", api._keydown, false);\n            window.addEventListener(\"keyup\", api._keyup, false);\n            keyboardInitialized = true;\n        }\n    };\n\n    /**\n     * key down event\n     * @ignore\n     */\n    api._keydown = function (e, keyCode, mouseButton) {\n\n        keyCode = keyCode || e.keyCode || e.which;\n        var action = api._KeyBinding[keyCode];\n\n        // publish a message for keydown event\n        me.event.publish(me.event.KEYDOWN, [\n            action,\n            keyCode,\n            action ? !keyLocked[action] : true\n        ]);\n\n        if (action) {\n            if (!keyLocked[action]) {\n                var trigger = mouseButton ? mouseButton : keyCode;\n                if (!keyRefs[action][trigger]) {\n                    keyStatus[action]++;\n                    keyRefs[action][trigger] = true;\n                }\n            }\n            // prevent event propagation\n            if (preventDefaultForKeys[keyCode]) {\n                return api._preventDefault(e);\n            }\n            else {\n                return true;\n            }\n        }\n\n        return true;\n    };\n\n\n    /**\n     * key up event\n     * @ignore\n     */\n    api._keyup = function (e, keyCode, mouseButton) {\n        keyCode = keyCode || e.keyCode || e.which;\n        var action = api._KeyBinding[keyCode];\n\n        // publish a message for keydown event\n        me.event.publish(me.event.KEYUP, [ action, keyCode ]);\n\n        if (action) {\n            var trigger = mouseButton ? mouseButton : keyCode;\n            keyRefs[action][trigger] = undefined;\n\n            if (keyStatus[action] > 0) {\n                keyStatus[action]--;\n            }\n\n            keyLocked[action] = false;\n\n            // prevent event propagation\n            if (preventDefaultForKeys[keyCode]) {\n                return api._preventDefault(e);\n            }\n            else {\n                return true;\n            }\n        }\n\n        return true;\n    };\n\n    /*\n     * PUBLIC STUFF\n     */\n\n    /**\n     * Almost all keyboard keys that have ASCII code, like:\n     * LEFT, UP, RIGHT, DOWN, ENTER, SHIFT, CTRL, ALT, ESC, SPACE, TAB, BACKSPACE, PAUSE,\n     * PAGE_UP, PAGE_DOWN, INSERT, DELETE, CAPS_LOCK, NUM_LOCK, SCROLL_LOCK, PRINT_SCREEN,\n     * Keys [0..9], [A..Z], [NUMPAD0..NUMPAD9], [F1..F12]\n     * @public\n     * @enum {number}\n     * @name KEY\n     * @memberOf me.input\n     */\n    api.KEY = {\n        \"BACKSPACE\" : 8,\n        \"TAB\" : 9,\n        \"ENTER\" : 13,\n        \"SHIFT\" : 16,\n        \"CTRL\" : 17,\n        \"ALT\" : 18,\n        \"PAUSE\" : 19,\n        \"CAPS_LOCK\" : 20,\n        \"ESC\" : 27,\n        \"SPACE\" : 32,\n        \"PAGE_UP\" : 33,\n        \"PAGE_DOWN\" : 34,\n        \"END\" : 35,\n        \"HOME\" : 36,\n        \"LEFT\" : 37,\n        \"UP\" : 38,\n        \"RIGHT\" : 39,\n        \"DOWN\" : 40,\n        \"PRINT_SCREEN\" : 42,\n        \"INSERT\" : 45,\n        \"DELETE\" : 46,\n        \"NUM0\" : 48,\n        \"NUM1\" : 49,\n        \"NUM2\" : 50,\n        \"NUM3\" : 51,\n        \"NUM4\" : 52,\n        \"NUM5\" : 53,\n        \"NUM6\" : 54,\n        \"NUM7\" : 55,\n        \"NUM8\" : 56,\n        \"NUM9\" : 57,\n        \"A\" : 65,\n        \"B\" : 66,\n        \"C\" : 67,\n        \"D\" : 68,\n        \"E\" : 69,\n        \"F\" : 70,\n        \"G\" : 71,\n        \"H\" : 72,\n        \"I\" : 73,\n        \"J\" : 74,\n        \"K\" : 75,\n        \"L\" : 76,\n        \"M\" : 77,\n        \"N\" : 78,\n        \"O\" : 79,\n        \"P\" : 80,\n        \"Q\" : 81,\n        \"R\" : 82,\n        \"S\" : 83,\n        \"T\" : 84,\n        \"U\" : 85,\n        \"V\" : 86,\n        \"W\" : 87,\n        \"X\" : 88,\n        \"Y\" : 89,\n        \"Z\" : 90,\n        \"WINDOW_KEY\" : 91,\n        \"NUMPAD0\" : 96,\n        \"NUMPAD1\" : 97,\n        \"NUMPAD2\" : 98,\n        \"NUMPAD3\" : 99,\n        \"NUMPAD4\" : 100,\n        \"NUMPAD5\" : 101,\n        \"NUMPAD6\" : 102,\n        \"NUMPAD7\" : 103,\n        \"NUMPAD8\" : 104,\n        \"NUMPAD9\" : 105,\n        \"MULTIPLY\" : 106,\n        \"ADD\" : 107,\n        \"SUBSTRACT\" : 109,\n        \"DECIMAL\" : 110,\n        \"DIVIDE\" : 111,\n        \"F1\" : 112,\n        \"F2\" : 113,\n        \"F3\" : 114,\n        \"F4\" : 115,\n        \"F5\" : 116,\n        \"F6\" : 117,\n        \"F7\" : 118,\n        \"F8\" : 119,\n        \"F9\" : 120,\n        \"F10\" : 121,\n        \"F11\" : 122,\n        \"F12\" : 123,\n        \"NUM_LOCK\" : 144,\n        \"SCROLL_LOCK\" : 145,\n        \"SEMICOLON\" : 186,\n        \"PLUS\" : 187,\n        \"COMMA\" : 188,\n        \"MINUS\" : 189,\n        \"PERIOD\" : 190,\n        \"FORWAND_SLASH\" : 191,\n        \"GRAVE_ACCENT\" : 192,\n        \"OPEN_BRACKET\" : 219,\n        \"BACK_SLASH\" : 220,\n        \"CLOSE_BRACKET\" : 221,\n        \"SINGLE_QUOTE\" : 222\n    };\n\n    /**\n     * return the key press status of the specified action\n     * @name isKeyPressed\n     * @memberOf me.input\n     * @public\n     * @function\n     * @param {String} action user defined corresponding action\n     * @return {Boolean} true if pressed\n     * @example\n     * if (me.input.isKeyPressed('left'))\n     * {\n     *    //do something\n     * }\n     * else if (me.input.isKeyPressed('right'))\n     * {\n     *    //do something else...\n     * }\n     *\n     */\n    api.isKeyPressed = function (action) {\n        if (keyStatus[action] && !keyLocked[action]) {\n            if (keyLock[action]) {\n                keyLocked[action] = true;\n            }\n            return true;\n        }\n        return false;\n    };\n\n    /**\n     * return the key status of the specified action\n     * @name keyStatus\n     * @memberOf me.input\n     * @public\n     * @function\n     * @param {String} action user defined corresponding action\n     * @return {Boolean} down (true) or up(false)\n     */\n    api.keyStatus = function (action) {\n        return (keyStatus[action] > 0);\n    };\n\n\n    /**\n     * trigger the specified key (simulated) event <br>\n     * @name triggerKeyEvent\n     * @memberOf me.input\n     * @public\n     * @function\n     * @param {me.input.KEY} keycode\n     * @param {Boolean} true to trigger a key press, or false for key release\n     * @example\n     * // trigger a key press\n     * me.input.triggerKeyEvent(me.input.KEY.LEFT, true);\n     */\n\n    api.triggerKeyEvent = function (keycode, status) {\n        if (status) {\n            api._keydown({}, keycode);\n        }\n        else {\n            api._keyup({}, keycode);\n        }\n    };\n\n\n    /**\n     * associate a user defined action to a keycode\n     * @name bindKey\n     * @memberOf me.input\n     * @public\n     * @function\n     * @param {me.input.KEY} keycode\n     * @param {String} action user defined corresponding action\n     * @param {Boolean} [lock=false] cancel the keypress event once read\n     * @param {Boolean} [preventDefault=me.input.preventDefault] prevent default browser action\n     * @example\n     * // enable the keyboard\n     * me.input.bindKey(me.input.KEY.LEFT,  \"left\");\n     * me.input.bindKey(me.input.KEY.RIGHT, \"right\");\n     * me.input.bindKey(me.input.KEY.X,     \"jump\", true);\n     * me.input.bindKey(me.input.KEY.F1,    \"options\", true, true);\n     */\n    api.bindKey = function (keycode, action, lock, preventDefault) {\n        // make sure the keyboard is enable\n        api._enableKeyboardEvent();\n\n        if (typeof preventDefault !== \"boolean\") {\n            preventDefault = api.preventDefault;\n        }\n\n        api._KeyBinding[keycode] = action;\n        preventDefaultForKeys[keycode] = preventDefault;\n\n        keyStatus[action] = 0;\n        keyLock[action] = lock ? lock : false;\n        keyLocked[action] = false;\n        keyRefs[action] = {};\n    };\n\n    /**\n     * unlock a key manually\n     * @name unlockKey\n     * @memberOf me.input\n     * @public\n     * @function\n     * @param {String} action user defined corresponding action\n     * @example\n     * // Unlock jump when touching the ground\n     * if (!this.falling && !this.jumping) {\n     *     me.input.unlockKey(\"jump\");\n     * }\n     */\n    api.unlockKey = function (action) {\n        keyLocked[action] = false;\n    };\n\n    /**\n     * unbind the defined keycode\n     * @name unbindKey\n     * @memberOf me.input\n     * @public\n     * @function\n     * @param {me.input.KEY} keycode\n     * @example\n     * me.input.unbindKey(me.input.KEY.LEFT);\n     */\n    api.unbindKey = function (keycode) {\n        // clear the event status\n        var keybinding = api._KeyBinding[keycode];\n        keyStatus[keybinding] = 0;\n        keyLock[keybinding] = false;\n        keyRefs[keybinding] = {};\n        // remove the key binding\n        api._KeyBinding[keycode] = null;\n        preventDefaultForKeys[keycode] = null;\n    };\n})(me.input);\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org/\n *\n */\n(function (api) {\n    /**\n     * The built in Event Object\n     * @external Event\n     * @see {@link https://developer.mozilla.org/en/docs/Web/API/Event|Event}\n     */\n\n    /**\n     * Event normalized X coordinate within the game canvas itself<br>\n     * <img src=\"images/event_coord.png\"/>\n     * @memberof! external:Event#\n     * @name external:Event#gameX\n     * @type {Number}\n     */\n\n    /**\n     * Event normalized Y coordinate within the game canvas itself<br>\n     * <img src=\"images/event_coord.png\"/>\n     * @memberof! external:Event#\n     * @name external:Event#gameY\n     * @type {Number}\n     */\n\n    /**\n     * Event X coordinate relative to the viewport<br>\n     * @memberof! external:Event#\n     * @name external:Event#gameScreenX\n     * @type {Number}\n     */\n\n    /**\n     * Event Y coordinate relative to the viewport<br>\n     * @memberof! external:Event#\n     * @name external:Event#gameScreenY\n     * @type {Number}\n     */\n\n    /**\n     * Event X coordinate relative to the map<br>\n     * @memberof! external:Event#\n     * @name external:Event#gameWorldX\n     * @type {Number}\n     */\n\n    /**\n     * Event Y coordinate relative to the map<br>\n     * @memberof! external:Event#\n     * @name external:Event#gameWorldY\n     * @type {Number}\n     */\n\n    /**\n     * The unique identifier of the contact for a touch, mouse or pen <br>\n     * (This id is also defined on non Pointer Event Compatible platform like pure mouse or iOS-like touch event)\n     * @memberof! external:Event#\n     * @name external:Event#pointerId\n     * @type {Number}\n     * @see http://msdn.microsoft.com/en-us/library/windows/apps/hh466123.aspx\n     */\n\n    /*\n     * PRIVATE STUFF\n     */\n\n    /**\n     * A pool of `Vector` objects to cache pointer/touch event coordinates.\n     * @type {Array.<Vector>}\n     */\n    var T_VECTORS = [];\n    for (var v = 0; v < 10; v++) { T_VECTORS.push(new me.Vector2d()); }\n\n    // list of registered Event handlers\n    var evtHandlers = new Map();\n\n    // current pointer\n    var currentPointer = new me.Rect(0, 0, 1, 1);\n\n    // some useful flags\n    var pointerInitialized = false;\n\n    // to keep track of the supported wheel event\n    var wheeltype = \"mousewheel\";\n\n    // Track last event timestamp to prevent firing events out of order\n    var lastTimeStamp = 0;\n\n    // \"active\" list of supported events\n    var activeEventList = null;\n\n    // list of standard pointer event type\n    var pointerEventList = [\n        \"mousewheel\",\n        \"pointermove\",\n        \"pointerdown\",\n        \"pointerup\",\n        \"pointercancel\",\n        \"pointerenter\",\n        \"pointerleave\"\n    ];\n\n    // previous MS prefixed pointer event type\n    var MSPointerEventList = [\n        \"mousewheel\",\n        \"MSPointerMove\",\n        \"MSPointerDown\",\n        \"MSPointerUp\",\n        \"MSPointerCancel\",\n        \"MSPointerEnter\",\n        \"MSPointerLeave\"\n    ];\n\n    // legacy mouse event type\n    var mouseEventList = [\n        \"mousewheel\",\n        \"mousemove\",\n        \"mousedown\",\n        \"mouseup\",\n        \"mousecancel\",\n        \"mouseenter\",\n        \"mouseleave\"\n    ];\n\n    // iOS style touch event type\n    var touchEventList = [\n        undefined,\n        \"touchmove\",\n        \"touchstart\",\n        \"touchend\",\n        \"touchcancel\",\n        \"touchenter\",\n        \"touchleave\"\n    ];\n\n    // internal constants\n    // var MOUSE_WHEEL   = 0;\n    var POINTER_MOVE    = 1;\n    var POINTER_DOWN    = 2;\n    var POINTER_UP      = 3;\n    var POINTER_CANCEL  = 4;\n    var POINTER_ENTER   = 5;\n    var POINTER_LEAVE   = 6;\n\n    /**\n     * cache value for the offset of the canvas position within the page\n     * @ignore\n     */\n    var viewportOffset = new me.Vector2d();\n\n    /**\n     * Array of object containing changed touch information (iOS event model)\n     * @ignore\n     */\n    var changedTouches = [];\n\n    /**\n     * cache value for the offset of the canvas position within the page\n     * @ignore\n     */\n    api._offset = null;\n\n    /**\n     * addEventListerner for the specified event list and callback\n     * @ignore\n     */\n    function registerEventListener(eventList, callback) {\n        for (var x = 2; x < eventList.length; ++x) {\n            if (typeof(eventList[x]) !== \"undefined\") {\n                me.video.renderer.getScreenCanvas().addEventListener(eventList[x], callback, false);\n            }\n        }\n    }\n\n    /**\n     * enable pointer event (MSPointer/Mouse/Touch)\n     * @ignore\n     */\n    function enablePointerEvent() {\n        if (!pointerInitialized) {\n            // get relative canvas position in the page\n            api._offset = me.video.getPos();\n            // Automatically update relative canvas position on scroll\n            window.addEventListener(\"scroll\", throttle(100, false,\n                function (e) {\n                    api._offset = me.video.getPos();\n                    me.event.publish(me.event.WINDOW_ONSCROLL, [ e ]);\n                }\n            ), false);\n\n            // check standard\n            if (navigator.pointerEnabled) {\n                activeEventList = pointerEventList;\n            }\n            else if (navigator.msPointerEnabled) { // check for backward compatibility with the 'MS' prefix\n                activeEventList = MSPointerEventList;\n            }\n            else if (me.device.touch) { //  `touch****` events for iOS/Android devices\n                activeEventList = touchEventList;\n            }\n            else { // Regular Mouse events\n                activeEventList = mouseEventList;\n            }\n\n            registerEventListener(activeEventList, onPointerEvent);\n\n            // detect wheel event support\n            // Modern browsers support \"wheel\", Webkit and IE support at least \"mousewheel\n            wheeltype = \"onwheel\" in document.createElement(\"div\") ? \"wheel\" : \"mousewheel\";\n            window.addEventListener(wheeltype, onMouseWheel, false);\n\n            // set the PointerMove/touchMove/MouseMove event\n            if (typeof(api.throttlingInterval) === \"undefined\") {\n                // set the default value\n                api.throttlingInterval = ~~(1000 / me.sys.fps);\n            }\n            // if time interval <= 16, disable the feature\n            if (api.throttlingInterval < 17) {\n                me.video.renderer.getScreenCanvas().addEventListener(\n                    activeEventList[POINTER_MOVE],\n                    onMoveEvent,\n                    false\n                );\n            }\n            else {\n                me.video.renderer.getScreenCanvas().addEventListener(\n                    activeEventList[POINTER_MOVE],\n                    throttle(\n                        api.throttlingInterval,\n                        false,\n                        function (e) {\n                            onMoveEvent(e);\n                        }\n                    ),\n                    false\n                );\n            }\n            pointerInitialized = true;\n        }\n    }\n\n    /**\n     * @ignore\n     */\n    function triggerEvent(handlers, type, e, pointerId) {\n        var callback;\n        if (handlers.callbacks[type]) {\n            handlers.pointerId = pointerId;\n            for (var i = handlers.callbacks[type].length - 1; (callback = handlers.callbacks[type][i]); i--) {\n                if (callback(e) === false) {\n                    // stop propagating the event if return false\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n\n    /**\n     * propagate events to registered objects\n     * @ignore\n     */\n    function dispatchEvent(e) {\n        var handled = false;\n        \n        // get the current screen to world offset\n        me.game.viewport.localToWorld(0, 0, viewportOffset);\n        \n        while (changedTouches.length > 0) {\n\n            // keep a reference to the last item\n            var changedTouch = changedTouches.pop();\n            // and put it back into our cache\n            T_VECTORS.push(changedTouch);\n            \n            // Do not fire older events\n            if (typeof(e.timeStamp) !== \"undefined\") {\n                if (e.timeStamp < lastTimeStamp) {   \n                    continue;\n                }\n                lastTimeStamp = e.timeStamp;\n            }\n\n            // if PointerEvent is not supported\n            if (!me.device.pointerEnabled) {\n                // -> define pointerId to simulate the PointerEvent standard\n                e.pointerId = changedTouch.id;\n            }\n\n            /* Initialize the two coordinate space properties. */\n            e.gameScreenX = changedTouch.x;\n            e.gameScreenY = changedTouch.y;\n            e.gameWorldX = e.gameScreenX + viewportOffset.x;\n            e.gameWorldY = e.gameScreenY + viewportOffset.y;\n\n            currentPointer.setShape(\n                e.gameWorldX, \n                e.gameWorldY, \n                e.width || 1, \n                e.height || 1\n            );\n            \n            var candidates = me.collision.quadTree.retrieve(currentPointer, me.Container._sortZ);\n            \n            // add the viewport to the list of candidates\n            candidates.push ( me.game.viewport );\n\n            for (var c = candidates.length, candidate; c--, (candidate = candidates[c]);) {\n            \n                if (evtHandlers.has(candidate)) {\n                    var handlers = evtHandlers.get(candidate);                        \n                    var region = handlers.region;\n                    var bounds = region.getBounds();\n                    \n                    if (region.floating === true) {\n                        e.gameX = e.gameScreenX;\n                        e.gameY = e.gameScreenY;\n                    } else {\n                        e.gameX = e.gameWorldX;\n                        e.gameY = e.gameWorldY;\n                    }\n\n                    var eventInBounds =\n                        // check the shape bounding box first\n                        bounds.containsPoint(e.gameX, e.gameY) &&\n                        // then check more precisely if needed\n                        (bounds === region || region.containsPoint(e.gameX, e.gameY));\n\n                    switch (activeEventList.indexOf(e.type)) {\n                        case POINTER_MOVE:\n                            // moved out of bounds: trigger the POINTER_LEAVE callbacks\n                            if (handlers.pointerId === e.pointerId && !eventInBounds) {\n                                if (triggerEvent(handlers, activeEventList[POINTER_LEAVE], e, null)) {\n                                    handled = true;\n                                    break;\n                                }\n                            }\n                            // no pointer & moved inside of bounds: trigger the POINTER_ENTER callbacks\n                            else if (handlers.pointerId === null && eventInBounds) {\n                                if (triggerEvent(handlers, activeEventList[POINTER_ENTER], e, e.pointerId)) {\n                                    handled = true;\n                                    break;\n                                }\n                            }\n\n                            // trigger the POINTER_MOVE callbacks\n                            if (eventInBounds && triggerEvent(handlers, e.type, e, e.pointerId)) {\n                                handled = true;\n                                break;\n                            }\n                            break;\n\n                        case POINTER_UP:\n                            // pointer defined & inside of bounds: trigger the POINTER_UP callback\n                            if (handlers.pointerId === e.pointerId && eventInBounds) {\n                                // trigger the corresponding callback\n                                if (triggerEvent(handlers, e.type, e, null)) {\n                                    handled = true;\n                                    break;\n                                }\n                            }\n                            break;\n\n                        case POINTER_CANCEL:\n                            // pointer defined: trigger the POINTER_CANCEL callback\n                            if (handlers.pointerId === e.pointerId) {\n                                // trigger the corresponding callback\n                                if (triggerEvent(handlers, e.type, e, null)) {\n                                    handled = true;\n                                    break;\n                                }\n                            }\n                            break;\n\n                        default:\n                            // event inside of bounds: trigger the POINTER_DOWN or MOUSE_WHEEL callback\n                            if (eventInBounds) {\n                                \n                                // trigger the corresponding callback\n                                if (triggerEvent(handlers, e.type, e, e.pointerId)) {\n                                    handled = true;\n                                    break;\n                                }\n                            }\n                            break;\n                    }                \n                }      \n                if (handled === true) {\n                    // stop iterating through this list of candidates\n                    break;\n                }\n            }\n        }\n        return handled;\n    }\n\n    /**\n     * translate event coordinates\n     * @ignore\n     */\n    function updateCoordFromEvent(event) {\n        var local = T_VECTORS.pop();\n\n        // PointerEvent or standard Mouse event\n        if (!event.touches) {\n            api.globalToLocal(event.clientX, event.clientY, local);\n            local.id = event.pointerId || 1;\n            changedTouches.push(local);\n        }\n        // iOS/Android like touch event\n        else {\n            for (var i = 0, l = event.changedTouches.length; i < l; i++) {\n                var t = event.changedTouches[i];\n                api.globalToLocal(t.clientX, t.clientY, local);\n                local.id = t.identifier;\n                changedTouches.push(local);\n            }\n        }\n        // if event.isPrimary is defined and false, return\n        if (event.isPrimary === false) {\n            return;\n        }\n\n        // Else use the first entry to simulate mouse event\n        api.pointer.pos.set(\n            changedTouches[0].x,\n            changedTouches[0].y\n        );\n\n        if (typeof(event.width) === \"number\") {\n            // resize the pointer object if necessary\n            if (event.width !== api.pointer.width || event.height !== api.pointer.height) {\n                api.pointer.resize(event.width || 1, event.height || 1);\n            }\n        }\n    }\n\n\n    /**\n     * mouse event management (mousewheel)\n     * @ignore\n     */\n    function onMouseWheel(e) {\n        /* jshint expr:true */\n        if (e.target === me.video.renderer.getScreenCanvas()) {\n            // create a (fake) normalized event object\n            var _event = {\n                deltaMode : 1,\n                type : \"mousewheel\",\n                deltaX: e.deltaX,\n                deltaY: e.deltaY,\n                deltaZ: e.deltaZ\n            };\n            if (wheeltype === \"mousewheel\") {\n                _event.deltaY = - 1 / 40 * e.wheelDelta;\n                // Webkit also support wheelDeltaX\n                e.wheelDeltaX && (_event.deltaX = - 1 / 40 * e.wheelDeltaX);\n            }\n            // dispatch mouse event to registered object\n            if (dispatchEvent(_event)) {\n                // prevent default action\n                return api._preventDefault(e);\n            }\n        }\n        return true;\n    }\n\n\n    /**\n     * mouse/touch/pointer event management (move)\n     * @ignore\n     */\n    function onMoveEvent(e) {\n        // update position\n        updateCoordFromEvent(e);\n        // dispatch mouse event to registered object\n        if (dispatchEvent(e)) {\n            // prevent default action\n            return api._preventDefault(e);\n        }\n        return true;\n    }\n\n    /**\n     * mouse/touch/pointer event management (start/down, end/up)\n     * @ignore\n     */\n    function onPointerEvent(e) {\n        // update the pointer position\n        updateCoordFromEvent(e);\n\n        // dispatch event to registered objects\n        if (dispatchEvent(e)) {\n            // prevent default action\n            return api._preventDefault(e);\n        }\n\n        // in case of touch event button is undefined\n        var button = e.button || 0;\n        var keycode = api.pointer.bind[button];\n\n        // check if mapped to a key\n        if (keycode) {\n            if (e.type === activeEventList[POINTER_DOWN]) {\n                return api._keydown(e, keycode, button + 1);\n            }\n            else { // 'mouseup' or 'touchend'\n                return api._keyup(e, keycode, button + 1);\n            }\n        }\n\n        return true;\n    }\n\n    /*\n     * PUBLIC STUFF\n     */\n\n    /**\n     * Pointer information (current position and size) <br>\n     * properties : <br>\n     * LEFT : constant for left button <br>\n     * MIDDLE : constant for middle button <br>\n     * RIGHT : constant for right button\n     * @public\n     * @type {me.Rect}\n     * @name pointer\n     * @memberOf me.input\n     */\n    api.pointer = new me.Rect(0, 0, 1, 1);\n    \n    // bind list for mouse buttons\n    api.pointer.bind = [ 0, 0, 0 ];\n\n    // W3C button constants\n    api.pointer.LEFT = 0;\n    api.pointer.MIDDLE = 1;\n    api.pointer.RIGHT = 2;\n\n    /**\n     * time interval for event throttling in milliseconds<br>\n     * default value : \"1000/me.sys.fps\" ms<br>\n     * set to 0 ms to disable the feature\n     * @public\n     * @type Number\n     * @name throttlingInterval\n     * @memberOf me.input\n     */\n    api.throttlingInterval = undefined;\n\n    /**\n     * Translate the specified x and y values from the global (absolute)\n     * coordinate to local (viewport) relative coordinate.\n     * @name globalToLocal\n     * @memberOf me.input\n     * @public\n     * @function\n     * @param {Number} x the global x coordinate to be translated.\n     * @param {Number} y the global y coordinate to be translated.\n     * @param {Number} [v] an optional vector object where to set the\n     * @return {me.Vector2d} A vector object with the corresponding translated coordinates.\n     * @example\n     * onMouseEvent : function (e) {\n     *    // convert the given into local (viewport) relative coordinates\n     *    var pos = me.input.globalToLocal(e.clientX, e,clientY);\n     *    // do something with pos !\n     * };\n     */\n    api.globalToLocal = function (x, y, v) {\n        v = v || new me.Vector2d();\n        var offset = api._offset;\n        var pixelRatio = me.device.getPixelRatio();\n        x -= offset.left;\n        y -= offset.top;\n        var scale = me.sys.scale;\n        if (scale.x !== 1.0 || scale.y !== 1.0) {\n            x /= scale.x;\n            y /= scale.y;\n        }\n        return v.set(x * pixelRatio, y * pixelRatio);\n    };\n\n    /**\n     * Associate a pointer event to a keycode<br>\n     * Left button – 0\n     * Middle button – 1\n     * Right button – 2\n     * @name bindPointer\n     * @memberOf me.input\n     * @public\n     * @function\n     * @param {Number} [button=me.input.pointer.LEFT] (accordingly to W3C values : 0,1,2 for left, middle and right buttons)\n     * @param {me.input.KEY} keyCode\n     * @example\n     * // enable the keyboard\n     * me.input.bindKey(me.input.KEY.X, \"shoot\");\n     * // map the left button click on the X key (default if the button is not specified)\n     * me.input.bindPointer(me.input.KEY.X);\n     * // map the right button click on the X key\n     * me.input.bindPointer(me.input.pointer.RIGHT, me.input.KEY.X);\n     */\n    api.bindPointer = function () {\n        var button = (arguments.length < 2) ? api.pointer.LEFT : arguments[0];\n        var keyCode = (arguments.length < 2) ? arguments[0] : arguments[1];\n\n        // make sure the mouse is initialized\n        enablePointerEvent();\n\n        // throw an exception if no action is defined for the specified keycode\n        if (!api._KeyBinding[keyCode]) {\n            throw new me.Error(\"no action defined for keycode \" + keyCode);\n        }\n        // map the mouse button to the keycode\n        api.pointer.bind[button] = keyCode;\n    };\n    /**\n     * unbind the defined keycode\n     * @name unbindPointer\n     * @memberOf me.input\n     * @public\n     * @function\n     * @param {Number} [button=me.input.pointer.LEFT] (accordingly to W3C values : 0,1,2 for left, middle and right buttons)\n     * @example\n     * me.input.unbindPointer(me.input.pointer.LEFT);\n     */\n    api.unbindPointer = function (button) {\n        // clear the event status\n        api.pointer.bind[\n            typeof(button) === \"undefined\" ?\n            api.pointer.LEFT : button\n        ] = null;\n    };\n\n\n    /**\n     * allows registration of event listeners on the object target. <br>\n     * melonJS defines the additional `gameX` and `gameY` properties when passing the Event object to the defined callback (see below)<br>\n     * @see external:Event\n     * @see {@link http://www.w3.org/TR/pointerevents/#list-of-pointer-events|W3C Pointer Event list}\n     * @name registerPointerEvent\n     * @memberOf me.input\n     * @public\n     * @function\n     * @param {String} eventType The event type for which the object is registering <br>\n     * melonJS currently supports: <br>\n     * <ul>\n     *   <li><code>\"pointermove\"</code></li>\n     *   <li><code>\"pointerdown\"</code></li>\n     *   <li><code>\"pointerup\"</code></li>\n     *   <li><code>\"pointerenter\"</code></li>\n     *   <li><code>\"pointerleave\"</code></li>\n     *   <li><code>\"pointercancel\"</code></li>\n     *   <li><code>\"mousewheel\"</code></li>\n     * </ul>\n     * @param {me.Rect|me.Polygon|me.Line|me.Ellipse} region a shape representing the region to register on\n     * @param {Function} callback methods to be called when the event occurs.\n     * @example\n     * // register on the 'pointerdown' event\n     * me.input.registerPointerEvent('pointerdown', this, this.pointerDown.bind(this));\n     */\n    api.registerPointerEvent = function (eventType, region, callback) {\n        // make sure the mouse/touch events are initialized\n        enablePointerEvent();\n\n        if (pointerEventList.indexOf(eventType) === -1) {\n            throw new me.Error(\"invalid event type : \" + eventType);\n        }\n\n        // convert to supported event type if pointerEvent not natively supported\n        if (pointerEventList !== activeEventList) {\n            eventType = activeEventList[pointerEventList.indexOf(eventType)];\n        }\n\n        // register the event\n        if (!evtHandlers.has(region)) {\n            evtHandlers.set(region, {\n                region : region,\n                callbacks : {},\n                pointerId : null,\n            });\n        }\n\n        // allocate array if not defined\n        var handlers = evtHandlers.get(region);\n        if (!handlers.callbacks[eventType]) {\n            handlers.callbacks[eventType] = [];\n        }\n\n        // initialize the handler\n        handlers.callbacks[eventType].push(callback);\n    };\n\n    /**\n     * allows the removal of event listeners from the object target.\n     * @see {@link http://www.w3.org/TR/pointerevents/#list-of-pointer-events|W3C Pointer Event list}\n     * @name releasePointerEvent\n     * @memberOf me.input\n     * @public\n     * @function\n     * @param {String} eventType The event type for which the object was registered. See {@link me.input.registerPointerEvent}\n     * @param {me.Rect|me.Polygon|me.Line|me.Ellipse} region the registered region to release for this event\n     * @param {Function} [callback=\"all\"] if specified unregister the event only for the specific callback\n     * @example\n     * // release the registered region on the 'pointerdown' event\n     * me.input.releasePointerEvent('pointerdown', this);\n     */\n    api.releasePointerEvent = function (eventType, region, callback) {\n        if (pointerEventList.indexOf(eventType) === -1) {\n            throw new me.Error(\"invalid event type : \" + eventType);\n        }\n\n        // convert to supported event type if pointerEvent not natively supported\n        if (pointerEventList !== activeEventList) {\n            eventType = activeEventList[pointerEventList.indexOf(eventType)];\n        }\n\n        var handlers = evtHandlers.get(region);\n        if (typeof(callback) === \"undefined\") {\n            // unregister all callbacks of \"eventType\" for the given region\n            while (handlers.callbacks[eventType].length > 0) {\n                handlers.callbacks[eventType].pop();\n            }\n        } else {\n            handlers.callbacks[eventType].remove(callback);\n        }\n    };\n\n    /**\n     * Will translate global (frequently used) pointer events\n     * which should be catched at root level, into minipubsub system events\n     * @name _translatePointerEvents\n     * @memberOf me.input\n     * @ignore\n     * @function\n     */\n    api._translatePointerEvents = function () {\n        // listen to mouse move (and touch move) events on the viewport\n        // and convert them to a system event by default\n        api.registerPointerEvent(\"pointermove\", me.game.viewport, function (e) {\n            me.event.publish(me.event.POINTERMOVE, [e]);\n        });\n    };\n})(me.input);\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org/\n *\n */\n(function (api) {\n    /*\n     * PRIVATE STUFF\n     */\n\n    // Analog deadzone\n    var deadzone = 0.1;\n\n    /**\n     * A function that returns a normalized value in range [-1.0..1.0], or 0.0 if the axis is unknown.\n     * @callback me.input~normalize_fn\n     * @param {Number} value The raw value read from the gamepad driver\n     * @param {Number} axis The axis index from the standard mapping, or -1 if not an axis\n     * @param {Number} button The button index from the standard mapping, or -1 if not a button\n     */\n    function defaultNormalizeFn(value) {\n        return value;\n    }\n\n    /**\n     * Normalize axis values for wired Xbox 360\n     * @ignore\n     */\n    function wiredXbox360NormalizeFn(value, axis, button) {\n        if (button === api.GAMEPAD.BUTTONS.L2 || button === api.GAMEPAD.BUTTONS.R2) {\n            return (value + 1) / 2;\n        }\n        return value;\n    }\n\n    /**\n     * Normalize axis values for OUYA\n     * @ignore\n     */\n    function ouyaNormalizeFn(value, axis, button) {\n        if (value > 0) {\n            if (button === api.GAMEPAD.BUTTONS.L2) {\n                // L2 is wonky; seems like the deadzone is around 20000\n                // (That's over 15% of the total range!)\n                value = Math.max(0, value - 20000) / 111070;\n            }\n            else {\n                // Normalize [1..65536] => [0.0..0.5]\n                value = (value - 1) / 131070;\n            }\n        }\n        else {\n            // Normalize [-65536..-1] => [0.5..1.0]\n            value = (65536 + value) / 131070 + 0.5;\n        }\n\n        return value;\n    }\n\n    // Match vendor and product codes for Firefox\n    var vendorProductRE = /^([0-9a-f]{1,4})-([0-9a-f]{1,4})-/i;\n\n    // Match leading zeros\n    var leadingZeroRE = /^0+/;\n\n    /**\n     * Firefox reports different ids for gamepads depending on the platform:\n     * - Windows: vendor and product codes contain leading zeroes\n     * - Mac: vendor and product codes are sparse (no leading zeroes)\n     *\n     * This function normalizes the id to support both formats\n     * @ignore\n     */\n    function addMapping(id, mapping) {\n        var expanded_id = id.replace(vendorProductRE, function (_, a, b) {\n            return (\n                \"000\".substr(a.length - 1) + a + \"-\" +\n                \"000\".substr(b.length - 1) + b + \"-\"\n            );\n        });\n        var sparse_id = id.replace(vendorProductRE, function (_, a, b) {\n            return (\n                a.replace(leadingZeroRE, \"\") + \"-\" +\n                b.replace(leadingZeroRE, \"\") + \"-\"\n            );\n        });\n\n        // Normalize optional parameters\n        mapping.analog = mapping.analog || mapping.buttons.map(function () {\n            return -1;\n        });\n        mapping.normalize_fn = mapping.normalize_fn || defaultNormalizeFn;\n\n        remap.set(expanded_id, mapping);\n        remap.set(sparse_id, mapping);\n    }\n\n    // binding list\n    var bindings = {};\n\n    // mapping list\n    var remap = new Map();\n\n    /**\n     * Default gamepad mappings\n     * @ignore\n     */\n    [\n        // Firefox mappings\n        [\n            \"45e-28e-Xbox 360 Wired Controller\",\n            {\n                \"axes\" : [ 0, 1, 3, 4 ],\n                \"buttons\" : [ 11, 12, 13, 14, 8, 9, -1, -1, 5, 4, 6, 7, 0, 1, 2, 3, 10 ],\n                \"analog\" : [ -1, -1, -1, -1, -1, -1, 2, 5, -1, -1, -1, -1, -1, -1, -1, -1, -1 ],\n                \"normalize_fn\" : wiredXbox360NormalizeFn\n            }\n        ],\n        [\n            \"54c-268-PLAYSTATION(R)3 Controller\",\n            {\n                \"axes\" : [ 0, 1, 2, 3 ],\n                \"buttons\" : [ 14, 13, 15, 12, 10, 11, 8, 9, 0, 3, 1, 2, 4, 6, 7, 5, 16 ]\n            }\n        ],\n        [\n            \"54c-5c4-Wireless Controller\", // PS4 Controller\n            {\n                \"axes\" : [ 0, 1, 2, 3 ],\n                \"buttons\" : [ 1, 0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 15, 16, 17, 12, 13 ]\n            }\n        ],\n        [\n            \"2836-1-OUYA Game Controller\",\n            {\n                \"axes\" : [ 0, 3, 7, 9 ],\n                \"buttons\" : [ 3, 6, 4, 5, 7, 8, 15, 16, -1, -1, 9, 10, 11, 12, 13, 14, -1 ],\n                \"analog\" : [ -1, -1, -1, -1, -1, -1, 5, 11, -1, -1, -1, -1, -1, -1, -1, -1, -1 ],\n                \"normalize_fn\" : ouyaNormalizeFn\n            }\n        ],\n\n        // Chrome mappings\n        [\n            \"OUYA Game Controller (Vendor: 2836 Product: 0001)\",\n            {\n                \"axes\" : [ 0, 1, 3, 4 ],\n                \"buttons\" : [ 0, 3, 1, 2, 4, 5, 12, 13, -1, -1, 6, 7, 8, 9, 10, 11, -1 ],\n                \"analog\" : [ -1, -1, -1, -1, -1, -1, 2, 5, -1, -1, -1, -1, -1, -1, -1, -1, -1 ],\n                \"normalize_fn\" : ouyaNormalizeFn\n            }\n        ]\n    ].forEach(function (value) {\n        addMapping(value[0], value[1]);\n    });\n\n    /**\n     * gamepad connected callback\n     * @ignore\n     */\n    window.addEventListener(\"gamepadconnected\", function (event) {\n        me.event.publish(me.event.GAMEPAD_CONNECTED, [ event.gamepad ]);\n    }, false);\n\n    /**\n     * gamepad disconnected callback\n     * @ignore\n     */\n    window.addEventListener(\"gamepaddisconnected\", function (event) {\n        me.event.publish(me.event.GAMEPAD_DISCONNECTED, [ event.gamepad ]);\n    }, false);\n\n    /**\n     * Update gamepad status\n     * @ignore\n     */\n    api._updateGamepads = navigator.getGamepads ? function () {\n        var gamepads = navigator.getGamepads();\n        var e = {};\n\n        // Trigger button bindings\n        Object.keys(bindings).forEach(function (index) {\n            if (!gamepads[index]) {\n                return;\n            }\n\n            var mapping = null;\n            if (gamepads[index].mapping !== \"standard\") {\n                mapping = remap.get(gamepads[index].id);\n            }\n\n            // Iterate all buttons that have active bindings\n            Object.keys(bindings[index].buttons).forEach(function (button) {\n                var last = bindings[index].buttons[button];\n                var mapped_button = button;\n                var mapped_axis = -1;\n\n                // Remap buttons if necessary\n                if (mapping) {\n                    mapped_button = mapping.buttons[button];\n                    mapped_axis = mapping.analog[button];\n                    if (mapped_button < 0 && mapped_axis < 0) {\n                        // Button is not mapped\n                        return;\n                    }\n                }\n\n                // Get mapped button\n                var current = gamepads[index].buttons[mapped_button] || {};\n\n                // Remap an axis to an analog button\n                if (mapping) {\n                    if (mapped_axis >= 0) {\n                        var value = mapping.normalize_fn(gamepads[index].axes[mapped_axis], -1, +button);\n\n                        // Create a new object, because GamepadButton is read-only\n                        current = {\n                            \"value\" : value,\n                            \"pressed\" : current.pressed || (Math.abs(value) >= deadzone)\n                        };\n                    }\n                }\n\n                me.event.publish(me.event.GAMEPAD_UPDATE, [ index, \"buttons\", +button, current ]);\n\n                // Edge detection\n                if (!last.pressed && current.pressed) {\n                    api._keydown(e, last.keyCode, mapped_button + 256);\n                }\n                else if (last.pressed && !current.pressed) {\n                    api._keyup(e, last.keyCode, mapped_button + 256);\n                }\n\n                // Update last button state\n                last.value = current.value;\n                last.pressed = current.pressed;\n            });\n        });\n    } : function () {};\n\n    /*\n     * PUBLIC STUFF\n     */\n\n    /**\n     * Namespace for standard gamepad mapping constants\n     * @public\n     * @namespace GAMEPAD\n     * @memberOf me.input\n     */\n    api.GAMEPAD = {\n        /**\n         * Standard gamepad mapping information for axes<br>\n         * <ul>\n         *   <li>Left control stick: <code>LX</code> (horizontal), <code>LY</code> (vertical)</li>\n         *   <li>Right control stick: <code>RX</code> (horizontal), <code>RY</code> (vertical)</li>\n         *   <li>Extras: <code>EXTRA_1</code>, <code>EXTRA_2</code>, <code>EXTRA_3</code>, <code>EXTRA_4</code></li>\n         * </ul>\n         * @public\n         * @name AXES\n         * @enum {Number}\n         * @memberOf me.input.GAMEPAD\n         * @see https://w3c.github.io/gamepad/#remapping\n         */\n        \"AXES\" : {\n            \"LX\"        : 0,\n            \"LY\"        : 1,\n            \"RX\"        : 2,\n            \"RY\"        : 3,\n            \"EXTRA_1\"   : 4,\n            \"EXTRA_2\"   : 5,\n            \"EXTRA_3\"   : 6,\n            \"EXTRA_4\"   : 7\n        },\n\n        /**\n         * Standard gamepad mapping information for buttons<br>\n         * <ul>\n         *   <li>Face buttons: <code>FACE_1</code>, <code>FACE_2</code>, <code>FACE_3</code>, <code>FACE_4</code></li>\n         *   <li>D-Pad: <code>UP</code>, <code>DOWN</code>, <code>LEFT</code>, <code>RIGHT</code></li>\n         *   <li>Shoulder buttons: <code>L1</code>, <code>L2</code>, <code>R1</code>, <code>R2</code></li>\n         *   <li>Analog stick (clicks): <code>L3</code>, <code>R3</code></li>\n         *   <li>Navigation: <code>SELECT</code> (<code>BACK</code>), <code>START</code> (<code>FORWARD</code>), <code>HOME</code></li>\n         *   <li>Extras: <code>EXTRA_1</code>, <code>EXTRA_2</code>, <code>EXTRA_3</code>, <code>EXTRA_4</code></li>\n         * </ul>\n         * @public\n         * @name BUTTONS\n         * @enum {Number}\n         * @memberOf me.input.GAMEPAD\n         * @see https://w3c.github.io/gamepad/#remapping\n         */\n        \"BUTTONS\" : {\n            \"FACE_1\"    : 0,\n            \"FACE_2\"    : 1,\n            \"FACE_3\"    : 2,\n            \"FACE_4\"    : 3,\n            \"L1\"        : 4,\n            \"R1\"        : 5,\n            \"L2\"        : 6,\n            \"R2\"        : 7,\n            \"SELECT\"    : 8,\n            \"BACK\"      : 8,\n            \"START\"     : 9,\n            \"FORWARD\"   : 9,\n            \"L3\"        : 10,\n            \"R3\"        : 11,\n            \"UP\"        : 12,\n            \"DOWN\"      : 13,\n            \"LEFT\"      : 14,\n            \"RIGHT\"     : 15,\n            \"HOME\"      : 16,\n            \"EXTRA_1\"   : 17,\n            \"EXTRA_2\"   : 18,\n            \"EXTRA_3\"   : 19,\n            \"EXTRA_4\"   : 20\n        }\n    };\n\n    /**\n     * Associate a gamepad event to a keycode\n     * @name bindGamepad\n     * @memberOf me.input\n     * @public\n     * @function\n     * @param {Number} index Gamepad index\n     * @param {me.input.GAMEPAD.BUTTONS} button\n     * @param {me.input.KEY} keyCode\n     * @example\n     * // enable the keyboard\n     * me.input.bindKey(me.input.KEY.X, \"shoot\");\n     * // map the lower face button on the first gamepad to the X key\n     * me.input.bindGamepad(0, me.input.GAMEPAD.BUTTONS.FACE_1, me.input.KEY.X);\n     */\n    api.bindGamepad = function (index, button, keyCode) {\n        // Throw an exception if no action is defined for the specified keycode\n        if (!api._KeyBinding[keyCode]) {\n            throw new me.Error(\"no action defined for keycode \" + keyCode);\n        }\n\n        // Allocate bindings if not defined\n        if (!bindings[index]) {\n            bindings[index] = {\n                \"axes\" : {},\n                \"buttons\" : {}\n            };\n        }\n\n        // Map the gamepad button to the keycode\n        bindings[index].buttons[button] = {\n            \"keyCode\" : keyCode,\n            \"value\" : 0,\n            \"pressed\" : false\n        };\n    };\n\n    /**\n     * unbind the defined keycode\n     * @name unbindGamepad\n     * @memberOf me.input\n     * @public\n     * @function\n     * @param {Number} index Gamepad index\n     * @param {me.input.GAMEPAD.BUTTONS} button\n     * @example\n     * me.input.unbindGamepad(0, me.input.GAMEPAD.BUTTONS.FACE_1);\n     */\n    api.unbindGamepad = function (index, button) {\n        if (!bindings[index]) {\n            throw new me.Error(\"no bindings for gamepad \" + index);\n        }\n        bindings[index].buttons[button] = {};\n    };\n\n    /**\n     * Set deadzone for analog gamepad inputs<br>\n     * The default deadzone is 0.1 (10%) Analog values less than this will be ignored\n     * @name setGamepadDeadzone\n     * @memberOf me.input\n     * @public\n     * @function\n     * @param {Number} value Deadzone value\n     */\n    api.setGamepadDeadzone = function (value) {\n        deadzone = value;\n    };\n\n    /**\n     * specify a custom mapping for a specific gamepad id<br>\n     * see below for the default mapping : <br>\n     * <center><img src=\"images/gamepad_diagram.png\"/></center><br>\n     * @name setGamepadMapping\n     * @memberOf me.input\n     * @public\n     * @function\n     * @param {String} id Gamepad id string\n     * @param {Object} mapping A hash table\n     * @param {Number[]} mapping.axes Standard analog control stick axis locations\n     * @param {Number[]} mapping.buttons Standard digital button locations\n     * @param {Number[]} [mapping.analog] Analog axis locations for buttons\n     * @param {me.input~normalize_fn} [mapping.normalize_fn] Axis normalization function\n     * @example\n     * // A weird controller that has its axis mappings reversed\n     * me.input.setGamepadMapping(\"Generic USB Controller\", {\n     *   \"axes\" : [ 3, 2, 1, 0 ],\n     *   \"buttons\" : [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16 ]\n     * });\n     *\n     * // Mapping extra axes to analog buttons\n     * me.input.setGamepadMapping(\"Generic Analog Controller\", {\n     *   \"axes\" : [ 0, 1, 2, 3 ],\n     *   \"buttons\" : [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16 ],\n     *\n     *   // Raw axis 4 is mapped to GAMEPAD.BUTTONS.FACE_1\n     *   // Raw axis 5 is mapped to GAMEPAD.BUTTONS.FACE_2\n     *   // etc...\n     *   // Also maps left and right triggers\n     *   \"analog\" : [ 4, 5, 6, 7, -1, -1, 8, 9, -1, -1, -1, -1, -1, -1, -1, -1, -1 ],\n     *\n     *   // Normalize the value of button L2: [-1.0..1.0] => [0.0..1.0]\n     *   \"normalize_fn\" : function (value, axis, button) {\n     *     return ((button === me.input.GAMEPAD.BUTTONS.L2) ? ((value + 1) / 2) : value) || 0;\n     *   }\n     * });\n     */\n    api.setGamepadMapping = addMapping;\n\n})(me.input);\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n    /**\n     * Base64 decoding\n     * @see <a href=\"http://www.webtoolkit.info/\">http://www.webtoolkit.info/</A>\n     * @ignore\n     */\n    var Base64 = (function () {\n        // hold public stuff in our singleton\n        var singleton = {};\n\n        // private property\n        var _keyStr = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\n\n        // public method for decoding\n        singleton.decode = function (input) {\n\n            // make sure our input string has the right format\n            input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\n\n            if (me.device.nativeBase64) {\n                // use native decoder\n                return window.atob(input);\n            }\n            else {\n                // use cross-browser decoding\n                var output = [], chr1, chr2, chr3, enc1, enc2, enc3, enc4, i = 0;\n\n                while (i < input.length) {\n                    enc1 = _keyStr.indexOf(input.charAt(i++));\n                    enc2 = _keyStr.indexOf(input.charAt(i++));\n                    enc3 = _keyStr.indexOf(input.charAt(i++));\n                    enc4 = _keyStr.indexOf(input.charAt(i++));\n\n                    chr1 = (enc1 << 2) | (enc2 >> 4);\n                    chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);\n                    chr3 = ((enc3 & 3) << 6) | enc4;\n\n                    output.push(String.fromCharCode(chr1));\n\n                    if (enc3 !== 64) {\n                        output.push(String.fromCharCode(chr2));\n                    }\n                    if (enc4 !== 64) {\n                        output.push(String.fromCharCode(chr3));\n                    }\n                }\n\n                output = output.join(\"\");\n                return output;\n            }\n        };\n\n        // public method for encoding\n        singleton.encode = function (input) {\n\n            // make sure our input string has the right format\n            input = input.replace(/\\r\\n/g, \"\\n\");\n\n            if (me.device.nativeBase64) {\n                // use native encoder\n                return window.btoa(input);\n            }\n            else {\n                // use cross-browser encoding\n                var output = [], chr1, chr2, chr3, enc1, enc2, enc3, enc4, i = 0;\n\n\n                while (i < input.length) {\n                    chr1 = input.charCodeAt(i++);\n                    chr2 = input.charCodeAt(i++);\n                    chr3 = input.charCodeAt(i++);\n\n                    enc1 = chr1 >> 2;\n                    enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);\n                    enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);\n                    enc4 = chr3 & 63;\n\n                    if (isNaN(chr2)) {\n                        enc3 = enc4 = 64;\n                    } else if (isNaN(chr3)) {\n                        enc4 = 64;\n                    }\n\n                    output.push(_keyStr.charAt(enc1));\n                    output.push(_keyStr.charAt(enc2));\n                    output.push(_keyStr.charAt(enc3));\n                    output.push(_keyStr.charAt(enc4));\n                }\n\n                output = output.join(\"\");\n                return output;\n            }\n        };\n\n        return singleton;\n\n    })();\n\n    /**\n     * a collection of utility functions<br>\n     * there is no constructor function for me.utils\n     * @namespace me.utils\n     * @memberOf me\n     */\n    me.utils = (function () {\n        // hold public stuff in our singleton\n        var api = {};\n\n        /*\n         * PRIVATE STUFF\n         */\n\n        // guid default value\n        var GUID_base  = \"\";\n        var GUID_index = 0;\n\n        // regexp to deal with file name & path\n        var removepath = /^.*(\\\\|\\/|\\:)/;\n        var removeext = /\\.[^\\.]*$/;\n\n        /*\n         * PUBLIC STUFF\n         */\n\n        /**\n         * Decode a base64 encoded string into a binary string\n         * @public\n         * @function\n         * @memberOf me.utils\n         * @name decodeBase64\n         * @param {String} input Base64 encoded data\n         * @return {String} Binary string\n         */\n        api.decodeBase64 = function (input) {\n            return Base64.decode(input);\n        };\n\n        /**\n         * Encode binary string into a base64 string\n         * @public\n         * @function\n         * @memberOf me.utils\n         * @name encodeBase64\n         * @param {String} input Binary string\n         * @return {String} Base64 encoded data\n         */\n        api.encodeBase64 = function (input) {\n            return Base64.encode(input);\n        };\n\n        /**\n         * Decode a base64 encoded string into a byte array\n         * @public\n         * @function\n         * @memberOf me.utils\n         * @name decodeBase64AsArray\n         * @param {String} input Base64 encoded data\n         * @param {Number} [bytes] number of bytes per array entry\n         * @return {Number[]} Decoded data\n         */\n        api.decodeBase64AsArray = function (input, bytes) {\n            bytes = bytes || 1;\n\n            var dec = Base64.decode(input), i, j, len;\n            var ar = new Uint32Array(dec.length / bytes);\n\n            for (i = 0, len = dec.length / bytes; i < len; i++) {\n                ar[i] = 0;\n                for (j = bytes - 1; j >= 0; --j) {\n                    ar[i] += dec.charCodeAt((i * bytes) + j) << (j << 3);\n                }\n            }\n            return ar;\n        };\n\n        /**\n         * decompress zlib/gzip data (NOT IMPLEMENTED)\n         * @public\n         * @function\n         * @memberOf me.utils\n         * @name decompress\n         * @param  {Number[]} data Array of bytes\n         * @param  {String} format compressed data format (\"gzip\",\"zlib\")\n         * @return {Number[]} Decompressed data\n         */\n        api.decompress = function () {\n            throw new me.Error(\"GZIP/ZLIB compressed TMX Tile Map not supported!\");\n        };\n\n        /**\n         * Decode a CSV encoded array into a binary array\n         * @public\n         * @function\n         * @memberOf me.utils\n         * @name decodeCSV\n         * @param  {String} input CSV formatted data\n         * @return {Number[]} Decoded data\n         */\n        api.decodeCSV = function (input) {\n            var entries = input.replace(\"\\n\", \"\").trim().split(\",\");\n\n            var result = [];\n            for (var i = 0; i < entries.length; i++) {\n                result.push(+entries[i]);\n            }\n            return result;\n        };\n\n        /**\n         * return the base name of the file without path info.<br>\n         * @public\n         * @function\n         * @memberOf me.utils\n         * @name getBasename\n         * @param  {String} path path containing the filename\n         * @return {String} the base name without path information.\n         */\n        api.getBasename = function (path) {\n            return path.replace(removepath, \"\").replace(removeext, \"\");\n        };\n\n        /**\n         * return the extension of the file in the given path <br>\n         * @public\n         * @function\n         * @memberOf me.utils\n         * @name getFileExtension\n         * @param  {String} path path containing the filename\n         * @return {String} filename extension.\n         */\n        api.getFileExtension = function (path) {\n            return path.substring(path.lastIndexOf(\".\") + 1, path.length);\n        };\n\n        /**\n         * Get image pixels\n         * @public\n         * @function\n         * @memberOf me.utils\n         * @name getPixels\n         * @param {Image|Canvas} image Image to read\n         * @return {ImageData} Canvas ImageData object\n         */\n        api.getPixels = function (arg) {\n            if (arg instanceof HTMLImageElement) {\n                var _context = me.CanvasRenderer.getContext2d(\n                    me.video.createCanvas(arg.width, arg.height)\n                );\n                _context.drawImage(arg, 0, 0);\n                return _context.getImageData(0, 0, arg.width, arg.height);\n            }\n            else {\n                // canvas !\n                return arg.getContext(\"2d\").getImageData(0, 0, arg.width, arg.height);\n            }\n        };\n\n        /**\n         * Normalize a String or Image to an Image reference\n         * @public\n         * @function\n         * @memberOf me.utils\n         * @name getImage\n         * @param {Image|String} image Image name or Image reference\n         * @return {Image} Image reference\n         */\n        api.getImage = function (image) {\n            return (\n                (typeof(image) === \"string\") ?\n                me.loader.getImage(me.utils.getBasename(image)) :\n                image\n            );\n        };\n\n        /**\n         * reset the GUID Base Name\n         * the idea here being to have a unique ID\n         * per level / object\n         * @ignore\n         */\n        api.resetGUID = function (base, index) {\n            // also ensure it's only 8bit ASCII characters\n            GUID_base  = base.toString().toUpperCase().toHex();\n            GUID_index = index || 0;\n        };\n\n        /**\n         * create and return a very simple GUID\n         * Game Unique ID\n         * @ignore\n         */\n        api.createGUID = function (index) {\n            // to cover the case of undefined id for groups\n            GUID_index += index || 1;\n            return GUID_base + \"-\" + (index || GUID_index);\n        };\n\n        // return our object\n        return api;\n    })();\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n */\n(function () {\n    var rgbaRx = /^rgba?\\((\\d+), ?(\\d+), ?(\\d+)(, ?([\\d\\.]+))?\\)$/;\n    var hex3Rx = /^#([\\da-fA-F])([\\da-fA-F])([\\da-fA-F])$/;\n    var hex6Rx = /^#([\\da-fA-F]{2})([\\da-fA-F]{2})([\\da-fA-F]{2})$/;\n\n    var cssToRGB = new Map();\n\n    [\n        // CSS1\n        [ \"black\",                  [   0,   0,   0 ] ],\n        [ \"silver\",                 [ 192, 192, 129 ] ],\n        [ \"gray\",                   [ 128, 128, 128 ] ],\n        [ \"white\",                  [ 255, 255, 255 ] ],\n        [ \"maroon\",                 [ 128,   0,   0 ] ],\n        [ \"red\",                    [ 255,   0,   0 ] ],\n        [ \"purple\",                 [ 128,   0, 128 ] ],\n        [ \"fuchsia\",                [ 255,   0, 255 ] ],\n        [ \"green\",                  [   0, 128,   0 ] ],\n        [ \"lime\",                   [   0, 255,   0 ] ],\n        [ \"olive\",                  [ 128, 128,   0 ] ],\n        [ \"yellow\",                 [ 255, 255,   0 ] ],\n        [ \"navy\",                   [   0,   0, 128 ] ],\n        [ \"blue\",                   [   0,   0, 255 ] ],\n        [ \"teal\",                   [   0, 128, 128 ] ],\n        [ \"aqua\",                   [   0, 255, 255 ] ],\n\n        // CSS2\n        [ \"orange\",                 [ 255, 165,   0 ] ],\n\n        // CSS3\n        [ \"aliceblue\",              [ 240, 248, 245 ] ],\n        [ \"antiquewhite\",           [ 250, 235, 215 ] ],\n        [ \"aquamarine\",             [ 127, 255, 212 ] ],\n        [ \"azure\",                  [ 240, 255, 255 ] ],\n        [ \"beige\",                  [ 245, 245, 220 ] ],\n        [ \"bisque\",                 [ 255, 228, 196 ] ],\n        [ \"blanchedalmond\",         [ 255, 235, 205 ] ],\n        [ \"blueviolet\",             [ 138,  43, 226 ] ],\n        [ \"brown\",                  [ 165,  42,  42 ] ],\n        [ \"burlywood\",              [ 222, 184,  35 ] ],\n        [ \"cadetblue\",              [  95, 158, 160 ] ],\n        [ \"chartreuse\",             [ 127, 255,   0 ] ],\n        [ \"chocolate\",              [ 210, 105,  30 ] ],\n        [ \"coral\",                  [ 255, 127,  80 ] ],\n        [ \"cornflowerblue\",         [ 100, 149, 237 ] ],\n        [ \"cornsilk\",               [ 255, 248, 220 ] ],\n        [ \"crimson\",                [ 220,  20,  60 ] ],\n        [ \"darkblue\",               [   0,   0, 139 ] ],\n        [ \"darkcyan\",               [   0, 139, 139 ] ],\n        [ \"darkgoldenrod\",          [ 184, 134,  11 ] ],\n        [ \"darkgray[*]\",            [ 169, 169, 169 ] ],\n        [ \"darkgreen\",              [   0, 100,   0 ] ],\n        [ \"darkgrey[*]\",            [ 169, 169, 169 ] ],\n        [ \"darkkhaki\",              [ 189, 183, 107 ] ],\n        [ \"darkmagenta\",            [ 139,   0, 139 ] ],\n        [ \"darkolivegreen\",         [  85, 107,  47 ] ],\n        [ \"darkorange\",             [ 255, 140,   0 ] ],\n        [ \"darkorchid\",             [ 153,  50, 204 ] ],\n        [ \"darkred\",                [ 139,   0,   0 ] ],\n        [ \"darksalmon\",             [ 233, 150, 122 ] ],\n        [ \"darkseagreen\",           [ 143, 188, 143 ] ],\n        [ \"darkslateblue\",          [  72,  61, 139 ] ],\n        [ \"darkslategray\",          [  47,  79,  79 ] ],\n        [ \"darkslategrey\",          [  47,  79,  79 ] ],\n        [ \"darkturquoise\",          [   0, 206, 209 ] ],\n        [ \"darkviolet\",             [ 148,   0, 211 ] ],\n        [ \"deeppink\",               [ 255,  20, 147 ] ],\n        [ \"deepskyblue\",            [   0, 191, 255 ] ],\n        [ \"dimgray\",                [ 105, 105, 105 ] ],\n        [ \"dimgrey\",                [ 105, 105, 105 ] ],\n        [ \"dodgerblue\",             [  30, 144, 255 ] ],\n        [ \"firebrick\",              [ 178,  34,  34 ] ],\n        [ \"floralwhite\",            [ 255, 250, 240 ] ],\n        [ \"forestgreen\",            [  34, 139,  34 ] ],\n        [ \"gainsboro\",              [ 220, 220, 220 ] ],\n        [ \"ghostwhite\",             [ 248, 248, 255 ] ],\n        [ \"gold\",                   [ 255, 215,   0 ] ],\n        [ \"goldenrod\",              [ 218, 165,  32 ] ],\n        [ \"greenyellow\",            [ 173, 255,  47 ] ],\n        [ \"grey\",                   [ 128, 128, 128 ] ],\n        [ \"honeydew\",               [ 240, 255, 240 ] ],\n        [ \"hotpink\",                [ 255, 105, 180 ] ],\n        [ \"indianred\",              [ 205,  92,  92 ] ],\n        [ \"indigo\",                 [  75,   0, 130 ] ],\n        [ \"ivory\",                  [ 255, 255, 240 ] ],\n        [ \"khaki\",                  [ 240, 230, 140 ] ],\n        [ \"lavender\",               [ 230, 230, 250 ] ],\n        [ \"lavenderblush\",          [ 255, 240, 245 ] ],\n        [ \"lawngreen\",              [ 124, 252,   0 ] ],\n        [ \"lemonchiffon\",           [ 255, 250, 205 ] ],\n        [ \"lightblue\",              [ 173, 216, 230 ] ],\n        [ \"lightcoral\",             [ 240, 128, 128 ] ],\n        [ \"lightcyan\",              [ 224, 255, 255 ] ],\n        [ \"lightgoldenrodyellow\",   [ 250, 250, 210 ] ],\n        [ \"lightgray\",              [ 211, 211, 211 ] ],\n        [ \"lightgreen\",             [ 144, 238, 144 ] ],\n        [ \"lightgrey\",              [ 211, 211, 211 ] ],\n        [ \"lightpink\",              [ 255, 182, 193 ] ],\n        [ \"lightsalmon\",            [ 255, 160, 122 ] ],\n        [ \"lightseagreen\",          [  32, 178, 170 ] ],\n        [ \"lightskyblue\",           [ 135, 206, 250 ] ],\n        [ \"lightslategray\",         [ 119, 136, 153 ] ],\n        [ \"lightslategrey\",         [ 119, 136, 153 ] ],\n        [ \"lightsteelblue\",         [ 176, 196, 222 ] ],\n        [ \"lightyellow\",            [ 255, 255, 224 ] ],\n        [ \"limegreen\",              [  50, 205,  50 ] ],\n        [ \"linen\",                  [ 250, 240, 230 ] ],\n        [ \"mediumaquamarine\",       [ 102, 205, 170 ] ],\n        [ \"mediumblue\",             [   0,   0, 205 ] ],\n        [ \"mediumorchid\",           [ 186,  85, 211 ] ],\n        [ \"mediumpurple\",           [ 147, 112, 219 ] ],\n        [ \"mediumseagreen\",         [  60, 179, 113 ] ],\n        [ \"mediumslateblue\",        [ 123, 104, 238 ] ],\n        [ \"mediumspringgreen\",      [   0, 250, 154 ] ],\n        [ \"mediumturquoise\",        [  72, 209, 204 ] ],\n        [ \"mediumvioletred\",        [ 199,  21, 133 ] ],\n        [ \"midnightblue\",           [  25,  25, 112 ] ],\n        [ \"mintcream\",              [ 245, 255, 250 ] ],\n        [ \"mistyrose\",              [ 255, 228, 225 ] ],\n        [ \"moccasin\",               [ 255, 228, 181 ] ],\n        [ \"navajowhite\",            [ 255, 222, 173 ] ],\n        [ \"oldlace\",                [ 253, 245, 230 ] ],\n        [ \"olivedrab\",              [ 107, 142,  35 ] ],\n        [ \"orangered\",              [ 255,  69,   0 ] ],\n        [ \"orchid\",                 [ 218, 112, 214 ] ],\n        [ \"palegoldenrod\",          [ 238, 232, 170 ] ],\n        [ \"palegreen\",              [ 152, 251, 152 ] ],\n        [ \"paleturquoise\",          [ 175, 238, 238 ] ],\n        [ \"palevioletred\",          [ 219, 112, 147 ] ],\n        [ \"papayawhip\",             [ 255, 239, 213 ] ],\n        [ \"peachpuff\",              [ 255, 218, 185 ] ],\n        [ \"peru\",                   [ 205, 133,  63 ] ],\n        [ \"pink\",                   [ 255, 192, 203 ] ],\n        [ \"plum\",                   [ 221, 160, 221 ] ],\n        [ \"powderblue\",             [ 176, 224, 230 ] ],\n        [ \"rosybrown\",              [ 188, 143, 143 ] ],\n        [ \"royalblue\",              [  65, 105, 225 ] ],\n        [ \"saddlebrown\",            [ 139,  69,  19 ] ],\n        [ \"salmon\",                 [ 250, 128, 114 ] ],\n        [ \"sandybrown\",             [ 244, 164,  96 ] ],\n        [ \"seagreen\",               [  46, 139,  87 ] ],\n        [ \"seashell\",               [ 255, 245, 238 ] ],\n        [ \"sienna\",                 [ 160,  82,  45 ] ],\n        [ \"skyblue\",                [ 135, 206, 235 ] ],\n        [ \"slateblue\",              [ 106,  90, 205 ] ],\n        [ \"slategray\",              [ 112, 128, 144 ] ],\n        [ \"slategrey\",              [ 112, 128, 144 ] ],\n        [ \"snow\",                   [ 255, 250, 250 ] ],\n        [ \"springgreen\",            [   0, 255, 127 ] ],\n        [ \"steelblue\",              [  70, 130, 180 ] ],\n        [ \"tan\",                    [ 210, 180, 140 ] ],\n        [ \"thistle\",                [ 216, 191, 216 ] ],\n        [ \"tomato\",                 [ 255,  99,  71 ] ],\n        [ \"turquoise\",              [  64, 224, 208 ] ],\n        [ \"violet\",                 [ 238, 130, 238 ] ],\n        [ \"wheat\",                  [ 245, 222, 179 ] ],\n        [ \"whitesmoke\",             [ 245, 245, 245 ] ],\n        [ \"yellowgreen\",            [ 154, 205,  50 ] ]\n    ].forEach(function (value) {\n        cssToRGB.set(value[0], value[1]);\n    });\n\n    /**\n     * A color manipulation object.\n     * @class\n     * @extends Object\n     * @memberOf me\n     * @constructor\n     * @param {Float32Array|Number} [r=0] red component or array of color components\n     * @param {Number} [g=0] green component\n     * @param {Number} [b=0] blue component\n     * @param {Number} [alpha=1.0] alpha value\n     */\n    me.Color = me.Object.extend(\n    /** @scope me.Color.prototype */\n    {\n\n        /** @ignore */\n        init : function (r, g, b, alpha) {\n\n            /**\n             * Color components in a Float32Array suitable for WebGL\n             * @name glArray\n             * @memberOf me.Color\n             * @type {Float32Array}\n             * @readonly\n             */\n            if (typeof (this.glArray) === \"undefined\") {\n                this.glArray = new Float32Array([ 0.0, 0.0, 0.0, 1.0 ]);\n            }\n\n            return this.setColor(r, g, b, alpha);\n        },\n\n        /**\n         * Set this color to the specified value.\n         * @name setColor\n         * @memberOf me.Color\n         * @function\n         * @param {Number} r red component [0 .. 255]\n         * @param {Number} g green component [0 .. 255]\n         * @param {Number} b blue component [0 .. 255]\n         * @param {Number} [alpha=1.0] alpha value [0.0 .. 1.0]\n         * @return {me.Color} Reference to this object for method chaining\n         */\n        setColor : function (r, g, b, alpha) {\n            // Private initialization: copy Color value directly\n            if (r instanceof me.Color) {\n                this.glArray.set(r.glArray);\n                return r;\n            }\n            this.r = r;\n            this.g = g;\n            this.b = b;\n            this.alpha = alpha;\n            return this;\n        },\n\n        /**\n         * Create a new copy of this color object.\n         * @name clone\n         * @memberOf me.Color\n         * @function\n         * @return {me.Color} Reference to the newly cloned object\n         */\n        clone : function () {\n            return me.pool.pull(\"me.Color\", this);\n        },\n\n        /**\n         * Copy a color object or CSS color into this one.\n         * @name copy\n         * @memberOf me.Color\n         * @function\n         * @param {me.Color|String} color\n         * @return {me.Color} Reference to this object for method chaining\n         */\n        copy : function (color) {\n            if (color instanceof me.Color) {\n                this.glArray.set(color.glArray);\n                return this;\n            }\n\n            return this.parseCSS(color);\n        },\n\n        /**\n         * Blend this color with the given one using addition.\n         * @name add\n         * @memberOf me.Color\n         * @function\n         * @param {me.Color} color\n         * @return {me.Color} Reference to this object for method chaining\n         */\n        add : function (color) {\n            this.glArray[0] = (this.glArray[0] + color.glArray[0]).clamp(0, 1);\n            this.glArray[1] = (this.glArray[1] + color.glArray[1]).clamp(0, 1);\n            this.glArray[2] = (this.glArray[2] + color.glArray[2]).clamp(0, 1);\n            this.glArray[3] = (this.glArray[3] + color.glArray[3]) / 2;\n\n            return this;\n        },\n\n        /**\n         * Darken this color value by 0..1\n         * @name darken\n         * @memberOf me.Color\n         * @function\n         * @param {Number} scale\n         * @return {me.Color} Reference to this object for method chaining\n         */\n        darken : function (scale) {\n            scale = scale.clamp(0, 1);\n            this.glArray[0] *= scale;\n            this.glArray[1] *= scale;\n            this.glArray[2] *= scale;\n\n            return this;\n        },\n\n        /**\n         * Lighten this color value by 0..1\n         * @name lighten\n         * @memberOf me.Color\n         * @function\n         * @param {Number} scale\n         * @return {me.Color} Reference to this object for method chaining\n         */\n        lighten : function (scale) {\n            scale = scale.clamp(0, 1);\n            this.glArray[0] = (this.glArray[0] + (1 - this.glArray[0]) * scale).clamp(0, 1);\n            this.glArray[1] = (this.glArray[1] + (1 - this.glArray[1]) * scale).clamp(0, 1);\n            this.glArray[2] = (this.glArray[2] + (1 - this.glArray[2]) * scale).clamp(0, 1);\n\n            return this;\n        },\n\n        /**\n         * Generate random r,g,b values for this color object\n         * @name random\n         * @memberOf me.Color\n         * @function\n         * @return {me.Color} Reference to this object for method chaining\n         */\n        random : function () {\n            return this.setColor(\n                Math.random() * 256,\n                Math.random() * 256,\n                Math.random() * 256,\n                this.alpha\n            );\n        },\n\n        /**\n         * Return true if the r,g,b,a values of this color are equal with the\n         * given one.\n         * @name equals\n         * @memberOf me.Color\n         * @function\n         * @param {me.Color} color\n         * @return {Boolean}\n         */\n        equals : function (color) {\n            return (\n                (this.glArray[0] === color.glArray[0]) &&\n                (this.glArray[1] === color.glArray[1]) &&\n                (this.glArray[2] === color.glArray[2]) &&\n                (this.glArray[3] === color.glArray[3])\n            );\n        },\n\n        /**\n         * Parse a CSS color string and set this color to the corresponding\n         * r,g,b values\n         * @name parseCSS\n         * @memberOf me.Color\n         * @function\n         * @param {String} color\n         * @return {me.Color} Reference to this object for method chaining\n         */\n        parseCSS : function (cssColor) {\n            // TODO : Memoize this function by caching its input\n\n            if (cssToRGB.has(cssColor)) {\n                return this.setColor.apply(this, cssToRGB.get(cssColor));\n            }\n\n            return this.parseRGB(cssColor);\n        },\n\n        /**\n         * Parse an RGB or RGBA CSS color string\n         * @name parseRGB\n         * @memberOf me.Color\n         * @function\n         * @param {String} color\n         * @return {me.Color} Reference to this object for method chaining\n         */\n        parseRGB : function (rgbColor) {\n            // TODO : Memoize this function by caching its input\n\n            var match = rgbaRx.exec(rgbColor);\n            if (match) {\n                return this.setColor(+match[1], +match[2], +match[3], +match[5]);\n            }\n\n            return this.parseHex(rgbColor);\n        },\n\n        /**\n         * Parse a Hex color (\"#RGB\" or \"#RRGGBB\" format) and set this color to\n         * the corresponding r,g,b values\n         * @name parseHex\n         * @memberOf me.Color\n         * @function\n         * @param {String} color\n         * @return {me.Color} Reference to this object for method chaining\n         */\n        parseHex : function (hexColor) {\n            // TODO : Memoize this function by caching its input\n\n            var match;\n            if ((match = hex6Rx.exec(hexColor))) {\n                return this.setColor(\n                    parseInt(match[1], 16),\n                    parseInt(match[2], 16),\n                    parseInt(match[3], 16)\n                );\n            }\n            if ((match = hex3Rx.exec(hexColor))) {\n                return this.setColor(\n                    parseInt(match[1] + match[1], 16),\n                    parseInt(match[2] + match[2], 16),\n                    parseInt(match[3] + match[3], 16)\n                );\n            }\n\n            throw new me.Color.Error(\n                \"invalid parameter: \" + hexColor\n            );\n        },\n\n        /**\n         * Returns the private glArray\n         * @ignore\n         */\n        toGL : function () {\n            return this.glArray;\n        },\n\n        /**\n         * Get the color in \"#RRGGBB\" format\n         * @name toHex\n         * @memberOf me.Color\n         * @function\n         * @return {String}\n         */\n        toHex : function () {\n            // TODO : Memoize this function by caching its result until any of\n            // the r,g,b,a values are changed\n\n            return \"#\" + this.r.toHex() + this.g.toHex() + this.b.toHex();\n        },\n\n        /**\n         * Get the color in \"rgb(R,G,B)\" format\n         * @name toRGB\n         * @memberOf me.Color\n         * @function\n         * @return {String}\n         */\n        toRGB : function () {\n            // TODO : Memoize this function by caching its result until any of\n            // the r,g,b,a values are changed\n\n            return \"rgb(\" +\n                this.r + \",\" +\n                this.g + \",\" +\n                this.b +\n            \")\";\n        },\n\n        /**\n         * Get the color in \"rgba(R,G,B,A)\" format\n         * @name toRGBA\n         * @memberOf me.Color\n         * @function\n         * @return {String}\n         */\n        toRGBA : function () {\n            // TODO : Memoize this function by caching its result until any of\n            // the r,g,b,a values are changed\n\n            return \"rgba(\" +\n                this.r + \",\" +\n                this.g + \",\" +\n                this.b + \",\" +\n                this.alpha +\n            \")\";\n        }\n    });\n\n    /**\n     * Color Red Component\n     * @type Number\n     * @name r\n     * @readonly\n     * @memberOf me.Color\n     */\n    Object.defineProperty(me.Color.prototype, \"r\", {\n        get : function () { return ~~(this.glArray[0] * 255); },\n        set : function (value) { this.glArray[0] = (~~value || 0).clamp(0, 255) / 255.0; },\n        enumerable : true,\n        configurable : true\n    });\n\n    /**\n     * Color Green Component\n     * @type Number\n     * @name g\n     * @readonly\n     * @memberOf me.Color\n     */\n    Object.defineProperty(me.Color.prototype, \"g\", {\n        get : function () { return ~~(this.glArray[1] * 255); },\n        set : function (value) { this.glArray[1] = (~~value || 0).clamp(0, 255) / 255.0; },\n        enumerable : true,\n        configurable : true\n    });\n\n    /**\n     * Color Blue Component\n     * @type Number\n     * @name b\n     * @readonly\n     * @memberOf me.Color\n     */\n    Object.defineProperty(me.Color.prototype, \"b\", {\n        get : function () { return ~~(this.glArray[2] * 255); },\n        set : function (value) { this.glArray[2] = (~~value || 0).clamp(0, 255) / 255.0; },\n        enumerable : true,\n        configurable : true\n    });\n\n    /**\n     * Color Alpha Component\n     * @type Number\n     * @name alpha\n     * @readonly\n     * @memberOf me.Color\n     */\n    Object.defineProperty(me.Color.prototype, \"alpha\", {\n        get : function () { return this.glArray[3]; },\n        set : function (value) { this.glArray[3] = typeof(value) === \"undefined\" ? 1.0 : (+value).clamp(0, 1); },\n        enumerable : true,\n        configurable : true\n    });\n\n    /**\n     * Base class for me.Color exception handling.\n     * @name Error\n     * @class\n     * @memberOf me.Color\n     * @constructor\n     * @param {String} msg Error message.\n     */\n    me.Color.Error = me.Error.extend({\n        init : function (msg) {\n            me.Error.prototype.init.apply(this, [ msg ]);\n            this.name = \"me.Color.Error\";\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n    /**\n     * A singleton object to access the device localStorage area\n     * @example\n     * // Initialize \"score\" and \"lives\" with default values\n     * // This loads the properties from localStorage if they exist, else it sets the given defaults\n     * me.save.add({ score : 0, lives : 3 });\n     *\n     * // Print all\n     * // On first load, this prints { score : 0, lives : 3 }\n     * // On further reloads, it prints { score : 31337, lives : 3, complexObject : ... }\n     * // Because the following changes will be saved to localStorage\n     * console.log(JSON.stringify(me.save));\n     *\n     * // Save score\n     * me.save.score = 31337;\n     *\n     * // Also supports complex objects thanks to the JSON backend\n     * me.save.add({ complexObject : {} })\n     * me.save.complexObject = { a : \"b\", c : [ 1, 2, 3, \"d\" ], e : { f : [{}] } };\n     *\n     * // WARNING: Do not set any child properties of complex objects directly!\n     * // Changes made that way will not save. Always set the entire object value at once.\n     * // If you cannot live with this limitation, there's a workaround:\n     * me.save.complexObject.c.push(\"foo\"); // Modify a child property\n     * me.save.complexObject = me.save.complexObject; // Save the entire object!\n     *\n     * // Remove \"lives\" from localStorage\n     * me.save.remove(\"lives\");\n     * @namespace me.save\n     * @memberOf me\n     */\n    me.save = (function () {\n        // Variable to hold the object data\n        var data = {};\n\n        // a function to check if the given key is a reserved word\n        function isReserved(key) {\n            return (key === \"add\" || key === \"remove\");\n        }\n\n        // Public API\n        var api = {\n            /**\n             * @ignore\n             */\n            _init: function () {\n                // Load previous data if local Storage is supported\n                if (me.device.localStorage === true) {\n                    var keys = JSON.parse(localStorage.getItem(\"me.save\")) || [];\n                    keys.forEach(function (key) {\n                        data[key] = JSON.parse(localStorage.getItem(\"me.save.\" + key));\n                    });\n                }\n            },\n\n            /**\n             * Add new keys to localStorage and set them to the given default values if they do not exist\n             * @name add\n             * @memberOf me.save\n             * @function\n             * @param {Object} props key and corresponding values\n             * @example\n             * // Initialize \"score\" and \"lives\" with default values\n             * me.save.add({ score : 0, lives : 3 });\n             */\n            add : function (props) {\n                Object.keys(props).forEach(function (key) {\n                    if (isReserved(key)) {\n                        return;\n                    }\n\n                    (function (prop) {\n                        Object.defineProperty(api, prop, {\n                            configurable : true,\n                            enumerable : true,\n                            get : function () {\n                                return data[prop];\n                            },\n                            set : function (value) {\n                                data[prop] = value;\n                                if (me.device.localStorage === true) {\n                                    localStorage.setItem(\"me.save.\" + prop, JSON.stringify(value));\n                                }\n                            }\n                        });\n                    })(key);\n\n                    // Set default value for key\n                    if (!(key in data)) {\n                        api[key] = props[key];\n                    }\n                });\n\n                // Save keys\n                if (me.device.localStorage === true) {\n                    localStorage.setItem(\"me.save\", JSON.stringify(Object.keys(data)));\n                }\n            },\n\n            /**\n             * Remove a key from localStorage\n             * @name remove\n             * @memberOf me.save\n             * @function\n             * @param {String} key key to be removed\n             * @example\n             * // Remove the \"score\" key from localStorage\n             * me.save.remove(\"score\");\n             */\n            remove : function (key) {\n                if (!isReserved(key)) {\n                    if (typeof data[key] !== \"undefined\") {\n                        delete data[key];\n                        if (me.device.localStorage === true) {\n                            localStorage.removeItem(\"me.save.\" + key);\n                            localStorage.setItem(\"me.save\", JSON.stringify(Object.keys(data)));\n                        }\n                    }\n                }\n            }\n        };\n\n        return api;\n    })();\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n * Tile QT 0.7.x format\n * http://www.mapeditor.org/\n *\n */\n(function () {\n    /**\n     * a collection of TMX utility Function\n     * @final\n     * @memberOf me\n     * @ignore\n     */\n    me.TMXUtils = (function () {\n        /*\n         * PUBLIC\n         */\n\n        // hold public stuff in our singleton\n        var api = {};\n\n        /**\n         * set and interpret a TMX property value\n         * @ignore\n         */\n        function setTMXValue(name, value) {\n            var match;\n\n            if (typeof(value) !== \"string\") {\n                // Value is already normalized\n                return value;\n            }\n\n            if (!value || value.isBoolean()) {\n                // if value not defined or boolean\n                value = value ? (value === \"true\") : true;\n            }\n            else if (value.isNumeric()) {\n                // check if numeric\n                value = Number(value);\n            }\n            else if (value.match(/^json:/i)) {\n                // try to parse it\n                match = value.split(/^json:/i)[1];\n                try {\n                    value = JSON.parse(match);\n                }\n                catch (e) {\n                    throw new me.Error(\"Unable to parse JSON: \" + match);\n                }\n            }\n            else if (value.match(/^eval:/i)) {\n                // try to evaluate it\n                match = value.split(/^eval:/i)[1];\n                try {\n                    value = eval(match);\n                }\n                catch (e) {\n                    throw new me.Error(\"Unable to evaluate: \" + match);\n                }\n            }\n\n            // normalize values\n            if (name.search(/^(ratio|anchorPoint)$/) === 0) {\n                // convert number to vector\n                if (typeof(value) === \"number\") {\n                    value = {\n                        \"x\" : value,\n                        \"y\" : value\n                    };\n                }\n            }\n\n            // return the interpreted value\n            return value;\n        }\n\n        function parseAttributes(obj, elt) {\n            // do attributes\n            if (elt.attributes && elt.attributes.length > 0) {\n                for (var j = 0; j < elt.attributes.length; j++) {\n                    var attribute = elt.attributes.item(j);\n                    if (typeof(attribute.name) !== \"undefined\") {\n                        // DOM4 (Attr no longer inherit from Node)\n                        obj[attribute.name] = attribute.value;\n                    } else {\n                        // else use the deprecated ones\n                        obj[attribute.nodeName] = attribute.nodeValue;\n                    }\n                }\n            }\n        }\n\n       /**\n        * Decode the given data\n        * @ignore\n        */\n        api.decode = function (data, encoding, compression) {\n            compression = compression || \"none\";\n            encoding = encoding || \"none\";\n\n            switch (encoding) {\n                case \"csv\":\n                    return me.utils.decodeCSV(data);\n\n                case \"base64\":\n                    var decoded = me.utils.decodeBase64AsArray(data, 4);\n                    return (\n                        (compression === \"none\") ?\n                        decoded :\n                        me.utils.decompress(decoded, compression)\n                    );\n\n                case \"none\":\n                    return data;\n\n                default:\n                    throw new me.Error(\"Unknown layer encoding: \" + encoding);\n            }\n        };\n\n        /**\n         * Normalize TMX format to Tiled JSON format\n         * @ignore\n         */\n        api.normalize = function (obj, item) {\n            var nodeName = item.nodeName;\n\n            switch (nodeName) {\n                case \"data\":\n                    var data = api.parse(item);\n                    obj.data = api.decode(data.text, data.encoding, data.compression);\n                    obj.encoding = \"none\";\n                    break;\n\n                case \"imagelayer\":\n                case \"layer\":\n                case \"objectgroup\":\n                    var layer = api.parse(item);\n                    layer.type = (nodeName === \"layer\" ? \"tilelayer\" : nodeName);\n                    if (layer.image) {\n                        layer.image = layer.image.source;\n                    }\n\n                    obj.layers = obj.layers || [];\n                    obj.layers.push(layer);\n                    break;\n\n                case \"animation\":\n                    obj.animation = api.parse(item).frames;\n                    break;\n\n                case \"frame\":\n                case \"object\":\n                    var name = nodeName + \"s\";\n                    obj[name] = obj[name] || [];\n                    obj[name].push(api.parse(item));\n                    break;\n\n                case \"tile\":\n                    var tile = api.parse(item);\n                    obj.tiles = obj.tiles || {};\n                    obj.tiles[tile.id] = tile;\n                    break;\n\n                case \"tileset\":\n                    var tileset = api.parse(item);\n                    if (tileset.image) {\n                        tileset.imagewidth = tileset.image.width;\n                        tileset.imageheight = tileset.image.height;\n                        tileset.image = tileset.image.source;\n                    }\n\n                    obj.tilesets = obj.tilesets || [];\n                    obj.tilesets.push(tileset);\n                    break;\n\n                case \"polygon\":\n                case \"polyline\":\n                    obj[nodeName] = [];\n\n                    // Get a point array\n                    var points = api.parse(item).points.split(\" \");\n\n                    // And normalize them into an array of vectors\n                    for (var i = 0, v; i < points.length; i++) {\n                        v = points[i].split(\",\");\n                        obj[nodeName].push({\n                            \"x\" : +v[0],\n                            \"y\" : +v[1]\n                        });\n                    }\n\n                    break;\n\n                case \"properties\":\n                    obj.properties = api.parse(item);\n                    break;\n\n                case \"property\":\n                    var property = api.parse(item);\n                    obj[property.name] = setTMXValue(property.name, property.value);\n                    break;\n\n                default:\n                    obj[nodeName] = api.parse(item);\n                    break;\n            }\n        };\n\n        /**\n         * Parse a XML TMX object and returns the corresponding javascript object\n         * @ignore\n         */\n        api.parse = function (xml) {\n            // Create the return object\n            var obj = {};\n\n            var text = \"\";\n\n            if (xml.nodeType === 1) {\n                // do attributes\n                parseAttributes(obj, xml);\n            }\n\n            // do children\n            if (xml.hasChildNodes()) {\n                for (var i = 0; i < xml.childNodes.length; i++) {\n                    var item = xml.childNodes.item(i);\n\n                    switch (item.nodeType) {\n                        case 1:\n                            api.normalize(obj, item);\n                            break;\n\n                        case 3:\n                            text += item.nodeValue.trim();\n                            break;\n                    }\n                }\n            }\n\n            if (text) {\n                obj.text = text;\n            }\n\n            return obj;\n        };\n\n        /**\n         * Apply TMX Properties to the given object\n         * @ignore\n         */\n        api.applyTMXProperties = function (obj, data) {\n            var properties = data.properties;\n            if (typeof(properties) !== \"undefined\") {\n                for (var name in properties) {\n                    if (properties.hasOwnProperty(name)) {\n                        // set the value\n                        obj[name] = setTMXValue(name, properties[name]);\n                    }\n                }\n            }\n        };\n\n        // return our object\n        return api;\n    })();\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n * Tile QT 0.7.x format\n * http://www.mapeditor.org/\n *\n */\n(function () {\n\n    /**\n     * TMX Object Group <br>\n     * contains the object group definition as defined in Tiled. <br>\n     * note : object group definition is translated into the virtual `me.game.world` using `me.Container`.\n     * @see me.Container\n     * @class\n     * @extends Object\n     * @memberOf me\n     * @constructor\n     */\n    me.TMXObjectGroup = me.Object.extend({\n        init : function (name, tmxObjGroup, orientation, tilesets, z) {\n            /**\n             * group name\n             * @public\n             * @type String\n             * @name name\n             * @memberOf me.TMXObjectGroup\n             */\n            this.name = name;\n\n            /**\n             * group width\n             * @public\n             * @type Number\n             * @name width\n             * @memberOf me.TMXObjectGroup\n             */\n            this.width = tmxObjGroup.width;\n\n            /**\n             * group height\n             * @public\n             * @type Number\n             * @name height\n             * @memberOf me.TMXObjectGroup\n             */\n            this.height = tmxObjGroup.height;\n\n            /**\n             * group z order\n             * @public\n             * @type Number\n             * @name z\n             * @memberOf me.TMXObjectGroup\n             */\n            this.z = z;\n\n            /**\n             * group objects list definition\n             * @see me.TMXObject\n             * @public\n             * @type Array\n             * @name name\n             * @memberOf me.TMXObjectGroup\n             */\n            this.objects = [];\n\n            var visible = typeof(tmxObjGroup.visible) !== \"undefined\" ? tmxObjGroup.visible : true;\n            this.opacity = (visible === true) ? (+tmxObjGroup.opacity || 1.0).clamp(0.0, 1.0) : 0;\n\n            // check if we have any user-defined properties\n            me.TMXUtils.applyTMXProperties(this, tmxObjGroup);\n\n            // parse all objects\n            var _objects = tmxObjGroup.objects;\n            if (_objects) {\n                var self = this;\n                _objects.forEach(function (tmxObj) {\n                    self.objects.push(new me.TMXObject(tmxObj, orientation, tilesets, z));\n                });\n            }\n        },\n\n        /**\n         * reset function\n         * @ignore\n         * @function\n         */\n\n        destroy : function () {\n            // clear all allocated objects\n            this.objects = null;\n        },\n\n        /**\n         * return the object count\n         * @ignore\n         * @function\n         */\n        getObjectCount : function () {\n            return this.objects.length;\n        },\n\n        /**\n         * returns the object at the specified index\n         * @ignore\n         * @function\n         */\n        getObjectByIndex : function (idx) {\n            return this.objects[idx];\n        }\n    });\n\n    /**\n     * a TMX Object defintion, as defined in Tiled. <br>\n     * note : object definition are translated into the virtual `me.game.world` using `me.Entity`.\n     * @see me.Entity\n     * @class\n     * @extends Object\n     * @memberOf me\n     * @constructor\n     */\n    me.TMXObject = me.Object.extend({\n        init :  function (tmxObj, orientation, tilesets, z) {\n\n            /**\n             * object point list (for Polygon and PolyLine)\n             * @public\n             * @type Vector2d[]\n             * @name points\n             * @memberOf me.TMXObject\n             */\n            this.points = undefined;\n\n            /**\n             * object name\n             * @public\n             * @type String\n             * @name name\n             * @memberOf me.TMXObject\n             */\n            this.name = tmxObj.name;\n\n            /**\n             * object x position\n             * @public\n             * @type Number\n             * @name x\n             * @memberOf me.TMXObject\n             */\n            this.x = +tmxObj.x;\n\n            /**\n             * object y position\n             * @public\n             * @type Number\n             * @name y\n             * @memberOf me.TMXObject\n             */\n            this.y = +tmxObj.y;\n\n            /**\n             * object z order\n             * @public\n             * @type Number\n             * @name z\n             * @memberOf me.TMXObject\n             */\n            this.z = +z;\n\n            /**\n             * object width\n             * @public\n             * @type Number\n             * @name width\n             * @memberOf me.TMXObject\n             */\n            this.width = +tmxObj.width || 0;\n\n            /**\n             * object height\n             * @public\n             * @type Number\n             * @name height\n             * @memberOf me.TMXObject\n             */\n            this.height = +tmxObj.height || 0;\n\n            /**\n             * object gid value\n             * when defined the object is a tiled object\n             * @public\n             * @type Number\n             * @name gid\n             * @memberOf me.TMXObject\n             */\n            this.gid = +tmxObj.gid || null;\n\n            /**\n             * object type\n             * @public\n             * @type String\n             * @name type\n             * @memberOf me.TMXObject\n             */\n            this.type = tmxObj.type;\n\n            /**\n             * The rotation of the object in radians clockwise (defaults to 0)\n             * @public\n             * @type Number\n             * @name rotation\n             * @memberOf me.TMXObject\n             */\n            this.rotation = Number.prototype.degToRad(+tmxObj.rotation || 0);\n\n            /**\n             * object unique identifier per level (Tiled 0.11.x+)\n             * @public\n             * @type Number\n             * @name id\n             * @memberOf me.TMXObject\n             */\n            this.id = +tmxObj.id || undefined;\n\n            /**\n             * object orientation (orthogonal or isometric)\n             * @public\n             * @type String\n             * @name orientation\n             * @memberOf me.TMXObject\n             */\n            this.orientation = orientation;\n\n            /**\n             * the collision shapes defined for this object\n             * @public\n             * @type Array\n             * @name shapes\n             * @memberOf me.TMXObject\n             */\n            this.shapes = undefined;\n\n            /**\n             * if true, the object is an Ellipse\n             * @public\n             * @type Boolean\n             * @name isEllipse\n             * @memberOf me.TMXObject\n             */\n            this.isEllipse = false;\n\n            /**\n             * if true, the object is a Polygon\n             * @public\n             * @type Boolean\n             * @name isPolygon\n             * @memberOf me.TMXObject\n             */\n            this.isPolygon = false;\n\n            /**\n             * if true, the object is a PolyLine\n             * @public\n             * @type Boolean\n             * @name isPolyLine\n             * @memberOf me.TMXObject\n             */\n            this.isPolyLine = false;\n\n            // check if the object has an associated gid\n            if (typeof this.gid === \"number\") {\n                this.setTile(tilesets);\n            }\n            else {\n                if (typeof(tmxObj.ellipse) !== \"undefined\") {\n                    this.isEllipse = true;\n                }\n                else {\n                    var points = tmxObj.polygon;\n                    if (typeof(points) !== \"undefined\") {\n                        this.isPolygon = true;\n                    }\n                    else {\n                        points = tmxObj.polyline;\n                        if (typeof(points) !== \"undefined\") {\n                            this.isPolyLine = true;\n                        }\n                    }\n                    if (typeof(points) !== \"undefined\") {\n                        this.points = [];\n                        var self = this;\n                        points.forEach(function (point) {\n                            self.points.push(new me.Vector2d(point.x, point.y));\n                        });\n                    }\n                }\n            }\n\n            // Adjust the Position to match Tiled\n            me.game.tmxRenderer.adjustPosition(this);\n\n            // set the object properties\n            me.TMXUtils.applyTMXProperties(this, tmxObj);\n\n            // define the object shapes if required\n            if (!this.shapes) {\n                this.shapes = this.parseTMXShapes();\n            }\n        },\n\n        /**\n         * set the object image (for Tiled Object)\n         * @ignore\n         * @function\n         */\n        setTile : function (tilesets) {\n            // get the corresponding tileset\n            var tileset = tilesets.getTilesetByGid(this.gid);\n\n            // set width and height equal to tile size\n            this.width = this.framewidth = tileset.tilewidth;\n            this.height = this.frameheight = tileset.tileheight;\n\n            // the object corresponding tile object\n            this.tile = new me.Tile(this.x, this.y, this.gid, tileset);\n        },\n\n        /**\n         * parses the TMX shape definition and returns a corresponding array of me.Shape object\n         * @name parseTMXShapes\n         * @memberOf me.TMXObject\n         * @private\n         * @function\n         * @return {me.Polygon[]|me.Line[]|me.Ellipse[]} an array of shape objects\n         */\n        parseTMXShapes : function () {\n            var i = 0;\n            var shapes = [];\n\n            // add an ellipse shape\n            if (this.isEllipse === true) {\n                // ellipse coordinates are the center position, so set default to the corresonding radius\n                shapes.push((new me.Ellipse(\n                    this.width / 2,\n                    this.height / 2,\n                    this.width,\n                    this.height\n                )).rotate(this.rotation));\n            }\n\n            // add a polygon\n            else if (this.isPolygon === true) {\n                shapes.push((new me.Polygon(0, 0, this.points)).rotate(this.rotation));\n            }\n\n            // add a polyline\n            else if (this.isPolyLine === true) {\n                var p = this.points;\n                var p1, p2;\n                var segments = p.length - 1;\n                for (i = 0; i < segments; i++) {\n                    // clone the value before, as [i + 1]\n                    // is reused later by the next segment\n                    p1 = p[i];\n                    p2 = p[i + 1].clone();\n                    if (this.rotation !== 0) {\n                        p1 = p1.rotate(this.rotation);\n                        p2 = p2.rotate(this.rotation);\n                    }\n                    shapes.push(new me.Line(0, 0, [ p1, p2 ]));\n                }\n            }\n\n            // it's a rectangle, returns a polygon object anyway\n            else {\n                shapes.push((new me.Polygon(\n                    0, 0, [\n                        new me.Vector2d(), new me.Vector2d(this.width, 0),\n                        new me.Vector2d(this.width, this.height), new me.Vector2d(0, this.height)\n                    ]\n                )).rotate(this.rotation));\n            }\n\n            // Apply isometric projection\n            if (this.orientation === \"isometric\") {\n                for (i = 0; i < shapes.length; i++) {\n                    shapes[i].rotate(Math.PI / 4).scale(Math.SQRT2, Math.SQRT1_2);\n                }\n            }\n\n            return shapes;\n        },\n        /**\n         * getObjectPropertyByName\n         * @ignore\n         * @function\n         */\n        getObjectPropertyByName : function (name) {\n            return this[name];\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n * Tile QT 0.7.x format\n * http://www.mapeditor.org/\n *\n */\n(function () {\n\n    // bitmask constants to check for flipped & rotated tiles\n    var TMX_FLIP_H          = 0x80000000,\n        TMX_FLIP_V          = 0x40000000,\n        TMX_FLIP_AD         = 0x20000000,\n        TMX_CLEAR_BIT_MASK  = ~(0x80000000 | 0x40000000 | 0x20000000);\n\n    /**\n     * a basic tile object\n     * @class\n     * @extends me.Rect\n     * @memberOf me\n     * @constructor\n     * @param {Number} x x index of the Tile in the map\n     * @param {Number} y y index of the Tile in the map\n     * @param {Number} gid tile gid\n     * @param {me.TMXTileset} tileset the corresponding tileset object\n\n     */\n    me.Tile = me.Rect.extend({\n        /** @ignore */\n        init : function (x, y, gid, tileset) {\n            /**\n             * tileset\n             * @public\n             * @type me.TMXTileset\n             * @name me.Tile#tileset\n             */\n            this.tileset = tileset;\n\n            /**\n             * the tile transformation matrix (if defined)\n             * @ignore\n             */\n            this.transform = null;\n            me.Rect.prototype.init.apply(this, [x * tileset.tilewidth, y * tileset.tileheight, tileset.tilewidth, tileset.tileheight]);\n\n            // Tile col / row pos\n            this.col = x;\n            this.row = y;\n\n            /**\n             * tileId\n             * @public\n             * @type int\n             * @name me.Tile#tileId\n             */\n            this.tileId = gid;\n            /**\n             * True if the tile is flipped horizontally<br>\n             * @public\n             * @type Boolean\n             * @name me.Tile#flipX\n             */\n            this.flippedX  = (this.tileId & TMX_FLIP_H) !== 0;\n            /**\n             * True if the tile is flipped vertically<br>\n             * @public\n             * @type Boolean\n             * @name me.Tile#flippedY\n             */\n            this.flippedY  = (this.tileId & TMX_FLIP_V) !== 0;\n            /**\n             * True if the tile is flipped anti-diagonally<br>\n             * @public\n             * @type Boolean\n             * @name me.Tile#flippedAD\n             */\n            this.flippedAD = (this.tileId & TMX_FLIP_AD) !== 0;\n\n            /**\n             * Global flag that indicates if the tile is flipped<br>\n             * @public\n             * @type Boolean\n             * @name me.Tile#flipped\n             */\n            this.flipped = this.flippedX || this.flippedY || this.flippedAD;\n            // create a transformation matrix if required\n            if (this.flipped === true) {\n                this.createTransform();\n            }\n\n            // clear out the flags and set the tileId\n            this.tileId &= TMX_CLEAR_BIT_MASK;\n        },\n\n        /**\n         * create a transformation matrix for this tile\n         * @ignore\n         */\n        createTransform : function () {\n            if (this.transform === null) {\n                this.transform = new me.Matrix2d();\n            }\n            // reset the matrix (in case it was already defined)\n            this.transform.identity();\n            var a = this.transform.val;\n            if (this.flippedAD) {\n                // Use shearing to swap the X/Y axis\n                this.transform.set(\n                    0, 1, 0,\n                    1, 0, 0,\n                    0, 0, 1\n                );\n                this.transform.translate(0, this.height - this.width);\n            }\n            if (this.flippedX) {\n                this.transform.translate((this.flippedAD ? this.height : this.width), 0);\n                a[0] *= -1;\n                a[3] *= -1;\n\n            }\n            if (this.flippedY) {\n                this.transform.translate(0, (this.flippedAD ? this.width : this.height));\n                a[1] *= -1;\n                a[4] *= -1;\n            }\n        },\n\n        /**\n         * return a renderable object for this Tile object\n         * @name me.Tile#getRenderable\n         * @public\n         * @function\n         * @param {Object} [settings] see {@link me.Sprite}\n         * @return {me.Renderable} either a me.Sprite object or a me.AnimationSheet (for animated tiles)\n         */\n        getRenderable : function (settings) {\n            var renderable;\n            var tileset = this.tileset;\n\n            if (tileset.animations.has(this.tileId)) {\n                var frames = [];\n                var frameId = [];\n                (tileset.animations.get(this.tileId).frames).forEach(function (frame) {\n                    frameId.push(frame.tileid);\n                    frames.push({\n                        name : \"\"+frame.tileid,\n                        delay : frame.duration\n                    });\n                });\n                renderable = tileset.texture.createAnimationFromName(frameId, settings);\n                renderable.addAnimation(this.tileId - tileset.firstgid, frames);\n                renderable.setCurrentAnimation(this.tileId - tileset.firstgid);\n\n            } else {\n                renderable = tileset.texture.createSpriteFromName(this.tileId - tileset.firstgid, settings);\n            }\n\n            // AD flag is never set for Tile Object, use the given rotation instead\n            if (typeof(settings) !== \"undefined\") {\n                var angle = settings.rotation || 0;\n                if (angle !== 0) {\n                    renderable._sourceAngle += angle;\n                    // translate accordingly\n                    switch (angle) {\n                        case Math.PI:\n                            renderable.translate(0, this.height * 2);\n                            break;\n                        case Math.PI / 2 :\n                            renderable.translate(this.width, this.height);\n                            break;\n                        case -(Math.PI / 2) :\n                            renderable.translate(-this.width, this.height);\n                            break;\n                        default :\n                            // this should not happen\n                            break;\n                    }\n                }\n            }\n\n            // any H/V flipping to apply?\n            if (this.flipped === true) {\n                renderable.flipX(this.flippedX);\n                renderable.flipY(this.flippedY);\n            }\n\n            return renderable;\n        },\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n * Tile QT 0.7.x format\n * http://www.mapeditor.org/\n *\n */\n(function () {\n\n    // bitmask constants to check for flipped & rotated tiles\n    var TMX_CLEAR_BIT_MASK = ~(0x80000000 | 0x40000000 | 0x20000000);\n\n    /**\n     * a TMX Tile Set Object\n     * @class\n     * @memberOf me\n     * @constructor\n     */\n    me.TMXTileset = me.Object.extend({\n        // constructor\n        init: function (tileset) {\n            var i = 0;\n            // first gid\n\n            // tile properties (collidable, etc..)\n            this.TileProperties = [];\n\n            this.firstgid = this.lastgid = +tileset.firstgid;\n            var src = tileset.source;\n            if (src && me.utils.getFileExtension(src) === \"tsx\") {\n                // load TSX\n                tileset = me.loader.getTMX(me.utils.getBasename(src));\n\n                if (!tileset) {\n                    throw new me.Error(src + \" TSX tileset not found\");\n                }\n            }\n\n            this.name = tileset.name;\n            this.tilewidth = +tileset.tilewidth;\n            this.tileheight = +tileset.tileheight;\n            this.spacing = +tileset.spacing || 0;\n            this.margin = +tileset.margin || 0;\n\n            // set tile offset properties (if any)\n            this.tileoffset = new me.Vector2d();\n\n            /**\n             * Tileset contains animated tiles\n             * @public\n             * @type Boolean\n             * @name me.TMXTileset#isAnimated\n             */\n            this.isAnimated = false;\n\n            /**\n             * Tileset animations\n             * @private\n             * @type Map\n             * @name me.TMXTileset#animations\n             */\n            this.animations = new Map();\n\n            var tiles = tileset.tiles;\n            for (i in tiles) {\n                if (tiles.hasOwnProperty(i) && (\"animation\" in tiles[i])) {\n                    this.isAnimated = true;\n                    this.animations.set(+i + this.firstgid, {\n                        dt      : 0,\n                        idx     : 0,\n                        frames  : tiles[i].animation,\n                        cur     : tiles[i].animation[0]\n                    });\n                }\n            }\n\n            var offset = tileset.tileoffset;\n            if (offset) {\n                this.tileoffset.x = +offset.x;\n                this.tileoffset.y = +offset.y;\n            }\n\n            // set tile properties, if any\n            var tileInfo = tileset.tileproperties;\n            if (tileInfo) {\n                for (i in tileInfo) {\n                    if (tileInfo.hasOwnProperty(i)) {\n                        this.setTileProperty(i + this.firstgid, tileInfo[i]);\n                    }\n                }\n            }\n\n            this.image = me.utils.getImage(tileset.image);\n            if (!this.image) {\n                throw new me.TMXTileset.Error(\"melonJS: '\" + tileset.image + \"' file for tileset '\" + this.name + \"' not found!\");\n            }\n\n            // create a texture atlas for the given tileset\n            this.texture = me.video.renderer.cache.get(this.image, {\n                framewidth : this.tilewidth,\n                frameheight : this.tileheight,\n                margin : this.margin,\n                spacing : this.spacing\n            });\n            this.atlas = this.texture.getAtlas();\n\n            // calculate the number of tiles per horizontal line\n            var hTileCount = ~~(this.image.width / (this.tilewidth + this.spacing));\n            var vTileCount = ~~(this.image.height / (this.tileheight + this.spacing));\n            // compute the last gid value in the tileset\n            this.lastgid = this.firstgid + (((hTileCount * vTileCount) - 1) || 0);\n            if (tileset.tilecount && this.lastgid - this.firstgid + 1 !== +tileset.tilecount) {\n                console.warn(\n                    \"Computed tilecount (\" + (this.lastgid - this.firstgid + 1) +\n                    \") does not match expected tilecount (\" + tileset.tilecount + \")\"\n                );\n            }\n        },\n\n        /**\n         * set the tile properties\n         * @ignore\n         * @function\n         */\n        setTileProperty : function (gid, prop) {\n            // set the given tile id\n            this.TileProperties[gid] = prop;\n        },\n\n        /**\n         * return true if the gid belongs to the tileset\n         * @name me.TMXTileset#contains\n         * @public\n         * @function\n         * @param {Number} gid\n         * @return {Boolean}\n         */\n        contains : function (gid) {\n            return gid >= this.firstgid && gid <= this.lastgid;\n        },\n\n        /**\n         * Get the view (local) tile ID from a GID, with animations applied\n         * @name me.TMXTileset#getViewTileId\n         * @public\n         * @function\n         * @param {Number} gid Global tile ID\n         * @return {Number} View tile ID\n         */\n        getViewTileId : function (gid) {\n            if (this.animations.has(gid)) {\n                // apply animations\n                gid = this.animations.get(gid).cur.tileid;\n            }\n            else {\n                // get the local tileset id\n                gid -= this.firstgid;\n            }\n\n            return gid;\n        },\n\n        /**\n         * return the properties of the specified tile\n         * @name me.TMXTileset#getTileProperties\n         * @public\n         * @function\n         * @param {Number} tileId\n         * @return {Object}\n         */\n        getTileProperties: function (tileId) {\n            return this.TileProperties[tileId];\n        },\n\n        // update tile animations\n        update : function (dt) {\n            var duration = 0,\n                result = false;\n\n            this.animations.forEach(function (anim) {\n                anim.dt += dt;\n                duration = anim.cur.duration;\n                while (anim.dt >= duration) {\n                    anim.dt -= duration;\n                    anim.idx = (anim.idx + 1) % anim.frames.length;\n                    anim.cur = anim.frames[anim.idx];\n                    duration = anim.cur.duration;\n                    result = true;\n                }\n            });\n\n            return result;\n        },\n\n        // draw the x,y tile\n        drawTile : function (renderer, dx, dy, tmxTile) {\n            // check if any transformation is required\n            if (tmxTile.flipped) {\n                renderer.save();\n                // apply the tile current transform\n                renderer.translate(dx, dy);\n                renderer.transform(tmxTile.transform);\n                // reset both values as managed through transform();\n                dx = dy = 0;\n            }\n\n            var offset = this.atlas[this.getViewTileId(tmxTile.tileId)].offset;\n\n            // draw the tile\n            renderer.drawImage(\n                this.image,\n                offset.x, offset.y,\n                this.tilewidth, this.tileheight,\n                dx, dy,\n                this.tilewidth, this.tileheight\n            );\n\n            if (tmxTile.flipped)  {\n                // restore the context to the previous state\n                renderer.restore();\n            }\n        }\n    });\n\n    /**\n     * an object containing all tileset\n     * @class\n     * @memberOf me\n     * @constructor\n     */\n    me.TMXTilesetGroup = me.Object.extend({\n        // constructor\n        init: function () {\n            this.tilesets = [];\n            this.length = 0;\n        },\n\n        //add a tileset to the tileset group\n        add : function (tileset) {\n            this.tilesets.push(tileset);\n            this.length++;\n        },\n\n        //return the tileset at the specified index\n        getTilesetByIndex : function (i) {\n            return this.tilesets[i];\n        },\n\n        /**\n         * return the tileset corresponding to the specified id <br>\n         * will throw an exception if no matching tileset is found\n         * @name me.TMXTilesetGroup#getTilesetByGid\n         * @public\n         * @function\n         * @param {Number} gid\n         * @return {me.TMXTileset} corresponding tileset\n         */\n        getTilesetByGid : function (gid) {\n            var invalidRange = -1;\n\n            // clear the gid of all flip/rotation flags\n            gid &= TMX_CLEAR_BIT_MASK;\n\n            // cycle through all tilesets\n            for (var i = 0, len = this.tilesets.length; i < len; i++) {\n                // return the corresponding tileset if matching\n                if (this.tilesets[i].contains(gid)) {\n                    return this.tilesets[i];\n                }\n                // typically indicates a layer with no asset loaded (collision?)\n                if (this.tilesets[i].firstgid === this.tilesets[i].lastgid &&\n                    gid >= this.tilesets[i].firstgid) {\n                    // store the id if the [firstgid .. lastgid] is invalid\n                    invalidRange = i;\n                }\n            }\n            // return the tileset with the invalid range\n            if (invalidRange !== -1) {\n                return this.tilesets[invalidRange];\n            }\n            else {\n                throw new me.Error(\"no matching tileset found for gid \" + gid);\n            }\n        }\n    });\n\n    /**\n     * Base class for TMXTileset exception handling.\n     * @name Error\n     * @class\n     * @memberOf me.TMXTileset\n     * @constructor\n     * @param {String} msg Error message.\n     */\n    me.TMXTileset.Error = me.Error.extend({\n        init : function (msg) {\n            me.Error.prototype.init.apply(this, [ msg ]);\n            this.name = \"me.TMXTileset.Error\";\n        }\n    });\n\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n * Tile QT 0.7.x format\n * http://www.mapeditor.org/\n *\n */\n(function () {\n\n    // scope global var & constants\n    var offsetsStaggerX = [\n        {x:   0, y:   0},\n        {x: + 1, y: - 1},\n        {x: + 1, y:   0},\n        {x: + 2, y:   0},\n    ];\n    var offsetsStaggerY = [\n        {x:   0, y:   0},\n        {x: - 1, y: + 1},\n        {x:   0, y: + 1},\n        {x:   0, y: + 2},\n    ];\n\n    /**\n     * The map renderder base class\n     * @memberOf me\n     * @ignore\n     * @constructor\n     */\n    me.TMXRenderer = me.Object.extend({\n        // constructor\n        init: function (cols, rows, tilewidth, tileheight) {\n            this.cols = cols;\n            this.rows = rows;\n            this.tilewidth = tilewidth;\n            this.tileheight = tileheight;\n        },\n\n        /**\n         * return true if the renderer can render the specified layer\n         * @ignore\n         */\n        canRender : function (layer) {\n            return (\n                (this.cols === layer.cols) &&\n                (this.rows === layer.rows) &&\n                (this.tilewidth === layer.tilewidth) &&\n                (this.tileheight === layer.tileheight)\n            );\n        }\n    });\n\n\n    /**\n     * an Orthogonal Map Renderder\n     * Tiled QT 0.7.x format\n     * @memberOf me\n     * @extends me.TMXRenderer\n     * @ignore\n     * @constructor\n     */\n    me.TMXOrthogonalRenderer = me.TMXRenderer.extend({\n        /**\n         * return true if the renderer can render the specified layer\n         * @ignore\n         */\n        canRender : function (layer) {\n            return (\n                (layer.orientation === \"orthogonal\") &&\n                me.TMXRenderer.prototype.canRender.apply(this, [ layer ])\n            );\n        },\n\n        /**\n         * return the tile position corresponding to the specified pixel\n         * @ignore\n         */\n        pixelToTileCoords : function (x, y, v) {\n            var ret = v || new me.Vector2d();\n            return ret.set(\n                this.pixelToTileX(x),\n                this.pixelToTileY(y)\n            );\n        },\n\n        /**\n         * return the tile position corresponding for the given X coordinate\n         * @ignore\n         */\n        pixelToTileX : function (x) {\n            return x / this.tilewidth;\n        },\n\n        /**\n         * return the tile position corresponding for the given Y coordinates\n         * @ignore\n         */\n        pixelToTileY : function (y) {\n            return y / this.tileheight;\n        },\n\n        /**\n         * return the pixel position corresponding of the specified tile\n         * @ignore\n         */\n        tileToPixelCoords : function (x, y, v) {\n            var ret = v || new me.Vector2d();\n            return ret.set(\n                x * this.tilewidth,\n                y * this.tileheight\n            );\n        },\n\n        /**\n         * fix the position of Objects to match\n         * the way Tiled places them\n         * @ignore\n         */\n        adjustPosition: function (obj) {\n            // only adjust position if obj.gid is defined\n            if (typeof(obj.gid) === \"number\") {\n                // Tiled objects origin point is \"bottom-left\" in Tiled,\n                // \"top-left\" in melonJS)\n                obj.y -= obj.height;\n            }\n        },\n\n        /**\n         * draw the tile map\n         * @ignore\n         */\n        drawTile : function (renderer, x, y, tmxTile, tileset) {\n            // draw the tile\n            tileset.drawTile(\n                renderer,\n                tileset.tileoffset.x + x * this.tilewidth,\n                tileset.tileoffset.y + (y + 1) * this.tileheight - tileset.tileheight,\n                tmxTile\n            );\n        },\n\n        /**\n         * draw the tile map\n         * @ignore\n         */\n        drawTileLayer : function (renderer, layer, rect) {\n            // get top-left and bottom-right tile position\n            var start = this.pixelToTileCoords(\n                Math.max(rect.pos.x - (layer.maxTileSize.width - layer.tilewidth), 0),\n                Math.max(rect.pos.y - (layer.maxTileSize.height - layer.tileheight), 0),\n                me.pool.pull(\"me.Vector2d\")\n            ).floorSelf();\n\n            var end = this.pixelToTileCoords(\n                rect.pos.x + rect.width + this.tilewidth,\n                rect.pos.y + rect.height + this.tileheight,\n                me.pool.pull(\"me.Vector2d\")\n            ).ceilSelf();\n\n            //ensure we are in the valid tile range\n            end.x = end.x > this.cols ? this.cols : end.x;\n            end.y = end.y > this.rows ? this.rows : end.y;\n\n            // main drawing loop\n            for (var y = start.y; y < end.y; y++) {\n                for (var x = start.x; x < end.x; x++) {\n                    var tmxTile = layer.layerData[x][y];\n                    if (tmxTile) {\n                        this.drawTile(renderer, x, y, tmxTile, tmxTile.tileset);\n                    }\n                }\n            }\n\n            me.pool.push(start);\n            me.pool.push(end);\n        }\n    });\n\n\n    /**\n     * an Isometric Map Renderder\n     * Tiled QT 0.7.x format\n     * @memberOf me\n     * @extends me.TMXRenderer\n     * @ignore\n     * @constructor\n     */\n    me.TMXIsometricRenderer = me.TMXRenderer.extend({\n        // constructor\n        init: function (cols, rows, tilewidth, tileheight) {\n            me.TMXRenderer.prototype.init.apply(this, [\n                cols,\n                rows,\n                tilewidth,\n                tileheight\n            ]);\n\n            this.hTilewidth = tilewidth / 2;\n            this.hTileheight = tileheight / 2;\n            this.originX = this.rows * this.hTilewidth;\n        },\n\n        /**\n         * return true if the renderer can render the specified layer\n         * @ignore\n         */\n        canRender : function (layer) {\n            return (\n                (layer.orientation === \"isometric\") &&\n                me.TMXRenderer.prototype.canRender.apply(this, [ layer ])\n            );\n        },\n\n        /**\n         * return the tile position corresponding to the specified pixel\n         * @ignore\n         */\n        pixelToTileCoords : function (x, y, v) {\n            var ret = v || new me.Vector2d();\n            return ret.set(\n                this.pixelToTileX(x, y),\n                this.pixelToTileY(y, x)\n            );\n        },\n\n        /**\n         * return the tile position corresponding for the given X coordinate\n         * @ignore\n         */\n        pixelToTileX : function (x, y) {\n            return (y / this.tileheight) + ((x - this.originX) / this.tilewidth);\n        },\n\n        /**\n         * return the tile position corresponding for the given Y coordinates\n         * @ignore\n         */\n        pixelToTileY : function (y, x) {\n            return (y / this.tileheight) - ((x - this.originX) / this.tilewidth);\n        },\n\n        /**\n         * return the pixel position corresponding of the specified tile\n         * @ignore\n         */\n        tileToPixelCoords : function (x, y, v) {\n            var ret = v || new me.Vector2d();\n            return ret.set(\n                (x - y) * this.hTilewidth + this.originX,\n                (x + y) * this.hTileheight\n            );\n        },\n\n        /**\n         * fix the position of Objects to match\n         * the way Tiled places them\n         * @ignore\n         */\n        adjustPosition: function (obj) {\n            var tilex = obj.x / this.hTilewidth;\n            var tiley = obj.y / this.tileheight;\n            var isoPos = this.tileToPixelCoords(tilex, tiley);\n\n            obj.x = isoPos.x;\n            obj.y = isoPos.y;\n        },\n\n        /**\n         * draw the tile map\n         * @ignore\n         */\n        drawTile : function (renderer, x, y, tmxTile, tileset) {\n            // draw the tile\n            tileset.drawTile(\n                renderer,\n                ((this.cols - 1) * tileset.tilewidth + (x - y) * tileset.tilewidth >> 1),\n                (-tileset.tilewidth + (x + y) * tileset.tileheight >> 2),\n                tmxTile\n            );\n        },\n\n        /**\n         * draw the tile map\n         * @ignore\n         */\n        drawTileLayer : function (renderer, layer, rect) {\n            // cache a couple of useful references\n            var tileset = layer.tileset;\n            var offset  = tileset.tileoffset;\n\n            // get top-left and bottom-right tile position\n            var rowItr = this.pixelToTileCoords(\n                rect.pos.x - tileset.tilewidth,\n                rect.pos.y - tileset.tileheight,\n                me.pool.pull(\"me.Vector2d\")\n            ).floorSelf();\n            var TileEnd = this.pixelToTileCoords(\n                rect.pos.x + rect.width + tileset.tilewidth,\n                rect.pos.y + rect.height + tileset.tileheight,\n                me.pool.pull(\"me.Vector2d\")\n            ).ceilSelf();\n\n            var rectEnd = this.tileToPixelCoords(TileEnd.x, TileEnd.y, me.pool.pull(\"me.Vector2d\"));\n\n            // Determine the tile and pixel coordinates to start at\n            var startPos = this.tileToPixelCoords(rowItr.x, rowItr.y, me.pool.pull(\"me.Vector2d\"));\n            startPos.x -= this.hTilewidth;\n            startPos.y += this.tileheight;\n\n            /* Determine in which half of the tile the top-left corner of the area we\n             * need to draw is. If we're in the upper half, we need to start one row\n             * up due to those tiles being visible as well. How we go up one row\n             * depends on whether we're in the left or right half of the tile.\n             */\n            var inUpperHalf = startPos.y - rect.pos.y > this.hTileheight;\n            var inLeftHalf  = rect.pos.x - startPos.x < this.hTilewidth;\n\n            if (inUpperHalf) {\n                if (inLeftHalf) {\n                    rowItr.x--;\n                    startPos.x -= this.hTilewidth;\n                }\n                else {\n                    rowItr.y--;\n                    startPos.x += this.hTilewidth;\n                }\n                startPos.y -= this.hTileheight;\n            }\n\n            // Determine whether the current row is shifted half a tile to the right\n            var shifted = inUpperHalf ^ inLeftHalf;\n\n            // initialize the columItr vector\n            var columnItr = rowItr.clone();\n\n            // main drawing loop\n            for (var y = startPos.y; y - this.tileheight < rectEnd.y; y += this.hTileheight) {\n                columnItr.setV(rowItr);\n                for (var x = startPos.x; x < rectEnd.x; x += this.tilewidth) {\n                    //check if it's valid tile, if so render\n                    if (\n                        (columnItr.x >= 0) &&\n                        (columnItr.y >= 0) &&\n                        (columnItr.x < this.cols) &&\n                        (columnItr.y < this.rows)\n                    ) {\n                        var tmxTile = layer.layerData[columnItr.x][columnItr.y];\n                        if (tmxTile) {\n                            tileset = tmxTile.tileset;\n                            // offset could be different per tileset\n                            offset  = tileset.tileoffset;\n                            // draw our tile\n                            tileset.drawTile(\n                                renderer,\n                                offset.x + x,\n                                offset.y + y - tileset.tileheight,\n                                tmxTile\n                            );\n                        }\n                    }\n                    // Advance to the next column\n                    columnItr.x++;\n                    columnItr.y--;\n                }\n\n                // Advance to the next row\n                if (!shifted) {\n                    rowItr.x++;\n                    startPos.x += this.hTilewidth;\n                    shifted = true;\n                }\n                else {\n                    rowItr.y++;\n                    startPos.x -= this.hTilewidth;\n                    shifted = false;\n                }\n            }\n\n            me.pool.push(rowItr);\n            me.pool.push(TileEnd);\n            me.pool.push(rectEnd);\n            me.pool.push(startPos);\n        }\n    });\n\n\n    /**\n     * an Hexagonal Map Renderder\n     * Tiled QT 0.7.x format\n     * @memberOf me\n     * @extends me.TMXRenderer\n     * @ignore\n     * @constructor\n     */\n    me.TMXHexagonalRenderer = me.TMXRenderer.extend({\n        // constructor\n        init: function (cols, rows, tilewidth, tileheight, hexsidelength, staggeraxis, staggerindex) {\n            me.TMXRenderer.prototype.init.apply(this, [\n                cols,\n                rows,\n                tilewidth,\n                tileheight\n            ]);\n\n            this.hexsidelength = hexsidelength;\n            this.staggeraxis = staggeraxis;\n            this.staggerindex = staggerindex;\n\n            this.sidelengthx = 0;\n            this.sidelengthy = 0;\n\n            if (staggeraxis === \"x\") {\n                this.sidelengthx = hexsidelength;\n            }\n            else {\n                this.sidelengthy = hexsidelength;\n            }\n\n            this.sideoffsetx = (this.tilewidth - this.sidelengthx) / 2;\n            this.sideoffsety = (this.tileheight - this.sidelengthy) / 2;\n\n            this.columnwidth = this.sideoffsetx + this.sidelengthx;\n            this.rowheight = this.sideoffsety + this.sidelengthy;\n\n            this.centers = [\n                new me.Vector2d(),\n                new me.Vector2d(),\n                new me.Vector2d(),\n                new me.Vector2d()\n            ];\n        },\n\n        /**\n         * return true if the renderer can render the specified layer\n         * @ignore\n         */\n        canRender : function (layer) {\n            return (\n                (layer.orientation === \"hexagonal\") &&\n                me.TMXRenderer.prototype.canRender.apply(this, [ layer ])\n            );\n        },\n\n        /**\n         * return the tile position corresponding to the specified pixel\n         * @ignore\n         */\n        pixelToTileCoords : function (x, y, v) {\n            var q, r;\n            var ret = v || new me.Vector2d();\n\n            if (this.staggeraxis === \"x\") { //flat top\n                x = x - ((this.staggerindex === \"odd\") ? this.sideoffsetx : this.tilewidth);\n            }\n            else { //pointy top\n                y = y - ((this.staggerindex === \"odd\") ? this.sideoffsety : this.tileheight);\n            }\n\n            // Start with the coordinates of a grid-aligned tile\n            var referencePoint = me.pool.pull(\"me.Vector2d\",\n                Math.floor(x / (this.tilewidth + this.sidelengthx)),\n                Math.floor((y / (this.tileheight + this.sidelengthy)))\n            );\n\n            // Relative x and y position on the base square of the grid-aligned tile\n            var rel = me.pool.pull(\"me.Vector2d\",\n                x - referencePoint.x * (this.tilewidth + this.sidelengthx),\n                y - referencePoint.y * (this.tileheight + this.sidelengthy)\n            );\n\n            // Adjust the reference point to the correct tile coordinates\n            if (this.staggeraxis === \"x\") {\n                referencePoint.x = referencePoint.x * 2;\n                if (this.staggerindex === \"even\") {\n                    ++referencePoint.x;\n                }\n            }\n            else {\n                referencePoint.y = referencePoint.y * 2;\n                if (this.staggerindex === \"even\") {\n                    ++referencePoint.y;\n                }\n            }\n\n            // Determine the nearest hexagon tile by the distance to the center\n            var left, top, centerX, centerY;\n            if (this.staggeraxis === \"x\") {\n                left = this.sidelengthx / 2;\n                centerX = left + this.columnwidth;\n                centerY = this.tileheight / 2;\n\n                this.centers[0].set(left, centerY);\n                this.centers[1].set(centerX, centerY - this.rowheight);\n                this.centers[2].set(centerX, centerY + this.rowheight);\n                this.centers[3].set(centerX + this.columnwidth, centerY);\n            }\n            else {\n                top = this.sidelengthy / 2;\n                centerX = this.tilewidth / 2;\n                centerY = top + this.rowheight;\n\n                this.centers[0].set(centerX, top);\n                this.centers[1].set(centerX - this.columnwidth, centerY);\n                this.centers[2].set(centerX + this.columnwidth, centerY);\n                this.centers[3].set(centerX, centerY + this.rowheight);\n            }\n\n            var nearest = 0;\n            var minDist = Number.MAX_VALUE;\n            var dc;\n            for (var i = 0; i < 4; ++i) {\n                dc = Math.pow(this.centers[i].x - rel.x, 2) + Math.pow(this.centers[i].y - rel.y, 2);\n                if (dc < minDist) {\n                    minDist = dc;\n                    nearest = i;\n                }\n            }\n\n            var offsets = (this.staggeraxis === \"x\") ? offsetsStaggerX : offsetsStaggerY;\n\n            q = referencePoint.x + offsets[nearest].x;\n            r = referencePoint.y + offsets[nearest].y;\n\n            me.pool.push(referencePoint);\n            me.pool.push(rel);\n\n            return ret.set(q, r);\n        },\n\n        /**\n         * return the tile position corresponding for the given X coordinate\n         * @ignore\n         */\n        pixelToTileX : function (x, y) {\n            var ret = me.pool.pull(\"me.Vector2d\");\n            this.pixelToTileCoords(x, y, ret);\n            me.pool.push(ret);\n            return ret.x;\n        },\n\n        /**\n         * return the tile position corresponding for the given Y coordinates\n         * @ignore\n         */\n        pixelToTileY : function (y, x) {\n            var ret = me.pool.pull(\"me.Vector2d\");\n            this.pixelToTileCoords(x, y, ret);\n            me.pool.push(ret);\n            return ret.y;\n        },\n\n        /**\n         * return the pixel position corresponding of the specified tile\n         * @ignore\n         */\n        tileToPixelCoords : function (q, r, v) {\n            var x, y;\n            var ret = v || new me.Vector2d();\n            if (this.staggeraxis === \"x\") {\n                //flat top\n                x = q * this.columnwidth;\n                if (this.staggerindex === \"odd\") {\n                    y = r * (this.tileheight + this.sidelengthy);\n                    y = y + (this.rowheight * (q & 1));\n                }\n                else {\n                    y = r * (this.tileheight + this.sidelengthy);\n                    y = y + (this.rowheight * (1 - (q & 1)));\n                }\n            }\n            else {\n                //pointy top\n                y = r * this.rowheight;\n                if (this.staggerindex === \"odd\") {\n                    x = q * (this.tilewidth + this.sidelengthx);\n                    x = x + (this.columnwidth * (r & 1));\n                }\n                else {\n                    x = q * (this.tilewidth + this.sidelengthx);\n                    x = x + (this.columnwidth * (1 - (r & 1)));\n                }\n            }\n            return ret.set(x, y);\n        },\n\n        /**\n         * fix the position of Objects to match\n         * the way Tiled places them\n         * @ignore\n         */\n        adjustPosition: function (obj) {\n            // only adjust position if obj.gid is defined\n            if (typeof(obj.gid) === \"number\") {\n                // Tiled objects origin point is \"bottom-left\" in Tiled,\n                // \"top-left\" in melonJS)\n                obj.y -= obj.height;\n            }\n        },\n\n        /**\n         * draw the tile map\n         * @ignore\n         */\n        drawTile : function (renderer, x, y, tmxTile, tileset) {\n            var point = this.tileToPixelCoords(x, y, me.pool.pull(\"me.Vector2d\"));\n\n            // draw the tile\n            tileset.drawTile(\n                renderer,\n                tileset.tileoffset.x + point.x,\n                tileset.tileoffset.y + point.y + (this.tileheight - tileset.tileheight),\n                tmxTile\n            );\n\n            me.pool.push(point);\n        },\n\n        /**\n         * draw the tile map\n         * @ignore\n         */\n        drawTileLayer : function (renderer, layer, rect) {\n            // get top-left and bottom-right tile position\n            var start = this.pixelToTileCoords(\n                rect.pos.x,\n                rect.pos.y\n           ).floorSelf();\n\n            var end = this.pixelToTileCoords(\n                rect.pos.x + rect.width + this.tilewidth,\n                rect.pos.y + rect.height + this.tileheight\n            ).ceilSelf();\n\n            //ensure we are in the valid tile range\n            start.x = start.x < 0 ? 0 : start.x;\n            start.y = start.y < 0 ? 0 : start.y;\n            end.x = end.x > this.cols ? this.cols : end.x;\n            end.y = end.y > this.rows ? this.rows : end.y;\n\n            // main drawing loop\n            for (var y = start.y; y < end.y; y++) {\n                for (var x = start.x; x < end.x; x++) {\n                    var tmxTile = layer.layerData[x][y];\n                    if (tmxTile) {\n                        this.drawTile(renderer, x, y, tmxTile, tmxTile.tileset);\n                    }\n                }\n            }\n        }\n    });\n\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n\n    /**\n     * a generic Color Layer Object\n     * @class\n     * @extends me.Renderable\n     * @memberOf me\n     * @constructor\n     * @param {String} name Layer name\n     * @param {me.Color|String} color CSS color\n     * @param {Number} z z-index position\n     */\n    me.ColorLayer = me.Renderable.extend({\n        // constructor\n        init: function (name, color, z) {\n            // parent constructor\n            me.Renderable.prototype.init.apply(this, [0, 0, Infinity, Infinity]);\n\n            // apply given parameters\n            this.name = name;\n            this.color = color;\n            this.pos.z = z;\n            this.floating = true;\n        },\n\n        /**\n         * draw the color layer\n         * @ignore\n         */\n        draw : function (renderer, rect) {\n            // set layer opacity\n            var _alpha = renderer.globalAlpha();\n            renderer.setGlobalAlpha(_alpha * this.getOpacity());\n\n            var vpos = me.game.viewport.pos;\n            renderer.setColor(this.color);\n            renderer.fillRect(\n                rect.left - vpos.x, rect.top - vpos.y,\n                rect.width, rect.height\n            );\n            // restore context alpha value\n            renderer.setGlobalAlpha(_alpha);\n            renderer.setColor(\"#fff\");\n        }\n    });\n\n    /**\n     * a generic Image Layer Object\n     * @class\n     * @extends me.Renderable\n     * @memberOf me\n     * @constructor\n     * @param {Number} x x coordinate\n     * @param {Number} y y coordinate\n     * @param {Object} settings ImageLayer properties\n     * @param {Image|String} settings.image Image reference. See {@link me.loader.getImage}\n     * @param {String} [settings.name=\"me.ImageLayer\"] Layer name\n     * @param {Number} [settings.z=0] z-index position\n     * @param {Number|me.Vector2d} [settings.ratio=1.0] Scrolling ratio to be applied\n     * @param {Number|me.Vector2d} [settings.anchorPoint=0.0] Image origin. See {@link me.ImageLayer#anchorPoint}\n     */\n    me.ImageLayer = me.Renderable.extend({\n        /**\n         * constructor\n         * @ignore\n         * @function\n         */\n        init: function (x, y, settings) {\n            // layer name\n            this.name = settings.name || \"me.ImageLayer\";\n\n            // get the corresponding image\n            this.image = me.utils.getImage(settings.image);\n\n            // XXX: Keep this check?\n            if (!this.image) {\n                throw new me.Error((\n                    (typeof(settings.image) === \"string\") ?\n                    \"'\" + settings.image + \"'\" :\n                    \"Image\"\n                ) + \" file for Image Layer '\" + this.name + \"' not found!\");\n            }\n\n            this.imagewidth = this.image.width;\n            this.imageheight = this.image.height;\n\n            // call the constructor\n            me.Renderable.prototype.init.apply(this, [x, y, Infinity, Infinity]);\n\n            // render in screen coordinates\n            this.floating = true;\n\n            // displaying order\n            this.pos.z = settings.z || 0;\n\n            this.offset = new me.Vector2d(x, y);\n\n            /**\n             * Define the image scrolling ratio<br>\n             * Scrolling speed is defined by multiplying the viewport delta position (e.g. followed entity) by the specified ratio.\n             * Setting this vector to &lt;0.0,0.0&gt; will disable automatic scrolling.<br>\n             * To specify a value through Tiled, use one of the following format : <br>\n             * - a number, to change the value for both axis <br>\n             * - a json expression like `json:{\"x\":0.5,\"y\":0.5}` if you wish to specify a different value for both x and y\n             * @public\n             * @type me.Vector2d\n             * @default <1.0,1.0>\n             * @name me.ImageLayer#ratio\n             */\n            this.ratio = new me.Vector2d(1.0, 1.0);\n\n            if (typeof(settings.ratio) !== \"undefined\") {\n                // little hack for backward compatiblity\n                if (typeof(settings.ratio) === \"number\") {\n                    this.ratio.set(settings.ratio, settings.ratio);\n                } else /* vector */ {\n                    this.ratio.setV(settings.ratio);\n                }\n            }\n\n            if (typeof(settings.anchorPoint) === \"undefined\") {\n                /**\n                 * Define how the image is anchored to the viewport bounds<br>\n                 * By default, its upper-left corner is anchored to the viewport bounds upper left corner.<br>\n                 * The anchorPoint is a unit vector where each component falls in range [0.0,1.0].<br>\n                 * Some common examples:<br>\n                 * * &lt;0.0,0.0&gt; : (Default) Anchor image to the upper-left corner of viewport bounds\n                 * * &lt;0.5,0.5&gt; : Center the image within viewport bounds\n                 * * &lt;1.0,1.0&gt; : Anchor image to the lower-right corner of viewport bounds\n                 * To specify a value through Tiled, use one of the following format : <br>\n                 * - a number, to change the value for both axis <br>\n                 * - a json expression like `json:{\"x\":0.5,\"y\":0.5}` if you wish to specify a different value for both x and y\n                 * @public\n                 * @type me.Vector2d\n                 * @default <0.0,0.0>\n                 * @name me.ImageLayer#anchorPoint\n                 */\n                this.anchorPoint.set(0, 0);\n            }\n            else {\n                if (typeof(settings.anchorPoint) === \"number\") {\n                    this.anchorPoint.set(settings.anchorPoint, settings.anchorPoint);\n                }\n                else /* vector */ {\n                    this.anchorPoint.setV(settings.anchorPoint);\n                }\n            }\n\n            /**\n             * Define if and how an Image Layer should be repeated.<br>\n             * By default, an Image Layer is repeated both vertically and horizontally.<br>\n             * Acceptable values : <br>\n             * * 'repeat' - The background image will be repeated both vertically and horizontally. (default) <br>\n             * * 'repeat-x' - The background image will be repeated only horizontally.<br>\n             * * 'repeat-y' - The background image will be repeated only vertically.<br>\n             * * 'no-repeat' - The background-image will not be repeated.<br>\n             * @public\n             * @type String\n             * @name me.ImageLayer#repeat\n             */\n            Object.defineProperty(this, \"repeat\", {\n                get : function get() {\n                    return this._repeat;\n                },\n                set : function set(val) {\n                    this._repeat = val;\n                    switch (this._repeat) {\n                        case \"no-repeat\" :\n                            this.repeatX = false;\n                            this.repeatY = false;\n                            break;\n                        case \"repeat-x\" :\n                            this.repeatX = true;\n                            this.repeatY = false;\n                            break;\n                        case \"repeat-y\" :\n                            this.repeatX = false;\n                            this.repeatY = true;\n                            break;\n                        default : // \"repeat\"\n                            this.repeatX = true;\n                            this.repeatY = true;\n                            break;\n                    }\n                    this.resize(me.game.viewport.width, me.game.viewport.height);\n                    this.createPattern();\n                }\n            });\n\n            this.repeat = settings.repeat || \"repeat\";\n        },\n\n        // called when the layer is added to the game world or a container\n        onActivateEvent : function () {\n            var _updateLayerFn = this.updateLayer.bind(this);\n            // register to the viewport change notification\n            this.vpChangeHdlr = me.event.subscribe(me.event.VIEWPORT_ONCHANGE, _updateLayerFn);\n            this.vpResizeHdlr = me.event.subscribe(me.event.VIEWPORT_ONRESIZE, this.resize.bind(this));\n            this.vpLoadedHdlr = me.event.subscribe(me.event.LEVEL_LOADED, function() {\n                // force a first refresh when the level is loaded\n                _updateLayerFn(me.game.viewport.pos);\n            });\n        },\n\n        /**\n         * resize the Image Layer to match the given size\n         * @name resize\n         * @memberOf me.ImageLayer\n         * @function\n         * @param {Number} w new width\n         * @param {Number} h new height\n        */\n        resize : function (w, h) {\n            me.Renderable.prototype.resize.apply(this, [\n                this.repeatX ? Infinity : w,\n                this.repeatY ? Infinity : h\n            ]);\n        },\n\n        /**\n         * createPattern function\n         * @ignore\n         * @function\n         */\n        createPattern : function () {\n            this._pattern = me.video.renderer.createPattern(this.image, this._repeat);\n        },\n\n        /**\n         * updateLayer function\n         * @ignore\n         * @function\n         */\n        updateLayer : function (vpos) {\n            var rx = this.ratio.x,\n                ry = this.ratio.y;\n\n            if (rx === ry === 0) {\n                // static image\n                return;\n            }\n\n            var viewport = me.game.viewport,\n                width = this.imagewidth,\n                height = this.imageheight,\n                bw = viewport.bounds.width,\n                bh = viewport.bounds.height,\n                ax = this.anchorPoint.x,\n                ay = this.anchorPoint.y,\n\n                /*\n                 * Automatic positioning\n                 *\n                 * See https://github.com/melonjs/melonJS/issues/741#issuecomment-138431532\n                 * for a thorough description of how this works.\n                 */\n                x = ~~(ax * (rx - 1) * (bw - viewport.width) + this.offset.x - rx * vpos.x),\n                y = ~~(ay * (ry - 1) * (bh - viewport.height) + this.offset.y - ry * vpos.y);\n\n\n            // Repeat horizontally; start drawing from left boundary\n            if (this.repeatX) {\n                this.pos.x = x % width;\n            }\n            else {\n                this.pos.x = x;\n            }\n\n            // Repeat vertically; start drawing from top boundary\n            if (this.repeatY) {\n                this.pos.y = y % height;\n            }\n            else {\n                this.pos.y = y;\n            }\n        },\n\n        /**\n         * draw the image layer\n         * @ignore\n         */\n        draw : function (renderer) {\n            var viewport = me.game.viewport,\n                width = this.imagewidth,\n                height = this.imageheight,\n                bw = viewport.bounds.width,\n                bh = viewport.bounds.height,\n                ax = this.anchorPoint.x,\n                ay = this.anchorPoint.y,\n                x = this.pos.x,\n                y = this.pos.y,\n                alpha = renderer.globalAlpha();\n\n            if (this.ratio.x === this.ratio.y === 0) {\n                x = ~~(x + ax * (bw - width));\n                y = ~~(y + ay * (bh - height));\n            }\n\n            renderer.setGlobalAlpha(alpha * this.getOpacity());\n            renderer.translate(x, y);\n            renderer.drawPattern(\n                this._pattern,\n                0,\n                0,\n                viewport.width * 2,\n                viewport.height * 2\n            );\n            renderer.translate(-x, -y);\n            renderer.setGlobalAlpha(alpha);\n        },\n\n        // called when the layer is removed from the game world or a container\n        onDeactivateEvent : function () {\n            // cancel all event subscriptions\n            me.event.unsubscribe(this.vpChangeHdlr);\n            me.event.unsubscribe(this.vpResizeHdlr);\n            me.event.unsubscribe(this.vpLoadedHdlr);\n        }\n\n    });\n\n    /**\n     * a TMX Tile Layer Object\n     * Tiled QT 0.7.x format\n     * @class\n     * @extends me.Renderable\n     * @memberOf me\n     * @constructor\n     * @param {Number} tilewidth width of each tile in pixels\n     * @param {Number} tileheight height of each tile in pixels\n     * @param {String} orientation \"isometric\" or \"orthogonal\"\n     * @param {me.TMXTilesetGroup} tilesets tileset as defined in Tiled\n     * @param {Number} z z-index position\n     */\n    me.TMXLayer = me.Renderable.extend({\n\n        /** @ignore */\n        init: function (tilewidth, tileheight, orientation, tilesets, z) {\n            // super constructor\n            me.Renderable.prototype.init.apply(this, [0, 0, 0, 0]);\n\n            // tile width & height\n            this.tilewidth  = tilewidth;\n            this.tileheight = tileheight;\n\n            // layer orientation\n            this.orientation = orientation;\n\n            /**\n             * The Layer corresponding Tilesets\n             * @public\n             * @type me.TMXTilesetGroup\n             * @name me.TMXLayer#tilesets\n             */\n            this.tilesets = tilesets;\n\n            // the default tileset\n            // XXX: Is this even used?\n            this.tileset = (this.tilesets ? this.tilesets.getTilesetByIndex(0) : null);\n\n            // Biggest tile size to draw\n            this.maxTileSize = {\n                \"width\" : 0,\n                \"height\" : 0\n            };\n            for (var i = 0; i < this.tilesets.length; i++) {\n                var tileset = this.tilesets.getTilesetByIndex(i);\n                this.maxTileSize.width = Math.max(this.maxTileSize.width, tileset.tilewidth);\n                this.maxTileSize.height = Math.max(this.maxTileSize.height, tileset.tileheight);\n            }\n\n            /**\n             * All animated tilesets in this layer\n             * @private\n             * @type Array\n             * @name me.TMXLayer#animatedTilesets\n             */\n            this.animatedTilesets = [];\n\n            /**\n             * Layer contains tileset animations\n             * @public\n             * @type Boolean\n             * @name me.TMXLayer#isAnimated\n             */\n            this.isAnimated = false;\n\n            // for displaying order\n            this.pos.z = z;\n        },\n\n        /** @ignore */\n        initFromJSON: function (layer) {\n            // additional TMX flags\n            this.name = layer.name;\n            this.cols = +layer.width;\n            this.rows = +layer.height;\n\n            // hexagonal maps only\n            this.hexsidelength = +layer.hexsidelength || undefined;\n            this.staggeraxis = layer.staggeraxis;\n            this.staggerindex = layer.staggerindex;\n\n            // layer opacity\n            var visible = typeof(layer.visible) !== \"undefined\" ? layer.visible : true;\n            this.setOpacity(visible ? +layer.opacity : 0);\n\n            // layer \"real\" size\n            if (this.orientation === \"isometric\") {\n                this.width = (this.cols + this.rows) * (this.tilewidth / 2);\n                this.height = (this.cols + this.rows) * (this.tileheight / 2);\n            } else {\n                this.width = this.cols * this.tilewidth;\n                this.height = this.rows * this.tileheight;\n            }\n            // check if we have any user-defined properties\n            me.TMXUtils.applyTMXProperties(this, layer);\n\n            // check for the correct rendering method\n            if (typeof (this.preRender) === \"undefined\") {\n                this.preRender = me.sys.preRender;\n            }\n\n            // if pre-rendering method is use, create an offline canvas/renderer\n            if (this.preRender === true) {\n                this.canvasRenderer = new me.CanvasRenderer(\n                    me.video.createCanvas(this.width, this.height),\n                    this.width, this.height,\n                    {/* use default values*/}\n                );\n            }\n\n            //initialize the layer data array\n            this.initArray(this.cols, this.rows);\n        },\n\n        // called when the layer is added to the game world or a container\n        onActivateEvent : function () {\n\n            // (re)initialize the layer data array\n            /*if (this.layerData === undefined) {\n                this.initArray(this.cols, this.rows);\n            }*/\n\n            if (this.animatedTilesets === undefined) {\n                this.animatedTilesets = [];\n            }\n\n            if (this.tilesets) {\n                var tileset = this.tilesets.tilesets;\n                for (var i = 0; i < tileset.length; i++) {\n                    if (tileset[i].isAnimated) {\n                        tileset[i].isAnimated = false;\n                        this.animatedTilesets.push(tileset[i]);\n                    }\n                }\n            }\n\n            this.isAnimated = this.animatedTilesets.length > 0;\n\n            // Force pre-render off when tileset animation is used\n            if (this.isAnimated) {\n                this.preRender = false;\n            }\n\n            // Resize the bounding rect\n            this.resizeBounds(this.width, this.height);\n        },\n\n        // called when the layer is removed from the game world or a container\n        onDeactivateEvent : function () {\n            // clear all allocated objects\n            //this.layerData = undefined;\n            this.animatedTilesets = undefined;\n        },\n\n\n        /**\n         * set the layer renderer\n         * @ignore\n         */\n        setRenderer : function (renderer) {\n            this.renderer = renderer;\n        },\n\n        /**\n         * Create all required arrays\n         * @ignore\n         */\n        initArray : function (w, h) {\n            // initialize the array\n            this.layerData = [];\n            for (var x = 0; x < w; x++) {\n                this.layerData[x] = [];\n                for (var y = 0; y < h; y++) {\n                    this.layerData[x][y] = null;\n                }\n            }\n        },\n\n        /**\n         * Return the TileId of the Tile at the specified position\n         * @name getTileId\n         * @memberOf me.TMXLayer\n         * @public\n         * @function\n         * @param {Number} x X coordinate\n         * @param {Number} y Y coordinate\n         * @return {Number} TileId\n         */\n        getTileId : function (x, y) {\n            var tile = this.getTile(x, y);\n            return (tile ? tile.tileId : null);\n        },\n\n        /**\n         * Return the Tile object at the specified position\n         * @name getTile\n         * @memberOf me.TMXLayer\n         * @public\n         * @function\n         * @param {Number} x X coordinate\n         * @param {Number} y Y coordinate\n         * @return {me.Tile} Tile Object\n         */\n        getTile : function (x, y) {\n            return this.layerData[~~this.renderer.pixelToTileX(x, y)][~~this.renderer.pixelToTileY(y, x)];\n        },\n\n        /**\n         * Create a new Tile at the specified position\n         * @name setTile\n         * @memberOf me.TMXLayer\n         * @public\n         * @function\n         * @param {Number} x X coordinate\n         * @param {Number} y Y coordinate\n         * @param {Number} tileId tileId\n         * @return {me.Tile} the corresponding newly created tile object\n         */\n        setTile : function (x, y, tileId) {\n            if (!this.tileset.contains(tileId)) {\n                // look for the corresponding tileset\n                this.tileset = this.tilesets.getTilesetByGid(tileId);\n            }\n            var tile = this.layerData[x][y] = new me.Tile(x, y, tileId, this.tileset);\n            // draw the corresponding tile\n            if (this.preRender) {\n                this.renderer.drawTile(this.canvasRenderer, x, y, tile, tile.tileset);\n            }\n            return tile;\n        },\n\n        /**\n         * clear the tile at the specified position\n         * @name clearTile\n         * @memberOf me.TMXLayer\n         * @public\n         * @function\n         * @param {Number} x X coordinate\n         * @param {Number} y Y coordinate\n         */\n        clearTile : function (x, y) {\n            // clearing tile\n            this.layerData[x][y] = null;\n            // erase the corresponding area in the canvas\n            if (this.preRender) {\n                this.canvasRenderer.clearRect(x * this.tilewidth, y * this.tileheight, this.tilewidth, this.tileheight);\n            }\n        },\n\n        /**\n         * update animations in a tileset layer\n         * @ignore\n         */\n        update : function (dt) {\n            if (this.isAnimated) {\n                var result = false;\n                for (var i = 0; i < this.animatedTilesets.length; i++) {\n                    result = this.animatedTilesets[i].update(dt) || result;\n                }\n                return result;\n            }\n\n            return false;\n        },\n\n        /**\n         * draw a tileset layer\n         * @ignore\n         */\n        draw : function (renderer, rect) {\n            // set the layer alpha value\n            var alpha = renderer.globalAlpha();\n            renderer.setGlobalAlpha(alpha * this.getOpacity());\n\n            // use the offscreen canvas\n            if (this.preRender) {\n                var width = Math.min(rect.width, this.width);\n                var height = Math.min(rect.height, this.height);\n\n                // draw using the cached canvas\n                renderer.drawImage(\n                    this.canvasRenderer.getCanvas(),\n                    rect.pos.x, rect.pos.y, // sx,sy\n                    width, height,          // sw,sh\n                    rect.pos.x, rect.pos.y, // dx,dy\n                    width, height           // dw,dh\n                );\n            }\n            // dynamically render the layer\n            else {\n                // draw the layer\n                this.renderer.drawTileLayer(renderer, this, rect);\n            }\n\n            // restore context to initial state\n            renderer.setGlobalAlpha(alpha);\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n * Tile QT +0.7.x format\n * http://www.mapeditor.org/\n *\n */\n(function () {\n\n    // constant to identify the collision object layer\n    var COLLISION_GROUP = \"collision\";\n\n    /**\n     * set a compatible renderer object\n     * for the specified map\n     * @ignore\n     */\n    function getNewDefaultRenderer(obj) {\n        switch (obj.orientation) {\n            case \"orthogonal\":\n                return new me.TMXOrthogonalRenderer(\n                    obj.cols,\n                    obj.rows,\n                    obj.tilewidth,\n                    obj.tileheight\n                );\n\n            case \"isometric\":\n                return new me.TMXIsometricRenderer(\n                    obj.cols,\n                    obj.rows,\n                    obj.tilewidth,\n                    obj.tileheight\n                );\n\n            case \"hexagonal\":\n                return new me.TMXHexagonalRenderer(\n                    obj.cols,\n                    obj.rows,\n                    obj.tilewidth,\n                    obj.tileheight,\n                    obj.hexsidelength,\n                    obj.staggeraxis,\n                    obj.staggerindex\n                );\n\n            // if none found, throw an exception\n            default:\n                throw new me.Error(obj.orientation + \" type TMX Tile Map not supported!\");\n        }\n    }\n\n    /**\n     * Set tiled layer Data\n     * @ignore\n     */\n    function setLayerData(layer, data) {\n        var idx = 0;\n        // set everything\n        for (var y = 0 ; y < layer.rows; y++) {\n            for (var x = 0; x < layer.cols; x++) {\n                // get the value of the gid\n                var gid = data[idx++];\n                // fill the array\n                if (gid !== 0) {\n                    // add a new tile to the layer\n                    layer.setTile(x, y, gid);\n                }\n            }\n        }\n    }\n\n    /**\n     * read the layer Data\n     * @ignore\n     */\n    function readLayer(map, data, z) {\n        var layer = new me.TMXLayer(map.tilewidth, map.tileheight, map.orientation, map.tilesets, z);\n        // init the layer properly\n        layer.initFromJSON(data);\n        // set a renderer\n        if (!me.game.tmxRenderer.canRender(layer)) {\n            layer.setRenderer(getNewDefaultRenderer(layer));\n        }\n        else {\n            // use the default one\n            layer.setRenderer(me.game.tmxRenderer);\n        }\n        // parse the layer data\n        setLayerData(layer, \n            me.TMXUtils.decode(\n                data.data,\n                data.encoding,\n                data.compression\n            )\n        );\n        return layer;\n    }\n\n    /**\n     * read the Image Layer Data\n     * @ignore\n     */\n    function readImageLayer(map, data, z) {\n        // Normalize properties\n        me.TMXUtils.applyTMXProperties(data.properties, data);\n\n        // create the layer\n        var imageLayer = new me.ImageLayer(\n            +data.x || 0,\n            +data.y || 0,\n            Object.assign({\n                name: data.name,\n                image: data.image,\n                z: z\n            }, data.properties)\n        );\n\n        // set some additional flags\n        var visible = typeof(data.visible) !== \"undefined\" ? data.visible : true;\n        imageLayer.setOpacity(visible ? +data.opacity : 0);\n\n        return imageLayer;\n    }\n\n    /**\n     * read the tileset Data\n     * @ignore\n     */\n    function readTileset(data) {\n        return (new me.TMXTileset(data));\n    }\n\n    /**\n     * read the object group Data\n     * @ignore\n     */\n    function readObjectGroup(map, data, z) {\n        return (new me.TMXObjectGroup(data.name, data, map.orientation, map.tilesets, z));\n    }\n\n\n    /**\n     * a TMX Tile Map Object\n     * Tiled QT +0.7.x format\n     * @class\n     * @extends me.Object\n     * @memberOf me\n     * @constructor\n     * @param {String} levelId name of TMX map\n     * @param {Object} data TMX map in JSON format\n     * @example\n     * // create a new level object based on the TMX JSON object\n     * var level = new me.TMXTileMap(levelId, me.loader.getTMX(levelId));\n     * // add the level to the game world container\n     * level.addTo(me.game.world, true);\n     */\n    me.TMXTileMap = me.Object.extend({\n        // constructor\n        init: function (levelId, data) {\n\n            /**\n             * name of the tilemap\n             * @public\n             * @type String\n             * @name me.TMXTileMap#name\n             */\n            this.name = levelId;\n\n            /**\n             * the level data (JSON)\n             * @ignore\n             */\n            this.data = data;\n\n            /**\n             * width of the tilemap in tiles\n             * @public\n             * @type Int\n             * @name me.TMXTileMap#cols\n             */\n            this.cols = +data.width;\n            /**\n             * height of the tilemap in tiles\n             * @public\n             * @type Int\n             * @name me.TMXTileMap#rows\n             */\n            this.rows = +data.height;\n\n            /**\n             * Tile width\n             * @public\n             * @type Int\n             * @name me.TMXTileMap#tilewidth\n             */\n            this.tilewidth = +data.tilewidth;\n\n            /**\n             * Tile height\n             * @public\n             * @type Int\n             * @name me.TMXTileMap#tileheight\n             */\n            this.tileheight = +data.tileheight;\n\n            // tilesets for this map\n            this.tilesets = null;\n            // layers\n            this.layers = [];\n            // group objects\n            this.objectGroups = [];\n\n            // tilemap version\n            this.version = data.version;\n\n            // map type (orthogonal or isometric)\n            this.orientation = data.orientation;\n            if (this.orientation === \"isometric\") {\n                this.width = (this.cols + this.rows) * (this.tilewidth / 2);\n                this.height = (this.cols + this.rows) * (this.tileheight / 2);\n            } else {\n                this.width = this.cols * this.tilewidth;\n                this.height = this.rows * this.tileheight;\n            }\n\n\n            // objects minimum z order\n            this.z = 0;\n\n            // object id\n            this.nextobjectid = +data.nextobjectid || undefined;\n\n\n            // hex/iso properties\n            this.hexsidelength = +data.hexsidelength || undefined;\n            this.staggeraxis = data.staggeraxis;\n            this.staggerindex = data.staggerindex;\n\n            // background color\n            this.backgroundcolor = data.backgroundcolor;\n\n            // set additional map properties (if any)\n            me.TMXUtils.applyTMXProperties(this, data);\n\n            // initialize a default TMX renderer\n            if ((me.game.tmxRenderer === null) || !me.game.tmxRenderer.canRender(this)) {\n                me.game.tmxRenderer = getNewDefaultRenderer(this);\n            }\n\n            // internal flag\n            this.initialized = false;\n\n        },\n\n        /**\n         * parse the map\n         * @ignore\n         */\n        readMapObjects: function (data) {\n\n            if (this.initialized === true) {\n                return;\n            }\n\n            // to automatically increment z index\n            var zOrder = this.z;\n            var self = this;\n\n            // Tileset information\n            if (!this.tilesets) {\n                // make sure we have a TilesetGroup Object\n                this.tilesets = new me.TMXTilesetGroup();\n            }\n\n            // parse all tileset objects\n            var tilesets = data.tilesets;\n            tilesets.forEach(function (tileset) {\n                // add the new tileset\n                self.tilesets.add(readTileset(tileset));\n            });\n\n            // check if a user-defined background color is defined\n            if (this.backgroundcolor) {\n                this.layers.push(\n                    new me.ColorLayer(\n                        \"background_color\",\n                        this.backgroundcolor,\n                        zOrder++\n                    )\n                );\n            }\n\n            // check if a background image is defined\n            if (this.background_image) {\n                // add a new image layer\n                this.layers.push(new me.ImageLayer(\n                    0, 0, {\n                        name : \"background_image\",\n                        image : this.background_image,\n                        z : zOrder++\n                    }\n                ));\n            }\n\n            data.layers.forEach(function (layer) {\n                switch (layer.type) {\n                    case \"imagelayer\":\n                        self.layers.push(readImageLayer(self, layer, zOrder++));\n                        break;\n\n                    case \"tilelayer\":\n                        self.layers.push(readLayer(self, layer, zOrder++));\n                        break;\n\n                    // get the object groups information\n                    case \"objectgroup\":\n                        self.objectGroups.push(readObjectGroup(self, layer, zOrder++));\n                        break;\n\n                    default:\n                        break;\n                }\n            });\n            this.initialized = true;\n        },\n\n\n        /**\n         * add all the map layers and objects to the given container\n         * @name me.TMXTileMap#addTo\n         * @public\n         * @function\n         * @param {me.Container} target container\n         * @param {boolean} flatten if true, flatten all objects into the given container\n         * @example\n         * // create a new level object based on the TMX JSON object\n         * var level = new me.TMXTileMap(levelId, me.loader.getTMX(levelId));\n         * // add the level to the game world container\n         * level.addTo(me.game.world, true);\n         */\n        addTo : function (container, flatten) {\n            var _sort = container.autoSort;\n            var _depth = container.autoDepth;\n\n            // disable auto-sort and auto-depth\n            container.autoSort = false;\n            container.autoDepth = false;\n\n            // add all layers instances\n            this.getLayers().forEach(function (layer) {\n                container.addChild(layer);\n            });\n\n            // add all Object instances\n            this.getObjects(flatten).forEach(function (object) {\n                container.addChild(object);\n            });\n\n            //  set back auto-sort and auto-depth\n            container.autoSort = _sort;\n            container.autoDepth = _depth;\n\n            // force a sort\n            container.sort(true);\n        },\n\n        /**\n         * return an Array of instantiated objects, based on the map object definition\n         * @name me.TMXTileMap#getObjects\n         * @public\n         * @function\n         * @param {boolean} flatten if true, flatten all objects into the returned array, <br>\n         * ignoring all defined groups (no sub containers will be created)\n         * @return {me.Renderable[]} Array of Objects\n         */\n        getObjects : function (flatten) {\n            var objects = [];\n            var isCollisionGroup = false;\n            var targetContainer;\n\n            // parse the map for objects\n            this.readMapObjects(this.data);\n\n            for (var g = 0; g < this.objectGroups.length; g++) {\n                var group = this.objectGroups[g];\n\n                // check if this is the collision shape group\n                isCollisionGroup = group.name.toLowerCase().includes(COLLISION_GROUP);\n\n                if (flatten === false) {\n                    // create a new container\n                    targetContainer = new me.Container(0, 0, this.width, this.height);\n\n                    // set additional properties\n                    targetContainer.name = group.name;\n                    targetContainer.pos.z = group.z;\n                    targetContainer.setOpacity(group.opacity);\n\n                    // disable auto-sort and auto-depth\n                    targetContainer.autoSort = false;\n                    targetContainer.autoDepth = false;\n                }\n\n                // iterate through the group and add all object into their\n                // corresponding target Container\n                for (var o = 0; o < group.objects.length; o++) {\n                    // TMX object settings\n                    var settings = group.objects[o];\n\n                    var obj = me.pool.pull(\n                        settings.name || \"me.Entity\",\n                        settings.x, settings.y,\n                        settings\n                    );\n                    // skip if the pull function does not return a corresponding object\n                    if (typeof obj !== \"object\") {\n                        continue;\n                    }\n\n                    // check if a me.Tile object is embedded\n                    if (typeof (settings.tile) === \"object\" && !obj.renderable) {\n                        obj.renderable = settings.tile.getRenderable(settings);\n                    }\n\n                    if (isCollisionGroup && !settings.name) {\n                        // configure the body accordingly\n                        obj.body.collisionType = me.collision.types.WORLD_SHAPE;\n                    }\n\n                    // set the obj z order correspondingly to its parent container/group\n                    obj.pos.z = group.z;\n\n                    //apply group opacity value to the child objects if group are merged\n                    if (flatten === true) {\n                        if (obj.isRenderable === true) {\n                            obj.setOpacity(obj.getOpacity() * group.opacity);\n                            // and to child renderables if any\n                            if (obj.renderable instanceof me.Renderable) {\n                                obj.renderable.setOpacity(obj.renderable.getOpacity() * group.opacity);\n                            }\n                        }\n                        // directly add the obj into the objects array\n                        objects.push(obj);\n                    } else /* false*/ {\n                        // add it to the new container\n                        targetContainer.addChild(obj);\n                    }\n\n                }\n\n                // if we created a new container\n                if ((flatten === false) && (targetContainer.children.length > 0)) {\n\n                    // re-enable auto-sort and auto-depth\n                    targetContainer.autoSort = true;\n                    targetContainer.autoDepth = true;\n\n                    // add our container to the world\n                    objects.push(targetContainer);\n                }\n            }\n            return objects;\n        },\n\n        /**\n         * return all the existing layers\n         * @name me.TMXTileMap#getLayers\n         * @public\n         * @function\n         * @return {me.TMXLayer[]} Array of Layers\n         */\n        getLayers : function () {\n            // parse the map for objects\n            this.readMapObjects(this.data);\n            return this.layers;\n        },\n\n        /**\n         * destroy function, clean all allocated objects\n         * @name me.TMXTileMap#destroy\n         * @public\n         * @function\n         */\n        destroy : function () {\n            this.tilesets = undefined;\n            this.layers = [];\n            this.objectGroups = [];\n            this.initialized = false;\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n    /**\n     * a level manager object <br>\n     * once ressources loaded, the level director contains all references of defined levels<br>\n     * There is no constructor function for me.levelDirector, this is a static object\n     * @namespace me.levelDirector\n     * @memberOf me\n     */\n    me.levelDirector = (function () {\n        // hold public stuff in our singletong\n        var api = {};\n\n        /*\n         * PRIVATE STUFF\n         */\n\n        // our levels\n        var levels = {};\n        // level index table\n        var levelIdx = [];\n        // current level index\n        var currentLevelIdx = 0;\n        // onresize handler\n        var onresize_handler = null;\n\n        function safeLoadLevel(levelId, options, restart) {\n            // clean the destination container\n            options.container.destroy();\n\n            // reset the renderer\n            me.video.renderer.reset();\n\n            // clean the current (previous) level\n            if (levels[api.getCurrentLevelId()]) {\n                levels[api.getCurrentLevelId()].destroy();\n            }\n\n            // update current level index\n            currentLevelIdx = levelIdx.indexOf(levelId);\n\n            // add the specified level to the game world\n            loadTMXLevel(levelId, options.container, options.flatten, options.setViewportBounds);\n\n            // publish the corresponding message\n            me.event.publish(me.event.LEVEL_LOADED, [ levelId ]);\n\n            // fire the callback\n            options.onLoaded(levelId);\n\n            if (restart) {\n                // resume the game loop if it was previously running\n                me.state.restart();\n            }\n        }\n\n        /**\n         * Load a TMX level\n         * @name loadTMXLevel\n         * @memberOf me.game\n         * @private\n         * @param {String} level level id\n         * @param {me.Container} target container\n         * @param {boolean} flatten if true, flatten all objects into the given container\n         * @param {boolean} setViewportBounds if true, set the viewport bounds to the map size\n         * @ignore\n         * @function\n         */\n        function loadTMXLevel(levelId, container, flatten, setViewportBounds) {\n            var level = levels[levelId];\n\n            // disable auto-sort for the given container\n            var autoSort = container.autoSort;\n            container.autoSort = false;\n\n            if (setViewportBounds) {\n                // update the viewport bounds\n                me.game.viewport.setBounds(\n                    0, 0,\n                    Math.max(level.width, me.game.viewport.width),\n                    Math.max(level.height, me.game.viewport.height)\n                );\n            }\n\n            // reset the GUID generator\n            // and pass the level id as parameter\n            me.utils.resetGUID(levelId, level.nextobjectid);\n\n            // add all level elements to the target container\n            level.addTo(container, flatten);\n\n            // sort everything (recursively)\n            container.sort(true);\n            container.autoSort = autoSort;\n\n            container.resize(level.width, level.height);\n\n            function resize_container() {\n                // center the map if smaller than the current viewport\n                container.pos.set(\n                    Math.max(0, ~~((me.game.viewport.width - level.width) / 2)),\n                    Math.max(0, ~~((me.game.viewport.height - level.height) / 2)),\n                    0\n                );\n\n                // translate the display if required\n                container.transform.identity();\n                container.transform.translateV(container.pos);\n            }\n\n            if (setViewportBounds) {\n                resize_container();\n\n                // Replace the resize handler\n                if (onresize_handler) {\n                    me.event.unsubscribe(onresize_handler);\n                }\n                onresize_handler = me.event.subscribe(me.event.VIEWPORT_ONRESIZE, resize_container);\n            }\n        }\n\n        /*\n         * PUBLIC STUFF\n         */\n\n        /**\n         * reset the level director\n         * @ignore\n         */\n        api.reset = function () {};\n\n        /**\n         * add a level\n         * @ignore\n         */\n        api.addLevel = function () {\n            throw new me.Error(\"no level loader defined\");\n        };\n\n        /**\n         * add a TMX level\n         * @ignore\n         */\n        api.addTMXLevel = function (levelId, callback) {\n            // just load the level with the XML stuff\n            if (levels[levelId] == null) {\n                //console.log(\"loading \"+ levelId);\n                levels[levelId] = new me.TMXTileMap(levelId, me.loader.getTMX(levelId));\n                // level index\n                levelIdx.push(levelId);\n            }\n            else  {\n                //console.log(\"level %s already loaded\", levelId);\n                return false;\n            }\n\n            // call the callback if defined\n            if (callback) {\n                callback();\n            }\n            // true if level loaded\n            return true;\n        };\n\n        /**\n         * load a level into the game manager<br>\n         * (will also create all level defined entities, etc..)\n         * @name loadLevel\n         * @memberOf me.levelDirector\n         * @public\n         * @function\n         * @param {String} level level id\n         * @param {Object} [options] additional optional parameters\n         * @param {me.Container} [options.container=me.game.world] container in which to load the specified level\n         * @param {function} [options.onLoaded=me.game.onLevelLoaded] callback for when the level is fully loaded\n         * @param {boolean} [options.flatten=me.game.mergeGroup] if true, flatten all objects into the given container\n         * @param {boolean} [options.setViewportBounds=true] if true, set the viewport bounds to the map size\n         * @example\n         * // the game defined ressources\n         * // to be preloaded by the loader\n         * // TMX maps\n         * var resources = [\n         *     {name: \"a4_level1\",   type: \"tmx\",   src: \"data/level/a4_level1.tmx\"},\n         *     {name: \"a4_level2\",   type: \"tmx\",   src: \"data/level/a4_level2.tmx\"},\n         *     {name: \"a4_level3\",   type: \"tmx\",   src: \"data/level/a4_level3.tmx\"},\n         *     // ...\n         * ];\n         *\n         * // ...\n         *\n         * // load a level\n         * me.levelDirector.loadLevel(\"a4_level1\");\n         */\n        api.loadLevel = function (levelId, options) {\n            options = Object.assign({\n                \"container\"         : me.game.world,\n                \"onLoaded\"          : me.game.onLevelLoaded,\n                \"flatten\"           : me.game.mergeGroup,\n                \"setViewportBounds\" : true\n            }, options || {});\n\n            // throw an exception if not existing\n            if (typeof(levels[levelId]) === \"undefined\") {\n                throw new me.Error(\"level \" + levelId + \" not found\");\n            }\n\n            if (levels[levelId] instanceof me.TMXTileMap) {\n\n                // check the status of the state mngr\n                var wasRunning = me.state.isRunning();\n\n                if (wasRunning) {\n                    // stop the game loop to avoid\n                    // some silly side effects\n                    me.state.stop();\n\n                    safeLoadLevel.defer(this, levelId, options, true);\n                }\n                else {\n                    safeLoadLevel(levelId, options);\n                }\n            }\n            else {\n                throw new me.Error(\"no level loader defined\");\n            }\n            return true;\n        };\n\n        /**\n         * return the current level id<br>\n         * @name getCurrentLevelId\n         * @memberOf me.levelDirector\n         * @public\n         * @function\n         * @return {String}\n         */\n        api.getCurrentLevelId = function () {\n            return levelIdx[currentLevelIdx];\n        };\n\n        /**\n         * return the current level definition.\n         * for a reference to the live instantiated level,\n         * rather use the container in which it was loaded (e.g. me.game.world)\n         * @name getCurrentLevel\n         * @memberOf me.levelDirector\n         * @public\n         * @function\n         * @return {me.TMXTileMap}\n         */\n        api.getCurrentLevel = function () {\n            return levels[api.getCurrentLevelId()];\n        };\n\n        /**\n         * reload the current level<br>\n         * @name reloadLevel\n         * @memberOf me.levelDirector\n         * @public\n         * @function\n         * @param {Object} [options] additional optional parameters\n         * @param {me.Container} [options.container=me.game.world] container in which to load the specified level\n         * @param {function} [options.onLoaded=me.game.onLevelLoaded] callback for when the level is fully loaded\n         * @param {boolean} [options.flatten=me.game.mergeGroup] if true, flatten all objects into the given container\n         */\n        api.reloadLevel = function (options) {\n            // reset the level to initial state\n            //levels[currentLevel].reset();\n            return api.loadLevel(api.getCurrentLevelId(), options);\n        };\n\n        /**\n         * load the next level<br>\n         * @name nextLevel\n         * @memberOf me.levelDirector\n         * @public\n         * @function\n         * @param {Object} [options] additional optional parameters\n         * @param {me.Container} [options.container=me.game.world] container in which to load the specified level\n         * @param {function} [options.onLoaded=me.game.onLevelLoaded] callback for when the level is fully loaded\n         * @param {boolean} [options.flatten=me.game.mergeGroup] if true, flatten all objects into the given container\n         */\n        api.nextLevel = function (options) {\n            //go to the next level\n            if (currentLevelIdx + 1 < levelIdx.length) {\n                return api.loadLevel(levelIdx[currentLevelIdx + 1], options);\n            }\n            else {\n                return false;\n            }\n        };\n\n        /**\n         * load the previous level<br>\n         * @name previousLevel\n         * @memberOf me.levelDirector\n         * @public\n         * @function\n         * @param {Object} [options] additional optional parameters\n         * @param {me.Container} [options.container=me.game.world] container in which to load the specified level\n         * @param {function} [options.onLoaded=me.game.onLevelLoaded] callback for when the level is fully loaded\n         * @param {boolean} [options.flatten=me.game.mergeGroup] if true, flatten all objects into the given container\n         */\n        api.previousLevel = function (options) {\n            // go to previous level\n            if (currentLevelIdx - 1 >= 0) {\n                return api.loadLevel(levelIdx[currentLevelIdx - 1], options);\n            }\n            else {\n                return false;\n            }\n        };\n\n        /**\n         * return the amount of level preloaded<br>\n         * @name levelCount\n         * @memberOf me.levelDirector\n         * @public\n         * @function\n         */\n        api.levelCount = function () {\n            return levelIdx.length;\n        };\n\n        // return our object\n        return api;\n    })();\n})();\n\n/**\n * @preserve Tween JS\n * https://github.com/sole/Tween.js\n */\n\n/* jshint -W011 */\n/* jshint -W013 */\n/* jshint -W089 */\n/* jshint -W093 */\n/* jshint -W098 */\n/* jshint -W108 */\n/* jshint -W116 */\n\n(function() {\n\n    /**\n     * Javascript Tweening Engine<p>\n     * Super simple, fast and easy to use tweening engine which incorporates optimised Robert Penner's equation<p>\n     * <a href=\"https://github.com/sole/Tween.js\">https://github.com/sole/Tween.js</a><p>\n     * author sole / http://soledadpenades.com<br>\n     * author mr.doob / http://mrdoob.com<br>\n     * author Robert Eisele / http://www.xarg.org<br>\n     * author Philippe / http://philippe.elsass.me<br>\n     * author Robert Penner / http://www.robertpenner.com/easing_terms_of_use.html<br>\n     * author Paul Lewis / http://www.aerotwist.com/<br>\n     * author lechecacharro<br>\n     * author Josh Faul / http://jocafa.com/\n     * @class\n     * @memberOf me\n     * @constructor\n     * @param {Object} object object on which to apply the tween\n     * @example\n     * // add a tween to change the object pos.y variable to 200 in 3 seconds\n     * tween = new me.Tween(myObject.pos).to({y: 200}, 3000).onComplete(myFunc);\n     * tween.easing(me.Tween.Easing.Bounce.Out);\n     * tween.start();\n     */\n    me.Tween = function ( object ) {\n\n        var _object = null;\n        var _valuesStart = null;\n        var _valuesEnd = null;\n        var _valuesStartRepeat = null;\n        var _duration = null;\n        var _repeat = null;\n        var _yoyo = null;\n        var _reversed = null;\n        var _delayTime = null;\n        var _startTime = null;\n        var _easingFunction = null;\n        var _interpolationFunction = null;\n        var _chainedTweens = null;\n        var _onStartCallback = null;\n        var _onStartCallbackFired = null;\n        var _onUpdateCallback = null;\n        var _onCompleteCallback = null;\n        var _tweenTimeTracker = null;\n\n\n        this._resumeCallback = function (elapsed) {\n            if (_startTime) {\n                _startTime += elapsed;\n            }\n        };\n\n        this.setProperties = function (object) {\n            _object = object;\n            _valuesStart = {};\n            _valuesEnd = {};\n            _valuesStartRepeat = {};\n            _duration = 1000;\n            _repeat = 0;\n            _yoyo = false;\n            _reversed = false;\n            _delayTime = 0;\n            _startTime = null;\n            _easingFunction = me.Tween.Easing.Linear.None;\n            _interpolationFunction = me.Tween.Interpolation.Linear;\n            _chainedTweens = [];\n            _onStartCallback = null;\n            _onStartCallbackFired = false;\n            _onUpdateCallback = null;\n            _onCompleteCallback = null;\n            _tweenTimeTracker = me.timer.lastUpdate;\n\n\n            // Set all starting values present on the target object\n            for ( var field in object ) {\n                if(typeof object !== 'object') {\n                    _valuesStart[ field ] = parseFloat(object[field], 10);\n                }\n            }\n\n            /**\n             * Calculate delta to resume the tween\n             * @ignore\n             */\n            me.event.subscribe(me.event.STATE_RESUME, this._resumeCallback);\n        };\n\n        this.setProperties(object);\n\n        /**\n         * reset the tween object to default value\n         * @ignore\n         */\n        this.onResetEvent = function ( object ) {\n            this.setProperties(object);\n        };\n\n        /**\n         * Unsubscribe when tween is removed\n         * @ignore\n         */\n        this.onDeactivateEvent = function () {\n            me.event.unsubscribe(me.event.STATE_RESUME, this._resumeCallback);\n        };\n\n        /**\n         * object properties to be updated and duration\n         * @name me.Tween#to\n         * @public\n         * @function\n         * @param {Object} properties hash of properties\n         * @param {Number} [duration=1000] tween duration\n         */\n        this.to = function ( properties, duration ) {\n\n            if ( duration !== undefined ) {\n\n                _duration = duration;\n\n            }\n\n            _valuesEnd = properties;\n\n            return this;\n\n        };\n\n        /**\n         * start the tween\n         * @name me.Tween#start\n         * @public\n         * @function\n         */\n        this.start = function ( time ) {\n\n            _onStartCallbackFired = false;\n\n            // add the tween to the object pool on start\n            me.game.world.addChild(this);\n\n            _startTime = (typeof(time) === 'undefined' ? me.timer.getTime() : time) + _delayTime;\n\n            for ( var property in _valuesEnd ) {\n\n                // check if an Array was provided as property value\n                if ( _valuesEnd[ property ] instanceof Array ) {\n\n                    if ( _valuesEnd[ property ].length === 0 ) {\n\n                        continue;\n\n                    }\n\n                    // create a local copy of the Array with the start value at the front\n                    _valuesEnd[ property ] = [ _object[ property ] ].concat( _valuesEnd[ property ] );\n\n                }\n\n                _valuesStart[ property ] = _object[ property ];\n\n                if( ( _valuesStart[ property ] instanceof Array ) === false ) {\n                    _valuesStart[ property ] *= 1.0; // Ensures we're using numbers, not strings\n                }\n\n                _valuesStartRepeat[ property ] = _valuesStart[ property ] || 0;\n\n            }\n\n            return this;\n\n        };\n\n        /**\n         * stop the tween\n         * @name me.Tween#stop\n         * @public\n         * @function\n         */\n        this.stop = function () {\n            // ensure the tween has not been removed previously\n            if (me.game.world.hasChild(this)) {\n                me.game.world.removeChildNow(this);\n            }\n            return this;\n        };\n\n        /**\n         * delay the tween\n         * @name me.Tween#delay\n         * @public\n         * @function\n         * @param {Number} amount delay amount expressed in milliseconds\n         */\n        this.delay = function ( amount ) {\n\n            _delayTime = amount;\n            return this;\n\n        };\n\n        /**\n         * Repeat the tween\n         * @name me.Tween#repeat\n         * @public\n         * @function\n         * @param {Number} times amount of times the tween should be repeated\n         */\n        this.repeat = function ( times ) {\n\n            _repeat = times;\n            return this;\n\n        };\n\n        /**\n         * allows the tween to bounce back to their original value when finished\n         * @name me.Tween#yoyo\n         * @public\n         * @function\n         * @param {Boolean} yoyo\n         */\n        this.yoyo = function( yoyo ) {\n\n            _yoyo = yoyo;\n            return this;\n\n        };\n\n        /**\n         * set the easing function\n         * @name me.Tween#easing\n         * @public\n         * @function\n         * @param {me.Tween.Easing} fn easing function\n         */\n        this.easing = function ( easing ) {\n            if (typeof easing !== 'function') {\n                throw new me.Tween.Error(\"invalid easing function for me.Tween.easing()\");\n            }\n            _easingFunction = easing;\n            return this;\n\n        };\n\n        /**\n         * set the interpolation function\n         * @name me.Tween#interpolation\n         * @public\n         * @function\n         * @param {me.Tween.Interpolation} fn interpolation function\n         */\n        this.interpolation = function ( interpolation ) {\n\n            _interpolationFunction = interpolation;\n            return this;\n\n        };\n\n        /**\n         * chain the tween\n         * @name me.Tween#chain\n         * @public\n         * @function\n         * @param {me.Tween} chainedTween Tween to be chained\n         */\n        this.chain = function () {\n\n            _chainedTweens = arguments;\n            return this;\n\n        };\n\n        /**\n         * onStart callback\n         * @name me.Tween#onStart\n         * @public\n         * @function\n         * @param {Function} onStartCallback callback\n         */\n        this.onStart = function ( callback ) {\n\n            _onStartCallback = callback;\n            return this;\n\n        };\n\n        /**\n         * onUpdate callback\n         * @name me.Tween#onUpdate\n         * @public\n         * @function\n         * @param {Function} onUpdateCallback callback\n         */\n        this.onUpdate = function ( callback ) {\n\n            _onUpdateCallback = callback;\n            return this;\n\n        };\n\n        /**\n         * onComplete callback\n         * @name me.Tween#onComplete\n         * @public\n         * @function\n         * @param {Function} onCompleteCallback callback\n         */\n        this.onComplete = function ( callback ) {\n\n            _onCompleteCallback = callback;\n            return this;\n\n        };\n\n        /** @ignore */\n        this.update = function ( dt ) {\n\n            // the original Tween implementation expect\n            // a timestamp and not a time delta\n            _tweenTimeTracker = (me.timer.lastUpdate > _tweenTimeTracker) ? me.timer.lastUpdate : _tweenTimeTracker + dt;\n            var time = _tweenTimeTracker;\n\n            var property;\n\n            if ( time < _startTime ) {\n\n                return true;\n\n            }\n\n            if ( _onStartCallbackFired === false ) {\n\n                if ( _onStartCallback !== null ) {\n\n                    _onStartCallback.call( _object );\n\n                }\n\n                _onStartCallbackFired = true;\n\n            }\n\n            var elapsed = ( time - _startTime ) / _duration;\n            elapsed = elapsed > 1 ? 1 : elapsed;\n\n            var value = _easingFunction( elapsed );\n\n            for ( property in _valuesEnd ) {\n\n                var start = _valuesStart[ property ] || 0;\n                var end = _valuesEnd[ property ];\n\n                if ( end instanceof Array ) {\n\n                    _object[ property ] = _interpolationFunction( end, value );\n\n                } else {\n\n                    // Parses relative end values with start as base (e.g.: +10, -3)\n                    if ( typeof(end) === \"string\" ) {\n                        end = start + parseFloat(end, 10);\n                    }\n\n                    // protect against non numeric properties.\n                    if ( typeof(end) === \"number\" ) {\n                        _object[ property ] = start + ( end - start ) * value;\n                    }\n\n                }\n\n            }\n\n            if ( _onUpdateCallback !== null ) {\n\n                _onUpdateCallback.call( _object, value );\n\n            }\n\n            if ( elapsed === 1 ) {\n\n                if ( _repeat > 0 ) {\n\n                    if( isFinite( _repeat ) ) {\n                        _repeat--;\n                    }\n\n                    // reassign starting values, restart by making startTime = now\n                    for( property in _valuesStartRepeat ) {\n\n                        if ( typeof( _valuesEnd[ property ] ) === \"string\" ) {\n                            _valuesStartRepeat[ property ] = _valuesStartRepeat[ property ] + parseFloat(_valuesEnd[ property ], 10);\n                        }\n\n                        if (_yoyo) {\n                            var tmp = _valuesStartRepeat[ property ];\n                            _valuesStartRepeat[ property ] = _valuesEnd[ property ];\n                            _valuesEnd[ property ] = tmp;\n                        }\n                        _valuesStart[ property ] = _valuesStartRepeat[ property ];\n\n                    }\n\n                    if (_yoyo) {\n                        _reversed = !_reversed;\n                    }\n\n                    _startTime = time + _delayTime;\n\n                    return true;\n\n                } else {\n                    // remove the tween from the object pool\n                    me.game.world.removeChildNow(this);\n\n                    if ( _onCompleteCallback !== null ) {\n\n                        _onCompleteCallback.call( _object );\n\n                    }\n\n                    for ( var i = 0, numChainedTweens = _chainedTweens.length; i < numChainedTweens; i ++ ) {\n\n                        _chainedTweens[ i ].start( time );\n\n                    }\n\n                    return false;\n\n                }\n\n            }\n\n            return true;\n\n        };\n\n    };\n\n    /**\n     * Easing Function :<br>\n     * <p>\n     * me.Tween.Easing.Linear.None<br>\n     * me.Tween.Easing.Quadratic.In<br>\n     * me.Tween.Easing.Quadratic.Out<br>\n     * me.Tween.Easing.Quadratic.InOut<br>\n     * me.Tween.Easing.Cubic.In<br>\n     * me.Tween.Easing.Cubic.Out<br>\n     * me.Tween.Easing.Cubic.InOut<br>\n     * me.Tween.Easing.Quartic.In<br>\n     * me.Tween.Easing.Quartic.Out<br>\n     * me.Tween.Easing.Quartic.InOut<br>\n     * me.Tween.Easing.Quintic.In<br>\n     * me.Tween.Easing.Quintic.Out<br>\n     * me.Tween.Easing.Quintic.InOut<br>\n     * me.Tween.Easing.Sinusoidal.In<br>\n     * me.Tween.Easing.Sinusoidal.Out<br>\n     * me.Tween.Easing.Sinusoidal.InOut<br>\n     * me.Tween.Easing.Exponential.In<br>\n     * me.Tween.Easing.Exponential.Out<br>\n     * me.Tween.Easing.Exponential.InOut<br>\n     * me.Tween.Easing.Circular.In<br>\n     * me.Tween.Easing.Circular.Out<br>\n     * me.Tween.Easing.Circular.InOut<br>\n     * me.Tween.Easing.Elastic.In<br>\n     * me.Tween.Easing.Elastic.Out<br>\n     * me.Tween.Easing.Elastic.InOut<br>\n     * me.Tween.Easing.Back.In<br>\n     * me.Tween.Easing.Back.Out<br>\n     * me.Tween.Easing.Back.InOut<br>\n     * me.Tween.Easing.Bounce.In<br>\n     * me.Tween.Easing.Bounce.Out<br>\n     * me.Tween.Easing.Bounce.InOut\n     * </p>\n     * @public\n     * @constant\n     * @type enum\n     * @name Easing\n     * @memberOf me.Tween\n     */\n    me.Tween.Easing = {\n\n        Linear: {\n            /** @ignore */\n            None: function ( k ) {\n\n                return k;\n\n            }\n\n        },\n\n        Quadratic: {\n            /** @ignore */\n            In: function ( k ) {\n\n                return k * k;\n\n            },\n            /** @ignore */\n            Out: function ( k ) {\n\n                return k * ( 2 - k );\n\n            },\n            /** @ignore */\n            InOut: function ( k ) {\n\n                if ( ( k *= 2 ) < 1 ) return 0.5 * k * k;\n                return - 0.5 * ( --k * ( k - 2 ) - 1 );\n\n            }\n\n        },\n\n        Cubic: {\n            /** @ignore */\n            In: function ( k ) {\n\n                return k * k * k;\n\n            },\n            /** @ignore */\n            Out: function ( k ) {\n\n                return --k * k * k + 1;\n\n            },\n            /** @ignore */\n            InOut: function ( k ) {\n\n                if ( ( k *= 2 ) < 1 ) return 0.5 * k * k * k;\n                return 0.5 * ( ( k -= 2 ) * k * k + 2 );\n\n            }\n\n        },\n\n        Quartic: {\n            /** @ignore */\n            In: function ( k ) {\n\n                return k * k * k * k;\n\n            },\n            /** @ignore */\n            Out: function ( k ) {\n\n                return 1 - ( --k * k * k * k );\n\n            },\n            /** @ignore */\n            InOut: function ( k ) {\n\n                if ( ( k *= 2 ) < 1) return 0.5 * k * k * k * k;\n                return - 0.5 * ( ( k -= 2 ) * k * k * k - 2 );\n\n            }\n\n        },\n\n        Quintic: {\n            /** @ignore */\n            In: function ( k ) {\n\n                return k * k * k * k * k;\n\n            },\n            /** @ignore */\n            Out: function ( k ) {\n\n                return --k * k * k * k * k + 1;\n\n            },\n            /** @ignore */\n            InOut: function ( k ) {\n\n                if ( ( k *= 2 ) < 1 ) return 0.5 * k * k * k * k * k;\n                return 0.5 * ( ( k -= 2 ) * k * k * k * k + 2 );\n\n            }\n\n        },\n\n        Sinusoidal: {\n            /** @ignore */\n            In: function ( k ) {\n\n                return 1 - Math.cos( k * Math.PI / 2 );\n\n            },\n            /** @ignore */\n            Out: function ( k ) {\n\n                return Math.sin( k * Math.PI / 2 );\n\n            },\n            /** @ignore */\n            InOut: function ( k ) {\n\n                return 0.5 * ( 1 - Math.cos( Math.PI * k ) );\n\n            }\n\n        },\n\n        Exponential: {\n            /** @ignore */\n            In: function ( k ) {\n\n                return k === 0 ? 0 : Math.pow( 1024, k - 1 );\n\n            },\n            /** @ignore */\n            Out: function ( k ) {\n\n                return k === 1 ? 1 : 1 - Math.pow( 2, - 10 * k );\n\n            },\n            /** @ignore */\n            InOut: function ( k ) {\n\n                if ( k === 0 ) return 0;\n                if ( k === 1 ) return 1;\n                if ( ( k *= 2 ) < 1 ) return 0.5 * Math.pow( 1024, k - 1 );\n                return 0.5 * ( - Math.pow( 2, - 10 * ( k - 1 ) ) + 2 );\n\n            }\n\n        },\n\n        Circular: {\n            /** @ignore */\n            In: function ( k ) {\n\n                return 1 - Math.sqrt( 1 - k * k );\n\n            },\n            /** @ignore */\n            Out: function ( k ) {\n\n                return Math.sqrt( 1 - ( --k * k ) );\n\n            },\n            /** @ignore */\n            InOut: function ( k ) {\n\n                if ( ( k *= 2 ) < 1) return - 0.5 * ( Math.sqrt( 1 - k * k) - 1);\n                return 0.5 * ( Math.sqrt( 1 - ( k -= 2) * k) + 1);\n\n            }\n\n        },\n\n        Elastic: {\n            /** @ignore */\n            In: function ( k ) {\n\n                var s, a = 0.1, p = 0.4;\n                if ( k === 0 ) return 0;\n                if ( k === 1 ) return 1;\n                if ( !a || a < 1 ) { a = 1; s = p / 4; }\n                else s = p * Math.asin( 1 / a ) / ( 2 * Math.PI );\n                return - ( a * Math.pow( 2, 10 * ( k -= 1 ) ) * Math.sin( ( k - s ) * ( 2 * Math.PI ) / p ) );\n\n            },\n            /** @ignore */\n            Out: function ( k ) {\n\n                var s, a = 0.1, p = 0.4;\n                if ( k === 0 ) return 0;\n                if ( k === 1 ) return 1;\n                if ( !a || a < 1 ) { a = 1; s = p / 4; }\n                else s = p * Math.asin( 1 / a ) / ( 2 * Math.PI );\n                return ( a * Math.pow( 2, - 10 * k) * Math.sin( ( k - s ) * ( 2 * Math.PI ) / p ) + 1 );\n\n            },\n            /** @ignore */\n            InOut: function ( k ) {\n\n                var s, a = 0.1, p = 0.4;\n                if ( k === 0 ) return 0;\n                if ( k === 1 ) return 1;\n                if ( !a || a < 1 ) { a = 1; s = p / 4; }\n                else s = p * Math.asin( 1 / a ) / ( 2 * Math.PI );\n                if ( ( k *= 2 ) < 1 ) return - 0.5 * ( a * Math.pow( 2, 10 * ( k -= 1 ) ) * Math.sin( ( k - s ) * ( 2 * Math.PI ) / p ) );\n                return a * Math.pow( 2, -10 * ( k -= 1 ) ) * Math.sin( ( k - s ) * ( 2 * Math.PI ) / p ) * 0.5 + 1;\n\n            }\n\n        },\n\n        Back: {\n            /** @ignore */\n            In: function ( k ) {\n\n                var s = 1.70158;\n                return k * k * ( ( s + 1 ) * k - s );\n\n            },\n            /** @ignore */\n            Out: function ( k ) {\n\n                var s = 1.70158;\n                return --k * k * ( ( s + 1 ) * k + s ) + 1;\n\n            },\n            /** @ignore */\n            InOut: function ( k ) {\n\n                var s = 1.70158 * 1.525;\n                if ( ( k *= 2 ) < 1 ) return 0.5 * ( k * k * ( ( s + 1 ) * k - s ) );\n                return 0.5 * ( ( k -= 2 ) * k * ( ( s + 1 ) * k + s ) + 2 );\n\n            }\n\n        },\n\n        Bounce: {\n            /** @ignore */\n            In: function ( k ) {\n\n                return 1 - me.Tween.Easing.Bounce.Out( 1 - k );\n\n            },\n            /** @ignore */\n            Out: function ( k ) {\n\n                if ( k < ( 1 / 2.75 ) ) {\n\n                    return 7.5625 * k * k;\n\n                } else if ( k < ( 2 / 2.75 ) ) {\n\n                    return 7.5625 * ( k -= ( 1.5 / 2.75 ) ) * k + 0.75;\n\n                } else if ( k < ( 2.5 / 2.75 ) ) {\n\n                    return 7.5625 * ( k -= ( 2.25 / 2.75 ) ) * k + 0.9375;\n\n                } else {\n\n                    return 7.5625 * ( k -= ( 2.625 / 2.75 ) ) * k + 0.984375;\n\n                }\n\n            },\n            /** @ignore */\n            InOut: function ( k ) {\n\n                if ( k < 0.5 ) return me.Tween.Easing.Bounce.In( k * 2 ) * 0.5;\n                return me.Tween.Easing.Bounce.Out( k * 2 - 1 ) * 0.5 + 0.5;\n\n            }\n\n        }\n\n    };\n\n    /**\n     * Interpolation Function :<br>\n     * <p>\n     * me.Tween.Interpolation.Linear<br>\n     * me.Tween.Interpolation.Bezier<br>\n     * me.Tween.Interpolation.CatmullRom\n     * </p>\n     * @public\n     * @constant\n     * @type enum\n     * @name Interpolation\n     * @memberOf me.Tween\n     */\n    me.Tween.Interpolation = {\n        /** @ignore */\n        Linear: function ( v, k ) {\n\n            var m = v.length - 1, f = m * k, i = Math.floor( f ), fn = me.Tween.Interpolation.Utils.Linear;\n\n            if ( k < 0 ) return fn( v[ 0 ], v[ 1 ], f );\n            if ( k > 1 ) return fn( v[ m ], v[ m - 1 ], m - f );\n\n            return fn( v[ i ], v[ i + 1 > m ? m : i + 1 ], f - i );\n\n        },\n        /** @ignore */\n        Bezier: function ( v, k ) {\n\n            var b = 0, n = v.length - 1, pw = Math.pow, bn = me.Tween.Interpolation.Utils.Bernstein, i;\n\n            for ( i = 0; i <= n; i++ ) {\n                b += pw( 1 - k, n - i ) * pw( k, i ) * v[ i ] * bn( n, i );\n            }\n\n            return b;\n\n        },\n        /** @ignore */\n        CatmullRom: function ( v, k ) {\n\n            var m = v.length - 1, f = m * k, i = Math.floor( f ), fn = me.Tween.Interpolation.Utils.CatmullRom;\n\n            if ( v[ 0 ] === v[ m ] ) {\n\n                if ( k < 0 ) i = Math.floor( f = m * ( 1 + k ) );\n\n                return fn( v[ ( i - 1 + m ) % m ], v[ i ], v[ ( i + 1 ) % m ], v[ ( i + 2 ) % m ], f - i );\n\n            } else {\n\n                if ( k < 0 ) return v[ 0 ] - ( fn( v[ 0 ], v[ 0 ], v[ 1 ], v[ 1 ], -f ) - v[ 0 ] );\n                if ( k > 1 ) return v[ m ] - ( fn( v[ m ], v[ m ], v[ m - 1 ], v[ m - 1 ], f - m ) - v[ m ] );\n\n                return fn( v[ i ? i - 1 : 0 ], v[ i ], v[ m < i + 1 ? m : i + 1 ], v[ m < i + 2 ? m : i + 2 ], f - i );\n\n            }\n\n        },\n\n        Utils: {\n            /** @ignore */\n            Linear: function ( p0, p1, t ) {\n\n                return ( p1 - p0 ) * t + p0;\n\n            },\n            /** @ignore */\n            Bernstein: function ( n , i ) {\n\n                var fc = me.Tween.Interpolation.Utils.Factorial;\n                return fc( n ) / fc( i ) / fc( n - i );\n\n            },\n            /** @ignore */\n            Factorial: ( function () {\n\n                var a = [ 1 ];\n\n                return function ( n ) {\n\n                    var s = 1, i;\n                    if ( a[ n ] ) return a[ n ];\n                    for ( i = n; i > 1; i-- ) s *= i;\n                    return a[ n ] = s;\n\n                };\n\n            } )(),\n            /** @ignore */\n            CatmullRom: function ( p0, p1, p2, p3, t ) {\n\n                var v0 = ( p2 - p0 ) * 0.5, v1 = ( p3 - p1 ) * 0.5, t2 = t * t, t3 = t * t2;\n                return ( 2 * p1 - 2 * p2 + v0 + v1 ) * t3 + ( - 3 * p1 + 3 * p2 - 2 * v0 - v1 ) * t2 + v0 * t + p1;\n\n            }\n\n        }\n\n    };\n\n    /**\n     * Base class for Tween exception handling.\n     * @name Error\n     * @class\n     * @memberOf me.Tween\n     * @constructor\n     * @param {String} msg Error message.\n     */\n    me.Tween.Error = me.Error.extend({\n        init : function (msg) {\n            me.Error.prototype.init.apply(this, [ msg ]);\n            this.name = \"me.Tween.Error\";\n        }\n    });\n})();\n\n/**\n * @preserve MinPubSub\n * a micro publish/subscribe messaging framework\n * @see https://github.com/daniellmb/MinPubSub\n * @author Daniel Lamb <daniellmb.com>\n *\n * Released under the MIT License\n */\n(function () {\n    /**\n     * There is no constructor function for me.event\n     * @namespace me.event\n     * @memberOf me\n     */\n    me.event = (function () {\n        // hold public stuff inside the singleton\n        var api = {};\n\n        /**\n         * the channel/subscription hash\n         * @ignore\n         */\n        var cache = {};\n\n        /*\n         * PUBLIC\n         */\n\n        /**\n         * Channel Constant when the game is paused <br>\n         * Data passed : none <br>\n         * @public\n         * @constant\n         * @type String\n         * @name me.event#STATE_PAUSE\n         */\n        api.STATE_PAUSE = \"me.state.onPause\";\n\n        /**\n         * Channel Constant for when the game is resumed <br>\n         * Data passed : {Number} time in ms the game was paused\n         * @public\n         * @constant\n         * @type String\n         * @name me.event#STATE_RESUME\n         */\n        api.STATE_RESUME = \"me.state.onResume\";\n\n        /**\n         * Channel Constant when the game is stopped <br>\n         * Data passed : none <br>\n         * @public\n         * @constant\n         * @type String\n         * @name me.event#STATE_STOP\n         */\n        api.STATE_STOP = \"me.state.onStop\";\n\n        /**\n         * Channel Constant for when the game is restarted <br>\n         * Data passed : {Number} time in ms the game was stopped\n         * @public\n         * @constant\n         * @type String\n         * @name me.event#STATE_RESTART\n         */\n        api.STATE_RESTART = \"me.state.onRestart\";\n\n        /**\n         * Channel Constant for when the game manager is initialized <br>\n         * Data passed : none <br>\n         * @public\n         * @constant\n         * @type String\n         * @name me.event#GAME_INIT\n         */\n        api.GAME_INIT = \"me.game.onInit\";\n\n        /**\n         * Channel Constant for when a level is loaded <br>\n         * Data passed : {String} Level Name\n         * @public\n         * @constant\n         * @type String\n         * @name me.event#LEVEL_LOADED\n         */\n        api.LEVEL_LOADED = \"me.game.onLevelLoaded\";\n\n        /**\n         * Channel Constant for when everything has loaded <br>\n         * Data passed : none <br>\n         * @public\n         * @constant\n         * @type String\n         * @name me.event#LOADER_COMPLETE\n         */\n        api.LOADER_COMPLETE = \"me.loader.onload\";\n\n        /**\n         * Channel Constant for displaying a load progress indicator <br>\n         * Data passed : {Number} [0 .. 1], {Resource} resource object<br>\n         * @public\n         * @constant\n         * @type String\n         * @name me.event#LOADER_PROGRESS\n         */\n        api.LOADER_PROGRESS = \"me.loader.onProgress\";\n\n        /**\n         * Channel Constant for pressing a binded key <br>\n         * Data passed : {String} user-defined action, {Number} keyCode,\n         * {Boolean} edge state <br>\n         * Edge-state is for detecting \"locked\" key bindings. When a locked key\n         * is pressed and held, the first event will have the third argument\n         * set true. Subsequent events will continue firing with the third\n         * argument set false.\n         * @public\n         * @constant\n         * @type String\n         * @name me.event#KEYDOWN\n         * @example\n         * me.input.bindKey(me.input.KEY.X, \"jump\", true); // Edge-triggered\n         * me.input.bindKey(me.input.KEY.Z, \"shoot\"); // Level-triggered\n         * me.event.subscribe(me.event.KEYDOWN, function (action, keyCode, edge) {\n         *   // Checking bound keys\n         *   if (action === \"jump\") {\n         *       if (edge) {\n         *           this.doJump();\n         *       }\n         *\n         *       // Make character fall slower when holding the jump key\n         *       this.vel.y = this.gravity;\n         *   }\n         * });\n         */\n        api.KEYDOWN = \"me.input.keydown\";\n\n        /**\n         * Channel Constant for releasing a binded key <br>\n         * Data passed : {String} user-defined action, {Number} keyCode <br>\n         * @public\n         * @constant\n         * @type String\n         * @name me.event#KEYUP\n         * @example\n         * me.event.subscribe(me.event.KEYUP, function (action, keyCode) {\n         *   // Checking unbound keys\n         *   if (keyCode == me.input.KEY.ESC) {\n         *       if (me.state.isPaused()) {\n         *           me.state.resume();\n         *       }\n         *       else {\n         *           me.state.pause();\n         *       }\n         *   }\n         * });\n         */\n        api.KEYUP = \"me.input.keyup\";\n\n        /**\n         * Channel Constant for when a gamepad is connected <br>\n         * Data passed : {Object} gamepad object\n         * @public\n         * @constant\n         * @type String\n         * @name me.event#GAMEPAD_CONNECTED\n         */\n        api.GAMEPAD_CONNECTED = \"gamepad.connected\";\n\n        /**\n         * Channel Constant for when a gamepad is disconnected <br>\n         * Data passed : {Object} gamepad object\n         * @public\n         * @constant\n         * @type String\n         * @name me.event#GAMEPAD_DISCONNECTED\n         */\n        api.GAMEPAD_DISCONNECTED = \"gamepad.disconnected\";\n\n        /**\n         * Channel Constant for when gamepad button/axis state is updated <br>\n         * Data passed : {Number} index <br>\n         * Data passed : {String} type : \"axes\" or \"buttons\" <br>\n         * Data passed : {Number} button <br>\n         * Data passed : {Number} current.value <br>\n         * Data passed : {Boolean} current.pressed <br>\n         * @public\n         * @constant\n         * @type String\n         * @name me.event#GAMEPAD_UPDATE\n         */\n        api.GAMEPAD_UPDATE = \"gamepad.update\";\n\n        /**\n         * Channel Constant for pointermove events on the viewport area <br>\n         * Data passed : {Object} the Event object <br>\n         * @public\n         * @constant\n         * @type String\n         * @name me.event#POINTERMOVE\n         */\n        api.POINTERMOVE = \"me.event.pointermove\";\n\n        /**\n         * Channel Constant for dragstart events on a Draggable entity <br>\n         * Data passed:\n         * {Object} the drag event <br>\n         * {Object} the Draggable entity <br>\n         * @public\n         * @constant\n         * @type String\n         * @name me.event#DRAGSTART\n         */\n        api.DRAGSTART = \"me.game.dragstart\";\n\n        /**\n         * Channel Constant for dragend events on a Draggable entity <br>\n         * Data passed:\n         * {Object} the drag event <br>\n         * {Object} the Draggable entity <br>\n         * @public\n         * @constant\n         * @type String\n         * @name me.event#DRAGEND\n         */\n        api.DRAGEND = \"me.game.dragend\";\n\n        /**\n         * Channel Constant for when the (browser) window is resized <br>\n         * Data passed : {Event} Event object <br>\n         * @public\n         * @constant\n         * @type String\n         * @name me.event#WINDOW_ONRESIZE\n         */\n        api.WINDOW_ONRESIZE = \"window.onresize\";\n\n        /**\n         * Channel Constant for when the viewport is resized <br>\n         * (this usually follows a WINDOW_ONRESIZE event, when using the `flex` scaling mode is used and after the viewport was updated).<br>\n         * Data passed : {Number} viewport width <br>\n         * Data passed : {Number} viewport height <br>\n         * @public\n         * @constant\n         * @type String\n         * @name me.event#VIEWPORT_ONRESIZE\n         */\n        api.VIEWPORT_ONRESIZE = \"viewport.onresize\";\n\n        /**\n         * Channel Constant for when the device is rotated <br>\n         * Data passed : {Event} Event object <br>\n         * @public\n         * @constant\n         * @type String\n         * @name me.event#WINDOW_ONORIENTATION_CHANGE\n         */\n        api.WINDOW_ONORIENTATION_CHANGE = \"window.orientationchange\";\n\n        /**\n         * Channel Constant for when the (browser) window is scrolled <br>\n         * Data passed : {Event} Event object <br>\n         * @public\n         * @constant\n         * @type String\n         * @name me.event#WINDOW_ONSCROLL\n         */\n        api.WINDOW_ONSCROLL = \"window.onscroll\";\n\n        /**\n         * Channel Constant for when the viewport position is updated <br>\n         * Data passed : {me.Vector2d} viewport position vector <br>\n         * @public\n         * @constant\n         * @type String\n         * @name me.event#VIEWPORT_ONCHANGE\n         */\n        api.VIEWPORT_ONCHANGE = \"viewport.onchange\";\n\n        /**\n         * Publish some data on a channel\n         * @name me.event#publish\n         * @public\n         * @function\n         * @param {String} channel The channel to publish on\n         * @param {Array} arguments The data to publish\n         *\n         * @example Publish stuff on '/some/channel'.\n         * Anything subscribed will be called with a function\n         * signature like: function (a,b,c){ ... }\n         *\n         * me.event.publish(\"/some/channel\", [\"a\",\"b\",\"c\"]);\n         *\n         */\n        api.publish = function (channel, args) {\n            var subs = cache[channel],\n                len = subs ? subs.length : 0;\n\n            //can change loop or reverse array if the order matters\n            while (len--) {\n                subs[len].apply(window, args || []); // is window correct here?\n            }\n        };\n\n        /**\n         * Register a callback on a named channel.\n         * @name me.event#subscribe\n         * @public\n         * @function\n         * @param {String} channel The channel to subscribe to\n         * @param {Function} callback The event handler, any time something is\n         * published on a subscribed channel, the callback will be called\n         * with the published array as ordered arguments\n         * @return {handle} A handle which can be used to unsubscribe this\n         * particular subscription\n         * @example\n         * me.event.subscribe(\"/some/channel\", function (a, b, c){ doSomething(); });\n         */\n\n        api.subscribe = function (channel, callback) {\n            if (!cache[channel]) {\n                cache[channel] = [];\n            }\n            cache[channel].push(callback);\n            return [ channel, callback ]; // Array\n        };\n\n        /**\n         * Disconnect a subscribed function for a channel.\n         * @name me.event#unsubscribe\n         * @public\n         * @function\n         * @param {Array|String} handle The return value from a subscribe call or the\n         * name of a channel as a String\n         * @param {Function} [callback] The callback to be unsubscribed.\n         * @example\n         * var handle = me.event.subscribe(\"/some/channel\", function (){});\n         * me.event.unsubscribe(handle);\n         *\n         * // Or alternatively ...\n         *\n         * var callback = function (){};\n         * me.event.subscribe(\"/some/channel\", callback);\n         * me.event.unsubscribe(\"/some/channel\", callback);\n         */\n        api.unsubscribe = function (handle, callback) {\n            var subs = cache[callback ? handle : handle[0]],\n                len = subs ? subs.length : 0;\n\n            callback = callback || handle[1];\n\n            while (len--) {\n                if (subs[len] === callback) {\n                    subs.splice(len, 1);\n                }\n            }\n        };\n\n        // return our object\n        return api;\n    })();\n})();\n\n/*!\n *  howler.js v2.0.0-beta5\n *  howlerjs.com\n *\n *  (c) 2013-2015, James Simpson of GoldFire Studios\n *  goldfirestudios.com\n *\n *  MIT License\n */\n\n/* jshint -W003 */\n/* jshint -W004 */\n/* jshint -W030 */\n/* jshint -W031 */\n/* jshint -W083 */\n/* jshint -W084 */\n/* jshint -W108 */\n\n(function() {\n\n  'use strict';\n\n  // Setup our audio context.\n  var ctx = null;\n  var usingWebAudio = true;\n  var noAudio = false;\n  var masterGain = null;\n  var canPlayEvent = 'canplaythrough';\n  setupAudioContext();\n\n  /** Global Methods **/\n  /***************************************************************************/\n\n  /**\n   * Create the global controller. All contained methods and properties apply\n   * to all sounds that are currently playing or will be in the future.\n   */\n  var HowlerGlobal = function() {\n    this.init();\n  };\n  HowlerGlobal.prototype = {\n    /**\n     * Initialize the global Howler object.\n     * @return {Howler}\n     */\n    init: function() {\n      var self = this || Howler;\n\n      // Internal properties.\n      self._codecs = {};\n      self._howls = [];\n      self._muted = false;\n      self._volume = 1;\n\n      // Keeps track of the suspend/resume state of the AudioContext.\n      self.state = 'running';\n      self.autoSuspend = true;\n\n      // Automatically begin the 30-second suspend process\n      self._autoSuspend();\n\n      // Set to false to disable the auto iOS enabler.\n      self.mobileAutoEnable = true;\n\n      // No audio is available on this system if this is set to true.\n      self.noAudio = noAudio;\n\n      // This will be true if the Web Audio API is available.\n      self.usingWebAudio = usingWebAudio;\n\n      // Expose the AudioContext when using Web Audio.\n      self.ctx = ctx;\n\n      // Check for supported codecs.\n      if (!noAudio) {\n        self._setupCodecs();\n      }\n\n      return self;\n    },\n\n    /**\n     * Get/set the global volume for all sounds.\n     * @param  {Float} vol Volume from 0.0 to 1.0.\n     * @return {Howler/Float}     Returns self or current volume.\n     */\n    volume: function(vol) {\n      var self = this || Howler;\n      vol = parseFloat(vol);\n\n      if (typeof vol !== 'undefined' && vol >= 0 && vol <= 1) {\n        self._volume = vol;\n\n        // When using Web Audio, we just need to adjust the master gain.\n        if (usingWebAudio) {\n          masterGain.gain.value = vol;\n        }\n\n        // Loop through and change volume for all HTML5 audio nodes.\n        for (var i=0; i<self._howls.length; i++) {\n          if (!self._howls[i]._webAudio) {\n            // Get all of the sounds in this Howl group.\n            var ids = self._howls[i]._getSoundIds();\n\n            // Loop through all sounds and change the volumes.\n            for (var j=0; j<ids.length; j++) {\n              var sound = self._howls[i]._soundById(ids[j]);\n\n              if (sound && sound._node) {\n                sound._node.volume = sound._volume * vol;\n              }\n            }\n          }\n        }\n\n        return self;\n      }\n\n      return self._volume;\n    },\n\n    /**\n     * Handle muting and unmuting globally.\n     * @param  {Boolean} muted Is muted or not.\n     */\n    mute: function(muted) {\n      var self = this || Howler;\n\n      self._muted = muted;\n\n      // With Web Audio, we just need to mute the master gain.\n      if (usingWebAudio) {\n        masterGain.gain.value = muted ? 0 : self._volume;\n      }\n\n      // Loop through and mute all HTML5 Audio nodes.\n      for (var i=0; i<self._howls.length; i++) {\n        if (!self._howls[i]._webAudio) {\n          // Get all of the sounds in this Howl group.\n          var ids = self._howls[i]._getSoundIds();\n\n          // Loop through all sounds and mark the audio node as muted.\n          for (var j=0; j<ids.length; j++) {\n            var sound = self._howls[i]._soundById(ids[j]);\n\n            if (sound && sound._node) {\n              sound._node.muted = (muted) ? true : sound._muted;\n            }\n          }\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Unload and destroy all currently loaded Howl objects.\n     * @return {Howler}\n     */\n    unload: function() {\n      var self = this || Howler;\n\n      for (var i=self._howls.length-1; i>=0; i--) {\n        self._howls[i].unload();\n      }\n\n      // Create a new AudioContext to make sure it is fully reset.\n      if (self.usingWebAudio && typeof ctx.close !== 'undefined') {\n        self.ctx = null;\n        ctx.close();\n        setupAudioContext();\n        self.ctx = ctx;\n      }\n\n      return self;\n    },\n\n    /**\n     * Check for codec support of specific extension.\n     * @param  {String} ext Audio file extention.\n     * @return {Boolean}\n     */\n    codecs: function(ext) {\n      return (this || Howler)._codecs[ext];\n    },\n\n    /**\n     * Check for browser support for various codecs and cache the results.\n     * @return {Howler}\n     */\n    _setupCodecs: function() {\n      var self = this || Howler;\n      var audioTest = new Audio();\n      var mpegTest = audioTest.canPlayType('audio/mpeg;').replace(/^no$/, '');\n      var isOpera = /OPR\\//.test(navigator.userAgent);\n      \n      self._codecs = {\n        mp3: !!(!isOpera && (mpegTest || audioTest.canPlayType('audio/mp3;').replace(/^no$/, ''))),\n        mpeg: !!mpegTest,\n        opus: !!audioTest.canPlayType('audio/ogg; codecs=\"opus\"').replace(/^no$/, ''),\n        ogg: !!audioTest.canPlayType('audio/ogg; codecs=\"vorbis\"').replace(/^no$/, ''),\n        wav: !!audioTest.canPlayType('audio/wav; codecs=\"1\"').replace(/^no$/, ''),\n        aac: !!audioTest.canPlayType('audio/aac;').replace(/^no$/, ''),\n        m4a: !!(audioTest.canPlayType('audio/x-m4a;') || audioTest.canPlayType('audio/m4a;') || audioTest.canPlayType('audio/aac;')).replace(/^no$/, ''),\n        mp4: !!(audioTest.canPlayType('audio/x-mp4;') || audioTest.canPlayType('audio/mp4;') || audioTest.canPlayType('audio/aac;')).replace(/^no$/, ''),\n        weba: !!audioTest.canPlayType('audio/webm; codecs=\"vorbis\"').replace(/^no$/, ''),\n        webm: !!audioTest.canPlayType('audio/webm; codecs=\"vorbis\"').replace(/^no$/, '')\n      };\n\n      return self;\n    },\n\n    /**\n     * Mobile browsers will only allow audio to be played after a user interaction.\n     * Attempt to automatically unlock audio on the first user interaction.\n     * Concept from: http://paulbakaus.com/tutorials/html5/web-audio-on-ios/\n     * @return {Howler}\n     */\n    _enableMobileAudio: function() {\n      var self = this || Howler;\n\n      // Only run this on iOS if audio isn't already eanbled.\n      var isMobile = /iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk/i.test(navigator.userAgent);\n      var isTouch = !!(('ontouchend' in window) || (navigator.maxTouchPoints > 0) || (navigator.msMaxTouchPoints > 0));\n      if (ctx && (self._mobileEnabled || !isMobile || !isTouch)) {\n        return;\n      }\n\n      self._mobileEnabled = false;\n\n      // Call this method on touch start to create and play a buffer,\n      // then check if the audio actually played to determine if\n      // audio has now been unlocked on iOS, Android, etc.\n      var unlock = function() {\n        // Create an empty buffer.\n        var buffer = ctx.createBuffer(1, 1, 22050);\n        var source = ctx.createBufferSource();\n        source.buffer = buffer;\n        source.connect(ctx.destination);\n\n        // Play the empty buffer.\n        if (typeof source.start === 'undefined') {\n          source.noteOn(0);\n        } else {\n          source.start(0);\n        }\n\n        // Setup a timeout to check that we are unlocked on the next event loop.\n        source.onended = function() {\n          source.disconnect(0);\n\n          // Update the unlocked state and prevent this check from happening again.\n          self._mobileEnabled = true;\n          self.mobileAutoEnable = false;\n\n          // Remove the touch start listener.\n          document.removeEventListener('touchend', unlock, true);\n        };\n      };\n\n      // Setup a touch start listener to attempt an unlock in.\n      document.addEventListener('touchend', unlock, true);\n\n      return self;\n    },\n\n    /**\n     * Automatically suspend the Web Audio AudioContext after no sound has played for 30 seconds.\n     * This saves processing/energy and fixes various browser-specific bugs with audio getting stuck.\n     * @return {Howler}\n     */\n    _autoSuspend: function() {\n      var self = this;\n\n      if (!self.autoSuspend || !ctx || typeof ctx.suspend === 'undefined' || !usingWebAudio) {\n        return;\n      }\n\n      // Check if any sounds are playing.\n      for (var i=0; i<self._howls.length; i++) {\n        if (self._howls[i]._webAudio) {\n          for (var j=0; j<self._howls[i]._sounds.length; j++) {\n            if (!self._howls[i]._sounds[j]._paused) {\n              return self;\n            }\n          }\n        }\n      }\n\n      // If no sound has played after 30 seconds, suspend the context.\n      self._suspendTimer = setTimeout(function() {\n        if (!self.autoSuspend) {\n          return;\n        }\n\n        self._suspendTimer = null;\n        self.state = 'suspending';\n        ctx.suspend().then(function() {\n          self.state = 'suspended';\n\n          if (self._resumeAfterSuspend) {\n            delete self._resumeAfterSuspend;\n            self._autoResume();\n          }\n        });\n      }, 30000);\n\n      return self;\n    },\n\n    /**\n     * Automatically resume the Web Audio AudioContext when a new sound is played.\n     * @return {Howler}\n     */\n    _autoResume: function() {\n      var self = this;\n\n      if (!ctx || typeof ctx.resume === 'undefined' || !usingWebAudio) {\n        return;\n      }\n\n      if (self.state === 'running' && self._suspendTimer) {\n        clearTimeout(self._suspendTimer);\n        self._suspendTimer = null;\n      } else if (self.state === 'suspended') {\n        self.state = 'resuming';\n        ctx.resume().then(function() {\n          self.state = 'running';\n        });\n      } else if (self.state === 'suspending') {\n        self._resumeAfterSuspend = true;\n      }\n\n      return self;\n    }\n  };\n\n  // Setup the global audio controller.\n  var Howler = new HowlerGlobal();\n\n  /** Group Methods **/\n  /***************************************************************************/\n\n  /**\n   * Create an audio group controller.\n   * @param {Object} o Passed in properties for this group.\n   */\n  var Howl = function(o) {\n    var self = this;\n\n    // Throw an error if no source is provided.\n    if (!o.src || o.src.length === 0) {\n      console.error('An array of source files must be passed with any new Howl.');\n      return;\n    }\n\n    self.init(o);\n  };\n  Howl.prototype = {\n    /**\n     * Initialize a new Howl group object.\n     * @param  {Object} o Passed in properties for this group.\n     * @return {Howl}\n     */\n    init: function(o) {\n      var self = this;\n\n      // Setup user-defined default properties.\n      self._autoplay = o.autoplay || false;\n      self._ext = o.ext || null;\n      self._html5 = o.html5 || false;\n      self._muted = o.mute || false;\n      self._loop = o.loop || false;\n      self._pool = o.pool || 5;\n      self._preload = (typeof o.preload === 'boolean') ? o.preload : true;\n      self._rate = o.rate || 1;\n      self._sprite = o.sprite || {};\n      self._src = (typeof o.src !== 'string') ? o.src : [o.src];\n      self._volume = o.volume !== undefined ? o.volume : 1;\n\n      // Setup all other default properties.\n      self._duration = 0;\n      self._loaded = false;\n      self._sounds = [];\n      self._endTimers = {};\n\n      // Setup event listeners.\n      self._onend = o.onend ? [{fn: o.onend}] : [];\n      self._onfaded = o.onfaded ? [{fn: o.onfaded}] : [];\n      self._onload = o.onload ? [{fn: o.onload}] : [];\n      self._onloaderror = o.onloaderror ? [{fn: o.onloaderror}] : [];\n      self._onpause = o.onpause ? [{fn: o.onpause}] : [];\n      self._onplay = o.onplay ? [{fn: o.onplay}] : [];\n      self._onstop = o.onstop ? [{fn: o.onstop}] : [];\n\n      // Web Audio or HTML5 Audio?\n      self._webAudio = usingWebAudio && !self._html5;\n\n      // Automatically try to enable audio on iOS.\n      if (typeof ctx !== 'undefined' && ctx && Howler.mobileAutoEnable) {\n        Howler._enableMobileAudio();\n      }\n\n      // Keep track of this Howl group in the global controller.\n      Howler._howls.push(self);\n\n      // Load the source file unless otherwise specified.\n      if (self._preload) {\n        self.load();\n      }\n\n      return self;\n    },\n\n    /**\n     * Load the audio file.\n     * @return {Howler}\n     */\n    load: function() {\n      var self = this;\n      var url = null;\n\n      // If no audio is available, quit immediately.\n      if (noAudio) {\n        self._emit('loaderror', null, 'No audio support.');\n        return;\n      }\n\n      // Make sure our source is in an array.\n      if (typeof self._src === 'string') {\n        self._src = [self._src];\n      }\n\n      // Loop through the sources and pick the first one that is compatible.\n      for (var i=0; i<self._src.length; i++) {\n        var ext, str;\n\n        if (self._ext && self._ext[i]) {\n          // If an extension was specified, use that instead.\n          ext = self._ext[i];\n        } else {\n          // Extract the file extension from the URL or base64 data URI.\n          str = self._src[i];\n          ext = /^data:audio\\/([^;,]+);/i.exec(str);\n          if (!ext) {\n            ext = /\\.([^.]+)$/.exec(str.split('?', 1)[0]);\n          }\n\n          if (ext) {\n            ext = ext[1].toLowerCase();\n          }\n        }\n\n        // Check if this extension is available.\n        if (Howler.codecs(ext)) {\n          url = self._src[i];\n          break;\n        }\n      }\n\n      if (!url) {\n        self._emit('loaderror', null, 'No codec support for selected audio sources.');\n        return;\n      }\n\n      self._src = url;\n\n      // If the hosting page is HTTPS and the source isn't,\n      // drop down to HTML5 Audio to avoid Mixed Content errors.\n      if (window.location.protocol === 'https:' && url.slice(0, 5) === 'http:') {\n        self._html5 = true;\n        self._webAudio = false;\n      }\n\n      // Create a new sound object and add it to the pool.\n      new Sound(self);\n\n      // Load and decode the audio data for playback.\n      if (self._webAudio) {\n        loadBuffer(self);\n      }\n\n      return self;\n    },\n\n    /**\n     * Play a sound or resume previous playback.\n     * @param  {String/Number} sprite Sprite name for sprite playback or sound id to continue previous.\n     * @return {Number}        Sound ID.\n     */\n    play: function(sprite) {\n      var self = this;\n      var args = arguments;\n      var id = null;\n\n      // Determine if a sprite, sound id or nothing was passed\n      if (typeof sprite === 'number') {\n        id = sprite;\n        sprite = null;\n      } else if (typeof sprite === 'undefined') {\n        // Use the default sound sprite (plays the full audio length).\n        sprite = '__default';\n\n        // Check if there is a single paused sound that isn't ended.\n        // If there is, play that sound. If not, continue as usual.\n        var num = 0;\n        for (var i=0; i<self._sounds.length; i++) {\n          if (self._sounds[i]._paused && !self._sounds[i]._ended) {\n            num++;\n            id = self._sounds[i]._id;\n          }\n        }\n\n        if (num === 1) {\n          sprite = null;\n        } else {\n          id = null;\n        }\n      }\n\n      // Get the selected node, or get one from the pool.\n      var sound = id ? self._soundById(id) : self._inactiveSound();\n\n      // If the sound doesn't exist, do nothing.\n      if (!sound) {\n        return null;\n      }\n\n      // Select the sprite definition.\n      if (id && !sprite) {\n        sprite = sound._sprite || '__default';\n      }\n\n      // If we have no sprite and the sound hasn't loaded, we must wait\n      // for the sound to load to get our audio's duration.\n      if (!self._loaded && !self._sprite[sprite]) {\n        self.once('load', function() {\n          self.play(self._soundById(sound._id) ? sound._id : undefined);\n        });\n        return sound._id;\n      }\n\n      // Don't play the sound if an id was passed and it is already playing.\n      if (id && !sound._paused) {\n        return sound._id;\n      }\n\n      // Make sure the AudioContext isn't suspended, and resume it if it is.\n      if (self._webAudio) {\n        Howler._autoResume();\n      }\n\n      // Determine how long to play for and where to start playing.\n      var seek = sound._seek > 0 ? sound._seek : self._sprite[sprite][0] / 1000;\n      var duration = ((self._sprite[sprite][0] + self._sprite[sprite][1]) / 1000) - seek;\n\n      // Create a timer to fire at the end of playback or the start of a new loop.\n      var timeout = (duration * 1000) / Math.abs(sound._rate);\n      if (timeout !== Infinity) {\n        self._endTimers[sound._id] = setTimeout(self._ended.bind(self, sound), timeout);\n      }\n\n      // Update the parameters of the sound\n      sound._paused = false;\n      sound._ended = false;\n      sound._sprite = sprite;\n      sound._seek = seek;\n      sound._start = self._sprite[sprite][0] / 1000;\n      sound._stop = (self._sprite[sprite][0] + self._sprite[sprite][1]) / 1000;\n      sound._loop = !!(sound._loop || self._sprite[sprite][2]);\n\n      // Begin the actual playback.\n      var node = sound._node;\n      if (self._webAudio) {\n        // Fire this when the sound is ready to play to begin Web Audio playback.\n        var playWebAudio = function() {\n          self._refreshBuffer(sound);\n\n          // Setup the playback params.\n          var vol = (sound._muted || self._muted) ? 0 : sound._volume * Howler.volume();\n          node.gain.setValueAtTime(vol, ctx.currentTime);\n          sound._playStart = ctx.currentTime;\n\n          // Play the sound using the supported method.\n          if (typeof node.bufferSource.start === 'undefined') {\n            sound._loop ? node.bufferSource.noteGrainOn(0, seek, 86400) : node.bufferSource.noteGrainOn(0, seek, duration);\n          } else {\n            sound._loop ? node.bufferSource.start(0, seek, 86400) : node.bufferSource.start(0, seek, duration);\n          }\n\n          // Start a new timer if none is present.\n          if (!self._endTimers[sound._id] && timeout !== Infinity) {\n            self._endTimers[sound._id] = setTimeout(self._ended.bind(self, sound), timeout);\n          }\n\n          if (!args[1]) {\n            setTimeout(function() {\n              self._emit('play', sound._id);\n            }, 0);\n          }\n        };\n\n        if (self._loaded) {\n          playWebAudio();\n        } else {\n          // Wait for the audio to load and then begin playback.\n          self.once('load', playWebAudio);\n\n          // Cancel the end timer.\n          self._clearTimer(sound._id);\n        }\n      } else {\n        // Fire this when the sound is ready to play to begin HTML5 Audio playback.\n        var playHtml5 = function() {\n          node.currentTime = seek;\n          node.muted = sound._muted || self._muted || Howler._muted || node.muted;\n          node.volume = sound._volume * Howler.volume();\n          node.playbackRate = sound._rate;\n          setTimeout(function() {\n            node.play();\n            if (!args[1]) {\n              self._emit('play', sound._id);\n            }\n          }, 0);\n        };\n\n        // Play immediately if ready, or wait for the 'canplaythrough'e vent.\n        if (node.readyState === 4 || !node.readyState && navigator.isCocoonJS) {\n          playHtml5();\n        } else {\n          var listener = function() {\n            // Setup the new end timer.\n            if (timeout !== Infinity) {\n              self._endTimers[sound._id] = setTimeout(self._ended.bind(self, sound), timeout);\n            }\n\n            // Begin playback.\n            playHtml5();\n\n            // Clear this listener.\n            node.removeEventListener(canPlayEvent, listener, false);\n          };\n          node.addEventListener(canPlayEvent, listener, false);\n\n          // Cancel the end timer.\n          self._clearTimer(sound._id);\n        }\n      }\n\n      return sound._id;\n    },\n\n    /**\n     * Pause playback and save current position.\n     * @param  {Number} id The sound ID (empty to pause all in group).\n     * @return {Howl}\n     */\n    pause: function(id) {\n      var self = this;\n\n      // Wait for the sound to begin playing before pausing it.\n      if (!self._loaded) {\n        self.once('play', function() {\n          self.pause(id);\n        });\n\n        return self;\n      }\n\n      // If no id is passed, get all ID's to be paused.\n      var ids = self._getSoundIds(id);\n\n      for (var i=0; i<ids.length; i++) {\n        // Clear the end timer.\n        self._clearTimer(ids[i]);\n\n        // Get the sound.\n        var sound = self._soundById(ids[i]);\n\n        if (sound && !sound._paused) {\n          // Reset the seek position.\n          sound._seek = self.seek(ids[i]);\n          sound._paused = true;\n\n          // Stop currently running fades.\n          self._stopFade(ids[i]);\n\n          if (sound._node) {\n            if (self._webAudio) {\n              // make sure the sound has been created\n              if (!sound._node.bufferSource) {\n                return self;\n              }\n\n              if (typeof sound._node.bufferSource.stop === 'undefined') {\n                sound._node.bufferSource.noteOff(0);\n              } else {\n                sound._node.bufferSource.stop(0);\n              }\n\n              // Clean up the buffer source.\n              sound._node.bufferSource = null;\n            } else if (!isNaN(sound._node.duration) || sound._node.duration === Infinity) {\n              sound._node.pause();\n            }\n          }\n\n          // Fire the pause event, unless `true` is passed as the 2nd argument.\n          if (!arguments[1]) {\n            self._emit('pause', sound._id);\n          }\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Stop playback and reset to start.\n     * @param  {Number} id The sound ID (empty to stop all in group).\n     * @return {Howl}\n     */\n    stop: function(id) {\n      var self = this;\n\n      // Wait for the sound to begin playing before stopping it.\n      if (!self._loaded) {\n        if (typeof self._sounds[0]._sprite !== 'undefined') {\n          self.once('play', function() {\n            self.stop(id);\n          });\n        }\n\n        return self;\n      }\n\n      // If no id is passed, get all ID's to be stopped.\n      var ids = self._getSoundIds(id);\n\n      for (var i=0; i<ids.length; i++) {\n        // Clear the end timer.\n        self._clearTimer(ids[i]);\n\n        // Get the sound.\n        var sound = self._soundById(ids[i]);\n\n        if (sound && !sound._paused) {\n          // Reset the seek position.\n          sound._seek = sound._start || 0;\n          sound._paused = true;\n          sound._ended = true;\n\n          // Stop currently running fades.\n          self._stopFade(ids[i]);\n\n          if (sound._node) {\n            if (self._webAudio) {\n              // make sure the sound has been created\n              if (!sound._node.bufferSource) {\n                return self;\n              }\n\n              if (typeof sound._node.bufferSource.stop === 'undefined') {\n                sound._node.bufferSource.noteOff(0);\n              } else {\n                sound._node.bufferSource.stop(0);\n              }\n\n              // Clean up the buffer source.\n              sound._node.bufferSource = null;\n            } else if (!isNaN(sound._node.duration) || sound._node.duration === Infinity) {\n              sound._node.pause();\n              sound._node.currentTime = sound._start || 0;\n            }\n          }\n\n          self._emit('stop', sound._id);\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Mute/unmute a single sound or all sounds in this Howl group.\n     * @param  {Boolean} muted Set to true to mute and false to unmute.\n     * @param  {Number} id    The sound ID to update (omit to mute/unmute all).\n     * @return {Howl}\n     */\n    mute: function(muted, id) {\n      var self = this;\n\n      // Wait for the sound to begin playing before muting it.\n      if (!self._loaded) {\n        self.once('play', function() {\n          self.mute(muted, id);\n        });\n\n        return self;\n      }\n\n      // If applying mute/unmute to all sounds, update the group's value.\n      if (typeof id === 'undefined') {\n        if (typeof muted === 'boolean') {\n          self._muted = muted;\n        } else {\n          return self._muted;\n        }\n      }\n\n      // If no id is passed, get all ID's to be muted.\n      var ids = self._getSoundIds(id);\n\n      for (var i=0; i<ids.length; i++) {\n        // Get the sound.\n        var sound = self._soundById(ids[i]);\n\n        if (sound) {\n          sound._muted = muted;\n\n          if (self._webAudio && sound._node) {\n            sound._node.gain.setValueAtTime(muted ? 0 : sound._volume * Howler.volume(), ctx.currentTime);\n          } else if (sound._node) {\n            sound._node.muted = Howler._muted ? true : muted;\n          }\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Get/set the volume of this sound or of the Howl group. This method can optionally take 0, 1 or 2 arguments.\n     *   volume() -> Returns the group's volume value.\n     *   volume(id) -> Returns the sound id's current volume.\n     *   volume(vol) -> Sets the volume of all sounds in this Howl group.\n     *   volume(vol, id) -> Sets the volume of passed sound id.\n     * @return {Howl/Number} Returns self or current volume.\n     */\n    volume: function() {\n      var self = this;\n      var args = arguments;\n      var vol, id;\n\n      // Determine the values based on arguments.\n      if (args.length === 0) {\n        // Return the value of the groups' volume.\n        return self._volume;\n      } else if (args.length === 1) {\n        // First check if this is an ID, and if not, assume it is a new volume.\n        var ids = self._getSoundIds();\n        var index = ids.indexOf(args[0]);\n        if (index >= 0) {\n          id = parseInt(args[0], 10);\n        } else {\n          vol = parseFloat(args[0]);\n        }\n      } else if (args.length >= 2) {\n        vol = parseFloat(args[0]);\n        id = parseInt(args[1], 10);\n      }\n\n      // Update the volume or return the current volume.\n      var sound;\n      if (typeof vol !== 'undefined' && vol >= 0 && vol <= 1) {\n        // Wait for the sound to begin playing before changing the volume.\n        if (!self._loaded) {\n          self.once('play', function() {\n            self.volume.apply(self, args);\n          });\n\n          return self;\n        }\n\n        // Set the group volume.\n        if (typeof id === 'undefined') {\n          self._volume = vol;\n        }\n\n        // Update one or all volumes.\n        id = self._getSoundIds(id);\n        for (var i=0; i<id.length; i++) {\n          // Get the sound.\n          sound = self._soundById(id[i]);\n\n          if (sound) {\n            sound._volume = vol;\n\n            // Stop currently running fades.\n            if (!args[2]) {\n              self._stopFade(id[i]);\n            }\n\n            if (self._webAudio && sound._node && !sound._muted) {\n              sound._node.gain.setValueAtTime(vol * Howler.volume(), ctx.currentTime);\n            } else if (sound._node && !sound._muted) {\n              sound._node.volume = vol * Howler.volume();\n            }\n          }\n        }\n      } else {\n        sound = id ? self._soundById(id) : self._sounds[0];\n        return sound ? sound._volume : 0;\n      }\n\n      return self;\n    },\n\n    /**\n     * Fade a currently playing sound between two volumes (if no id is passsed, all sounds will fade).\n     * @param  {Number} from The value to fade from (0.0 to 1.0).\n     * @param  {Number} to   The volume to fade to (0.0 to 1.0).\n     * @param  {Number} len  Time in milliseconds to fade.\n     * @param  {Number} id   The sound id (omit to fade all sounds).\n     * @return {Howl}\n     */\n    fade: function(from, to, len, id) {\n      var self = this;\n\n      // Wait for the sound to play before fading.\n      if (!self._loaded) {\n        self.once('play', function() {\n          self.fade(from, to, len, id);\n        });\n\n        return self;\n      }\n\n      // Set the volume to the start position.\n      self.volume(from, id);\n\n      // Fade the volume of one or all sounds.\n      var ids = self._getSoundIds(id);\n      for (var i=0; i<ids.length; i++) {\n        // Get the sound.\n        var sound = self._soundById(ids[i]);\n\n        // Create a linear fade or fall back to timeouts with HTML5 Audio.\n        if (sound) {\n          if (self._webAudio && !sound._muted) {\n            var currentTime = ctx.currentTime;\n            var end = currentTime + (len / 1000);\n            sound._volume = from;\n            sound._node.gain.setValueAtTime(from, currentTime);\n            sound._node.gain.linearRampToValueAtTime(to, end);\n\n            // Fire the event when complete.\n            sound._timeout = setTimeout(function(id, sound) {\n              delete sound._timeout;\n              setTimeout(function() {\n                sound._volume = to;\n                self._emit('faded', id);\n              }, end - ctx.currentTime > 0 ? Math.ceil((end - ctx.currentTime) * 1000) : 0);\n            }.bind(self, ids[i], sound), len);\n          } else {\n            var diff = Math.abs(from - to);\n            var dir = from > to ? 'out' : 'in';\n            var steps = diff / 0.01;\n            var stepLen = len / steps;\n            \n            (function() {\n              var vol = from;\n              sound._interval = setInterval(function(id, sound) {\n                // Update the volume amount.\n                vol += (dir === 'in' ? 0.01 : -0.01);\n\n                // Make sure the volume is in the right bounds.\n                vol = Math.max(0, vol);\n                vol = Math.min(1, vol);\n\n                // Round to within 2 decimal points.\n                vol = Math.round(vol * 100) / 100;\n\n                // Change the volume.\n                self.volume(vol, id, true);\n\n                // When the fade is complete, stop it and fire event.\n                if (vol === to) {\n                  clearInterval(sound._interval);\n                  delete sound._interval;\n                  self._emit('faded', id);\n                }\n              }.bind(self, ids[i], sound), stepLen);\n            })();\n          }\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Internal method that stops the currently playing fade when\n     * a new fade starts, volume is changed or the sound is stopped.\n     * @param  {Number} id The sound id.\n     * @return {Howl}\n     */\n    _stopFade: function(id) {\n      var self = this;\n      var sound = self._soundById(id);\n\n      if (sound._interval) {\n        clearInterval(sound._interval);\n        delete sound._interval;\n        self._emit('faded', id);\n      } else if (sound._timeout) {\n        clearTimeout(sound._timeout);\n        delete sound._timeout;\n        sound._node.gain.cancelScheduledValues(ctx.currentTime);\n        self._emit('faded', id);\n      }\n\n      return self;\n    },\n\n    /**\n     * Get/set the loop parameter on a sound. This method can optionally take 0, 1 or 2 arguments.\n     *   loop() -> Returns the group's loop value.\n     *   loop(id) -> Returns the sound id's loop value.\n     *   loop(loop) -> Sets the loop value for all sounds in this Howl group.\n     *   loop(loop, id) -> Sets the loop value of passed sound id.\n     * @return {Howl/Boolean} Returns self or current loop value.\n     */\n    loop: function() {\n      var self = this;\n      var args = arguments;\n      var loop, id, sound;\n\n      // Determine the values for loop and id.\n      if (args.length === 0) {\n        // Return the grou's loop value.\n        return self._loop;\n      } else if (args.length === 1) {\n        if (typeof args[0] === 'boolean') {\n          loop = args[0];\n          self._loop = loop;\n        } else {\n          // Return this sound's loop value.\n          sound = self._soundById(parseInt(args[0], 10));\n          return sound ? sound._loop : false;\n        }\n      } else if (args.length === 2) {\n        loop = args[0];\n        id = parseInt(args[1], 10);\n      }\n\n      // If no id is passed, get all ID's to be looped.\n      var ids = self._getSoundIds(id);\n      for (var i=0; i<ids.length; i++) {\n        sound = self._soundById(ids[i]);\n\n        if (sound) {\n          sound._loop = loop;\n          if (self._webAudio && sound._node && sound._node.bufferSource) {\n            sound._node.bufferSource.loop = loop;\n          }\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Get/set the playback rate of a sound. This method can optionally take 0, 1 or 2 arguments.\n     *   rate() -> Returns the first sound node's current playback rate.\n     *   rate(id) -> Returns the sound id's current playback rate.\n     *   rate(rate) -> Sets the playback rate of all sounds in this Howl group.\n     *   rate(rate, id) -> Sets the playback rate of passed sound id.\n     * @return {Howl/Number} Returns self or the current playback rate.\n     */\n    rate: function() {\n      var self = this;\n      var args = arguments;\n      var rate, id;\n\n      // Determine the values based on arguments.\n      if (args.length === 0) {\n        // We will simply return the current rate of the first node.\n        id = self._sounds[0]._id;\n      } else if (args.length === 1) {\n        // First check if this is an ID, and if not, assume it is a new rate value.\n        var ids = self._getSoundIds();\n        var index = ids.indexOf(args[0]);\n        if (index >= 0) {\n          id = parseInt(args[0], 10);\n        } else {\n          rate = parseFloat(args[0]);\n        }\n      } else if (args.length === 2) {\n        rate = parseFloat(args[0]);\n        id = parseInt(args[1], 10);\n      }\n\n      // Update the playback rate or return the current value.\n      var sound;\n      if (typeof rate === 'number') {\n        // Wait for the sound to load before changing the playback rate.\n        if (!self._loaded) {\n          self.once('load', function() {\n            self.rate.apply(self, args);\n          });\n\n          return self;\n        }\n\n        // Set the group rate.\n        if (typeof id === 'undefined') {\n          self._rate = rate;\n        }\n\n        // Update one or all volumes.\n        id = self._getSoundIds(id);\n        for (var i=0; i<id.length; i++) {\n          // Get the sound.\n          sound = self._soundById(id[i]);\n\n          if (sound) {\n            sound._rate = rate;\n\n            // Change the playback rate.\n            if (self._webAudio && sound._node && sound._node.bufferSource) {\n              sound._node.bufferSource.playbackRate.value = rate;\n            } else if (sound._node) {\n              sound._node.playbackRate = rate;\n            }\n\n            // Reset the timers.\n            var seek = self.seek(id[i]);\n            var duration = ((self._sprite[sound._sprite][0] + self._sprite[sound._sprite][1]) / 1000) - seek;\n            var timeout = (duration * 1000) / Math.abs(sound._rate);\n\n            self._clearTimer(id[i]);\n            self._endTimers[id[i]] = setTimeout(self._ended.bind(self, sound), timeout);\n          }\n        }\n      } else {\n        sound = self._soundById(id);\n        return sound ? sound._rate : self._rate;\n      }\n\n      return self;\n    },\n\n    /**\n     * Get/set the seek position of a sound. This method can optionally take 0, 1 or 2 arguments.\n     *   seek() -> Returns the first sound node's current seek position.\n     *   seek(id) -> Returns the sound id's current seek position.\n     *   seek(seek) -> Sets the seek position of the first sound node.\n     *   seek(seek, id) -> Sets the seek position of passed sound id.\n     * @return {Howl/Number} Returns self or the current seek position.\n     */\n    seek: function() {\n      var self = this;\n      var args = arguments;\n      var seek, id;\n\n      // Determine the values based on arguments.\n      if (args.length === 0) {\n        // We will simply return the current position of the first node.\n        id = self._sounds[0]._id;\n      } else if (args.length === 1) {\n        // First check if this is an ID, and if not, assume it is a new seek position.\n        var ids = self._getSoundIds();\n        var index = ids.indexOf(args[0]);\n        if (index >= 0) {\n          id = parseInt(args[0], 10);\n        } else {\n          id = self._sounds[0]._id;\n          seek = parseFloat(args[0]);\n        }\n      } else if (args.length === 2) {\n        seek = parseFloat(args[0]);\n        id = parseInt(args[1], 10);\n      }\n\n      // If there is no ID, bail out.\n      if (typeof id === 'undefined') {\n        return self;\n      }\n\n      // Wait for the sound to load before seeking it.\n      if (!self._loaded) {\n        self.once('load', function() {\n          self.seek.apply(self, args);\n        });\n\n        return self;\n      }\n\n      // Get the sound.\n      var sound = self._soundById(id);\n\n      if (sound) {\n        if (seek >= 0) {\n          // Pause the sound and update position for restarting playback.\n          var playing = self.playing(id);\n          if (playing) {\n            self.pause(id, true);\n          }\n\n          // Move the position of the track and cancel timer.\n          sound._seek = seek;\n          self._clearTimer(id);\n\n          // Restart the playback if the sound was playing.\n          if (playing) {\n            self.play(id, true);\n          }\n        } else {\n          if (self._webAudio) {\n            return (sound._seek + (self.playing(id) ? ctx.currentTime - sound._playStart : 0));\n          } else {\n            return sound._node.currentTime;\n          }\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Check if a specific sound is currently playing or not.\n     * @param  {Number} id The sound id to check. If none is passed, first sound is used.\n     * @return {Boolean}    True if playing and false if not.\n     */\n    playing: function(id) {\n      var self = this;\n      var sound = self._soundById(id) || self._sounds[0];\n\n      return sound ? !sound._paused : false;\n    },\n\n    /**\n     * Get the duration of this sound.\n     * @return {Number} Audio duration.\n     */\n    duration: function() {\n      return this._duration;\n    },\n\n    /**\n     * Unload and destroy the current Howl object.\n     * This will immediately stop all sound instances attached to this group.\n     */\n    unload: function() {\n      var self = this;\n\n      // Stop playing any active sounds.\n      var sounds = self._sounds;\n      for (var i=0; i<sounds.length; i++) {\n        // Stop the sound if it is currently playing.\n        if (!sounds[i]._paused) {\n          self.stop(sounds[i]._id);\n          self._emit('end', sounds[i]._id);\n        }\n\n        // Remove the source or disconnect.\n        if (!self._webAudio) {\n          // Set the source to an empty string to stop any downloading.\n          sounds[i]._node.src = '';\n\n          // Remove any event listeners.\n          sounds[i]._node.removeEventListener('error', sounds[i]._errorFn, false);\n          sounds[i]._node.removeEventListener(canPlayEvent, sounds[i]._loadFn, false);\n        }\n\n        // Empty out all of the nodes.\n        delete sounds[i]._node;\n\n        // Make sure all timers are cleared out.\n        self._clearTimer(sounds[i]._id);\n\n        // Remove the references in the global Howler object.\n        var index = Howler._howls.indexOf(self);\n        if (index >= 0) {\n          Howler._howls.splice(index, 1);\n        }\n      }\n\n      // Delete this sound from the cache.\n      if (cache) {\n        delete cache[self._src];\n      }\n\n      // Clear out `self`.\n      self._sounds = [];\n      self = null;\n\n      return null;\n    },\n\n    /**\n     * Listen to a custom event.\n     * @param  {String}   event Event name.\n     * @param  {Function} fn    Listener to call.\n     * @param  {Number}   id    (optional) Only listen to events for this sound.\n     * @param  {Number}   once  (INTERNAL) Marks event to fire only once.\n     * @return {Howl}\n     */\n    on: function(event, fn, id, once) {\n      var self = this;\n      var events = self['_on' + event];\n\n      if (typeof fn === 'function') {\n        events.push(once ? {id: id, fn: fn, once: once} : {id: id, fn: fn});\n      }\n\n      return self;\n    },\n\n    /**\n     * Remove a custom event. Call without parameters to remove all events.\n     * @param  {String}   event Event name.\n     * @param  {Function} fn    Listener to remove. Leave empty to remove all.\n     * @param  {Number}   id    (optional) Only remove events for this sound.\n     * @return {Howl}\n     */\n    off: function(event, fn, id) {\n      var self = this;\n      var events = self['_on' + event];\n\n      if (fn) {\n        // Loop through event store and remove the passed function.\n        for (var i=0; i<events.length; i++) {\n          if (fn === events[i].fn && id === events[i].id) {\n            events.splice(i, 1);\n            break;\n          }\n        }\n      } else if (event) {\n        // Clear out all events of this type.\n        self['_on' + event] = [];\n      } else {\n        // Clear out all events of every type.\n        var keys = Object.keys(self);\n        for (var i=0; i<keys.length; i++) {\n          if ((keys[i].indexOf('_on') === 0) && Array.isArray(self[keys[i]])) {\n            self[keys[i]] = [];\n          }\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Listen to a custom event and remove it once fired.\n     * @param  {String}   event Event name.\n     * @param  {Function} fn    Listener to call.\n     * @param  {Number}   id    (optional) Only listen to events for this sound.\n     * @return {Howl}\n     */\n    once: function(event, fn, id) {\n      var self = this;\n\n      // Setup the event listener.\n      self.on(event, fn, id, 1);\n\n      return self;\n    },\n\n    /**\n     * Emit all events of a specific type and pass the sound id.\n     * @param  {String} event Event name.\n     * @param  {Number} id    Sound ID.\n     * @param  {Number} msg   Message to go with event.\n     * @return {Howl}\n     */\n    _emit: function(event, id, msg) {\n      var self = this;\n      var events = self['_on' + event];\n      \n      // Loop through event store and fire all functions.\n      for (var i=0; i<events.length; i++) {\n        if (!events[i].id || events[i].id === id) {\n          setTimeout(function(fn) {\n            fn.call(this, id, msg);\n          }.bind(self, events[i].fn), 0);\n\n          // If this event was setup with `once`, remove it.\n          if (events[i].once) {\n            self.off(event, events[i].fn, events[i].id);\n          }\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Fired when playback ends at the end of the duration.\n     * @param  {Sound} sound The sound object to work with.\n     * @return {Howl}\n     */\n    _ended: function(sound) {\n      var self = this;\n      var sprite = sound._sprite;\n\n      // Should this sound loop?\n      var loop = !!(sound._loop || self._sprite[sprite][2]);\n\n      // Fire the ended event.\n      self._emit('end', sound._id);\n\n      // Restart the playback for HTML5 Audio loop.\n      if (!self._webAudio && loop) {\n        self.stop(sound._id).play(sound._id);\n      }\n\n      // Restart this timer if on a Web Audio loop.\n      if (self._webAudio && loop) {\n        self._emit('play', sound._id);\n        sound._seek = sound._start || 0;\n        sound._playStart = ctx.currentTime;\n\n        var timeout = ((sound._stop - sound._start) * 1000) / Math.abs(sound._rate);\n        self._endTimers[sound._id] = setTimeout(self._ended.bind(self, sound), timeout);\n      }\n\n      // Mark the node as paused.\n      if (self._webAudio && !loop) {\n        sound._paused = true;\n        sound._ended = true;\n        sound._seek = sound._start || 0;\n        self._clearTimer(sound._id);\n\n        // Clean up the buffer source.\n        sound._node.bufferSource = null;\n\n        // Attempt to auto-suspend AudioContext if no sounds are still playing.\n        Howler._autoSuspend();\n      }\n\n      // When using a sprite, end the track.\n      if (!self._webAudio && !loop) {\n        self.stop(sound._id);\n      }\n\n      return self;\n    },\n\n    /**\n     * Clear the end timer for a sound playback.\n     * @param  {Number} id The sound ID.\n     * @return {Howl}\n     */\n    _clearTimer: function(id) {\n      var self = this;\n\n      if (self._endTimers[id]) {\n        clearTimeout(self._endTimers[id]);\n        delete self._endTimers[id];\n      }\n\n      return self;\n    },\n\n    /**\n     * Return the sound identified by this ID, or return null.\n     * @param  {Number} id Sound ID\n     * @return {Object}    Sound object or null.\n     */\n    _soundById: function(id) {\n      var self = this;\n\n      // Loop through all sounds and find the one with this ID.\n      for (var i=0; i<self._sounds.length; i++) {\n        if (id === self._sounds[i]._id) {\n          return self._sounds[i];\n        }\n      }\n\n      return null;\n    },\n\n    /**\n     * Return an inactive sound from the pool or create a new one.\n     * @return {Sound} Sound playback object.\n     */\n    _inactiveSound: function() {\n      var self = this;\n\n      self._drain();\n\n      // Find the first inactive node to recycle.\n      for (var i=0; i<self._sounds.length; i++) {\n        if (self._sounds[i]._ended) {\n          return self._sounds[i].reset();\n        }\n      }\n\n      // If no inactive node was found, create a new one.\n      return new Sound(self);\n    },\n\n    /**\n     * Drain excess inactive sounds from the pool.\n     */\n    _drain: function() {\n      var self = this;\n      var limit = self._pool;\n      var cnt = 0;\n      var i = 0;\n\n      // If there are less sounds than the max pool size, we are done.\n      if (self._sounds.length < limit) {\n        return;\n      }\n\n      // Count the number of inactive sounds.\n      for (i=0; i<self._sounds.length; i++) {\n        if (self._sounds[i]._ended) {\n          cnt++;\n        }\n      }\n\n      // Remove excess inactive sounds, going in reverse order.\n      for (i=self._sounds.length - 1; i>=0; i--) {\n        if (cnt <= limit) {\n          return;\n        }\n\n        if (self._sounds[i]._ended) {\n          // Disconnect the audio source when using Web Audio.\n          if (self._webAudio && self._sounds[i]._node) {\n            self._sounds[i]._node.disconnect(0);\n          }\n\n          // Remove sounds until we have the pool size.\n          self._sounds.splice(i, 1);\n          cnt--;\n        }\n      }\n    },\n\n    /**\n     * Get all ID's from the sounds pool.\n     * @param  {Number} id Only return one ID if one is passed.\n     * @return {Array}    Array of IDs.\n     */\n    _getSoundIds: function(id) {\n      var self = this;\n\n      if (typeof id === 'undefined') {\n        var ids = [];\n        for (var i=0; i<self._sounds.length; i++) {\n          ids.push(self._sounds[i]._id);\n        }\n\n        return ids;\n      } else {\n        return [id];\n      }\n    },\n\n    /**\n     * Load the sound back into the buffer source.\n     * @param  {Sound} sound The sound object to work with.\n     * @return {Howl}\n     */\n    _refreshBuffer: function(sound) {\n      var self = this;\n\n      // Setup the buffer source for playback.\n      sound._node.bufferSource = ctx.createBufferSource();\n      sound._node.bufferSource.buffer = cache[self._src];\n\n      // Connect to the correct node.\n      if (sound._panner) {\n        sound._node.bufferSource.connect(sound._panner);\n      } else {\n        sound._node.bufferSource.connect(sound._node);\n      }\n\n      // Setup looping and playback rate.\n      sound._node.bufferSource.loop = sound._loop;\n      if (sound._loop) {\n        sound._node.bufferSource.loopStart = sound._start || 0;\n        sound._node.bufferSource.loopEnd = sound._stop;\n      }\n      sound._node.bufferSource.playbackRate.value = self._rate;\n\n      return self;\n    }\n  };\n\n  /** Single Sound Methods **/\n  /***************************************************************************/\n\n  /**\n   * Setup the sound object, which each node attached to a Howl group is contained in.\n   * @param {Object} howl The Howl parent group.\n   */\n  var Sound = function(howl) {\n    this._parent = howl;\n    this.init();\n  };\n  Sound.prototype = {\n    /**\n     * Initialize a new Sound object.\n     * @return {Sound}\n     */\n    init: function() {\n      var self = this;\n      var parent = self._parent;\n\n      // Setup the default parameters.\n      self._muted = parent._muted;\n      self._loop = parent._loop;\n      self._volume = parent._volume;\n      self._muted = parent._muted;\n      self._rate = parent._rate;\n      self._seek = 0;\n      self._paused = true;\n      self._ended = true;\n      self._sprite = '__default';\n\n      // Generate a unique ID for this sound.\n      self._id = Math.round(Date.now() * Math.random());\n\n      // Add itself to the parent's pool.\n      parent._sounds.push(self);\n\n      // Create the new node.\n      self.create();\n\n      return self;\n    },\n\n    /**\n     * Create and setup a new sound object, whether HTML5 Audio or Web Audio.\n     * @return {Sound}\n     */\n    create: function() {\n      var self = this;\n      var parent = self._parent;\n      var volume = (Howler._muted || self._muted || self._parent._muted) ? 0 : self._volume * Howler.volume();\n\n      if (parent._webAudio) {\n        // Create the gain node for controlling volume (the source will connect to this).\n        self._node = (typeof ctx.createGain === 'undefined') ? ctx.createGainNode() : ctx.createGain();\n        self._node.gain.setValueAtTime(volume, ctx.currentTime);\n        self._node.paused = true;\n        self._node.connect(masterGain);\n      } else {\n        self._node = new Audio();\n\n        // Listen for errors (http://dev.w3.org/html5/spec-author-view/spec.html#mediaerror).\n        self._errorFn = self._errorListener.bind(self);\n        self._node.addEventListener('error', self._errorFn, false);\n\n        // Listen for 'canplaythrough' event to let us know the sound is ready.\n        self._loadFn = self._loadListener.bind(self);\n        self._node.addEventListener(canPlayEvent, self._loadFn, false);\n\n        // Setup the new audio node.\n        self._node.src = parent._src;\n        self._node.preload = 'auto';\n        self._node.volume = volume;\n\n        // Begin loading the source.\n        self._node.load();\n      }\n\n      return self;\n    },\n\n    /**\n     * Reset the parameters of this sound to the original state (for recycle).\n     * @return {Sound}\n     */\n    reset: function() {\n      var self = this;\n      var parent = self._parent;\n\n      // Reset all of the parameters of this sound.\n      self._muted = parent._muted;\n      self._loop = parent._loop;\n      self._volume = parent._volume;\n      self._muted = parent._muted;\n      self._rate = parent._rate;\n      self._seek = 0;\n      self._paused = true;\n      self._ended = true;\n      self._sprite = '__default';\n\n      // Generate a new ID so that it isn't confused with the previous sound.\n      self._id = Math.round(Date.now() * Math.random());\n\n      return self;\n    },\n\n    /**\n     * HTML5 Audio error listener callback.\n     */\n    _errorListener: function() {\n      var self = this;\n\n      if (self._node.error && self._node.error.code === 4) {\n        Howler.noAudio = true;\n      }\n\n      // Fire an error event and pass back the code.\n      self._parent._emit('loaderror', self._id, self._node.error ? self._node.error.code : 0);\n      \n      // Clear the event listener.\n      self._node.removeEventListener('error', self._errorListener, false);\n    },\n\n    /**\n     * HTML5 Audio canplaythrough listener callback.\n     */\n    _loadListener: function() {\n      var self = this;\n      var parent = self._parent;\n\n      // Round up the duration to account for the lower precision in HTML5 Audio.\n      parent._duration = Math.ceil(self._node.duration * 10) / 10;\n\n      // Setup a sprite if none is defined.\n      if (Object.keys(parent._sprite).length === 0) {\n        parent._sprite = {__default: [0, parent._duration * 1000]};\n      }\n\n      if (!parent._loaded) {\n        parent._loaded = true;\n        parent._emit('load');\n      }\n\n      if (parent._autoplay) {\n        parent.play();\n      }\n\n      // Clear the event listener.\n      self._node.removeEventListener(canPlayEvent, self._loadFn, false);\n    }\n  };\n\n  /** Helper Methods **/\n  /***************************************************************************/\n\n  // Only define these methods when using Web Audio.\n  if (usingWebAudio) {\n\n    var cache = {};\n\n    /**\n     * Buffer a sound from URL, Data URI or cache and decode to audio source (Web Audio API).\n     * @param  {Howl} self\n     */\n    var loadBuffer = function(self) {\n      var url = self._src;\n\n      // Check if the buffer has already been cached and use it instead.\n      if (cache[url]) {\n        // Set the duration from the cache.\n        self._duration = cache[url].duration;\n\n        // Load the sound into this Howl.\n        loadSound(self);\n\n        return;\n      }\n\n      if (/^data:[^;]+;base64,/.test(url)) {\n        // Setup polyfill for window.atob to support IE9.\n        // Modified from: https://github.com/davidchambers/Base64.js\n        window.atob = window.atob || function(input) {\n          var chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n          var str = String(input).replace(/=+$/, '');\n          for (\n            var bc = 0, bs, buffer, idx = 0, output = '';\n            buffer = str.charAt(idx++);\n            ~buffer && (bs = bc % 4 ? bs * 64 + buffer : buffer, bc++ % 4) ? output += String.fromCharCode(255 & bs >> (-2 * bc & 6)) : 0\n          ) {\n            buffer = chars.indexOf(buffer);\n          }\n\n          return output;\n        };\n\n        // Decode the base64 data URI without XHR, since some browsers don't support it.\n        var data = atob(url.split(',')[1]);\n        var dataView = new Uint8Array(data.length);\n        for (var i=0; i<data.length; ++i) {\n          dataView[i] = data.charCodeAt(i);\n        }\n        \n        decodeAudioData(dataView.buffer, self);\n      } else {\n        // Load the buffer from the URL.\n        var xhr = new XMLHttpRequest();\n        xhr.open('GET', url, true);\n        xhr.responseType = 'arraybuffer';\n        xhr.onload = function() {\n          decodeAudioData(xhr.response, self);\n        };\n        xhr.onerror = function() {\n          // If there is an error, switch to HTML5 Audio.\n          if (self._webAudio) {\n            self._html5 = true;\n            self._webAudio = false;\n            self._sounds = [];\n            delete cache[url];\n            self.load();\n          }\n        };\n        safeXhrSend(xhr);\n      }\n    };\n\n    /**\n     * Send the XHR request wrapped in a try/catch.\n     * @param  {Object} xhr XHR to send.\n     */\n    var safeXhrSend = function(xhr) {\n      try {\n        xhr.send();\n      } catch (e) {\n        xhr.onerror();\n      }\n    };\n\n    /**\n     * Decode audio data from an array buffer.\n     * @param  {ArrayBuffer} arraybuffer The audio data.\n     * @param  {Howl}        self\n     */\n    var decodeAudioData = function(arraybuffer, self) {\n      // Decode the buffer into an audio source.\n      ctx.decodeAudioData(arraybuffer, function(buffer) {\n        if (buffer && self._sounds.length > 0) {\n          cache[self._src] = buffer;\n          loadSound(self, buffer);\n        }\n      }, function() {\n        self._emit('loaderror', null, 'Decoding audio data failed.');\n      });\n    };\n\n    /**\n     * Sound is now loaded, so finish setting everything up and fire the loaded event.\n     * @param  {Howl} self\n     * @param  {Object} buffer The decoded buffer sound source.\n     */\n    var loadSound = function(self, buffer) {\n      // Set the duration.\n      if (buffer && !self._duration) {\n        self._duration = buffer.duration;\n      }\n\n      // Setup a sprite if none is defined.\n      if (Object.keys(self._sprite).length === 0) {\n        self._sprite = {__default: [0, self._duration * 1000]};\n      }\n\n      // Fire the loaded event.\n      if (!self._loaded) {\n        self._loaded = true;\n        self._emit('load');\n      }\n\n      // Begin playback if specified.\n      if (self._autoplay) {\n        self.play();\n      }\n    };\n\n  }\n\n  /**\n   * Setup the audio context when available, or switch to HTML5 Audio mode.\n   */\n  function setupAudioContext() {\n    try {\n      if (typeof AudioContext !== 'undefined') {\n        ctx = new AudioContext();\n      } else if (typeof webkitAudioContext !== 'undefined') {\n        ctx = new webkitAudioContext();\n      } else {\n        usingWebAudio = false;\n      }\n    } catch(e) {\n      usingWebAudio = false;\n    }\n\n    if (!usingWebAudio) {\n      if (typeof Audio !== 'undefined') {\n        try {\n          var test = new Audio();\n\n          // Check if the canplaythrough event is available.\n          if (typeof test.oncanplaythrough === 'undefined') {\n            canPlayEvent = 'canplay';\n          }\n        } catch(e) {\n          noAudio = true;\n        }\n      } else {\n        noAudio = true;\n      }\n    }\n\n    // Test to make sure audio isn't disabled in Internet Explorer\n    try {\n      var test = new Audio();\n      if (test.muted) {\n        noAudio = true;\n      }\n    } catch (e) {}\n\n    // Create a master gain node.\n    if (usingWebAudio) {\n      masterGain = (typeof ctx.createGain === 'undefined') ? ctx.createGainNode() : ctx.createGain();\n      masterGain.gain.value = 1;\n      masterGain.connect(ctx.destination);\n    }\n  }\n\n  // Add support for AMD (Asynchronous Module Definition) libraries such as require.js.\n  if (typeof define === 'function' && define.amd) {\n    define([], function() {\n      return {\n        Howler: Howler,\n        Howl: Howl\n      };\n    });\n  }\n\n  // Add support for CommonJS libraries such as browserify.\n  if (typeof exports !== 'undefined') {\n    exports.Howler = Howler;\n    exports.Howl = Howl;\n  }\n\n  // Define globally in case AMD is not available or unused.\n  if (typeof window !== 'undefined') {\n    window.HowlerGlobal = HowlerGlobal;\n    window.Howler = Howler;\n    window.Howl = Howl;\n    window.Sound = Sound;\n  }\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n */\n(function () {\n    /**\n     * There is no constructor function for me.plugins<br>\n     * This namespace is a container for all registered plugins.\n     * @see me.plugin.register\n     * @namespace me.plugins\n     * @memberOf me\n     */\n    me.plugins = {};\n\n    /**\n     * There is no constructor function for me.plugin\n     * @namespace me.plugin\n     * @memberOf me\n     */\n    me.plugin = (function () {\n\n        // hold public stuff inside the singleton\n        var singleton = {};\n\n        /*--------------\n            PUBLIC\n          --------------*/\n\n        /**\n        * a base Object for plugin <br>\n        * plugin must be installed using the register function\n        * @see me.plugin\n        * @class\n        * @extends Object\n        * @name plugin.Base\n        * @memberOf me\n        * @constructor\n        */\n        singleton.Base = me.Object.extend(\n        /** @scope me.plugin.Base.prototype */\n        {\n            /** @ignore */\n            init : function () {\n                /**\n                 * define the minimum required version of melonJS<br>\n                 * this can be overridden by the plugin\n                 * @public\n                 * @type String\n                 * @default \"3.0.0\"\n                 * @name me.plugin.Base#version\n                 */\n                this.version = \"3.0.0\";\n            }\n        });\n\n        /**\n         * patch a melonJS function\n         * @name patch\n         * @memberOf me.plugin\n         * @public\n         * @function\n         * @param {Object} proto target object\n         * @param {String} name target function\n         * @param {Function} fn replacement function\n         * @example\n         * // redefine the me.game.update function with a new one\n         * me.plugin.patch(me.game, \"update\", function () {\n         *   // display something in the console\n         *   console.log(\"duh\");\n         *   // call the original me.game.update function\n         *   this._patched();\n         * });\n         */\n        singleton.patch = function (proto, name, fn) {\n            // use the object prototype if possible\n            if (typeof proto.prototype !== \"undefined\") {\n                proto = proto.prototype;\n            }\n            // reuse the logic behind me.Object.extend\n            if (typeof(proto[name]) === \"function\") {\n                // save the original function\n                var _parent = proto[name];\n                // override the function with the new one\n                Object.defineProperty(proto, name, {\n                    \"configurable\" : true,\n                    \"value\" : (function (name, fn) {\n                        return function () {\n                            this._patched = _parent;\n                            var ret = fn.apply(this, arguments);\n                            this._patched = null;\n                            return ret;\n                        };\n                    })(name, fn)\n                });\n            }\n            else {\n                console.error(name + \" is not an existing function\");\n            }\n        };\n\n        /**\n         * Register a plugin.\n         * @name register\n         * @memberOf me.plugin\n         * @see me.plugin.Base\n         * @public\n         * @function\n         * @param {me.plugin.Base} plugin Plugin to instiantiate and register\n         * @param {String} name\n         * @param {} [arguments...] all extra parameters will be passed to the plugin constructor\n         * @example\n         * // register a new plugin\n         * me.plugin.register(TestPlugin, \"testPlugin\");\n         * // the plugin then also become available\n         * // under then me.plugins namespace\n         * me.plugins.testPlugin.myfunction ();\n         */\n        singleton.register = function (plugin, name) {\n            // ensure me.plugin[name] is not already \"used\"\n            if (me.plugin[name]) {\n                console.error(\"plugin \" + name + \" already registered\");\n            }\n\n            // get extra arguments\n            var _args = [];\n            if (arguments.length > 2) {\n                // store extra arguments if any\n                _args = Array.prototype.slice.call(arguments, 1);\n            }\n\n            // try to instantiate the plugin\n            _args[0] = plugin;\n            var instance = new (plugin.bind.apply(plugin, _args))();\n\n            // inheritance check\n            if (!instance || !(instance instanceof me.plugin.Base)) {\n                throw new me.Error(\"Plugin should extend the me.plugin.Base Class !\");\n            }\n\n            // compatibility testing\n            if (me.sys.checkVersion(instance.version) > 0) {\n                throw new me.Error(\"Plugin version mismatch, expected: \" + instance.version + \", got: \" + me.version);\n            }\n\n            // create a reference to the new plugin\n            me.plugins[name] = instance;\n        };\n\n        // return our singleton\n        return singleton;\n    })();\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n */\n\n/**\n * Used to make a game entity draggable\n * @class\n * @extends me.Entity\n * @memberOf me\n * @constructor\n * @param {Number} x the x coordinates of the entity object\n * @param {Number} y the y coordinates of the entity object\n * @param {Object} settings Entity properties (see {@link me.Entity})\n */\nme.DraggableEntity = (function (Entity, Input, Event, Vector) {\n    \"use strict\";\n\n    return Entity.extend(\n    /** @scope me.DraggableEntity.prototype */\n    {\n        /**\n         * Constructor\n         * @name init\n         * @memberOf me.DraggableEntity\n         * @function\n         * @param {Number} x the x postion of the entity\n         * @param {Number} y the y postion of the entity\n         * @param {Object} settings the additional entity settings\n         */\n        init: function (x, y, settings) {\n            Entity.prototype.init.apply(this, [x, y, settings]);\n            this.dragging = false;\n            this.dragId = null;\n            this.grabOffset = new Vector(0, 0);\n            this.onPointerEvent = Input.registerPointerEvent;\n            this.removePointerEvent = Input.releasePointerEvent;\n            this.initEvents();\n        },\n\n        /**\n         * Initializes the events the modules needs to listen to\n         * It translates the pointer events to me.events\n         * in order to make them pass through the system and to make\n         * this module testable. Then we subscribe this module to the\n         * transformed events.\n         * @name initEvents\n         * @memberOf me.DraggableEntity\n         * @function\n         */\n        initEvents: function () {\n            var self = this;\n            this.mouseDown = function (e) {\n                this.translatePointerEvent(e, Event.DRAGSTART);\n            };\n            this.mouseUp = function (e) {\n                this.translatePointerEvent(e, Event.DRAGEND);\n            };\n            this.onPointerEvent(\"pointerdown\", this, this.mouseDown.bind(this));\n            this.onPointerEvent(\"pointerup\", this, this.mouseUp.bind(this));\n            Event.subscribe(Event.POINTERMOVE, this.dragMove.bind(this));\n            Event.subscribe(Event.DRAGSTART, function (e, draggable) {\n                if (draggable === self) {\n                    self.dragStart(e);\n                }\n            });\n            Event.subscribe(Event.DRAGEND, function (e, draggable) {\n                if (draggable === self) {\n                    self.dragEnd(e);\n                }\n            });\n        },\n\n        /**\n         * Translates a pointer event to a me.event\n         * @name translatePointerEvent\n         * @memberOf me.DraggableEntity\n         * @function\n         * @param {Object} e the pointer event you want to translate\n         * @param {String} translation the me.event you want to translate\n         * the event to\n         */\n        translatePointerEvent: function (e, translation) {\n            Event.publish(translation, [e, this]);\n        },\n\n        /**\n         * Gets called when the user starts dragging the entity\n         * @name dragStart\n         * @memberOf me.DraggableEntity\n         * @function\n         * @param {Object} x the pointer event\n         */\n        dragStart: function (e) {\n            if (this.dragging === false) {\n                this.dragging = true;\n                this.dragId = e.pointerId;\n                this.grabOffset.set(e.gameX, e.gameY);\n                this.grabOffset.sub(this.pos);\n                return false;\n            }\n        },\n\n        /**\n         * Gets called when the user drags this entity around\n         * @name dragMove\n         * @memberOf me.DraggableEntity\n         * @function\n         * @param {Object} x the pointer event\n         */\n        dragMove: function (e) {\n            if (this.dragging === true) {\n                if (this.dragId === e.pointerId) {\n                    this.pos.set(e.gameX, e.gameY, this.pos.z); //TODO : z ?\n                    this.pos.sub(this.grabOffset);\n                }\n            }\n        },\n\n        /**\n         * Gets called when the user stops dragging the entity\n         * @name dragEnd\n         * @memberOf me.DraggableEntity\n         * @function\n         * @param {Object} x the pointer event\n         */\n        dragEnd: function () {\n            if (this.dragging === true) {\n                this.pointerId = undefined;\n                this.dragging = false;\n                return false;\n            }\n        },\n\n        /**\n         * Destructor\n         * @name destroy\n         * @memberOf me.DraggableEntity\n         * @function\n         */\n        destroy: function () {\n            Event.unsubscribe(Event.POINTERMOVE, this.dragMove);\n            Event.unsubscribe(Event.DRAGSTART, this.dragStart);\n            Event.unsubscribe(Event.DRAGEND, this.dragEnd);\n            this.removePointerEvent(\"pointerdown\", this);\n            this.removePointerEvent(\"pointerup\", this);\n        }\n    });\n}(me.Entity, me.input, me.event, me.Vector2d));\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n */\n\n/**\n * Used to make a game entity a droptarget\n * @class\n * @extends me.Entity\n * @memberOf me\n * @constructor\n * @param {Number} x the x coordinates of the entity object\n * @param {Number} y the y coordinates of the entity object\n * @param {Object} settings Entity properties (see {@link me.Entity})\n */\nme.DroptargetEntity = (function (Entity, Event) {\n    \"use strict\";\n\n    return Entity.extend(\n    /** @scope me.DroptargetEntity.prototype */\n    {\n        /**\n         * Constructor\n         * @name init\n         * @memberOf me.DroptargetEntity\n         * @function\n         * @param {Number} x the x postion of the entity\n         * @param {Number} y the y postion of the entity\n         * @param {Object} settings the additional entity settings\n         */\n        init: function (x, y, settings) {\n            /**\n             * constant for the overlaps method\n             * @public\n             * @constant\n             * @type String\n             * @name CHECKMETHOD_OVERLAP\n             * @memberOf me.DroptargetEntity\n             */\n            this.CHECKMETHOD_OVERLAP = \"overlaps\";\n            /**\n             * constant for the contains method\n             * @public\n             * @constant\n             * @type String\n             * @name CHECKMETHOD_CONTAINS\n             * @memberOf me.DroptargetEntity\n             */\n            this.CHECKMETHOD_CONTAINS = \"contains\";\n            /**\n             * the checkmethod we want to use\n             * @public\n             * @constant\n             * @type String\n             * @name checkMethod\n             * @memberOf me.DroptargetEntity\n             */\n            this.checkMethod = null;\n            Entity.prototype.init.apply(this, [x, y, settings]);\n            Event.subscribe(Event.DRAGEND, this.checkOnMe.bind(this));\n            this.checkMethod = this[this.CHECKMETHOD_OVERLAP];\n        },\n\n        /**\n         * Sets the collision method which is going to be used to check a valid drop\n         * @name setCheckMethod\n         * @memberOf me.DroptargetEntity\n         * @function\n         * @param {Constant} checkMethod the checkmethod (defaults to CHECKMETHOD_OVERLAP)\n         */\n        setCheckMethod: function (checkMethod) {\n            //  We can improve this check,\n            //  because now you can use every method in theory\n            if (typeof(this[checkMethod]) !== \"undefined\") {\n                this.checkMethod = this[checkMethod];\n            }\n        },\n\n        /**\n         * Checks if a dropped entity is dropped on the current entity\n         * @name checkOnMe\n         * @memberOf me.DroptargetEntity\n         * @function\n         * @param {Object} draggableEntity the draggable entity that is dropped\n         */\n        checkOnMe: function (e, draggableEntity) {\n            if (draggableEntity && this.checkMethod(draggableEntity.getBounds())) {\n                // call the drop method on the current entity\n                this.drop(draggableEntity);\n            }\n        },\n\n        /**\n         * Gets called when a draggable entity is dropped on the current entity\n         * @name drop\n         * @memberOf me.DroptargetEntity\n         * @function\n         * @param {Object} draggableEntity the draggable entity that is dropped\n         */\n        drop: function () {},\n\n        /**\n         * Destructor\n         * @name destroy\n         * @memberOf me.DroptargetEntity\n         * @function\n         */\n        destroy: function () {\n            Event.unsubscribe(Event.DRAGEND, this.checkOnMe);\n        }\n    });\n}(me.Entity, me.event));\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n\n/*\n * A Collectable entity\n */\n\n/**\n * @class\n * @extends me.Entity\n * @memberOf me\n * @constructor\n * @param {Number} x the x coordinates of the entity object\n * @param {Number} y the y coordinates of the entity object\n * @param {Object} settings See {@link me.Entity}\n */\nme.CollectableEntity = me.Entity.extend(\n/** @scope me.CollectableEntity.prototype */\n{\n    /** @ignore */\n    init : function (x, y, settings) {\n        // call the super constructor\n        me.Entity.prototype.init.apply(this, [x, y, settings]);\n        this.body.collisionType = me.collision.types.COLLECTABLE_OBJECT;\n    }\n});\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n\n/*\n * A level entity\n */\n\n/**\n * @class\n * @extends me.Entity\n * @memberOf me\n * @constructor\n * @param {Number} x the x coordinates of the object\n * @param {Number} y the y coordinates of the object\n * @param {Object} settings See {@link me.Entity}\n * @param {String} [settings.duration] Fade duration (in ms)\n * @param {String|me.Color} [settings.color] Fade color\n * @param {String} [settings.to] TMX level to load\n * @param {String|me.Container} [settings.container] Target container. See {@link me.levelDirector.loadLevel}\n * @param {Function} [settings.onLoaded] Level loaded callback. See {@link me.levelDirector.loadLevel}\n * @param {Boolean} [settings.flatten] Flatten all objects into the target container. See {@link me.levelDirector.loadLevel}\n * @param {Boolean} [settings.setViewportBounds] Resize the viewport to match the level. See {@link me.levelDirector.loadLevel}\n * @example\n * me.game.world.addChild(new me.LevelEntity(\n *     x, y, {\n *         \"duration\" : 250,\n *         \"color\" : \"#000\",\n *         \"to\" : \"mymap2\"\n *     }\n * ));\n */\nme.LevelEntity = me.Entity.extend(\n/** @scope me.LevelEntity.prototype */\n{\n    /** @ignore */\n    init : function (x, y, settings) {\n        me.Entity.prototype.init.apply(this, [x, y, settings]);\n\n        this.nextlevel = settings.to;\n\n        this.fade = settings.fade;\n        this.duration = settings.duration;\n        this.fading = false;\n\n        this.name = \"levelEntity\";\n\n        // a temp variable\n        this.gotolevel = settings.to;\n\n        // Collect the defined level settings\n        this.loadLevelSettings = {};\n        [ \"container\", \"onLoaded\", \"flatten\", \"setViewportBounds\" ].forEach(function (v) {\n            if (typeof(settings[v]) !== \"undefined\") {\n                this.loadLevelSettings[v] = settings[v];\n            }\n        }.bind(this));\n\n        // Lookup container name\n        if (typeof(this.loadLevelSettings.container) === \"string\") {\n            this.loadLevelSettings.container = me.game.world.getChildByName(this.loadLevelSettings.container)[0];\n        }\n\n        this.body.collisionType = me.collision.types.ACTION_OBJECT;\n    },\n\n    /**\n     * @ignore\n     */\n    onFadeComplete : function () {\n        me.levelDirector.loadLevel(this.gotolevel, this.loadLevelSettings);\n        me.game.viewport.fadeOut(this.fade, this.duration);\n    },\n\n    /**\n     * go to the specified level\n     * @name goTo\n     * @memberOf me.LevelEntity\n     * @function\n     * @param {String} [level=this.nextlevel] name of the level to load\n     * @protected\n     */\n    goTo : function (level) {\n        this.gotolevel = level || this.nextlevel;\n        // load a level\n        //console.log(\"going to : \", to);\n        if (this.fade && this.duration) {\n            if (!this.fading) {\n                this.fading = true;\n                me.game.viewport.fadeIn(this.fade, this.duration,\n                        this.onFadeComplete.bind(this));\n            }\n        } else {\n            me.levelDirector.loadLevel(this.gotolevel, this.loadLevelSettings);\n        }\n    },\n\n    /** @ignore */\n    onCollision : function () {\n        if (this.name === \"levelEntity\") {\n            this.goTo();\n        }\n        return false;\n    }\n});\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n    // generate a default image for the particles\n    var pixel = (function () {\n        var canvas = me.video.createCanvas(1, 1);\n        var context = canvas.getContext(\"2d\");\n        context.fillStyle = \"#fff\";\n        context.fillRect(0, 0, 1, 1);\n        return canvas;\n    })();\n\n    /**\n     * me.ParticleEmitterSettings contains the default settings for me.ParticleEmitter.<br>\n     *\n     * @protected\n     * @class\n     * @memberOf me\n     * @see me.ParticleEmitter\n     */\n    me.ParticleEmitterSettings = {\n        /**\n         * Width of the particle spawn area.<br>\n         * @public\n         * @type Number\n         * @name width\n         * @memberOf me.ParticleEmitterSettings\n         * @default 0\n         */\n        width : 0,\n\n        /**\n         * Height of the particle spawn area.<br>\n         * @public\n         * @type Number\n         * @name height\n         * @memberOf me.ParticleEmitterSettings\n         * @default 0\n         */\n        height : 0,\n\n        /**\n         * Image used for particles.<br>\n         * @public\n         * @type CanvasImageSource\n         * @name image\n         * @memberOf me.ParticleEmitterSettings\n         * @default 1x1 white pixel\n         * @see http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasimagesource\n         */\n        image : pixel,\n\n        /**\n         * Total number of particles in the emitter.<br>\n         * @public\n         * @type Number\n         * @name totalParticles\n         * @default 50\n         * @memberOf me.ParticleEmitterSettings\n         */\n        totalParticles : 50,\n\n        /**\n         * Start angle for particle launch in Radians.<br>\n         * @public\n         * @type Number\n         * @name angle\n         * @default Math.PI / 2\n         * @memberOf me.ParticleEmitterSettings\n         */\n        angle : Math.PI / 2,\n\n        /**\n         * Variation in the start angle for particle launch in Radians.<br>\n         * @public\n         * @type Number\n         * @name angleVariation\n         * @default 0\n         * @memberOf me.ParticleEmitterSettings\n         */\n        angleVariation : 0,\n\n        /**\n         * Minimum time each particle lives once it is emitted in ms.<br>\n         * @public\n         * @type Number\n         * @name minLife\n         * @default 1000\n         * @memberOf me.ParticleEmitterSettings\n         */\n        minLife : 1000,\n\n        /**\n         * Maximum time each particle lives once it is emitted in ms.<br>\n         * @public\n         * @type Number\n         * @name maxLife\n         * @default 3000\n         * @memberOf me.ParticleEmitterSettings\n         */\n        maxLife : 3000,\n\n        /**\n         * Start speed of particles.<br>\n         * @public\n         * @type Number\n         * @name speed\n         * @default 2\n         * @memberOf me.ParticleEmitterSettings\n         */\n        speed : 2,\n\n        /**\n         * Variation in the start speed of particles.<br>\n         * @public\n         * @type Number\n         * @name speedVariation\n         * @default 1\n         * @memberOf me.ParticleEmitterSettings\n         */\n        speedVariation : 1,\n\n        /**\n         * Minimum start rotation for particles sprites in Radians.<br>\n         * @public\n         * @type Number\n         * @name minRotation\n         * @default 0\n         * @memberOf me.ParticleEmitterSettings\n         */\n        minRotation : 0,\n\n        /**\n         * Maximum start rotation for particles sprites in Radians.<br>\n         * @public\n         * @type Number\n         * @name maxRotation\n         * @default 0\n         * @memberOf me.ParticleEmitterSettings\n         */\n        maxRotation : 0,\n\n        /**\n         * Minimum start scale ratio for particles (1 = no scaling).<br>\n         * @public\n         * @type Number\n         * @name minStartScale\n         * @default 1\n         * @memberOf me.ParticleEmitterSettings\n         */\n        minStartScale : 1,\n\n        /**\n         * Maximum start scale ratio for particles (1 = no scaling).<br>\n         * @public\n         * @type Number\n         * @name maxStartScale\n         * @default 1\n         * @memberOf me.ParticleEmitterSettings\n         */\n        maxStartScale : 1,\n\n        /**\n         * Minimum end scale ratio for particles.<br>\n         * @public\n         * @type Number\n         * @name minEndScale\n         * @default 0\n         * @memberOf me.ParticleEmitterSettings\n         */\n        minEndScale : 0,\n\n        /**\n         * Maximum end scale ratio for particles.<br>\n         * @public\n         * @type Number\n         * @name maxEndScale\n         * @default 0\n         * @memberOf me.ParticleEmitterSettings\n         */\n        maxEndScale : 0,\n\n        /**\n         * Vertical force (Gravity) for each particle.<br>\n         * @public\n         * @type Number\n         * @name gravity\n         * @default 0\n         * @memberOf me.ParticleEmitterSettings\n         * @see me.sys.gravity\n         */\n        gravity : 0,\n\n        /**\n         * Horizontal force (like a Wind) for each particle.<br>\n         * @public\n         * @type Number\n         * @name wind\n         * @default 0\n         * @memberOf me.ParticleEmitterSettings\n         */\n        wind : 0,\n\n        /**\n         * Update the rotation of particle in accordance the particle trajectory.<br>\n         * The particle sprite should aim at zero angle (draw from left to right).<br>\n         * Override the particle minRotation and maxRotation.<br>\n         * @public\n         * @type Boolean\n         * @name followTrajectory\n         * @default false\n         * @memberOf me.ParticleEmitterSettings\n         */\n        followTrajectory : false,\n\n        /**\n         * Enable the Texture Additive by canvas composite operation (lighter).<br>\n         * WARNING: Composite Operation may decreases performance!.<br>\n         * @public\n         * @type Boolean\n         * @name textureAdditive\n         * @default false\n         * @memberOf me.ParticleEmitterSettings\n         */\n        textureAdditive : false,\n\n        /**\n         * Update particles only in the viewport, remove it when out of viewport.<br>\n         * @public\n         * @type Boolean\n         * @name onlyInViewport\n         * @default true\n         * @memberOf me.ParticleEmitterSettings\n         */\n        onlyInViewport : true,\n\n        /**\n         * Render particles in screen space. <br>\n         * @public\n         * @type Boolean\n         * @name floating\n         * @default false\n         * @memberOf me.ParticleEmitterSettings\n         */\n        floating : false,\n\n        /**\n         * Maximum number of particles launched each time in this emitter (used only if emitter is Stream).<br>\n         * @public\n         * @type Number\n         * @name maxParticles\n         * @default 10\n         * @memberOf me.ParticleEmitterSettings\n         */\n        maxParticles : 10,\n\n        /**\n         * How often a particle is emitted in ms (used only if emitter is Stream).<br>\n         * Necessary that value is greater than zero.<br>\n         * @public\n         * @type Number\n         * @name frequency\n         * @default 100\n         * @memberOf me.ParticleEmitterSettings\n         */\n        frequency : 100,\n\n        /**\n         * Duration that the emitter releases particles in ms (used only if emitter is Stream).<br>\n         * After this period, the emitter stop the launch of particles.<br>\n         * @public\n         * @type Number\n         * @name duration\n         * @default Infinity\n         * @memberOf me.ParticleEmitterSettings\n         */\n        duration : Infinity,\n\n        /**\n         * Skip n frames after updating the particle system once. <br>\n         * This can be used to reduce the performance impact of emitters with many particles.<br>\n         * @public\n         * @type Number\n         * @name framesToSkip\n         * @default 0\n         * @memberOf me.ParticleEmitterSettings\n         */\n        framesToSkip : 0\n    };\n\n    /**\n     * Particle Emitter Object.\n     * @class\n     * @extends Rect\n     * @memberOf me\n     * @constructor\n     * @param {Number} x x-position of the particle emitter\n     * @param {Number} y y-position of the particle emitter\n     * @param {object} settings An object containing the settings for the particle emitter. See {@link me.ParticleEmitterSettings}\n     * @example\n     *\n     * // Create a basic emitter at position 100, 100\n     * var emitter = new me.ParticleEmitter(100, 100);\n     *\n     * // Adjust the emitter properties\n     * emitter.totalParticles = 200;\n     * emitter.minLife = 1000;\n     * emitter.maxLife = 3000;\n     * emitter.z = 10;\n     *\n     * // Add the emitter to the game world\n     * me.game.world.addChild(emitter);\n     * me.game.world.addChild(emitter.container);\n     *\n     * // Launch all particles one time and stop, like a explosion\n     * emitter.burstParticles();\n     *\n     * // Launch constantly the particles, like a fountain\n     * emitter.streamParticles();\n     *\n     * // At the end, remove emitter from the game world\n     * // call this in onDestroyEvent function\n     * me.game.world.removeChild(emitter);\n     *\n     */\n    me.ParticleEmitter = me.Rect.extend(\n    /** @scope me.ParticleEmitter.prototype */\n    {\n        /**\n         * @ignore\n         */\n        init: function (x, y, settings) {\n            // Emitter is Stream, launch particles constantly\n            /** @ignore */\n            this._stream = false;\n\n            // Frequency timer (in ms) for emitter launch new particles\n            // used only in stream emitter\n            /** @ignore */\n            this._frequencyTimer = 0;\n\n            // Time of live (in ms) for emitter launch new particles\n            // used only in stream emitter\n            /** @ignore */\n            this._durationTimer = 0;\n\n            // Emitter is emitting particles\n            /** @ignore */\n            this._enabled = false;\n            // Emitter will always update\n            this.isRenderable = false;\n            // call the super constructor\n            me.Rect.prototype.init.apply(this,\n                [x, y,\n                Infinity,\n                Infinity]\n            );\n\n            // don't sort the particles by z-index\n            this.autoSort = false;\n\n            this.container = new me.ParticleContainer(this);\n\n            /**\n             * @ignore\n             */\n            Object.defineProperty(this.pos, \"z\", {\n                get : (function () { return this.container.pos.z; }).bind(this),\n                set : (function (value) { this.container.pos.z = value; }).bind(this),\n                enumerable : true,\n                configurable : true\n            });\n\n            /**\n             * Floating property for particles, value is forwarded to the particle container <br>\n             * @type Boolean\n             * @name floating\n             * @memberOf me.ParticleEmitter\n             */\n            Object.defineProperty(this, \"floating\", {\n                get : function () { return this.container.floating; },\n                set : function (value) { this.container.floating = value; },\n                enumerable : true,\n                configurable : true\n            });\n\n            // Reset the emitter to defaults\n            this.reset(settings);\n        },\n        \n        onActivateEvent: function() {\n            this.ancestor.addChild(this.container);\n            this.container.pos.z = this.pos.z;\n            if (!this.ancestor.autoSort) {\n                this.ancestor.sort();\n            }\n        },\n        \n        onDeactivateEvent: function() {\n            this.container.ancestor.removeChild(this.container);\n        },\n\n        destroy: function () {\n            this.reset();\n        },\n\n        /**\n         * returns a random point inside the bounds for this emitter\n         * @name getRandomPoint\n         * @memberOf me.ParticleEmitter\n         * @function\n         * @return {me.Vector2d} new vector\n         */\n        getRandomPoint: function () {\n            var vector = this.pos.clone();\n            vector.x += (0).randomFloat(this.width);\n            vector.y += (0).randomFloat(this.height);\n            return vector;\n        },\n\n        /**\n         * Reset the emitter with default values.<br>\n         * @function\n         * @param {Object} settings [optional] object with emitter settings. See {@link me.ParticleEmitterSettings}\n         * @name reset\n         * @memberOf me.ParticleEmitter\n         */\n        reset: function (settings) {\n            // check if settings exists and create a dummy object if necessary\n            settings = settings || {};\n            var defaults = me.ParticleEmitterSettings;\n\n            var width = (typeof settings.width === \"number\") ? settings.width : defaults.width;\n            var height = (typeof settings.height === \"number\") ? settings.height : defaults.height;\n            this.resize(width, height);\n\n            Object.assign(this, defaults, settings);\n\n            // reset particle container values\n            this.container.destroy();\n        },\n\n        // Add count particles in the game world\n        /** @ignore */\n        addParticles: function (count) {\n            for (var i = 0; i < ~~count; i++) {\n                // Add particle to the container\n                var particle = me.pool.pull(\"me.Particle\", this);\n                this.container.addChild(particle);\n            }\n        },\n\n        /**\n         * Emitter is of type stream and is launching particles <br>\n         * @function\n         * @returns {Boolean} Emitter is Stream and is launching particles\n         * @name isRunning\n         * @memberOf me.ParticleEmitter\n         */\n        isRunning: function () {\n            return this._enabled && this._stream;\n        },\n\n        /**\n         * Launch particles from emitter constantly <br>\n         * Particles example: Fountains\n         * @param {Number} duration [optional] time that the emitter releases particles in ms\n         * @function\n         * @name streamParticles\n         * @memberOf me.ParticleEmitter\n         */\n        streamParticles: function (duration) {\n            this._enabled = true;\n            this._stream = true;\n            this.frequency = Math.max(this.frequency, 1);\n            this._durationTimer = (typeof duration === \"number\") ? duration : this.duration;\n        },\n\n        /**\n         * Stop the emitter from generating new particles (used only if emitter is Stream) <br>\n         * @function\n         * @name stopStream\n         * @memberOf me.ParticleEmitter\n         */\n        stopStream: function () {\n            this._enabled = false;\n        },\n\n        /**\n         * Launch all particles from emitter and stop <br>\n         * Particles example: Explosions <br>\n         * @param {Number} total [optional] number of particles to launch\n         * @function\n         * @name burstParticles\n         * @memberOf me.ParticleEmitter\n         */\n        burstParticles: function (total) {\n            this._enabled = true;\n            this._stream = false;\n            this.addParticles((typeof total === \"number\") ? total : this.totalParticles);\n            this._enabled = false;\n        },\n\n        /**\n         * @ignore\n         */\n        update: function (dt) {\n            // Launch new particles, if emitter is Stream\n            if ((this._enabled) && (this._stream)) {\n                // Check if the emitter has duration set\n                if (this._durationTimer !== Infinity) {\n                    this._durationTimer -= dt;\n\n                    if (this._durationTimer <= 0) {\n                        this.stopStream();\n                        return false;\n                    }\n                }\n\n                // Increase the emitter launcher timer\n                this._frequencyTimer += dt;\n\n                // Check for new particles launch\n                var particlesCount = this.container.children.length;\n                if ((particlesCount < this.totalParticles) && (this._frequencyTimer >= this.frequency)) {\n                    if ((particlesCount + this.maxParticles) <= this.totalParticles) {\n                        this.addParticles(this.maxParticles);\n                    }\n                    else {\n                        this.addParticles(this.totalParticles - particlesCount);\n                    }\n\n                    this._frequencyTimer = 0;\n                }\n            }\n            return true;\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n    /**\n     * Particle Container Object.\n     * @class\n     * @extends me.Container\n     * @memberOf me\n     * @constructor\n     * @param {me.ParticleEmitter} emitter the emitter which owns this container\n     */\n    me.ParticleContainer = me.Container.extend(\n    /** @scope ParticleContainer */\n    {\n        /**\n         * @ignore\n         */\n        init: function (emitter) {\n            // cache a reference to the viewport to use as our bounding box\n            this._viewport = me.game.viewport;\n\n            // call the super constructor\n            me.Container.prototype.init.apply(this);\n\n            // don't sort the particles by z-index\n            this.autoSort = false;\n\n            // count the updates\n            this._updateCount = 0;\n\n            // internally store how much time was skipped when frames are skipped\n            this._dt = 0;\n\n            // cache the emitter for later use\n            this._emitter = emitter;\n        },\n\n        /**\n         * @ignore\n         */\n        getBounds : function () {\n            return this._viewport;\n        },\n\n        /**\n         * @ignore\n         */\n        update: function (dt) {\n            // skip frames if necessary\n            if (++this._updateCount > this._emitter.framesToSkip) {\n                this._updateCount = 0;\n            }\n            if (this._updateCount > 0) {\n                this._dt += dt;\n                return false;\n            }\n\n            // apply skipped delta time\n            dt += this._dt;\n            this._dt = 0;\n\n            // Update particles and remove them if they are dead\n            var viewport = me.game.viewport;\n            for (var i = this.children.length - 1; i >= 0; --i) {\n                var particle = this.children[i];\n                particle.isRenderable = true;\n                // particle.inViewport = viewport.isVisible(particle);\n                particle.inViewport = this.floating || (\n                    particle.pos.x < viewport.pos.x + viewport.width &&\n                    viewport.pos.x < particle.pos.x + particle.width &&\n                    particle.pos.y < viewport.pos.y + viewport.height &&\n                    viewport.pos.y < particle.pos.y + particle.height\n                );\n                if (!particle.update(dt)) {\n                    this.removeChildNow(particle);\n                }\n            }\n            return true;\n        },\n\n        /**\n         * @ignore\n         */\n        draw : function (renderer, rect) {\n            if (this.children.length > 0) {\n                var context = renderer.getContext(),\n                    gco;\n                // Check for additive draw\n                if (this._emitter.textureAdditive) {\n                    gco = context.globalCompositeOperation;\n                    context.globalCompositeOperation = \"lighter\";\n                }\n\n                me.Container.prototype.draw.apply(this, [renderer, rect]);\n\n                // Restore globalCompositeOperation\n                if (this._emitter.textureAdditive) {\n                    context.globalCompositeOperation = gco;\n                }\n            }\n        }\n    });\n})();\n\n/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n */\n(function () {\n    /**\n     * Single Particle Object.\n     * @class\n     * @extends me.Renderable\n     * @memberOf me\n     * @constructor\n     * @param {me.ParticleEmitter} particle emitter\n     */\n    me.Particle = me.Renderable.extend(\n    /** @scope me.Particle.prototype */\n    {\n        /**\n         * @ignore\n         */\n        init : function (emitter) {\n            // Call the super constructor\n            var point = emitter.getRandomPoint();\n            me.Renderable.prototype.init.apply(this, [point.x, point.y, emitter.image.width, emitter.image.height]);\n\n            // Particle will always update\n            this.alwaysUpdate = true;\n\n            // Particle will not act as a rednerable\n            // FIXME: This is probably not needed. It's a hack that tries to\n            // workaround performance issues within container.\n            this.isRenderable = false;\n\n            // Cache the image reference\n            this.image = emitter.image;\n\n            // Set the start particle Angle and Speed as defined in emitter\n            var angle = emitter.angle + ((emitter.angleVariation > 0) ? ((0).randomFloat(2) - 1) * emitter.angleVariation : 0);\n            var speed = emitter.speed + ((emitter.speedVariation > 0) ? ((0).randomFloat(2) - 1) * emitter.speedVariation : 0);\n\n            // Set the start particle Velocity\n            this.vel = new me.Vector2d(speed * Math.cos(angle), -speed * Math.sin(angle));\n\n            // Set the start particle Time of Life as defined in emitter\n            this.life = emitter.minLife.randomFloat(emitter.maxLife);\n            this.startLife = this.life;\n\n            // Set the start and end particle Scale as defined in emitter\n            // clamp the values as minimum and maximum scales range\n            this.startScale = emitter.minStartScale.randomFloat(\n                emitter.maxStartScale\n            ).clamp(emitter.minStartScale, emitter.maxStartScale);\n            this.endScale = emitter.minEndScale.randomFloat(\n                emitter.maxEndScale\n            ).clamp(emitter.minEndScale, emitter.maxEndScale);\n\n            // Set the particle Gravity and Wind (horizontal gravity) as defined in emitter\n            this.gravity = emitter.gravity;\n            this.wind = emitter.wind;\n\n            // Set if the particle update the rotation in accordance the trajectory\n            this.followTrajectory = emitter.followTrajectory;\n\n            // Set if the particle update only in Viewport\n            this.onlyInViewport = emitter.onlyInViewport;\n\n            // Set the particle Z Order\n            this.pos.z = emitter.z;\n\n            // cache inverse of the expected delta time\n            this._deltaInv = me.sys.fps / 1000;\n\n            this.transform = new me.Matrix2d();\n\n            // Set the start particle rotation as defined in emitter\n            // if the particle not follow trajectory\n            if (!emitter.followTrajectory) {\n                this.angle = emitter.minRotation.randomFloat(emitter.maxRotation);\n            }\n        },\n\n        /**\n         * Update the Particle <br>\n         * This is automatically called by the game manager {@link me.game}\n         * @name update\n         * @memberOf me.Particle\n         * @function\n         * @ignore\n         * @param {Number} dt time since the last update in milliseconds\n         */\n        update : function (dt) {\n            // move things forward independent of the current frame rate\n            var skew = dt * this._deltaInv;\n\n            // Decrease particle life\n            this.life = this.life > dt ? this.life - dt : 0;\n\n            // Calculate the particle Age Ratio\n            var ageRatio = this.life / this.startLife;\n\n            // Resize the particle as particle Age Ratio\n            var scale = this.startScale;\n            if (this.startScale > this.endScale) {\n                scale *= ageRatio;\n                scale = (scale < this.endScale) ? this.endScale : scale;\n            }\n            else if (this.startScale < this.endScale) {\n                scale /= ageRatio;\n                scale = (scale > this.endScale) ? this.endScale : scale;\n            }\n\n            // Set the particle opacity as Age Ratio\n            this.alpha = ageRatio;\n\n            // Adjust the particle velocity\n            this.vel.x += this.wind * skew;\n            this.vel.y += this.gravity * skew;\n\n            // If necessary update the rotation of particle in accordance the particle trajectory\n            var angle = this.followTrajectory ? Math.atan2(this.vel.y, this.vel.x) : this.angle;\n\n            this.pos.x += this.vel.x * skew;\n            this.pos.y += this.vel.y * skew;\n\n            // Update particle transform\n            this.transform.set(\n                scale, 0, 0,\n                0, scale, 0,\n                ~~this.pos.x, ~~this.pos.y, 1\n            ).rotate(angle);\n\n            // Return true if the particle is not dead yet\n            return (this.inViewport || !this.onlyInViewport) && (this.life > 0);\n        },\n\n        draw : function (renderer) {\n            renderer.save();\n\n            // particle alpha value\n            renderer.setGlobalAlpha(renderer.globalAlpha() * this.alpha);\n\n            // translate to the defined anchor point and scale it\n            renderer.transform(this.transform);\n\n            var w = this.width, h = this.height;\n            renderer.drawImage(\n                this.image,\n                0, 0,\n                w, h,\n                -w / 2, -h / 2,\n                w, h\n            );\n\n            renderer.restore();\n        }\n    });\n\n\n    /*---------------------------------------------------------*/\n    // END END END\n    /*---------------------------------------------------------*/\n})(window);\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./lib/melonJS.js\n ** module id = 1\n ** module chunks = 0\n **/","/*\n * MelonJS Game Engine\n * Copyright (C) 2011 - 2015, Olivier Biot, Jason Oster, Aaron McLeod\n * http://www.melonjs.org\n *\n * a simple debug panel plugin\n * usage : me.plugin.register.defer(this, me.debug.Panel, \"debug\");\n *\n * you can then use me.plugin.debug.show() or me.plugin.debug.hide()\n * to show or hide the panel, or press respectively the \"S\" and \"H\" keys.\n *\n * note :\n * Heap Memory information is available under Chrome when using\n * the \"--enable-memory-info\" parameter to launch Chrome\n */\n\n(function () {\n\n    // ensure that me.debug is defined\n    me.debug = me.debug || {};\n\n    var DEBUG_HEIGHT = 50;\n\n    var Counters = me.Object.extend({\n        init : function (stats) {\n            this.stats = {};\n            this.reset(stats);\n        },\n\n        reset : function (stats) {\n            var self = this;\n            (stats || Object.keys(this.stats)).forEach(function (stat) {\n                self.stats[stat] = 0;\n            });\n        },\n\n        inc : function (stat, value) {\n            this.stats[stat] += (value || 1);\n        },\n\n        get : function (stat) {\n            return this.stats[stat];\n        }\n    });\n\n    var DebugPanel = me.Renderable.extend({\n        /** @private */\n        init : function (showKey, hideKey) {\n            // call the super constructor\n            this._super(me.Renderable, \"init\", [ 0, 0, me.game.viewport.width, DEBUG_HEIGHT ]);\n\n            // minimum melonJS version expected\n            this.version = \"2.1.0\";\n\n            // to hold the debug options\n            // clickable rect area\n            this.area = {};\n\n            // Useful counters\n            this.counters = new Counters([\n                \"shapes\",\n                \"sprites\",\n                \"velocity\",\n                \"bounds\",\n                \"children\"\n            ]);\n\n            // for z ordering\n            // make it ridiculously high\n            this.z = Infinity;\n\n            // visibility flag\n            this.visible = false;\n\n            // frame update time in ms\n            this.frameUpdateTime = 0;\n\n            // frame draw time in ms\n            this.frameDrawTime = 0;\n\n            // set the object GUID value\n            this.GUID = \"debug-\" + me.utils.createGUID();\n\n            // set the object entity name\n            this.name = \"me.debugPanel\";\n\n            // persistent\n            this.isPersistent = true;\n\n            // a floating object\n            this.floating = true;\n\n            // renderable\n            this.isRenderable = true;\n\n            // always update, even when not visible\n            this.alwaysUpdate = true;\n\n            // WebGL/Canvas compatibility\n            this.canvas = me.video.createCanvas(this.width, this.height, true);\n\n            // create a default font, with fixed char width\n            this.font_size = 10;\n            this.mod = 1;\n            if (this.width < 500) {\n                this.font_size = 7;\n                this.mod = 0.7;\n            }\n            this.font = new me.Font(\"courier\", this.font_size, \"white\");\n\n            // clickable areas\n            var size = 12 * this.mod;\n            this.area.renderHitBox   = new me.Rect(163, 5,  size, size);\n            this.area.renderVelocity = new me.Rect(163, 20, size, size);\n            this.area.renderQuadTree = new me.Rect(253, 5,  size, size);\n\n            // some internal string/length\n            this.help_str        = \"(s)how/(h)ide\";\n            this.help_str_len    = this.font.measureText(me.video.renderer, this.help_str).width;\n            this.fps_str_len     = this.font.measureText(me.video.renderer, \"00/00 fps\").width;\n            this.memoryPositionX = 400 * this.mod;\n\n            // enable the FPS counter\n            me.debug.displayFPS = true;\n\n            // bind the \"S\" and \"H\" keys\n            me.input.bindKey(showKey || me.input.KEY.S, \"show\", false, false);\n            me.input.bindKey(hideKey || me.input.KEY.H, \"hide\", false, false);\n\n            // add some keyboard shortcuts\n            var self = this;\n            this.keyHandler = me.event.subscribe(me.event.KEYDOWN, function (action) {\n                if (action === \"show\") {\n                    self.show();\n                }\n                else if (action === \"hide\") {\n                    self.hide();\n                }\n            });\n            me.event.subscribe(me.event.VIEWPORT_ONRESIZE, function (w) {\n                self.resize(w, DEBUG_HEIGHT);\n            });\n\n            //patch patch patch !\n            this.patchSystemFn();\n        },\n\n        /**\n         * patch system fn to draw debug information\n         */\n        patchSystemFn : function () {\n\n            // add a few new debug flag (if not yet defined)\n            me.debug.renderHitBox   = me.debug.renderHitBox   || me.game.HASH.hitbox || false;\n            me.debug.renderVelocity = me.debug.renderVelocity || me.game.HASH.velocity || false;\n            me.debug.renderQuadTree = me.debug.renderQuadTree || me.game.HASH.quadtree || false;\n\n            var _this = this;\n            var bounds = new me.Rect(0, 0, 0, 0);\n\n            // patch timer.js\n            me.plugin.patch(me.timer, \"update\", function (dt) {\n                // call the original me.timer.update function\n                this._patched(dt);\n\n                // call the FPS counter\n                me.timer.countFPS();\n            });\n\n            // patch me.game.update\n            me.plugin.patch(me.game, \"update\", function (dt) {\n                var frameUpdateStartTime = window.performance.now();\n\n                this._patched(dt);\n\n                // calculate the update time\n                _this.frameUpdateTime = window.performance.now() - frameUpdateStartTime;\n            });\n\n            // patch me.game.draw\n            me.plugin.patch(me.game, \"draw\", function () {\n                var frameDrawStartTime = window.performance.now();\n\n                _this.counters.reset();\n                this._patched();\n\n                // calculate the drawing time\n                _this.frameDrawTime = window.performance.now() - frameDrawStartTime;\n            });\n\n            // patch sprite.js\n            me.plugin.patch(me.Sprite, \"draw\", function (renderer) {\n                // call the original me.Sprite.draw function\n                this._patched(renderer);\n\n                // draw the sprite rectangle\n                if (me.debug.renderHitBox) {\n                    renderer.save();\n                    renderer.setColor(\"green\");\n                    renderer.strokeRect(this.left, this.top, this.width, this.height);\n                    _this.counters.inc(\"sprites\");\n                    renderer.restore();\n                }\n            });\n\n            // patch entities.js\n            me.plugin.patch(me.Entity, \"draw\", function (renderer) {\n                // call the original me.Entity.draw function\n                this._patched(renderer);\n\n                // check if debug mode is enabled\n                if (me.debug.renderHitBox) {\n                    renderer.save();\n                    renderer.setLineWidth(1);\n\n                    // draw the bounding rect shape\n                    renderer.setColor(\"orange\");\n                    bounds.copy(this.getBounds());\n                    bounds.pos.sub(this.ancestor._absPos);\n                    renderer.drawShape(bounds);\n                    _this.counters.inc(\"bounds\");\n\n                    // draw all defined shapes\n                    renderer.setColor(\"red\");\n                    renderer.translate(this.pos.x, this.pos.y);\n                    for (var i = this.body.shapes.length, shape; i--, (shape = this.body.shapes[i]);) {\n                        renderer.drawShape(shape);\n                        _this.counters.inc(\"shapes\");\n                    }\n\n                    renderer.restore();\n                }\n\n                if (me.debug.renderVelocity && (this.body.vel.x || this.body.vel.y)) {\n                    bounds.copy(this.getBounds());\n                    bounds.pos.sub(this.ancestor._absPos);\n                    // draw entity current velocity\n                    var x = ~~(bounds.pos.x + (bounds.width / 2));\n                    var y = ~~(bounds.pos.y + (bounds.height / 2));\n\n                    renderer.save();\n                    renderer.setLineWidth(1);\n\n                    renderer.setColor(\"blue\");\n                    renderer.translate(x, y);\n                    renderer.strokeLine(0, 0, ~~(this.body.vel.x * (bounds.width / 2)), ~~(this.body.vel.y * (bounds.height / 2)));\n                    _this.counters.inc(\"velocity\");\n\n                    renderer.restore();\n                }\n            });\n\n            // patch container.js\n            me.plugin.patch(me.Container, \"draw\", function (renderer, rect) {\n                // call the original me.Container.draw function\n                this._patched(renderer, rect);\n\n                // check if debug mode is enabled\n\n                if (me.debug.renderHitBox) {\n                    renderer.save();\n                    renderer.setLineWidth(1);\n\n                    // draw the bounding rect shape\n                    renderer.setColor(\"orange\");\n                    bounds.copy(this.getBounds());\n                    bounds.pos.sub(this.ancestor._absPos);\n                    renderer.drawShape(bounds);\n                    _this.counters.inc(\"bounds\");\n\n                    // draw the children bounding rect shape\n                    renderer.setColor(\"purple\");\n                    bounds.copy(this.childBounds);\n                    bounds.pos.sub(this.ancestor._absPos);\n                    renderer.drawShape(bounds);\n                    _this.counters.inc(\"children\");\n\n                    renderer.restore();\n                }\n            });\n        },\n\n        /**\n         * show the debug panel\n         */\n        show : function () {\n            if (!this.visible) {\n                // register a mouse event for the checkboxes\n                me.input.registerPointerEvent(\"pointerdown\", this, this.onClick.bind(this), true);\n                // add the debug panel to the game world\n                me.game.world.addChild(this, Infinity);\n                // mark it as visible\n                this.visible = true;\n            }\n        },\n\n        /**\n         * hide the debug panel\n         */\n        hide : function () {\n            if (this.visible) {\n                // release the mouse event for the checkboxes\n                // me.input.releasePointerEvent(\"pointerdown\", this);\n                this.canvas.removeEventListener(\"click\", this.onClick.bind(this));\n                // remove the debug panel from the game world\n                me.game.world.removeChild(this);\n                // mark it as invisible\n                this.visible = false;\n            }\n        },\n\n\n        /** @private */\n        update : function () {\n            if (me.input.isKeyPressed(\"show\")) {\n                this.show();\n            }\n            else if (me.input.isKeyPressed(\"hide\")) {\n                this.hide();\n            }\n            return true;\n        },\n\n        /** @private */\n        onClick : function (e)  {\n            // check the clickable areas\n            if (this.area.renderHitBox.containsPoint(e.gameX, e.gameY)) {\n                me.debug.renderHitBox = !me.debug.renderHitBox;\n            }\n            else if (this.area.renderVelocity.containsPoint(e.gameX, e.gameY)) {\n                // does nothing for now, since velocity is\n                // rendered together with hitboxes (is a global debug flag required?)\n                me.debug.renderVelocity = !me.debug.renderVelocity;\n            }\n            else if (this.area.renderQuadTree.containsPoint(e.gameX, e.gameY)) {\n                me.debug.renderQuadTree = !me.debug.renderQuadTree;\n            }\n            // force repaint\n            me.game.repaint();\n        },\n\n        /** @private */\n        drawQuadTreeNode : function (renderer, node) {\n            var bounds = node.bounds;\n\n            // draw the current bounds\n            if (node.nodes.length === 0) {\n                // cap the alpha value to 0.4 maximum\n                var _alpha = (node.objects.length * 0.4) / me.collision.maxChildren;\n                if (_alpha > 0.0) {\n                    renderer.save();\n                    renderer.setColor(\"rgba(255,0,0,\" + _alpha + \")\");\n                    renderer.fillRect(bounds.pos.x, bounds.pos.y, bounds.width, bounds.height);\n                    renderer.restore();\n                }\n            }\n            else {\n                //has subnodes? drawQuadtree them!\n                for (var i = 0; i < node.nodes.length; i++) {\n                    this.drawQuadTreeNode(renderer, node.nodes[i]);\n                }\n            }\n        },\n\n        /** @private */\n        drawQuadTree : function (renderer) {\n            // save the current globalAlpha value\n            var _alpha = renderer.globalAlpha();\n            var x = me.game.viewport.pos.x;\n            var y = me.game.viewport.pos.y;\n\n            renderer.translate(-x, -y);\n\n            this.drawQuadTreeNode(renderer, me.collision.quadTree);\n\n            renderer.translate(x, y);\n\n            renderer.setGlobalAlpha(_alpha);\n        },\n\n        /** @private */\n        drawMemoryGraph : function (renderer, endX) {\n            if (window.performance && window.performance.memory) {\n                var usedHeap  = Number.prototype.round(window.performance.memory.usedJSHeapSize / 1048576, 2);\n                var totalHeap =  Number.prototype.round(window.performance.memory.totalJSHeapSize / 1048576, 2);\n                var maxLen = ~~(endX - this.memoryPositionX - 5);\n                var len = maxLen * (usedHeap / totalHeap);\n\n                renderer.setColor(\"#0065AD\");\n                renderer.fillRect(this.memoryPositionX, 0, maxLen, 20);\n                renderer.setColor(\"#3AA4F0\");\n                renderer.fillRect(this.memoryPositionX + 1, 1, len - 1, 17);\n\n                this.font.draw(renderer, \"Heap : \" + usedHeap + \"/\" + totalHeap + \" MB\", this.memoryPositionX + 5, 5 * this.mod);\n            }\n            else {\n                // Heap Memory information not available\n                this.font.draw(renderer, \"Heap : ??/?? MB\", this.memoryPositionX, 5 * this.mod);\n            }\n        },\n\n        /** @private */\n        draw : function (renderer) {\n            renderer.save();\n\n            // draw the QuadTree (before the panel)\n            if (me.debug.renderQuadTree === true) {\n                this.drawQuadTree(renderer);\n            }\n\n            // draw the panel\n            renderer.setGlobalAlpha(0.5);\n            renderer.setColor(\"black\");\n            renderer.fillRect(\n                this.left,  this.top,\n                this.width, this.height\n            );\n            renderer.setGlobalAlpha(1.0);\n\n            this.font.draw(renderer, \"#objects : \" + me.game.world.children.length, 5 * this.mod, 5 * this.mod);\n            this.font.draw(renderer, \"#draws   : \" + me.game.world.drawCount, 5 * this.mod, 20 * this.mod);\n\n            // debug checkboxes\n            this.font.draw(renderer, \"?hitbox   [\" + (me.debug.renderHitBox ? \"x\" : \" \") + \"]\",   100 * this.mod, 5 * this.mod);\n            this.font.draw(renderer, \"?velocity [\" + (me.debug.renderVelocity ? \"x\" : \" \") + \"]\", 100 * this.mod, 20 * this.mod);\n\n            this.font.draw(renderer, \"?QuadTree [\" + (me.debug.renderQuadTree ? \"x\" : \" \") + \"]\", 190 * this.mod, 5 * this.mod);\n\n            // draw the update duration\n            this.font.draw(renderer, \"Update : \" + this.frameUpdateTime.toFixed(2) + \" ms\", 285 * this.mod, 5 * this.mod);\n            // draw the draw duration\n            this.font.draw(renderer, \"Draw   : \" + this.frameDrawTime.toFixed(2) + \" ms\", 285 * this.mod, 20 * this.mod);\n\n            this.font.bold();\n\n            // Draw color code hints\n            this.font.fillStyle.copy(\"red\");\n            this.font.draw(renderer, \"Shapes   : \" + this.counters.get(\"shapes\"), 5 * this.mod, 35 * this.mod);\n\n            this.font.fillStyle.copy(\"green\");\n            this.font.draw(renderer, \"Sprites   : \" + this.counters.get(\"sprites\"), 100 * this.mod, 35 * this.mod);\n\n            this.font.fillStyle.copy(\"blue\");\n            this.font.draw(renderer, \"Velocity  : \" + this.counters.get(\"velocity\"), 190 * this.mod, 35 * this.mod);\n\n            this.font.fillStyle.copy(\"orange\");\n            this.font.draw(renderer, \"Bounds : \" + this.counters.get(\"bounds\"), 285 * this.mod, 35 * this.mod);\n\n            this.font.fillStyle.copy(\"purple\");\n            this.font.draw(renderer, \"Children : \" + this.counters.get(\"children\"), 400 * this.mod, 35 * this.mod);\n\n            // Reset font style\n            this.font.setFont(\"courier\", this.font_size, \"white\");\n\n            // draw the memory heap usage\n            var endX = this.width - 25;\n            this.drawMemoryGraph(renderer, endX - this.help_str_len);\n\n            // some help string\n            this.font.draw(renderer, this.help_str, endX - this.help_str_len, 20 * this.mod);\n\n            //fps counter\n            var fps_str = me.timer.fps + \"/\" + me.sys.fps + \" fps\";\n            this.font.draw(renderer, fps_str, this.width - this.fps_str_len - 5, 5 * this.mod);\n\n            renderer.restore();\n        },\n\n        /** @private */\n        onDestroyEvent : function () {\n            // hide the panel\n            this.hide();\n            // unbind keys event\n            me.input.unbindKey(me.input.KEY.S);\n            me.input.unbindKey(me.input.KEY.H);\n            me.event.unsubscribe(this.keyHandler);\n        }\n    });\n\n    /**\n     * @class\n     * @public\n     * @extends me.plugin.Base\n     * @memberOf me\n     * @constructor\n     */\n    me.debug.Panel = me.plugin.Base.extend(\n    /** @scope me.debug.Panel.prototype */\n    {\n\n        /** @private */\n        init : function (showKey, hideKey) {\n            // call the super constructor\n            this._super(me.plugin.Base, \"init\");\n\n            var panel = new DebugPanel(showKey, hideKey);\n            panel.show();\n        }\n    });\n\n    /*---------------------------------------------------------*/\n    // END END END\n    /*---------------------------------------------------------*/\n})();\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./lib/plugins/debugPanel.js\n ** module id = 2\n ** module chunks = 0\n **/","import resources from './resources';\nimport PlayScreen from './screens/play';\nimport TextEntity from './entities/text';\nimport ShipEntity from './entities/ship';\n\n/**\n * main\n */\nwindow.game = {\n\n    /**\n     *\n     * Initialize the application\n     */\n    onload() {\n\n        // init the video\n        if (!me.video.init(800, 800, {wrapper : \"screen\", scale : \"auto\", transparent : \"true\"})) {\n            alert(\"Your browser does not support HTML5 canvas.\");\n            return;\n        }\n\n        // Set some default debug flags\n        me.debug.renderHitBox = true;\n\n        // add \"#debug\" to the URL to enable the debug Panel\n        if (me.game.HASH.debug === true) {\n            window.onReady(function () {\n                me.plugin.register.defer(this, me.debug.Panel, \"debug\", me.input.KEY.V);\n            });\n        }\n\n        // set all ressources to be loaded\n        me.loader.onload = this.loaded.bind(this);\n\n        // set all ressources to be loaded\n        me.loader.preload(resources);\n\n        // load everything & display a loading screen\n        me.state.change(me.state.LOADING);\n    },\n\n    /**\n     * callback when everything is loaded\n     */\n    loaded() {\n\n        // set the \"Play/Ingame\" Screen Object\n        this.playScreen = new PlayScreen();\n        me.state.set(me.state.PLAY, this.playScreen);\n\n        // set the fade transition effect\n        me.state.transition(\"fade\", \"#19232b\", 250);\n\n        // register our objects entity in the object pool\n        let text = new TextEntity(0, 0, 100, 20);\n        text.isPersistent = true;\n        me.game.world.addChild(text);\n\n        let ship = new ShipEntity(7200, 4200, 100, 20);\n        ship.isPersistent = true;\n        me.game.world.addChild(ship);\n\n        // register on mouse event\n        me.input.registerPointerEvent(\"pointermove\", me.game.viewport, function (event) {\n            me.event.publish(\"pointermove\", [ event ]);\n        }, false);\n\n        // switch to PLAY state\n        me.state.change(me.state.PLAY);\n    }\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/game.js\n **/","export default [\n\n    /* Graphics.\n     * @example\n     * { name: \"example\", type:\"image\", src: \"data/img/example.png\" },\n     */\n    { name: \"Tileset_Hexagonal_PointyTop_60x52_60x80\",  type:\"image\", src: \"data/img/Tileset_Hexagonal_PointyTop_60x52_60x80.png\" },\n\n    /* Maps.\n     * @example\n     * { name: \"example01\", type: \"tmx\", src: \"data/map/example01.tmx\" },\n     * { name: \"example01\", type: \"tmx\", src: \"data/map/example01.json\" },\n      */\n    { name: \"map\", type: \"tmx\", src: \"data/map/map.tmx\" },\n\n    /* Background music.\n     * @example\n     * { name: \"example_bgm\", type: \"audio\", src: \"data/bgm/\" },\n     */\n\n    /* Sound effects.\n     * @example\n     * { name: \"example_sfx\", type: \"audio\", src: \"data/sfx/\" }\n     */\n\n    /* Atlases\n     * @example\n     * { name: \"example_tps\", type: \"json\", src: \"data/img/example_tps.json\" },\n     */\n\n];\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/resources.js\n **/","export default me.ScreenObject.extend({\n    /**\n     *  action to perform on state change\n     */\n    onResetEvent() {\n        // load a level\n        me.levelDirector.loadLevel(\"map\");\n    },\n\n    /**\n     *  action to perform on state change\n     */\n    onDestroyEvent() {\n    }\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/screens/play.js\n **/","/************************************************************************************/\n/*                                                                                  */\n/*        a text entity                                                           */\n/*                                                                                  */\n/************************************************************************************/\nexport default me.Renderable.extend({\n    init(x, y, width, height) {\n        const self = this;\n        this.text = \"?,?\";\n        this.fontSize = 20;\n        this.font = new me.Font(\"courier\", this.fontSize, \"white\");\n\n        // call the constructor\n        this._super(me.Renderable, \"init\", [x, y, width, height]);\n        this.floating = true;\n\n        this.pointerDown = me.event.subscribe(\"pointermove\", function (event) {\n            self.text = \"?,?\";\n            //self.text = Math.round(event.gameX) + \",\" + Math.round(event.gameY);\n            if (me.levelDirector.getCurrentLevelId()) {\n                const layer = me.game.world.getChildByName(\"Ground\")[0];\n                const tile = layer.getTile(event.gameWorldX, event.gameWorldY);\n                if (tile) {\n                    self.text = tile.col + \",\" + tile.row;\n                }\n            }\n        });\n    },\n\n    draw(renderer) {\n        renderer.setColor(\"black\");\n        renderer.fillRect(\n            this.left,  this.top,\n            this.width, this.height\n        );\n        this.font.draw(renderer, this.text, this.pos.x, this.pos.y);\n    },\n\n    update() {\n        return true;\n    },\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/entities/text.js\n **/","export default me.Renderable.extend({\n    init(x, y, width, height) {\n        const self = this;\n        this.text = \"SHIP\";\n        this.fontSize = 20;\n        this.font = new me.Font(\"courier\", this.fontSize, \"white\");\n        this.col = 3;\n        this.row = 3;\n\n        // call the constructor\n        this._super(me.Renderable, \"init\", [x, y, width, height]);\n        this.floating = true;\n\n        this.pointerDown = me.event.subscribe(\"pointermove\", function (event) {\n            //self.text = Math.round(event.gameX) + \",\" + Math.round(event.gameY);\n            if (me.levelDirector.getCurrentLevelId()) {\n                const layer = me.game.world.getChildByName(\"Ground\")[0];\n                const tile = layer.getTile(event.gameWorldX, event.gameWorldY);\n                if (tile) {\n                    self.setTile(tile.col, tile.row);\n                }\n            }\n        });\n    },\n\n    setTile(col, row) {\n        this.col = col;\n        this.row = row;\n\n        const odd = this.row % 2 == 1;\n        this.pos.x = (this.col * 60) + 100 + (this.row % 2 * 30);\n        this.pos.y = (this.row * 39);\n    },\n\n    draw(renderer) {\n        renderer.setColor(\"black\");\n        renderer.fillRect(\n            this.left,  this.top,\n            this.width, this.height\n        );\n        this.font.draw(renderer, this.text, this.pos.x, this.pos.y);\n    },\n\n    update() {\n        return true;\n    },\n})\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/entities/ship.js\n **/"],"sourceRoot":""}